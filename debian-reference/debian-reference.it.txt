Debian Reference

                             Osamu Aoki

Diritto d'autore © 2013-2021 Osamu Aoki

    Questa guida di riferimento Debian, Debian Reference (versione
    2.77) (2021-01-10 06:32:51 UTC) è pensata per fornire un'ampia
    panoramica del sistema Debian in qualità di guida
    post-installazione per l'utente. Copre molti aspetti
    dell'amministrazione di sistema attraverso esempi di uso di
    comandi di shell, pensati per chi non è sviluppatore.

Sommario

Questo testo è libero; lo si può ridistribuire e/o modificare nei
termini della GNU General Public License in qualsiasi versione
aderente alle Linee guida Debian per il Software Libero (DFSG).

---------------------------------------------------------------------

Questa guida di riferimento Debian Reference (versione 2.77)
(2021-01-10 06:32:51 UTC) è pensata per fornire un'ampia panoramica
dell'amministrazione di un sistema Debian in qualità di guida
post-installazione per l'utente.

Si rivolge ad un lettore che abbia voglia di imparare gli script di
shell, ma che non è pronto a leggere tutti i sorgenti C per scoprire
come funzioni il sistema GNU/Linux.

Per istruzioni sull'installazione, vedere:

  * Guida all'installazione di Debian GNU/Linux per l'attuale sistema
    stable

  * Guida all'installazione di Debian GNU/Linux per l'attuale sistema
    testing

1. Note legali

    Non viene fornita alcuna garanzia. Tutti i marchi registrati
    appartengono ai rispettivi proprietari.

    Il sistema Debian è, di per sé, un'entità in continuo movimento;
    ciò rende difficile alla sua documentazione essere aggiornata e
    corretta. Sebbene come base per questo testo sia stata usata la
    versione "unstable" al momento della sua stesura, alcuni
    contenuti potrebbero essere obsoleti al momento della sua
    lettura.

    Si consideri questo documento come un riferimento secondario.
    Esso non sostituisce nessuna guida autorevole. L'autore e i
    collaboratori non si assumono responsabilità per le conseguenze
    di errori, omissioni o ambiguità presenti in questo documento.

2. Cosa è Debian

    Il Progetto Debian è un'associazione di individui che hanno fatto
    causa comune per creare un sistema operativo libero. La sua
    distribuzione è caratterizzata dai seguenti aspetti.

      * Impegno per la libertà del software: Il Contratto sociale
        Debian e le Linee Guida Debian per il Software Libero (DFSG).

      * Sforzo volontario non pagato, distribuito, basato su Internet
        https://www.debian.org.

      * Vasto numero di pacchetti software di alta qualità
        pre-compilati.

      * Attenzione alla stabilità e alla sicurezza, con facile
        accesso agli aggiornamenti di sicurezza.

      * Attenzione ad aggiornamenti senza problemi ai pacchetti più
        recenti dei software negli archivi unstable e testing.

      * Vasto numero di architetture hardware supportate.

    I vari pezzi di Software Libero in Debian provengono da GNU,
    Linux, BSD, X, ISC, Apache, Ghostscript, Common Unix Printing
    System , Samba, GNOME, KDE, Mozilla, LibreOffice, Vim, TeX,
    LaTeX, DocBook, Perl, Python, Tcl, Java, Ruby, PHP, Berkeley DB,
    MariaDB, PostgreSQL, SQLite, Exim, Postfix, Mutt, FreeBSD,
    OpenBSD, Plan 9 e molti altri progetti software liberi
    indipendenti. Debian integra questa diversità del Software Libero
    in un unico sistema.

3. Informazioni su questo documento

3.1. Linee guida

    Nella stesura di questo documento sono state seguite le seguenti
    linee guida.

      * Fornire una panoramica ed evitare casi particolari. (Vista
        d'insieme.)

      * Mantenere il testo conciso e semplice.

      * Non reinventare la ruota. (Usare rimandi alle risorse
        esistenti.)

      * Concentrarsi sugli strumenti senza interfaccia utente grafica
        e sulla console. (Usare esempi shell.)

      * Essere obiettivi. (Usare popcon, ecc.)

    Suggerimento
   
    Si è cercato di spiegare aspetti gerarchici e i più bassi livelli
    di funzionamento del sistema.

%

3.2. Prerequisiti

    Avvertimento

    Il lettore deve fare lo sforzo di cercare risposte da solo
    andando oltre questa documentazione. Questo documento fornisce
    solo degli efficaci punti di partenza.

    Il lettore deve cercare le soluzioni da solo dalle fonti
    primarie.

      * The Debian Administrator's Handbook

      * Il sito Debian all'indirizzo https://www.debian.org per le
        informazioni generiche.

      * La documentazione nella directory "/usr/share/doc/
        <nome_pacchetto>".

      * La pagina man in stile Unix: "dpkg -L <nome_pacchetto> |grep
        '/man/man.*/'" .

      * La pagina info in stile GNU: "dpkg -L <nome_pacchetto> |grep
        '/info/'" .

      * Le segnalazioni di bug: http://bugs.debian.org/
        <nome_pacchetto> .

      * Il Debian Wiki all'indirizzo https://wiki.debian.org/ per gli
        aspetti mutevoli e gli argomenti specifici.

      * Gli HOWTO del progetto di documentazione di Linux TLDP (The
        Linux Documentation Project), all'indirizzo http://tldp.org/
        .

      * Le specifiche Single UNIX Specification dal sito web di The
        UNIX System di Open Group, all'indirizzo http://www.unix.org
        /.

      * L'enciclopedia libera Wikipedia all'indirizzo https://
        www.wikipedia.org/ .

    Nota

    Per una documentazione dettagliata può essere necessario
    installare il corrispondente pacchetto di documentazione il cui
    nome ha il suffisso "-doc" .

%

3.3. Convenzioni

    Questo documento fornisce informazioni attraverso il seguente
    stile semplificato di rappresentazione con esempi di comandi per
    la shell bash(1).

    # <comando nell'account root>
    $ <comando nell'account utente>

    Questi prompt di shell distinguono gli account usati e
    corrispondono a ciò che si ottiene impostando le variabili
    d'ambiente in questo modo: "PS1='\$'" e "PS2=' '". Questi valori
    sono stati scelti per aumentare la leggibilità del documento e
    non sono quelli tipici di una reale installazione del sistema.

    Nota
   
    Si veda il significato delle variabili d'ambiente "$PS1" e "$PS2"
    in bash(1).

    Le azioni che gli amministratori di sistema devono eseguire sono
    scritte all'infinito, ad esempio "Premere il tasto Invio dopo
    ogni stringa di comando digitata nella shell."

    La colonna descrizione ed altre simili in tabelle possono
    contenere un sintagma nominale che segue le convenzioni per le
    descrizioni brevi dei pacchetti e che perde l'articolo iniziale
    quali "un" ed "il". Le colonne possono, in alternativa, contenere
    una verbo al presente seguendo la convenzione usata nella
    descrizione breve dei comandi nelle pagine man. Questa scelta
    potrà apparire strana per qualcuno, ma fa parte della scelta
    deliberata dell'autore di mantenere più semplice possibile lo
    stile di questa documentazione. In entrambi i casi l'iniziale non
    è maiuscola e manca il punto finale seguendo le dette convenzioni
    per le descrizioni brevi.

    Nota

    I nomi propri, inclusi i nomi dei comandi mantengono la corretta
    iniziale maiuscola/minuscola indipendentemente dalla loro
    posizione.

    Un breve comando citato all'interno di un paragrafo di testo
    viene reso dal carattere a spaziatura fissa racchiuso tra
    virgolette doppie come in "aptitude safe-upgrade".

    Dati testuali da un file di configurazione citati all'interno di
    un paragrafo di testo vengono resi ‪dal carattere a spaziatura
    fissa racchiuso tra virgolette doppie come in "deb-src".

    Un comando viene reso dall'uso del carattere a spaziatura fissa
    per il suo nome, seguito eventualmente dal numero di sezione
    della sua pagina man tra parentesi, come in bash(1). Ci si senta
    incoraggiati ad ottenere ulteriori informazioni digitando quanto
    segue.

    $ man 1 bash

    Una pagina man viene resa dall'uso del carattere a spaziatura
    fissa per il suo nome seguito dal numero della sua sezione nelle
    pagine man racchiuso tra parentesi, come in sources.list(5). Ci
    si senta incoraggiati ad ottenere ulteriori informazioni
    digitando quanto segue.

    $ man 5 sources.list

    Una pagina info viene resa dal suo comando corrispondente in
    carattere a spaziatura fissa racchiuso tra virgolette doppie,
    come in "info make". Ci si senta incoraggiati ad ottenere
    ulteriori informazioni digitando quanto segue.

    $ info make

    Un nome di file viene reso dal carattere a spaziatura fissa tra
    virgolette doppie, come in "/etc/passwd". Per quanto riguarda i
    file di configurazione ci si senta incoraggiati ad ottenere
    ulteriori informazioni digitando quanto segue.

    $ sensible-pager "/etc/passwd"

    Un nome di directory viene reso dal carattere a spaziatura fissa
    tra virgolette doppie, come in «/etc/apt/». Ci si senta
    incoraggiati ad esplorare il suo contenuto digitando quanto
    segue.

    $ mc "/etc/apt/"

    Un nome di pacchetto viene reso dal carattere a spaziatura fissa,
    come in vim. Ci si senta incoraggiati ad ottenere ulteriori
    informazioni digitando quanto segue.

    $ dpkg -L vim
    $ apt-cache show vim
    $ aptitude show vim

    La posizione di una documentazione può essere indicata con il
    nome di file in carattere a spaziatura fissa tra virgolette
    doppie, come in "/usr/share/doc/base-passwd/
    users-and-groups.txt.gz" e "/usr/share/doc/base-passwd/
    users-and-groups.html", oppure dal suo URL, come in https://
    www.debian.org. Ci si senta incoraggiati a leggere la
    documentazione digitando quanto segue.

    $ zcat "/usr/share/doc/base-passwd/users-and-groups.txt.gz" | sensible-pager
    $ sensible-browser "/usr/share/doc/base-passwd/users-and-groups.html"
    $ sensible-browser "https://www.debian.org"

    Una variabile d'ambiente viene resa dal suo nome preceduto dal
    segno "$" in carattere a spaziatura fissa tra virgolette doppie,
    come in "$TERM". Ci si senta incoraggiati ad ottenere il suo
    valore attuale digitando quanto segue.

    $ echo "$TERM"

%

3.4. Popcon

    I dati da popcon sono usati come misura oggettiva della
    popolarità di ciascun pacchetto. Sono stati scaricati il
    2021-01-10 06:32:17 UTC e contengono i dati totali inviati da
    197967 rapporti su 178828 pacchetti binari e 26 architetture.

    Nota

    Notare che l'archivio amd64 unstable contiene attualmente solo
    62716 pacchetti. I dati di popcon contengono rapporti inviati da
    molte installazioni su sistemi vecchi.

    Il numero popcon, preceduto da "V:" che sta per "voti", è
    calcolato così: "1000 * (rapporti popcon inviati con il pacchetto
    eseguito di recente sul PC)/(numero totale di rapporti popcon
    inviati)".

    Il numero popcon, preceduto da "I:" che sta per "installazioni",
    è calcolato così: "1000 * (rapporti popcon inviati con il
    pacchetto installato sul PC)/(numero totale di rapporti popcon
    inviati)".

    Nota

    I numeri popcon non dovrebbero essere considerati una misura
    assoluta dell'importanza dei pacchetti. Ci sono molti fattori che
    possono influenzare le statistiche. Per esempio, alcuni sistemi
    che partecipano a popcon possono avere montato directory quali "/
    bin" con l'opzione "noatime" per migliorare le prestazioni di
    sistema, influenzando di fatto negativamente i "voti" per quel
    sistema.

%

3.5. La dimensione dei pacchetti

    Anche i dati sulla dimensione dei pacchetti sono usati come
    misura oggettiva per ciascun pacchetto. Sono basati sulla
    "Installed-Size:" riportata dal comando "apt-cache show" o
    "aptitude show" (attualmente sull'architettura amd64 per la
    versione unstable). La dimensione è riportata in KiB (Kibibyte =
    unità di 1024 byte).

    Nota

    Una piccola dimensione per un pacchetto può indicare che esso è,
    nella versione unstable un pacchetto fittizio che installa,
    attraverso le dipendenze, altri pacchetti con contenuti
    sostanziosi. Il pacchetto fittizio permette una transizione
    facile o una suddivisione di pacchetto.

    Nota

    Una dimensione di pacchetto seguita da "(*)" indica che il
    pacchetto non è presente nella versione unstable ed è stata
    quindi usata la dimensione del pacchetto in experimental al suo
    posto.

%

3.6. Segnalazioni di bug in questo documento

    Se si trovano errori in questo documento segnalare i bug nel
    pacchetto debian-reference usando reportbug(1). Se possibile,
    includere i suggerimenti di correzione come "diff -u alla
    versione in puro testo o ai sorgenti.

%

4. Alcuni promemoria per i nuovi utenti

    Alcuni promemoria per i nuovi utenti:

      * Fare il backup dei propri dati

      * Mantenere sicure le proprie password e chiavi di sicurezza

      * KISS (keep it simple stupid), cioè mantenere le cose semplici

          + Non iper-progettare il proprio sistema

      * Leggere i propri file di log

          + Il PRIMO errore è quello che conta

      * RTFM (read the fine manual), cioè leggere il manuale

      * Cercare in Internet prima di fare domande

      * Non lavorare come root quando non è necessario

      * Non manomettere il sistema di gestione dei pacchetti

      * Non digitare nulla di cui non si capisce il significato

      * Non cambiare i permessi dei file (prima di una completa
        revisione della sicurezza)

      * Non lasciare la shell di root fino a che non si sono TESTATE
        le proprie modifiche

      * Avere sempre un supporto di avvio alternativo (chiavetta USB,
        CD, …)

%

5. Alcune citazioni per i nuovi utenti

    Ecco alcune interessanti citazioni dalla mailing list di Debian
    che potrebbero illuminare i nuovi utenti.

      * "Questo è Unix. Ti dà abbastanza corda da impiccarti." ---
        Miquel van Smoorenburg <miquels at cistron.nl>
   
      * "Unix È amichevole... è solo molto selettivo riguardo i suoi
        amici." --- Tollef Fog Heen <tollef at add.no>

    Wikipedia ha un articolo (in inglese) sulla "Filosofia Unix" che
    elenca citazioni interessanti.

Capitolo 1. Tutorial GNU/Linux

    Penso che imparare un sistema informatico sia come imparare una
    lingua straniera. Anche se le guide e la documentazione sono
    utili, si deve fare pratica diretta. Per aiutare il lettore a
    iniziare dolcemente, ho elaborato alcuni punti base.

    Il potente design di Debian GNU/Linux deriva dal sistema
    operativo Unix, cioè un sistema operativo multiutente e
    multitasking. Bisogna imparare a sfruttare la potenza di queste
    caratteristiche e le somiglianze tra Unix e GNU/Linux.

    Non bisogna scappare dai testi pensati per Unix e affidarsi
    solamente a testi su GNU/Linux dato che in questo modo ci si
    priva di molte informazioni utili.

    Nota

    Se si è usato tramite strumenti a riga di comando un sistema *nix
    per un certo tempo, probabilmente si sa già tutto ciò che viene
    spiegato qui. Si usi questa sezione come un ripasso e per
    consultazioni.

1.1. Nozioni di base sulla console

%

1.1.1. Il prompt di shell

    All'avvio del sistema, se non è stato installato il Sistema X
    Window con un display manager come gdm3, viene presentata la
    schermata di login a caratteri. Supponiamo che il proprio nome
    host sia pippo, il prompt di login apparirà come segue.

    pippo login:

    Se è stato installato un ambiente GUI come GNOME o KDE, allora ci
    si può spostare ad un prompt di login premendo Ctrl-Alt-F1 e si
    può ritornare all'ambiente grafico con Alt-F7 (vedere
    Sezione 1.1.6, «Console virtuali» in seguito per maggiori
    informazioni).

    Al prompt di login digitare il proprio nome utente, ad esempio
    pinguino e premere il tasto Invio, poi digitare la propria
    password e premere di nuovo Invio.

    Nota

    Nella tradizione Unix, il nome utente e la password di un sistema
    Debian distinguono le lettere maiuscole dalle minuscole. Il nome
    utente di solito viene scelto usando solo lettere minuscole. Il
    primo account utente viene normalmente creato durante
    l'installazione. Account utente aggiuntivi possono essere creati
    da root con adduser(8).

    Il sistema si presenta con il messaggio di benvenuto memorizzato
    in "/etc/motd" (Message Of The Day, messaggio del giorno) e
    fornisce un prompt dei comandi.

    Debian GNU/Linux jessie/sid pippo tty1
    pippo login: pinguino
    Password:
    Last login: Mon Sep 23 19:36:44 JST 2013 on tty3
    Linux snoopy 3.11-1-amd64 #1 SMP Debian 3.11.6-2 (2013-11-01) x86_64

    The programs included with the Debian GNU/Linux system are free software;
    the exact distribution terms for each program are described in the
    individual files in /usr/share/doc/*/copyright.

    Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
    permitted by applicable law.
    pippo:~$

    Si è ora nella shell. La shell interpreta i comandi dell'utente.

%

1.1.2. Il prompt di shell in X

    Se è stato installato il Sistema X Window con un display manager
    come gdm3 di GNOME, selezionando l'attività "Ambiente desktop"
    durante l'installazione, all'avvio del sistema viene presentata
    una schermata grafica di login. Si inseriscono il nome utente e
    la password per fare il login come utente non privilegiato. Usare
    il tasto Tab per spostarsi dal campo del nome utente a quello
    della password e viceversa, oppure usare il mouse e il clic
    principale.

    Si può ottenere il prompt di shell sotto X avviando un programma
    emulatore di terminale come gnome-terminal(1), rxvt(1) o xterm(1)
    . Nell'ambiente desktop GNOME, cliccare su "Applicazioni" →
    "Accessori" → "Terminale" .

    Si può anche fare riferimento alla sezione Sezione 1.1.6,
    «Console virtuali» in seguito.

    In altri sistemi Desktop (come fluxbox), potrebbe non esserci un
    punto evidente per l'apertura del menu. Se si è in questa
    condizione, provare a fare clic, con il tasto destro, sullo
    sfondo della schermata del desktop e sperare che appaia un menu.

%

1.1.3. L'account root

    L'account root viene anche indicato come superutente o utente
    privilegiato. Da questo account si possono eseguire i seguenti
    compiti amministrativi.

      * Leggere, scrivere e cancellare qualsiasi file sul sistema
        indipendentemente dai suoi permessi.

      * Impostare il proprietario e i permessi di qualunque file sul
        sistema.

      * Impostare la password di qualsiasi utente non privilegiato
        nel sistema.

      * Fare il login in qualsiasi account senza la password.

    Questi poteri illimitati dell'account root rendono necessario
    essere prudenti e responsabili nel loro uso.

    Avvertimento
   
    Non comunicare mai la password di root ad altri.

    Nota

    I permessi di un file (inclusi i device hardware come CD-ROM,
    ecc. che sono nient'altro che un altro file per il sistema
    Debian) lo possono rendere inutilizzabile o inaccessibile per gli
    utenti non root. Benché usare l'account root sia un metodo veloce
    per affrontare questo tipo di situazione, la sua soluzione
    dovrebbe essere l'impostazione degli appropriati permessi e
    gruppi proprietari per il file (vedere Sezione 1.2.3, «Permessi
    del file system»).

%

1.1.4. Il prompt di shell di root

    Ecco alcuni metodi di base per ottenere il prompt di shell per
    root usando la password di root.

      * Inserire root al prompt di login a caratteri.

      * Cliccare su "Applicazioni" → "Accessori" → "Terminale Root",
        nell'ambiente Desktop GNOME.

      * Digitare "su -l" al prompt di shell di un utente qualsiasi.
   
          + L'ambiente dell'utente attuale non viene in questo caso
            preservato.

      * Digitare "su" al prompt di shell di un utente qualsiasi.

          + L'ambiente dell'utente attuale viene in questo caso
            parzialmente preservato.

1.1.5. Strumenti di amministrazione del sistema con interfaccia
utente grafica

    Quando il menu del desktop non avvia gli strumenti con
    interfaccia grafica per l'amministrazione di sistema con i
    privilegi appropriati, si può avviarli dal prompt di shell di
    root dell'emulatore di terminale per X, quali gnome-terminal(1), 
    rxvt(1) o xterm(1). Vedere Sezione 1.1.4, «Il prompt di shell di
    root» e Sezione 7.8.5, «Eseguire client X come root».

    Avvertimento

    Non avviare mai il gestore di sessioni/display manager di X
    dall'account root inserendo root al prompt di un display manager
    come gdm3(1).

    Avvertimento

    Non eseguire mai in X Window programmi con interfaccia utente
    grafica non fidati da remoto quando sono visualizzate
    informazioni critiche, dato che potrebbero spiare lo schermo X.

%

1.1.6. Console virtuali

    Nel sistema Debian standard, ci sono sei console a caratteri in
    stile VT100 disponibili tra cui ci si può spostare per avviare
    una shell di comando direttamente sull'host Linux. A meno che non
    si sia in un ambiente con interfaccia grafica, si può passare da
    una console virtuale all'altra usando simultaneamente il
    tasto_Alt_sinistro e uno dei tasti F1 — F6. Ogni console a
    caratteri permette un login indipendente nell'account e offre un
    ambiente multiutente. L'ambiente multiutente è una bellissima
    caratteristica di Unix e ci si può abituare presto a dipendere da
    esso.

    Se si è nel Sistema X Window, si accedere alla console a
    caratteri 1 premendo i tasti Ctrl-Alt-F1, cioè premendo
    contemporaneamente il tasto_Ctrl_sinistro, il tasto_Alt_sinistro
    e il tasto_F1. Si può tornare al Sistema X Window, che di solito
    è in esecuzione sulla console virtuale 7, premendo Alt-F7.

    In alternativa ci si può spostare in un'altra console virtuale,
    per esempio la console 1, dalla riga di comando.

    # chvt 1

%

1.1.7. Come uscire dal prompt dei comandi

    Si digita Ctrl-D, cioè il tasto_Ctrl_sinistro e il tasto_d
    vengono premuti contemporaneamente al prompt dei comandi per
    chiuderà l'attività della shell. Se si è nella console a
    caratteri, in questo modo si ritorna al prompt di login. Anche se
    questi caratteri di controllo vengono indicati con le lettere
    maiuscole, come "control D", non è necessario premere il tasto
    Maiusc. Per indicare Ctrl-D viene anche usata l'espressione
    abbreviata ^D. In alternativa si può digitare "exit".

    In quest'ultimo modo, se si è in un emulatore di terminale (
    x-terminal-emulator(1)), lo si può chiudere.

%

1.1.8. Come spegnere il sistema

    Esattamente come ogni altro SO moderno in cui le operazioni su
    file comportano una cache dei dati in memoria per migliorare le
    prestazioni, il sistema Debian ha bisogno della appropriata
    procedura di spegnimento prima che l'alimentazione possa essere
    staccata in modo sicuro. Questo serve a preservare l'integrità
    dei file, forzando la scrittura su disco di tutti i cambiamenti
    avvenuti in memoria. Se è disponibile il controllo software
    dell'alimentazione, la procedura di spegnimento automaticamente
    toglie l'alimentazione al sistema. (In caso contrario può essere
    necessario tener premuto per alcuni secondi il tasto di
    accensione/spegnimento.)

    Si può spegnere il sistema dalla riga di comando nella normale
    modalità multiutente.

    # shutdown -h now

    Si può spegnere il sistema dalla riga di comando nella modalità
    single-user.

    # poweroff -i -f

    In alternativa, se "/etc/inittab" contiene "ca:12345:ctrlaltdel:/
    sbin/shutdown -t1 -a -h now" al suo interno, per spegnere si può
    digitare Ctrl-Alt-Canc (il tasto_Ctrl_sinistro, il
    tasto_Alt_sinistro e Canc sono premuti contemporaneamente). Per i
    dettagli vedere inittab(5).

    Vedere Sezione 6.9.6, «Spegnere il sistema remoto su SSH».

%

1.1.9. Ripristinare una console funzionante

    Quando, dopo aver fatto qualcosa di strano come "cat
    <un-qualche-file-binario>", lo schermo impazzisce digitare
    "reset" al prompt dei comandi. Mentre lo si digita il comando
    potrebbe non essere visualizzato. Si può anche usare "clear" per
    pulire lo schermo.

%

1.1.10. Suggerimenti per pacchetti aggiuntivi per i principianti

    Sebbene anche l'installazione minima del sistema Debian, senza
    alcun ambiente desktop, fornisca le funzionalità Unix di base è
    una buona idea installare con apt-get(8) alcuni pacchetti
    aggiuntivi per la riga di comando e i terminali a caratteri
    basati su curses, come mc e vim con cui i principianti possono
    fare i primi passi. Eseguire i comandi seguenti.

    # apt-get update
     ...
    # apt-get install mc vim sudo
     ...

    Se questi pacchetti sono già installati, nessun nuovo pacchetto
    sarà installato.

    Tabella 1.1. Elenco di pacchetti con interessanti programmi in
    modalità testuale

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|            descrizione            |
    |---------+------+----------+-----------------------------------|
    |mc       |V:59, |1482      |Gestore di file testuale a tutto   |
    |         |I:236 |          |schermo                            |
    |---------+------+----------+-----------------------------------|
    |sudo     |V:563,|4555      |Programma per garantire privilegi  |
    |         |I:806 |          |di root limitati agli utenti       |
    |---------+------+----------+-----------------------------------|
    |         |V:106,|          |Editor di testi Unix Vi IMproved,  |
    |vim      |I:398 |3231      |un editor di testi per             |
    |         |      |          |programmatori (versione standard)  |
    |---------+------+----------+-----------------------------------|
    |         |V:62, |          |Editor di testi Unix Vi IMproved,  |
    |vim-tiny |I:970 |1553      |un editor di testi per             |
    |         |      |          |programmatori (versione compatta)  |
    |---------+------+----------+-----------------------------------|
    |emacs-nox|V:4,  |18364     |Emacs dal progetto GNU, l'editor di|
    |         |I:17  |          |testi estensibile basato su Lisp   |
    |---------+------+----------+-----------------------------------|
    |w3m      |V:31, |2289      |Browser Web testuali               |
    |         |I:284 |          |                                   |
    |---------+------+----------+-----------------------------------|
    |gpm      |V:11, |530       |Taglia e Incolla in stile Unix     |
    |         |I:17  |          |nella console testuale (demone)    |
    +---------------------------------------------------------------+


    Potrebbe essere una buona idea leggere un po' di documentazione.

    Tabella 1.2. Elenco di pacchetti con documentazione interessante

    +---------------------------------------------------------------+
    |     pacchetto      |popcon|dimensione|      descrizione       |
    |--------------------+------+----------+------------------------|
    |                    |      |          |Documentazione del      |
    |doc-debian          |I:854 |166       |Progetto Debian, (FAQ   |
    |                    |      |          |Debian) ed altri        |
    |                    |      |          |documenti               |
    |--------------------+------+----------+------------------------|
    |debian-policy       |I:36  |4306      |Manuale Debian Policy e |
    |                    |      |          |documenti correlati     |
    |--------------------+------+----------+------------------------|
    |                    |      |          |Linee guida ed          |
    |developers-reference|I:6   |1917      |informazioni per gli    |
    |                    |      |          |sviluppatori Debian     |
    |--------------------+------+----------+------------------------|
    |maint-guide         |I:4   |987       |Guida Debian per il     |
    |                    |      |          |nuovo Manutentore       |
    |--------------------+------+----------+------------------------|
    |debian-history      |I:1   |4285      |Storia del Progetto     |
    |                    |      |          |Debian                  |
    |--------------------+------+----------+------------------------|
    |debian-faq          |I:849 |817       |FAQ Debian              |
    +---------------------------------------------------------------+


    Si possono installare alcuni di questi pacchetti usando i comandi
    seguenti.

    # apt-get install nome_pacchetto

%

1.1.11. Un account utente extra

    Se non si vuole usare il proprio account utente principale per le
    esercitazioni descritte in seguito, si può creare un account
    utente per esercitarsi, ad esempio pesce con il comando seguente.

    # adduser pesce

    Rispondere a tutte le domande.

    In questo modo si crea un nuovo account chiamato pesce. Dopo aver
    fatto pratica si può rimuover questo account e la sua directory
    home digitando quanto segue.

    # deluser --remove-home pesce

%

1.1.12. Configurazione di sudo

    Per la tipica postazione di lavoro di un unico utente, come il
    sistema desktop Debian su un PC portatile, è frequente l'uso di
    una semplice configurazione di sudo(8), come qui di seguito
    descritto, per permettere all'utente non privilegiato, ad esempio
    pinguino, di ottenere privilegi di amministratore con la sola
    propria password, senza quella dell'utente root.

    # echo "pinguino  ALL=(ALL) ALL" >> /etc/sudoers

    In alternativa è uso comune usare la configurazione seguente per
    permettere all'utente non privilegiato, ad esempio pinguino, di
    ottenere privilegi di amministratore senza alcuna password.

    # echo "pinguino  ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

    Questo trucco dovrebbe essere usato esclusivamente per le
    postazioni di lavoro con un solo utente, in cui l'utente è anche
    l'amministratore.

    Avvertimento

    Non impostare account per utenti regolari su postazioni di lavoro
    multi-utente in questo modo perché ciò sarebbe un grosso problema
    per la sicurezza del sistema.

    Attenzione

    Nell'esempio precedente la password e l'account di pinguino
    richiedono altrettanta protezione della password e account
    dell'utente root.

    Attenzione

    I privilegi di amministrazione in questo contesto sono forniti a
    qualcuno che è autorizzato ad eseguire i compiti di
    amministrazione del sistema sulla macchina. Non dare mai tali
    privilegi ad un manager del dipartimento di Amministrazione della
    propria azienda o al proprio capo, a meno che non siano
    autorizzati e capaci.

    Nota

    Per fornire privilegi di accesso a specifici device e file, si
    dovrebbe considerare l'uso dei gruppi per dare un accesso
    limitato, invece di usare i privilegi di root attraverso sudo(8).

    Nota

    Con una configurazione più attenta e precisa, sudo(8) può
    garantire privilegi amministrativi limitati ad altri utenti in un
    sistema condiviso, senza rendere nota la password di root. Questo
    può aiutare la tracciabilità su host con più di un
    amministratore, in modo che si possa dire chi ha fatto cosa.
    D'altra parte si potrebbe anche volere che nessuno abbia tali
    privilegi.

%

1.1.13. Tempo di giocare

    Si è ora pronti a giocare con il sistema Debian senza rischi
    fintanto che si usa l'account utente non privilegiato.

    Ciò è possibile perché il sistema Debian è, anche subito dopo
    l'installazione predefinita, configurato con i permessi dei file
    corretti che impediscono agli utenti non privilegiati di
    danneggiare il sistema. Ci possono essere naturalmente ancora dei
    punti deboli che possono essere sfruttati, ma chi si preoccupa di
    tali cose non dovrebbe leggere questa sezione ma piuttosto il
    manuale Securing Debian.

    Si può imparare il sistema Debian, come sistema *nix nelle
    sezioni seguenti.

      * Sezione 1.2, «File system stile Unix» (concetti di base)

      * Sezione 1.3, «Midnight Commander (MC)» (sopravvivere)

      * Sezione 1.4, «Ambiente di lavoro di base in stile Unix»
        (lavoro di base)

      * Sezione 1.5, «Il semplice comando di shell» (uso della shell)

      * Sezione 1.6, «Elaborazione di testo stile Unix» (elaborazione
        di testi)

%

1.2. File system stile Unix

    In GNU/Linux ed altri sistemi operativi *nix, i file sono
    organizzati in directory. Tutti i file e le directory sono
    organizzati in un unico grande albero che ha la sua radice in "/
    ". Viene chiamato albero perché il file system, se viene
    disegnato, ha l'aspetto di un albero messo però sottosopra.

    Questi file e directory possono essere sparsi su diversi
    dispositivi. mount(8) serve per attaccare il file system trovato
    su un qualche dispositivo al grande albero dei file. Al
    contrario, umount(8) lo stacca. Nei kernel Linux recenti mount(8)
    con alcune opzioni può collegare parte di un albero dei file in
    qualche altra posizione o può montare file system come condivisi,
    privati, slave o non-collegabili. Le opzioni di montaggio
    supportate per ciascun file system sono disponibili in "/usr/
    share/doc/linux-doc-*/Documentation/filesystems/".

    Nei sistemi Unix vengono chiamate directory quelle che in altri
    sistemi sono chiamate cartelle. Notare anche che non esiste in
    nessun sistema Unix un concetto di unità, come "A:". C'è un solo
    unico file system e tutto vi è incluso. Questo è un grandissimo
    vantaggio rispetto a Windows.

%

1.2.1. Nozioni di base sui file Unix

    Ecco alcune nozioni di base sui file Unix.

      * Nei nomi dei file si distingue tra maiuscole e minuscole. I
        file "MIOFILE" e "MioFile" sono cioè file diversi.

      * La directory root indica la radice del file system, indicata
        semplicemente con "/". Non la si confonda con la directory
        home dell'utente root: "/root".

      * Ogni directory ha un nome che può contenere qualsiasi lettera
        o simbolo tranne"/". La directory radice è un'eccezione; il
        suo nome è "/" (pronunciato "slash" o "directory root/
        radice") e il suo nome non può essere cambiato.

      * Ogni file o directory è indicato da un nome di file
        pienamente qualificato, un nome file assoluto o un percorso,
        fornendo la sequenza di directory attraverso le quali si deve
        passare per raggiungerlo. I tre termini sono sinonimi.

      * Tutti i nomi di file pienamente qualificati iniziano con la
        directory "/" e c'è un carattere "/" tra ciascuna directory o
        file nel nome del file. Il primo carattere "/" è la directory
        di più alto livello e gli altri "/" separano le directory
        successive fino a che non si raggiunge l'ultima voce che è il
        nome del file stesso. I termini usati possono creare
        confusione. Prendere in considerazione come esempio il
        seguente nome file pienamente qualificato come esempio: "/usr
        /share/keytables/us.map.gz"; anche se ci si riferisce al solo
        nome base, "us.map.gz" come al suo nome file.

      * La directory radice ha un certo numero di rami, come "/etc/"
        e "/usr/". Queste sottodirectory a loro volta si diramano in
        ulteriori sottodirectory, come "/etc/init.d/" e "/usr/local/
        ". Viste tutte insieme vengono chiamate albero delle
        directory. Si può pensare ad un nome file assoluto come ad un
        percorso dalla base dell'albero ("/") alla punta di un ramo
        (un file). Si può anche sentir parlare dell'albero delle
        directory come se fosse un albero genealogico che comprende
        tutti i discendenti di un'unica figura detta directory radice
        ("/): le sottodirectory hanno perciò dei genitori e un
        percorso mostra gli antenati completi di un file. Ci sono
        anche percorsi relativi che iniziano da una qualche posizione
        che non sia la directory radice. Si dovrebbe tenere a mente
        che la directory "../" si riferisce alla directory genitore.
        Questa terminologia si applica anche ad altre strutture
        simili a quella delle directory, come le strutture di dati
        gerarchici.

      * Non c'è alcun nome speciale di percorso di directory che
        corrisponda ad un dispositivo fisico, come il disco fisso.
        Questa è una differenza rispetto a RT-11, CP/M, OpenVMS,
        MS-DOS, AmigaOS e Microsoft Windows, in cui il percorso
        contiene una porzione con il nome di dispositivo come "C:\".
        (Esistono tuttavia directory che si riferiscono ai
        dispositivi fisici come a parte del file system normale.
        Vedere Sezione 1.2.2, «Aspetti tecnici del file system».)

    Nota

    Benché si possa usare quasi qualsiasi lettera o simbolo nel nome
    di un file, in pratica farlo non è una bella idea. È meglio
    evitare qualsiasi carattere che ha spesso un significato
    particolare sulla riga di comando, inclusi spazi, tabulazioni, a
    capo e altri caratteri speciali: { } ( ) [ ] ' ` " \ / > < | ; !
    # & ^ * % @ $. Se si vuole separare delle parole all'interno di
    un nome file, buone alternative sono un punto, un trattino ed il
    segno di sottolineatura. Si può anche scrivere in maiuscolo ogni
    parola, "InQuestoModo". Gli utenti Linux esperti tendono ad
    evitare l'uso degli spazi nei nomi dei file.

    Nota

    La parola "root" può significare l'"utente root" o la "directory
    root". Il contesto in cui il termine viene usato dovrebbe rendere
    chiaro il suo significato.

    Nota

    La parola percorso non è usata solamente per un nome di file
    pienamente qualificato come descritto in precedenza, ma anche per
    il percorso di ricerca dei comandi. Il significato è di solito
    reso chiaro dal contesto.

    Le linee guida raccomandate per la gerarchia dei file sono
    descritte in dettaglio nel Filesystem Hierarchy Standard ("/usr/
    share/doc/debian-policy/fhs/fhs-2.3.txt.gz" e in hier(7)). Come
    inizio si dovrebbe tenere a mente quanto segue.

    Tabella 1.3. Elenco degli usi delle directory principali

    +---------------------------------------------------------------+
    |directory|                 uso della directory                 |
    |---------+-----------------------------------------------------|
    |/        |la directory root                                    |
    |---------+-----------------------------------------------------|
    |/etc/    |file di configurazione a livello di sistema          |
    |---------+-----------------------------------------------------|
    |/var/log/|file di registro del sistema                         |
    |---------+-----------------------------------------------------|
    |/home/   |tutte le directory home degli utenti non privilegiati|
    +---------------------------------------------------------------+


%

1.2.2. Aspetti tecnici del file system

    Nella scia della tradizione Unix, il sistema Debian GNU/Linux
    fornisce il file system in cui risiedono i dati fisici nel disco
    fisso e negli altri dispositivi di memorizzazione, ed inoltre le
    interazioni con i dispositivi hardware come gli schermi delle
    console e le console seriali remote vengono rappresentate in un
    modo unificato in "/dev/".

    Ogni file, directory, pipe con nome (un modo per due programmi di
    scambiare dati) o dispositivo fisico presente in un sistema
    Debian GNU/Linux ha una struttura di dati chiamata inode che
    descrive gli attributi ad esso associati come l'utente che lo
    possiede (proprietario), il gruppo a cui appartiene, la data
    dell'ultimo accesso ad esso, ecc. L'idea di rappresentare
    praticamente tutto nel file system è stata un'innovazione di Unix
    e i kernel Linux moderni hanno sviluppato questa idea e sono
    andati oltre. Ora anche le informazioni sui processi in
    esecuzione sul computer possono essere trovate nel file system.

    La rappresentazione astratta e unificata di entità fisiche e di
    processi interni è molto potente dato che permette di usare lo
    stesso comando per lo stesso tipo di operazione su molti tipi di
    device completamente diversi l'uno dall'altro. È anche possibile
    cambiare il modo in cui il kernel funziona scrivendo dati in file
    speciali che sono collegati ai processi in esecuzione.

    Suggerimento
   
    Per identificare la corrispondenza tra l'albero dei file e le
    entità fisiche, eseguire mount(8) senza opzioni.

%

1.2.3. Permessi del file system

    I permessi del file system di sistemi *nix sono definiti e
    influenzano tre categorie di utenti.

      * L'utente che è il proprietario del file (u).

      * Gli altri utenti del gruppo a cui appartiene il file (g).

      * Tutti gli altriutenti (o) a cui ci si riferisce anche con i
        termini "mondo" e "tutti".

    Per un file, a ciascun permesso corrispondono le seguenti azioni.

      * Il permesso di lettura (r) permette al proprietario di
        esaminare il contenuto del file.

      * Il permesso di scrittura (w) permette al proprietario di
        modificare il file.

      * Il permesso di esecuzione (x) permette al proprietario di
        eseguire il file come comando.

    Per una directory, a ciascun permesso corrispondono le seguenti
    azioni.

      * Il permesso di lettura (r) permette al proprietario di
        elencare il contenuto della directory.

      * Il permesso di scrittura (w) permette al proprietario di
        aggiungere o rimuovere file dalla directory.

      * Il permesso di esecuzione (x) permette al proprietario di
        accedere ai file nella directory.

    In questo caso il permesso di esecuzione su una directory non
    solo significa poter leggere i file in quella directory ma anche
    poterne vedere gli attributi, come la dimensione e la data di
    modifica.

    Per visualizzare le informazioni sui permessi (ed altro) di file
    e directory si usa ls(1). Quando chiamato con l'opzione "-l"
    mostra, nell'ordine elencato in seguito, le seguenti
    informazioni.

      * Tipo di file (primo carattere).

      * Permessi di accesso al file (nove caratteri, tre ciascuno per
        utente, gruppo e altri, in questo ordine).

      * Numero di collegamenti fisici al file.

      * Nome dell'utente proprietario del file.

      * Nome del gruppo a cui il file appartiene.

      * Dimensione in caratteri (byte) del file.

      * Data ed ora del file (mtime).

      * Nome del file.

    Tabella 1.4. Elenco dei valori possibili per il primo carattere
    nell'output di "ls -l"

    +--------------------------------+
    |carattere|     significato      |
    |---------+----------------------|
    |-        |file normale          |
    |---------+----------------------|
    |d        |directory             |
    |---------+----------------------|
    |l        |collegamento simbolico|
    |---------+----------------------|
    |c        |device a caratteri    |
    |---------+----------------------|
    |b        |device a blocchi      |
    |---------+----------------------|
    |p        |pipe con nome         |
    |---------+----------------------|
    |s        |socket                |
    +--------------------------------+


    Per cambiare il proprietario di un file da un account root si usa
    chown(1). Per cambiare il gruppo di un file dall'account del
    proprietario o da quello di root si usa chgrp(1). Per cambiare i
    permessi di accesso di file o directory dall'account del
    proprietario o da quello di root si usa chmod(1). La sintassi di
    base per manipolare un file pippo è la seguente.

    # chown <nuovoproprietario> pippo
    # chgrp <nuovogruppo> pippo
    # chmod  [ugoa][+-=][rwxXst][,...] pippo

    Per esempio si può fare in modo che l'utente pippo sia il
    proprietario di un albero di directory condivisa dal gruppo pluto
    con i seguenti comandi.

    # cd /qualche/posizione/
    # chown -R pippo:pluto .
    # chmod -R ug+rwX,o=rX .

    Ci sono altri tre bit speciali di permessi.

      * Il bit set user ID (s o S al posto del permesso x
        dell'utente).

      * Il bit set group ID (s o S al posto del permesso x del
        gruppo).

      * Il bit sticky (t o T al posto del permesso x degli altri).

    Nell'output di "ls -l" il valore di questi bit è maiuscolo se il
    bit di permesso di esecuzione nascosto da essi è non impostato.

    L'impostazione del bit set user ID per un file eseguibile
    permette ad un utente di eseguire quel file con l'ID del
    proprietario del file (per esempio root). In modo simile,
    l'impostazione del bit set group ID per un file eseguibile
    permette ad un utente di eseguire il file con l'ID del gruppo a
    cui appartiene il file (per esempio root). Poiché l'impostazione
    di questi bit può causare rischi in termini di sicurezza, il loro
    uso richiede una particolare cautela.

    L'impostazione del bit set group ID per una directory abilita lo
    schema di creazione di file in stile BSD, in cui tutti i file
    creati nella directory appartengono al gruppo della directory.

    L'impostazione dello sticky bit per una directory impedisce la
    rimozione di un file nella directory da parte dell'utente che non
    ne è il proprietario. Per preservare i contenuti di un file in
    directory con permessi di scrittura per tutti, come "/tmp" o in
    directory con permessi di scrittura per un gruppo, non solo si
    deve impostare il permesso di scrittura per il file, ma anche
    impostare lo sticky bit per la directory. In caso contrario,
    qualunque utente con i permessi di scrittura per la directory può
    rimuovere il file e crearne uno nuovo con lo stesso nome.

    Ecco alcuni interessanti esempi di permessi dei file.

    $ ls -l /etc/passwd /etc/shadow /dev/ppp /usr/sbin/exim4
    crw------T 1 root root   108, 0 Oct 16 20:57 /dev/ppp
    -rw-r--r-- 1 root root     2761 Aug 30 10:38 /etc/passwd
    -rw-r----- 1 root shadow   1695 Aug 30 10:38 /etc/shadow
    -rwsr-xr-x 1 root root   973824 Sep 23 20:04 /usr/sbin/exim4
    $ ls -ld /tmp /var/tmp /usr/local /var/mail /usr/src
    drwxrwxrwt 14 root root  20480 Oct 16 21:25 /tmp
    drwxrwsr-x 10 root staff  4096 Sep 29 22:50 /usr/local
    drwxr-xr-x 10 root root   4096 Oct 11 00:28 /usr/src
    drwxrwsr-x  2 root mail   4096 Oct 15 21:40 /var/mail
    drwxrwxrwt  3 root root   4096 Oct 16 21:20 /var/tmp

    Esiste un metodo numerico alternativo per descrivere i permessi
    dei file con chmod(1); tale metodo numerico usa numeri ottali
    (base=8) di 3 o 4 cifre.

    Tabella 1.5. Permessi in notazione numerica per i comandi chmod
    (1)

    +---------------------------------------------------------------+
    |   cifra   |                    significato                    |
    |-----------+---------------------------------------------------|
    |1ª cifra   |somma di set user ID (=4), set group ID (=2) e     |
    |opzionale  |sticky bit (=1)                                    |
    |-----------+---------------------------------------------------|
    |2ª cifra   |somma dei permessi di lettura (=4), scrittura (=2) |
    |           |e esecuzione (=1) per l'utente                     |
    |-----------+---------------------------------------------------|
    |3ª cifra   |come sopra, ma per ilgruppo                        |
    |-----------+---------------------------------------------------|
    |4ª cifra   |come sopra, ma per gli altri                       |
    +---------------------------------------------------------------+


    Sembra complicato, ma è in realtà piuttosto semplice. Se si
    guardano le prime colonne (2-10) nell'output del comando "ls -l"
    e le si leggono come una rappresentazione binaria (base=2) dei
    permessi sui file (dove "-" equivale a "0" e "rwx" equivalgono a
    "1"), le ultime 3 cifre del valore numerico dei permessi
    dovrebbero apparire come la corretta rappresentazione dei
    permessi sui file in numerazione ottale (base=8).

    Per esempio, provare a fare quanto segue.

    $ touch pippo pluto
    $ chmod u=rw,go=r pippo
    $ chmod 644 pluto
    $ ls -l pippo pluto
    -rw-r--r-- 1 pinguino pinguino 0 ott 16 21:39 pluto
    -rw-r--r-- 1 pinguino pinguino 0 ott 16 21:35 pippo

    Suggerimento

    Se si deve aver accesso alle informazioni visualizzate da "ls -l"
    in script di shell, si dovrebbero usare i comandi pertinenti,
    come test(1), stat(1) e readlink(1). Si possono usare anche i
    comandi interni della shell come "[" o "test".

%

1.2.4. Controllo dei permessi per i file appena creati: umask

    I permessi che vengono applicati ad un file o una directory
    appena creati sono limitati dal comando interno della shell
    umask. Vedere dash(1), bash(1) e builtins(7).

    (permessi del file) = (permessi del file richiesti) & ~(valore di umask)

    Tabella 1.6. Esempi di valori di umask

    +---------------------------------------------------------------+
    |umask|  permessi dei  |   permessi delle    |       uso        |
    |     |  file creati   |  directory create   |                  |
    |-----+----------------+---------------------+------------------|
    |0022 |-rw-r--r--      |-rwxr-xr-x           |scrivibile solo   |
    |     |                |                     |dall'utente       |
    |-----+----------------+---------------------+------------------|
    |0002 |-rw-rw-r--      |-rwxrwxr-x           |scrivibile solo   |
    |     |                |                     |dal gruppo        |
    +---------------------------------------------------------------+


    Il sistema Debian usa, in modo predefinito, uno schema UPG (User
    Private Group, gruppo privato dell'utente). Ogni volta che viene
    aggiunto un nuovo utente al sistema, viene creato un UPG; questo
    ha lo stesso nome dell'utente per il quale è stato creato e
    quell'utente è l'unico membro dell'UPG. Lo schema UPG rende
    sicura l'impostazione della umask a 0002 dato che ogni utente ha
    il proprio gruppo privato. (In alcune varianti di Unix è
    abbastanza comune impostare tutti gli utenti normali come
    appartenenti ad un unico gruppo users ed è in quel caso una buona
    idea impostare umask a 0022 per ragioni di sicurezza.)

    Suggerimento
   
    Abilitare UPG inserendo "umask 002" nel file ~/.bashrc.

%

1.2.5. Permessi per gruppi di utenti (gruppi)

    Per far sì che i permessi di un gruppo vengano applicati ad un
    particolare utente, tale utente deve essere inserito come membro
    del gruppo usando "sudo vigr" per /etc/group e "sudo vigr -s" per
    /etc/gshadow. Per abilitare la nuova configurazione dei gruppi è
    necessario fare il log out e quindi di nuovo il login (oppure
    eseguire "exec newgrp").

    Nota

    In alternativa, si possono aggiungere dinamicamente gli utenti ai
    gruppi durante il processo di autenticazione aggiungendo la riga
    "auth optional pam_group.so" al file "/etc/pam.d/common-auth" e
    configurando "/etc/security/group.conf". (Vedere Capitolo 4, 
    Autenticazione.)

    I dispositivi hardware sono, in un sistema Debian, semplicemente
    un altro tipo di file. Se si hanno problemi ad accedere a
    dispositivi quali CD-ROM e chiavette USB da un account utente, si
    dovrebbe inserire quell'utente nel gruppo appropriato.

    Alcuni importanti gruppi pre-impostati dal sistema permettono ai
    loro membri l'accesso a file e device particolari senza i
    privilegi di root.

    Tabella 1.7. Elenco dei principali gruppi forniti dal sistema per
    accesso ai file

    +---------------------------------------------------------------+
    |gruppo |       descrizione dei file e device accessibili       |
    |-------+-------------------------------------------------------|
    |dialout|accesso diretto e completo alle porte seriali ("/dev/  |
    |       |ttyS[0-3]")                                            |
    |-------+-------------------------------------------------------|
    |dip    |accesso limitato alle porte seriali per connessione IP |
    |       |dialup a peer fidati                                   |
    |-------+-------------------------------------------------------|
    |cdrom  |unità CD-ROM, DVD+/-RW                                 |
    |-------+-------------------------------------------------------|
    |audio  |device audio                                           |
    |-------+-------------------------------------------------------|
    |video  |device video                                           |
    |-------+-------------------------------------------------------|
    |scanner|scanner                                                |
    |-------+-------------------------------------------------------|
    |adm    |registri di monitoraggio del sistema                   |
    |-------+-------------------------------------------------------|
    |staff  |alcune directory per compiti minori di amministrazione:|
    |       |""/usr/local", "/home"                                 |
    +---------------------------------------------------------------+


    Suggerimento

    È necessario far parte del gruppo dialout per riconfigurare il
    modem, comporre numeri, ecc. Se però root crea file di
    configurazione predefiniti per i peer fidati in "/etc/ppp/peers/
    ", è necessario solamente far parte del grupo dip per creare una
    connessione IP dialup a tali peer fidati usando i comandi pppd(8)
    , pon(1) e poff(1).

    Alcuni importanti gruppi pre-impostati dal sistema permettono ai
    loro membri di eseguire particolari comandi senza i privilegi di
    root.

    Tabella 1.8. Elenco dei principali gruppi forniti dal sistema per
    l'esecuzione di particolari comandi

    +---------------------------------------------------------------+
    |gruppo |                  comandi accessibili                  |
    |-------+-------------------------------------------------------|
    |sudo   |eseguire sudo senza password                           |
    |-------+-------------------------------------------------------|
    |lpadmin|eseguire comandi per aggiungere, modificare e rimuovere|
    |       |stampanti dal database delle stampanti                 |
    +---------------------------------------------------------------+


    Per l'elenco completo degli utenti e gruppi forniti dal sistema,
    vedere la recente versione del documento "Utenti e gruppi" in "/
    usr/share/doc/base-passwd/users-and-groups.html" fornito dal
    pacchetto base-passwd.

    Vedere passwd(5), group(5), shadow(5), newgrp(1), vipw(8), vigr
    (8) e pam_group(8) per informazioni sui comandi di gestione di
    utenti e gruppi sul sistema.

%

1.2.6. Orari

    Ci sono tre tipi di orari per un file GNU/Linux.

    Tabella 1.9. Elenco dei tipi di data

    +------------------------------------------------------+
    |tipo |     significato (definizione storica Unix)     |
    |-----+------------------------------------------------|
    |mtime|orario di modifica del file (ls -l)             |
    |-----+------------------------------------------------|
    |ctime|orario di cambiamento di stato del file (ls -lc)|
    |-----+------------------------------------------------|
    |atime|orario dell'ultimo accesso al file (ls -lu)     |
    +------------------------------------------------------+


    Nota
   
    ctime non è l'orario di creazione del file.

    Nota
   
    L'attuale significato di atime sui sistemi GNU/Linux potrebbe
    essere diverso dalla sua definizione storica in Unix.

      * La sovrascrittura di un file cambia tutti gli attributi mtime
        , ctime e atime del file.

      * Il cambiamento del proprietario o dei permessi di un file
        cambia gli attributi ctime e atime del file.

      * La lettura di un file cambia l'attributo atime di un file nei
        sistemi Unix storici.

      * La lettura di un file cambia l'attributo atime di un file in
        un sistema GNU/Linux se il file system è montato con
        "strictatime".

      * Leggere un file per la prima volta o dopo un giorno modifica
        l'attributo atime del file stesso su sistemi GNU/Linux, se il
        filesystem è stato montato con "relatime". (comportamento di
        default da Linux 2.6.30)

      * Leggere un file non modifica l'attributo atime del file
        stesso su sistemi GNU/Linux se il filesystem è stato montato
        con "noatime".

    Nota

    Le opzioni di mount "noatime" e "relatime" sono introdotte per
    migliorare le prestazioni in lettura del file system nei normali
    casi d'uso. Semplici operazioni di lettura dei file con l'opzione
    "strictatime" comportano lunghe operazioni di scrittura per
    aggiornare l'attributo atime. L'attributo atime però è raramente
    utilizzato, a parte per il file mbox(5). Vedere mount(8).

    Usare il comando touch(1) per cambiare l'orario di file
    esistenti.

    Per gli orari, il comando ls produce stringhe diverse con le
    localizzazioni non in inglese ("it_IT.UTF-8") rispetto alla
    vecchia ("C").

    $ LANG=it_IT.UTF-8  ls -l pippo
    -rw-rw-r-- 1 pinguino pinguino 0 ott 16 21:35 pippo
    $ LANG=C  ls -l pippo
    -rw-rw-r-- 1 pinguino pinguino 0 Oct 16 21:35 pippo

    Suggerimento
   
    Vedere Sezione 9.2.5, «Visualizzazione personalizzata di date e
    orari» per personalizzare l'output di "ls -l".

%

1.2.7. Collegamenti

    Ci sono due metodi per associale un file "pippo" ad un diverso
    nome file "pluto".

      * Collegamento fisico

          + Nome duplicato per un file esistente

          + "ln pippo pluto"
   
      * Collegamento simbolico o symlink

          + File speciale che punta ad un altro file in base al nome

          + "ln -s pippo pluto"

    Vedere l'esempio seguente per notare i cambiamenti nel conteggio
    dei collegamenti e le sottili differenze tra i risultati del
    comando rm.

    $ umask 002
    $ echo "Contenuto originale" > pluto
    $ ls -li pluto
    1449840 -rw-rw-r-- 1 penguin penguin 17 ott 16 21:42 pluto
    $ ln pluto paper    # collegamento fisico
    $ ln -s pluto pippo  # collegamento simbolico
    $ ls -li pluto paper pippo
    1449840 -rw-rw-r-- 2 penguin penguin 17 ott 16 21:42 paper
    1450180 lrwxrwxrwx 1 penguin penguin  3 ott 16 21:47 pippo -> pluto
    1449840 -rw-rw-r-- 2 penguin penguin 17 ott 16 21:42 pluto
    $ rm pluto
    $ echo "Nuovo contenuto" > pluto
    $ ls -li pluto paper pippo
    1449840 -rw-rw-r-- 1 penguin penguin 17 ott 16 21:42 paper
    1450180 lrwxrwxrwx 1 penguin penguin  3 ott 16 21:47 pippo -> pluto
    1450183 -rw-rw-r-- 1 penguin penguin 12 ott 16 21:48 pluto
    $ cat paper
    Contenuto originale
    $ cat pippo
    Nuovo contenuto

    Il collegamento fisico può essere creato all'interno dello stesso
    file system e condivide uno stesso numero di inode, come rivela
    l'opzione "-i" di ls(1).

    Il collegamento simbolico ha sempre permessi di accesso nominali
    "rwxrwxrwx, come mostrato nell'esempio precedente, ma con gli
    effettivi permessi di accesso stabiliti dai permessi del file a
    cui punta.

    Attenzione

    In generale è una buona idea non creare collegamenti simbolici
    complicati o non creare collegamenti fisici per nulla, a meno di
    non avere una ragione molto buona per farlo. Possono diventare
    degli incubi quando la combinazione logica dei collegamenti
    simbolici crea cicli ricorsivi nel file system.

    Nota

    È in generale preferibile usare collegamenti simbolici piuttosto
    che fisici, a meno che non sia abbia una buona ragione per usare
    un collegamento fisico.

    La directory "." punta alla directory in cui appare, perciò il
    conteggio dei collegamenti per ogni nuova directory inizia da 2.
    La directory ".." punta alla directory genitore, perciò il
    conteggio dei collegamenti di una directory aumenta con
    l'aggiunta di nuove sottodirectory.

    Se si è appena passati da Windows a Linux, appare presto chiaro
    come sia ben progettato il collegamento dei nomi di file in Unix
    se paragonato con i collegamenti in ambiente Windows che sono
    l'equivalente più prossimo in quel sistema. Dato che sono
    implementati nel file system, le applicazioni non possono vedere
    alcuna differenza tra un file collegamento ed un originale. Nel
    caso di collegamenti fisici, non c'è realmente nessuna
    differenza.

%

1.2.8. Pipe con nome (FIFO)

    Una pipe con nome è un file che si comporta da pipe. Si mette
    qualcosa dentro il file e questa cosa esce dall'altra parte.
    Questa è chiamata una FIFO (First-In-First_Out, primo ad
    entrare-primo ad uscire): la prima cosa che viene immessa nella
    pipe è la prima ad uscire dall'altra estremità.

    Se si scrive su una pipe con nome, il processo che sta eseguendo
    la scrittura nella pipe non termina fino a che l'informazione
    scritta nella pipe non viene letta. Se si legge da una pipe con
    nome, il processo di lettura attende che non ci sia più nulla da
    leggere prima di terminare. La dimensione della pipe è sempre
    zero: non archivia dati, ma semplicemente collega due processi
    come fa la funzionalità fornita dalla sintassi per pipe "|" della
    shell. Tuttavia, dato che questa pipe ha un nome, i due processi
    non devono essere nella stessa riga di comando e nemmeno essere
    eseguiti dallo stesso utente. Le pipe sono un'innovazione di Unix
    di grandissimo impatto.

    Per esempio, provare a fare quanto segue.

    $ cd; mkfifo miapipe
    $ echo "hello" >miapipe & # messo sullo sfondo
    [1] 8022
    $ ls -l miapipe
    prw-rw-r-- 1 pinguino pinguino 0 ott 16 21:49 miapipe
    $ cat miapipe
    hello
    [1]+  Done                    echo "hello" >miapipe
    $ ls miapipe
    miapipe
    $ rm miapipe

%

1.2.9. Socket

    I socket sono usati moltissimo da tutte le comunicazioni
    Internet, da database e dal sistema operativo stesso. Sono simili
    alle pipe con nome (FIFO) e permettono ai processi di scambiare
    informazioni anche tra computer diversi. Per un socket, non è
    necessario che questi processi siano in esecuzione
    contemporaneamente, né di essere eseguiti come processi figli di
    uno stesso processo antenato. Questo è il punto culminante della
    comunicazione tra processi (IPC). Lo scambio di informazioni può
    avvenire sulla rete tra host diversi. I due più comuni sono il
    socket Internet e gli Unix domain socket.

    Suggerimento
   
    "netstat -an" fornisce una vista d'insieme molto utile dei socket
    aperti su un dato sistema.

%

1.2.10. File di device

    I file di device fanno riferimento a dispositivi fisici o
    virtuali sul sistema, come i dischi fissi, la scheda video, lo
    schermo o la tastiera. Un esempio di dispositivo virtuale è la
    console, rappresentata da "/dev/console".

    Ci sono 2 tipi di file di device.

      * Device a caratteri

          + Vi si accede un carattere alla volta.

          + 1 carattere = 1 byte

          + Es., device della tastiera, porta seriale, ...
   
      * Device a blocchi

          + Vi si accede in base a unità più grandi chiamate blocchi.

          + 1 blocco > 1 byte

          + Es., dischi fissi, ...

    I file di device possono essere letti e scritti, anche se è
    probabile che i file contengano dati binari che appaiono come
    farfuglii incomprensibili per le persone. La scrittura diretta di
    dati in questi file è utile a volte per trovare la soluzione a
    problemi con le connessioni hardware. Si può, per esempio, fare
    il dump di un file di testo in un device di stampa "/dev/lp0" o
    inviare comandi del modem alla porta seriale appropriata "/dev/
    ttyS0". Ma, a meno che ciò non venga fatto con cautela, può
    causare grandissimi disastri. Perciò, essere prudenti.

    Nota
   
    Per il normale accesso ad una stampante, usare lp(1).

    I numeri di nodo dei device sono visualizzati se si esegue ls(1)
    come nell'esempio seguente.

    $ ls -l /dev/sda /dev/sr0 /dev/ttyS0 /dev/zero
    brw-rw---T  1 root disk     8,  0 Oct 16 20:57 /dev/sda
    brw-rw---T+ 1 root cdrom   11,  0 Oct 16 21:53 /dev/sr0
    crw-rw---T  1 root dialout  4, 64 Oct 16 20:57 /dev/ttyS0
    crw-rw-rw-  1 root root     1,  5 Oct 16 20:57 /dev/zero

      * "/dev/sda" ha major number del device 8 e minor number del
        device 0. È accessibile in lettura e scrittura dagli utenti
        che appartengono al gruppo disk.

      * "/dev/sr0" ha major number del device 11 e minor number del
        device 0. È accessibile in lettura e scrittura dagli utenti
        che appartengono al gruppo cdrom.

      * "/dev/ttyS0" ha major number del device 4 e minor number del
        device 64. È accessibile in lettura e scrittura dagli utenti
        che appartengono al gruppo dialout.

      * "/dev/zero" ha major number del device 1 e minor number del
        device 5. È accessibile in lettura e scrittura da chiunque.

    Nei sistemi Linux moderni il file system sotto "/dev" viene
    popolato automaticamente dal meccanismo udev(7).

%

1.2.11. File di device speciali

    Ci sono alcuni file di device speciali.

    Tabella 1.10. Elenco di file dei device speciali

    +---------------------------------------------------------------+
    |file di| azione  |         descrizione della risposta          |
    |device |         |                                             |
    |-------+---------+---------------------------------------------|
    |/dev/  |lettura  |restituisce il "carattere EOF (End of File,  |
    |null   |         |fine del file)"                              |
    |-------+---------+---------------------------------------------|
    |/dev/  |scrittura|non ritorna nulla (un pozzo senza fondo in   |
    |null   |         |cui buttare via dati)                        |
    |-------+---------+---------------------------------------------|
    |/dev/  |lettura  |ritorna il "carattere \0 (NUL)", diverso dal |
    |zero   |         |numero zero in ASCII                         |
    |-------+---------+---------------------------------------------|
    |/dev/  |         |ritorna caratteri a caso da un vero          |
    |random |lettura  |generatore di numeri casuali che dà reale    |
    |       |         |entropia (lento)                             |
    |-------+---------+---------------------------------------------|
    |/dev/  |         |ritorna caratteri casuali da un generatore di|
    |urandom|lettura  |numeri pseudocasuali crittograficamente      |
    |       |         |sicuro                                       |
    |-------+---------+---------------------------------------------|
    |/dev/  |scrittura|ritorna l'errore di disco pieno (ENOSPC)     |
    |full   |         |                                             |
    +---------------------------------------------------------------+


    Sono spesso usati insieme alla redirezione di shell (vedere
    Sezione 1.5.8, «Sequenze tipiche di comandi e ridirezione della
    shell»).

%

1.2.12. procfs e sysfs

    procfs e sysfs, montati in "/proc" e "/sys" sono pseudo-file
    system ed espongono strutture interne di dati del kernel nello
    spazio utente. In altre parole, queste voci sono virtuali,
    funzionano cioè come una comoda finestra sul funzionamento del
    sistema operativo.

    La directory "/proc" contiene (tra le altre cose) una
    sottodirectory per ciascun processo in esecuzione sul sistema che
    prende nome dall'ID del processo (PID). Le utilità di sistema,
    come ps(1), che accedono alle informazioni sui processi,
    ottengono le loro informazioni da questa struttura di directory.

    Le directory in "/proc/sys/" contengono interfacce per cambiare
    certi parametri del kernel durante l'esecuzione. (Si può fare la
    stessa cosa tramite comandi sysctl(8) specifici o tramite il suo
    file di precaricamento/configurazione "/etc/sysctl.conf".)

    Le persone spesso vanno in panico quando si accorgono di un file
    in particolare, "/proc/kcore" che è particolarmente enorme. È
    (più o meno) una copia del contenuto della memoria del computer
    ed è usato per fare il debug del kernel. È un file virtuale che
    punta alla memoria del computer perciò non ci si preoccupi della
    sua dimensione.

    La directory "/sys" contiene strutture dati del kernel esportate,
    i loro attributi e i collegamenti tra di esse. Contiene anche
    interfacce per cambiare alcuni parametri del kernel durante
    l'esecuzione.

    Vedere proc.txt(.gz)", "sysfs.txt(.gz)" e altri documenti
    correlati nella documentazione del kernel Linux ("/usr/share/doc/
    linux-doc-*/Documentation/filesystems/*") fornita dai pacchetti
    linux-doc-*.

%

1.2.13. tmpfs

    tmpfs è un file system temporaneo che contiene tutti i file nella
    memoria virtuale. I dati del tmpfs nella page cache in memoria
    possono essere spostati nello spazio di swap su disco quando
    necessario.

    La directory "/run" viene montata come il tmpfs nelle prime fasi
    del processo di avvio. Ciò vi permette la scrittura anche quando
    la directory "/" è montata in sola lettura. Questa è la nuova
    posizione per la memorizzazione dei file transitori e sostituisce
    diverse posizioni descritte nella versione 2.3 del Filesystem
    Hierarchy Standard(Standard per la gerarchia del file system):

      * "/var/run" → "/run"

      * "/var/lock" → "/run/lock"

      * "/dev/shm" → "/run/shm"

    Vedere "tmpfs.txt(.gz)" nella documentazione del kernel Linux ("/
    usr/share/doc/linux-doc-*/Documentation/filesystems/*") fornita
    dai pacchetti linux-doc-*.

%

1.3. Midnight Commander (MC)

    Midnight Commander (MC) è un "coltellino svizzero" GNU per la
    console Linux ed altri ambienti in terminale. Dà ai principianti
    la possibilità di usare una console comandata da menu che è molto
    più facile da imparare dei comandi Unix standard.

    Potrebbe essere necessario installare il pacchetto di Midnight
    Commander che si chiama "mc" con il seguente comando.

    $ sudo apt-get install mc

    Usare il comando mc(1) per esplorare il sistema Debian. È il modo
    migliore di imparare. Esplorare qualche posizione interessante
    usando semplicemente i tasti freccia e il tasto Invio.

      * "/etc" e le sue sottodirectory

      * "/var/log" e le sue sottodirectory
   
      * "/usr/share/doc" e le sue sottodirectory

      * "/sbin" e "/bin"

%

1.3.1. Personalizzazione di MC

    Per far sì che MC cambi la directory di lavoro in uscita e si
    sposti con cd nella directory, suggerisco di modificare "~
    /.bashrc" per includere uno scipt fornito nel pacchetto mc.

    . /usr/lib/mc/mc.sh

    Vedere mc(1) (sotto l'opzione "-P") per capirne la ragione. (Se
    non è chiaro esattamento quello di cui sto parlando, si può
    tornare a questo più tardi.)

%

1.3.2. Avvio di MC

    MC può essere avviato nel modo seguente.

    $ mc

    MC si prende cura di tutte le operazioni sui file attraverso i
    suoi menu, richiedendo perciò solo un minimo sforzo da parte
    dell'utente. Premere semplicemente F1 per ottenere la schermata
    di aiuto. Si può giocherellare con MC premendo semplicemente i
    tasti freccia e i tasti funzione.

    Nota

    In alcune console, come gnome-terminal(1), le battute sui tasti
    funzione potrebbero essere rubate dal programma di console. Si
    possono disabilitare queste funzionalità per gnome-terminal in
    "Modifica" → "Scorciatoie da tastiera".

    Se si incontrano problemi di codifica dei caratteri con
    visualizzazione di caratteri spazzatura, l'aggiunta dell'opzione
    "-a" alla riga di comando di MC può aiutare a prevenirli.

    Se ciò non risolve i problemi di visualizzazione in MC, vedere
    Sezione 9.4.6, «Configurazione del terminale».

%

1.3.3. Gestore dei file in MC

    L'impostazione predefinita è con due pannelli di directory
    contenenti gli elenchi dei file. Un'altra utile modalità è
    l'impostazione della finestra destra per contenere le
    "informazioni" per vedere informazioni sui privilegi di accesso
    dei file, ecc. Di seguito sono elencati alcuni tasti essenziali.
    Con il demone gpm(8) in esecuzione, si può anche usare il mouse
    in una console a caratteri Linux. (Assicurarsi di premeri il
    tasto Maiusc per ottenere il comportamento normale di taglia e
    incolla in MC.)

    Tabella 1.11. Le associazioni dei tasti di MC

    +---------------------------------------------------------------+
    |  tasto  |                  azione associata                   |
    |---------+-----------------------------------------------------|
    |F1       |menu di aiuto                                        |
    |---------+-----------------------------------------------------|
    |F3       |visualizzatore interno di file                       |
    |---------+-----------------------------------------------------|
    |F4       |editor interno                                       |
    |---------+-----------------------------------------------------|
    |F9       |attiva il menu a tendina                             |
    |---------+-----------------------------------------------------|
    |F10      |esce da Midnight Commander                           |
    |---------+-----------------------------------------------------|
    |Tab      |sposta tra le due finestre                           |
    |---------+-----------------------------------------------------|
    |Insert o |segna il file per una operazione su più file, come la|
    |Ctrl-T   |copia                                                |
    |---------+-----------------------------------------------------|
    |Del      |cancella il file (essere prudenti: impostare MC per  |
    |         |la modalità di cancellazione sicura)                 |
    |---------+-----------------------------------------------------|
    |tasti    |intuitivi                                            |
    |freccia  |                                                     |
    +---------------------------------------------------------------+


%

1.3.4. Trucchetti per la riga di comando di MC

      * Il comando cd cambia la directory mostrata nel pannello
        selezionato.

      * Ctrl-Invio o Alt-Invio copia un nome di file nella riga di
        comando. Usarlo con i comandi cp(1) e mv(1) assieme alla
        modifica della riga di comando.

      * Alt-Tab mostra le scelte date dall'espansione di shell dei
        nomi di file.
   
      * Si possono specificare le directory iniziali per entrambe le
        finestre come argomenti per MC; per esempio, "mc /etc /root".

      * Esc + tasto n → Fn (cioè, Esc + 1 → F1, ecc.; Esc + 0 → F10)

      * Premere Esc prima di un tasto ha lo stesso effetto di premere
        Alt ed il tasto contemporaneamente; premere cioè Esc + c per
        Alt-C. Esc è chiamato meta-tasto ed è a volte indicato con
        "M-".

%

1.3.5. L'editor interno di MC

    L'editor interno ha un interessante schema per il taglia e
    incolla. La pressione di F3 marca l'inizio di una selezione, una
    seconda pressione di F3 marca la fine della selezione e la
    evidenzia. Si può poi muovere il cursore. Se si preme F6, l'area
    selezionata viene spostata nella posizione del cursore. Se si
    preme F5 l'area selezionata viene copiata ed inserita alla
    posizione del cursore. F2 salva il file. F10 fa uscire. La
    maggior parte dei tasti cursore funziona in modo intuitivo.

    Si può avviare direttamente questo editor su di un file usando
    uno dei comandi seguenti.

    $ mc -e nome_del_file_da_modificare

    $ mcedit nome_del_file_da_modificare

    Questo non è un editor multi-finestra, ma si possono usare più
    console Linux per ottenere lo stesso effetto. Per copiare tra
    finestre, usare i tasti Alt-F<n> per cambiare console virtuale e
    usare "File→Insert file" o "File→Copy to file" per spostare una
    porzione di un file in un altro file.

    Questo editor interno può essere rimpiazzato da qualsiasi editor
    esterno a propria scelta.

    Inoltre molti programmi usano la variabile d'ambiente "$EDITOR" o
    "$VISUAL" per decidere quale editor usare. Se inizialmente non ci
    si trova a proprio agio con vim(1) o nano(1), si può impostare
    queste variabili a "mcedit" aggiungendo le righe seguenti al file
    "~/.bashrc".

    export EDITOR=mcedit
    export VISUAL=mcedit

    Io raccomando di impostarle a "vim", se possibile.

    Se non ci si trova a proprio agio con vim(1), si può continuare
    ad usare mcedit(1) per la maggior parte dei compiti di
    manutenzione del sistema.

%

1.3.6. Il visualizzatore interno di MC

    MC è un visualizzatore molto intelligente. È un grande strumento
    per cercare parole in documenti. Lo uso sempre per i file nella
    directory "/usr/share/doc". È il metodo più veloce per navigare
    tra una massa di informazioni Linux. Questo visualizzatore può
    essere avviato direttamente usando uno dei comandi seguenti.

    $ mc -v percorso/del/nome_file_da_visualizzare

    $ mcview percorso/del/nome_file_da_visualizzare

%

1.3.7. Funzionalità di avvio automatico di MC

    Se si preme Invio su di un file, un programma appropriato gestirà
    il contenuto del file (vedere Sezione 9.3.11, «Personalizzare i
    programmi da avviare»). Questa è una funzionalità molto comoda di
    MC.

    Tabella 1.12. La reazione al tasto Invio in MC

    +---------------------------------------------------------------+
    |   tipo di file   |          reazione al tasto Invio           |
    |------------------+--------------------------------------------|
    |file eseguibile   |esegue comando                              |
    |------------------+--------------------------------------------|
    |file man          |invia i contenuti tramite pipe al software  |
    |                  |di visualizzazione                          |
    |------------------+--------------------------------------------|
    |file html         |invia i contenuti tramite pipe al browser   |
    |                  |web                                         |
    |------------------+--------------------------------------------|
    |file "*.tar.gz" e |naviga i suoi contenuti come se fosse una   |
    |"*.deb"           |sottodirectory                              |
    +---------------------------------------------------------------+


    Per far sì che queste funzionalità di visualizzazione dei file e
    di file virtuali funzionino, i file visualizzabili non dovrebbero
    essere impostati come eseguibili. Cambiare il loro stato usando 
    chmod(1) o attraverso il menu file di MC.

%

1.3.8. File system FTP virtuale di MC

    MC può essere usato per accedere a file in Internet usando FTP.
    Premere F9 per andare nel menu, poi digitare "p" per attivare il
    file system FTP virtuale. Inserire un URL nella forma
    "nomeutente:password@nomehost.nomedominio" e la directory remota
    apparirà come una directory locale.

    Provare "[deb.debian.org/debian]" come URL e navigare
    nell'archivio Debian.

%

1.4. Ambiente di lavoro di base in stile Unix

    Anche se MC permette di fare quasi tutto, è bene imparare come
    usare gli strumenti a riga di comando invocati dal prompt di
    shell e prendere familiarità con l'ambiente di lavoro in stile
    Unix.

%

1.4.1. La shell di login

    Si può selezionare la propria shell di login con chsh(1).

    Tabella 1.13. Elenco di programmi shell

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|Shell|         descrizione         |
    |         |      |          |POSIX|                             |
    |---------+------+----------+-----+-----------------------------|
    |bash     |V:791,|6469      |Sì   |Bash: GNU Bourne Again SHell |
    |         |I:999 |          |     |(standard de facto)          |
    |---------+------+----------+-----+-----------------------------|
    |tcsh     |V:9,  |1316      |No   |TENEX C Shell: una versione  |
    |         |I:29  |          |     |migliorata di Berkeley csh   |
    |---------+------+----------+-----+-----------------------------|
    |dash     |V:907,|221       |Sì   |Debian Almquist Shell, buona |
    |         |I:992 |          |     |per script di shell          |
    |---------+------+----------+-----+-----------------------------|
    |zsh      |V:37, |2442      |Sì   |Z shell: la shell standard   |
    |         |I:73  |          |     |con molti miglioramenti      |
    |---------+------+----------+-----+-----------------------------|
    |mksh     |V:4,  |1469      |Sì   |Una versione della Korn shell|
    |         |I:12  |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |csh      |V:2,  |343       |No   |C Shell OpenBSD, una versione|
    |         |I:8   |          |     |di Berkeley csh              |
    |---------+------+----------+-----+-----------------------------|
    |         |V:0,  |          |     |Stand-alone shell con comandi|
    |sash     |I:6   |1054      |Sì   |interni (non adatta per      |
    |         |      |          |     |essere la "/bin/sh" standard)|
    |---------+------+----------+-----+-----------------------------|
    |ksh      |V:3,  |3284      |Sì   |la versione reale di AT&T    |
    |         |I:16  |          |     |della Korn shell             |
    |---------+------+----------+-----+-----------------------------|
    |rc       |V:0,  |169       |No   |implementazione della rc     |
    |         |I:2   |          |     |shell di AT&T Plan 9         |
    |---------+------+----------+-----+-----------------------------|
    |posh     |V:0,  |190       |Sì   |Policy-compliant Ordinary    |
    |         |I:0   |          |     |SHell (derivata da pdksh)    |
    +---------------------------------------------------------------+


    Suggerimento

    Sebbene le shell in stile POSIX condividano la stessa sintassi di
    base, esse possono differire nel comportamento relativo a cose
    anche basilari, come le variabili della shell e l'espansione dei
    modelli glob. Per i dettagli controllare la loro documentazione.

    In questo capitolo del tutorial la shell interattiva considerata
    è sempre bash.

%

1.4.2. Personalizzare bash

    Si può personalizzare il comportamento di bash(1) con "~
    /.bashrc".

    Per esempio provare quanto segue.

    # enable bash-completion
    if ! shopt -oq posix; then
      if [ -f /usr/share/bash-completion/bash_completion ]; then
        . /usr/share/bash-completion/bash_completion
      elif [ -f /etc/bash_completion ]; then
        . /etc/bash_completion
      fi
    fi

    # CD quando si esce da MC
    . /usr/lib/mc/mc.sh

    # impostare il CDPATH ad un buon valore
    CDPATH=.:/usr/share/doc:~:~/Desktop:~
    export CDPATH

    PATH="${PATH+$PATH:}/usr/sbin:/sbin"
    # impostare PATH in modo che includa la directory bin privata dell'utente se esiste
    if [ -d ~/bin ] ; then
      PATH="~/bin${PATH+:$PATH}"
    fi
    export PATH

    EDITOR=vim
    export EDITOR

    Suggerimento

    Si possono trovare altri suggerimenti sulla personalizzazione di 
    bash(1), come Sezione 9.2.7, «Comandi colorati», in Capitolo 9, 
    Suggerimenti per il sistema.

    Suggerimento
   
    Il pacchetto bash-completion permette il completamento automatico
    per bash.

%

1.4.3. Associazioni di tasti speciali

    Nell'ambiente *nix, ci sono alcune associazioni di tasti che
    hanno un significato speciale. Notare che in una console a
    caratteri Linux normale solo i tasti Ctrl e Altsinistri
    funzionano come atteso. Ecco alcune combinazioni di tasti che
    vale la pena ricordare.

    Tabella 1.14. Elenco di associazioni di tasti per bash

    +---------------------------------------------------------------+
    |        tasto        | descrizione dell'associazione di tasti  |
    |---------------------+-----------------------------------------|
    |Ctrl-U               |cancella il contenuto della riga prima   |
    |                     |del cursore                              |
    |---------------------+-----------------------------------------|
    |Ctrl-H               |cancella il carattere prima del cursore  |
    |---------------------+-----------------------------------------|
    |Ctrl-D               |termina l'input (se si sta usando la     |
    |                     |shell, esce dalla shell)                 |
    |---------------------+-----------------------------------------|
    |Ctrl-C               |termina un programma in esecuzione       |
    |---------------------+-----------------------------------------|
    |Ctrl-Z               |arresta temporaneamente un programma     |
    |                     |spostandolo come compito sullo sfondo    |
    |---------------------+-----------------------------------------|
    |Ctrl-S               |ferma l'output a schermo.                |
    |---------------------+-----------------------------------------|
    |Ctrl-Q               |riattiva l'output a schermo.             |
    |---------------------+-----------------------------------------|
    |Ctrl-Alt-Del         |riavvia/ferma il sistema, vedere inittab |
    |                     |(5)                                      |
    |---------------------+-----------------------------------------|
    |Left-Alt-key         |meta-tasto per Emacs e interfacce utente |
    |(opzionalmente, tasto|simili                                   |
    |Windows)             |                                         |
    |---------------------+-----------------------------------------|
    |freccia in su        |avvia la ricerca nello storico dei       |
    |                     |comandi in bash                          |
    |---------------------+-----------------------------------------|
    |Ctrl-R               |inizia una ricerca incrementale nello    |
    |                     |storico dei comandi in bash              |
    |---------------------+-----------------------------------------|
    |Tab                  |completa l'input di un nome di file nella|
    |                     |riga di comando in bash                  |
    |---------------------+-----------------------------------------|
    |Ctrl-V Tab           |inserisce in input un carattere Tab senza|
    |                     |espansione nella riga di comando in bash |
    +---------------------------------------------------------------+


    Suggerimento
   
    La funzionalità di Ctrl-S nel terminale può essere disabilitata
    usando stty(1).

%

1.4.4. Funzionamento del mouse in stile Unix

    Il funzionamento del mouse in stile Unix è basato sul sistema a 3
    pulsanti.

    Tabella 1.15. Elenco delle funzioni del mouse in stile Unix

    +---------------------------------------------------------------+
    |        azione        |                risposta                |
    |----------------------+----------------------------------------|
    |Clic sinistro e       |seleziona e copia negli appunti         |
    |trascinamento         |                                        |
    |----------------------+----------------------------------------|
    |Clic sinistro         |marca l'inizio della selezione          |
    |----------------------+----------------------------------------|
    |Clic destro           |marca la fine della selezione e copia   |
    |                      |negli appunti                           |
    |----------------------+----------------------------------------|
    |Clic di mezzo         |incolla gli appunti alla posizione del  |
    |                      |cursore                                 |
    +---------------------------------------------------------------+


    La rotella centrale presente nei mouse moderni viene considerata
    come il pulsante di mezzo e può essere usata per fare il
    corrispondente clic. Cliccare contemporaneamente con i pulsanti
    destro e sinistro funziona da clic di mezzo nelle situazioni in
    cui si hanno mouse a 2 pulsanti. Per poter usare il mouse in una
    console a caratteri Linux è necessario che gpm(8) sia in
    esecuzione come demone.

%

1.4.5. Il paginatore

    Il comando less(1) è il paginatore (navigatore del contenuto dei
    file) migliorato. Legge il file specificato nell'argomento del
    comando o il suo standard input. Premere "h" se si ha bisogno di
    aiuto nella navigazione con il comando less. Può fare molto di
    più di more(1) e può essere fornito di superpoteri eseguendo
    "eval $(lesspipe)" o "eval $(lessfile)" nello script di avvio
    della shell. Vedere ulteriori informazioni in "/usr/share/doc/
    less/LESSOPEN". L'opzione "-R" permette output raw e abilita le
    sequenze di escape ANSI per i colori. Vedere less(1).

%

1.4.6. L'editor di testo

    Si dovrebbe diventare competenti in una delle varianti dei
    programmi Vim o Emacs che sono popolari sui sistemi *nix.

    Penso che abituarsi ai comandi Vim sia la cosa giusta da fare,
    dato che un editor Vi è sempre presente nel mondo Linux/Unix. (In
    realtà, il vi originale o il nuovo nvi sono programmi che si
    trovano ovunque. Io ho scelto invece Vim per i principianti dato
    che offre l'aiuto attraverso il tasto F1 pur essendo abbastanza
    simile e più potente.)

    Se si sceglie invece Emacs o XEmacs come editor preferito, si sta
    facendo comunque davvero un'ottima scelta, specialmente per la
    programmazione. Emacs ha una vastità di altre funzionalità,
    incluso il funzionamento come newsreader, editor di directory,
    programma di posta, ecc. Quando usato per la programmazione o la
    scrittura di script, riconosce intelligentemente il formato che
    si sta usando e cerca di fornire assistenza. Alcune persone
    sostengono che l'unico programma di cui hanno bisogno su Linux è
    Emacs. Dieci minuti spesi ad imparare Emacs ora possono far
    risparmiare ore in futuro. È caldamente raccomandato avere a
    portata di mano il manuale di GNU Emacs da consultare quando si
    sta imparando Emacs.

    Tutti questi programmi sono di solito forniti con un programma
    tutor che aiuta ad impararli facendo pratica. Avviare Vim
    digitando "vim" e premere il tasto F1. Si dovrebbero leggere come
    minimo le prime 35 righe. Poi seguire il corso di apprendimento
    in linea muovendo il cursore su "|tutor|" e premendo Ctrl-].

    Nota

    I buoni editor, come Vim ed Emacs, possono gestire correttamente
    testi UTF-8 e testi in altre codifiche esotiche. È opportuno
    usare l'ambiente X con la localizzazione UTF-8 e installare i
    programmi e i tipi di carattere necessari. Gli editor hanno
    opzioni per impostare la codifica dei file indipendentemente
    dall'ambiente X. Fare riferimento alla loro documentazione sui
    testi multibyte.

%

1.4.7. Impostare un editor di testi predefinito

    Debian è fornita con svariati editor differenti. Si raccomanda di
    installare, come detto in precedenza, il pacchetto vim.

    Debian fornisce un accesso unificato all'editor predefinito di
    sistema attraverso il comando "/usr/bin/editor" in modo che altri
    programmi (ad esempio reportbug(1)) possano richiamarlo. Lo si
    può modificare con il comando seguente.

    $ sudo update-alternatives --config editor

    Io raccomando ai principianti la scelta di "/usr/bin/vim.basic"
    invece di"/usr/bin/vim.tiny" dato che supporta l'evidenziazione
    della sintassi.

    Suggerimento

    Molti programmi usano la variabile d'ambiente "$EDITOR" o
    "$VISUAL" per decidere quale editor usare (vedereSezione 1.3.5,
    «L'editor interno di MC» e Sezione 9.3.11, «Personalizzare i
    programmi da avviare». Per coerenza, in un sistema Debian,
    impostare queste variabili a "/usr/bin/editor". (Storicamente
    "$EDITOR" era "ed" e "$VISUAL" era "vi".)

%

1.4.8. Personalizzare vim

    Si può personalizzare il comportamento di vim(1) tramite "~
    /.vimrc".

    Per esempio, provare a fare quanto segue.

    " -------------------------------
    " Configurazione locale
    "
    set nocompatible
    set nopaste
    set pastetoggle=<f2>
    syn on
    if $USER == "root"
     set nomodeline
     set noswapfile
    else
     set modeline
     set swapfile
    endif
    " riempimento per evitare che la riga sopra sia considerata una modeline
    " riempimento
    " riempimento

%

1.4.9. Registrare le attività della shell

    L'output dei comandi di shell può scorrere fuori dallo schermo e
    potrebbe essere perduto per sempre. È buona norma registrare le
    attività di shell in un file in modo da poterle riguardare in
    seguito. Questo tipo di registro è essenziale quando si fa una
    qualsiasi attività di amministrazione del sistema.

    Il metodo base per registrare l'attività di shell è di eseguirla
    sotto script(1).

    Per esempio, provare a fare quanto segue.

    $ script
    Script è avviato, il file è typescript

    Eseguire qualsiasi comando di shell sotto script.

    Premere Ctrl-D per uscire da script.

    $ vim typescript

    Vedere Sezione 9.2.3, «Registrare le attività della shell in modo
    pulito».

%

1.4.10. Comandi Unix di base

    È bene imparare i comandi Unix di base. Il termine "Unix" è qui
    usato in senso lato; ogni SO clone di Unix offre di solito
    comandi equivalenti. Il sistema Debian non fa eccezione. Non ci
    si preoccupi se, al momento, alcuni comandi non funzionano come
    si vorrebbe. Se si usa alias nella shell, i corrispondenti output
    dei comandi sono diversi. Questi esempi non sono pensati per
    essere eseguiti necessariamente in questo ordine.

    Provare tutti i comandi seguenti da un account utente non
    privilegiato.

    Tabella 1.16. Elenco di comandi Unix di base

    +---------------------------------------------------------------+
    |    comando    |                  descrizione                  |
    |---------------+-----------------------------------------------|
    |pwd            |mostra il nome della directory attuale/di      |
    |               |lavoro                                         |
    |---------------+-----------------------------------------------|
    |whoami         |mostra il nome dell'utente attuale             |
    |---------------+-----------------------------------------------|
    |id             |mostra l'identità dell'utente attuale (nome,   |
    |               |uid, gid e gruppi associati)                   |
    |---------------+-----------------------------------------------|
    |file <pippo>   |mostra che tipo di file sia il file "<pippo>"  |
    |---------------+-----------------------------------------------|
    |type -p        |mostra la posizione del file del comando "     |
    |<nomecomando>  |<nomecomando>"                                 |
    |---------------+-----------------------------------------------|
    |which          |" "                                            |
    |<nomecomando>  |                                               |
    |---------------+-----------------------------------------------|
    |type           |mostra informazioni sul comando "<nomecomando>"|
    |<nomecomando>  |                                               |
    |---------------+-----------------------------------------------|
    |apropos        |trova comandi riguardanti "<parola-chiave>"    |
    |<parola-chiave>|                                               |
    |---------------+-----------------------------------------------|
    |man -k         |" "                                            |
    |<parola-chiave>|                                               |
    |---------------+-----------------------------------------------|
    |whatis         |mostra una spiegazione di una riga sul comando |
    |<nomecomando>  |"<nomecomando>"                                |
    |---------------+-----------------------------------------------|
    |man -a         |mostra una spiegazione del comando "           |
    |<nomecomando>  |<nomecomando>" (in stile Unix)                 |
    |---------------+-----------------------------------------------|
    |info           |mostra una spiegazione piuttosto lunga del     |
    |<nomecomando>  |comando "<nomecomando>" (in stile GNU)         |
    |---------------+-----------------------------------------------|
    |ls             |elenca il contenuto di directory (non i file   |
    |               |punto e le directory)                          |
    |---------------+-----------------------------------------------|
    |ls -a          |elenca il contenuto di directory (tutti i file |
    |               |e directory)                                   |
    |---------------+-----------------------------------------------|
    |ls -A          |elenca il contenuto di directory (quasi tutti i|
    |               |file e directory, cioè salta ".." e ".")       |
    |---------------+-----------------------------------------------|
    |ls -la         |elenca tutto il contenuto di directory con     |
    |               |informazioni dettagliate                       |
    |---------------+-----------------------------------------------|
    |ls -lai        |elenca tutto il contenuto di directory con     |
    |               |numeri di inode e informazioni dettagliate     |
    |---------------+-----------------------------------------------|
    |ls -d          |elenca tutte le directory dentro la directory  |
    |               |attuale                                        |
    |---------------+-----------------------------------------------|
    |tree           |mostra il contenuto in forma di albero         |
    |---------------+-----------------------------------------------|
    |lsof <pippo>   |mostra lo stato aperto per il file "<pippo>"   |
    |---------------+-----------------------------------------------|
    |lsof -p <pid>  |mostra i file aperti dal processo con ID "<pid>|
    |               |"                                              |
    |---------------+-----------------------------------------------|
    |mkdir <pippo>  |crea una nuova directory "<pippo>" nella       |
    |               |directory attuale                              |
    |---------------+-----------------------------------------------|
    |rmdir <pippo>  |rimuove la directory "<pippo>" nella directory |
    |               |attuale                                        |
    |---------------+-----------------------------------------------|
    |               |cambia directory spostandosi nella directory " |
    |cd <pippo>     |<pippo>" nella directory attuale o in una      |
    |               |directory elencata nella variabile "$CDPATH"   |
    |---------------+-----------------------------------------------|
    |cd /           |cambia directory spostandosi nella directory   |
    |               |radice                                         |
    |---------------+-----------------------------------------------|
    |cd             |cambia directory spostandosi nella directory   |
    |               |home dell'utente                               |
    |---------------+-----------------------------------------------|
    |cd /<pippo>    |cambia directory spostandosi nella directory   |
    |               |con percorso assoluto "/<pippo>"               |
    |---------------+-----------------------------------------------|
    |cd ..          |cambia directory spostandosi nella directory   |
    |               |genitore                                       |
    |---------------+-----------------------------------------------|
    |cd ~<pippo>    |cambia directory spostandosi nella directory   |
    |               |home dell'utente "<pippo>"                     |
    |---------------+-----------------------------------------------|
    |cd -           |cambia directory spostandosi nella directory   |
    |               |precedente                                     |
    |---------------+-----------------------------------------------|
    |</etc/motd     |mostra il contenuto di "/etc/motd" usando il   |
    |pager          |paginatore predefinito                         |
    |---------------+-----------------------------------------------|
    |touch          |crea un file "<filediprova>" vuoto             |
    |<filediprova>  |                                               |
    |---------------+-----------------------------------------------|
    |cp <pippo>     |copia un file "<pippo>" esistente in un nuovo  |
    |<pluto>        |file "<pluto>"                                 |
    |---------------+-----------------------------------------------|
    |rm             |rimuove il file "<filediprova>"                |
    |<filediprova>  |                                               |
    |---------------+-----------------------------------------------|
    |mv <pippo>     |rinomina un file "<pippo>" esistente con il    |
    |<pluto>        |nuovo nome "<pluto>" ("<pluto>" non deve       |
    |               |esistere)                                      |
    |---------------+-----------------------------------------------|
    |mv <pippo>     |muove un file "<pippo>" esistente nella nuova  |
    |<pluto>        |posizione "<pluto>/<pippo>" (la directory "    |
    |               |<pluto>" deve esistere)                        |
    |---------------+-----------------------------------------------|
    |mv <pippo>     |muove un file "<pippo>" esistente in una nuova |
    |<pluto>/       |posizione con il nuovo nome "<pluto>/<paperino>|
    |<paperino>     |" (la directory "<pluto>" deve esistere ma non |
    |               |deve esistere "<bar>/<baz>")                   |
    |---------------+-----------------------------------------------|
    |chmod 600      |fa sì che il file "<pippo>" esistente sia non  |
    |<pippo>        |leggibile e non scrivibile da altri (e non     |
    |               |eseguibile per nessuno)                        |
    |---------------+-----------------------------------------------|
    |chmod 644      |fa sì che il file "<pippo>" esistente sia      |
    |<pippo>        |leggibile ma non scrivibile da altri (e non    |
    |               |eseguibile per nessuno)                        |
    |---------------+-----------------------------------------------|
    |chmod 755      |fa sì che il file "<pippo>" esistente sia      |
    |<pippo>        |leggibile ma non scrivibile da altri (ed       |
    |               |eseguibile per tutti)                          |
    |---------------+-----------------------------------------------|
    |find . -name   |trova nomi di file corrispondenti al "<modello>|
    |<modello>      |" di shell (lento)                             |
    |---------------+-----------------------------------------------|
    |locate -d .    |trova nomi di file corrispondenti al "<pattern>|
    |<modello>      |" di shell (più veloce, usa un database        |
    |               |generato regolarmente)                         |
    |---------------+-----------------------------------------------|
    |grep -e "      |trova un "<modello>" in tutti i file nella     |
    |<modello>"     |directory attuale che terminano con ".html" e  |
    |*.html         |mostra tutte le corrispondenze                 |
    |---------------+-----------------------------------------------|
    |top            |mostra informazioni sui processi a tutto       |
    |               |schermo, digitare "q" per uscire               |
    |---------------+-----------------------------------------------|
    |ps aux | pager |mostra informazioni su tutti i processi in     |
    |               |esecuzione usando output in stile BSD          |
    |---------------+-----------------------------------------------|
    |ps -ef | pager |mostra informazioni su tutti i processi in     |
    |               |esecuzione usando output in stile system V Unix|
    |---------------+-----------------------------------------------|
    |ps aux | grep  |mostra tutti i processi che stanno eseguendo   |
    |-e "[e]xim4*"  |"exim" e "exim4"                               |
    |---------------+-----------------------------------------------|
    |ps axf | pager |mostra informazioni su tutti i processi in     |
    |               |esecuzione usando output in ASCII art          |
    |---------------+-----------------------------------------------|
    |kill <1234>    |uccide un processo identificato dall'ID "<1234>|
    |               |"                                              |
    |---------------+-----------------------------------------------|
    |gzip <pippo>   |comprime <pippo>" per creare "<pippo>.gz",     |
    |               |usando la codifica Lempel-Ziv (LZ77)           |
    |---------------+-----------------------------------------------|
    |gunzip         |decomprime "<pippo>.gz" per creare "<pippo>"   |
    |<pippo>.gz     |                                               |
    |---------------+-----------------------------------------------|
    |               |comprime "<pippo>" per creare "<pippo>.bz2",   |
    |               |usando l'algoritmo Burrows-Wheeler per la      |
    |bzip2 <pippo>  |compressione di testo con ordinamento di       |
    |               |blocchi e la codifica Huffman (compressione    |
    |               |migliore di gzip)                              |
    |---------------+-----------------------------------------------|
    |bunzip2        |decomprime "<pippo>.bz2" per creare "<pippo>"  |
    |<pippo>.bz2    |                                               |
    |---------------+-----------------------------------------------|
    |               |comprime "<pippo>" per creare "<pippo>.xz",    |
    |xz <pippo>     |usando l'algoritmo Lempel–Ziv–Markov chain     |
    |               |(compressione migliore di bzip2)               |
    |---------------+-----------------------------------------------|
    |unxz <pippo>.xz|decomprime "<pippo>.xz" per creare "<pippo>"   |
    |---------------+-----------------------------------------------|
    |tar -xvf       |estrae i file dall'archivio "<pippo>.tar"      |
    |<pippo>.tar    |                                               |
    |---------------+-----------------------------------------------|
    |tar -xvzf      |estrae file dall'archivio "<pippo>.tar.gz"     |
    |<pippo>.tar.gz |compresso con gzip                             |
    |---------------+-----------------------------------------------|
    |tar -xvjf      |estrae file dall'archivio "<pippo>.tar.bz2"    |
    |<pippo>.tar.bz2|                                               |
    |---------------+-----------------------------------------------|
    |tar -xvJf      |estrae file dall'archivio "<pippo>.tar.xz"     |
    |<pippo>.tar.xz |                                               |
    |---------------+-----------------------------------------------|
    |tar -cvf       |archivia i contenuti della directory "<pluto>/"|
    |<pippo>.tar    |nell'archivio "<pippo>.tar"                    |
    |<pluto>/       |                                               |
    |---------------+-----------------------------------------------|
    |tar -cvzf      |archivia i contenuti della directory "<pluto>/"|
    |<pippo>.tar.gz |nell'archivio compresso "<pippo>.tar.gz"       |
    |<pluto>/       |                                               |
    |---------------+-----------------------------------------------|
    |tar -cvjf      |archivia i contenuti della directory "<plutor>/|
    |<pippo>.tar.bz2|" nell'archivio "<pippo>.tar.bz2"              |
    |<pluto>/       |                                               |
    |---------------+-----------------------------------------------|
    |tar -cvJf      |archivia i contenuti della directory "<plutor>/|
    |<pippo>.tar.xz |" nell'archivio "<pippo>.tar.xz"               |
    |<pluto>/       |                                               |
    |---------------+-----------------------------------------------|
    |zcat README.gz |mostra i contenuti del file compresso          |
    || pager        |"README.gz" usando il paginatore predefinito   |
    |---------------+-----------------------------------------------|
    |zcat README.gz |crea un file "pippo con i contenuti di         |
    |> pippo        |"README.gz" decompressi                        |
    |---------------+-----------------------------------------------|
    |zcat README.gz |aggiunge i contenuti di "README.gz" decompressi|
    |>> pippo       |in coda al file "pippo" (se il file non esiste,|
    |               |lo crea)                                       |
    +---------------------------------------------------------------+


    Nota

    Unix tradizionalmente nasconde i nomi di file che iniziano con
    ".". Sono tradizionalmente file contenenti informazioni di
    configurazione e preferenze dell'utente.

    Nota
   
    Per il comando cd vedere builtins(7).

    Nota

    Il paginatore predefinito del sistema di base di Debian è more(1)
    che non ha lo scorrimento all'indietro. Installando il pacchetto
    less, con la riga di comando "apt-get install less", less(1)
    diventa il paginatore predefinito e si può così scorrere il testo
    all'indietro usando i tasti freccia.

    Nota

    I caratteri "[" e "]" nella espressione regolare del comando "ps
    aux | grep -e "[e]xim4*"" sopra citato, permettono a grep di
    evitare di trovare corrispondenza con sé stesso. La parte "4*"
    nella espressione regolare significa 0 o più ripetizioni del
    carattere "4" e perciò permette a grep di trovare corrispondenza
    sia con "exim" sia con "exim4". Sebbene il carattere "*" sia
    usato nei nomi di file con metacaratteri della shell e nelle
    espressioni regolari, il suo significato è diverso nei due casi.
    Si possono imparare le espressioni regolari da grep(1).

    Come esercizio, esplorare le directory e dare un'occhiata al
    sistema usando i comandi citati sopra. Se si hanno domande su uno
    qualsiasi dei comandi in console, assicurarsi di leggere la
    pagina di manuale.

    Per esempio, provare a fare quanto segue.

    $ man man
    $ man bash
    $ man builtins
    $ man grep
    $ man ls

    Può essere un po' difficile abituarsi allo stile delle pagine man
    perché sono piuttosto concise, in particolar modo le più vecchie
    e tradizionali. Una volta che ci si fa la mano, però, si apprezza
    la loro concisione.

    Notare che molti comandi in stile Unix, inclusi quelli da GNU e
    BSD, mostrano una breve informazione di aiuto se li si invoca in
    uno dei modi seguenti (o in alcuni casi se lo si fa senza usare
    opzioni).

    $ <nomecomando> --help
    $ <nomecomando> -h

%

1.5. Il semplice comando di shell

    Ora si ha un'idea di come usare il sistema Debian; è tempo di
    dare uno sguardo più approfondito al meccanismo di esecuzione dei
    comandi nel sistema Debian. Qui la realtà è stata semplificata ad
    uso del principiante. Vedere bash(1) per una spiegazione esatta.

    Un semplice comando è formato da una sequenza di componenti.

     1. Assegnazioni di variabili (opzionale)

     2. Nome del comando

     3. Opzioni (opzionali)

     4. Ridirezioni (opzionali, > , >> , < , << , ecc.)

     5. Operatori di controllo (opzionale, && , || , <a-capo> , ; , &
        , ( , ) )

%

1.5.1. Esecuzione dei comandi e variabili d'ambiente

    I valori di alcune variabili d'ambiente cambiano il comportamento
    di alcuni comandi Unix.

    I valori predefiniti delle variabili d'ambiente sono impostati
    inizialmente dal sistema PAM e poi alcuni di essi possono essere
    reimpostati da alcuni programmi applicativi.

      * Il display manager, come gdm3, reimposta variabili
        d'ambiente.
   
      * La shell reimposta variabili d'ambiente nel suo codice di
        avvio in "~/.bash_profile" e "~/.bashrc".

%

1.5.2. La variabile "$LANG"

    Il valore completo di localizzazione impostato nella variabile
    "$LANG" consiste di 3 parti: "xx_YY.ZZZZ".

    Tabella 1.17. Le 3 parti del valore di localizzazione

    +---------------------------------------------------------------+
    |     valore di     |                significato                |
    |  localizzazione   |                                           |
    |-------------------+-------------------------------------------|
    |xx                 |codice ISO 639 della lingua (in minuscole),|
    |                   |come "en"                                  |
    |-------------------+-------------------------------------------|
    |YY                 |codice ISO 3166 del paese (in maiuscole)   |
    |                   |come "US"                                  |
    |-------------------+-------------------------------------------|
    |ZZZZ               |codeset, impostato sempre ad "UTF-8"       |
    +---------------------------------------------------------------+


    Per i codici delle lingue e dei paesi, vedere le descrizioni
    pertinenti in "info gettext".

    In un sistema Debian moderno il codeset dovrebbe essere sempre
    impostato a UTF-8, a meno che non si voglia specificatamente
    usare uno usato in passato e avendo una buona ragione e le
    conoscenze per farlo.

    Per dettagli più specifici sulla configurazione della
    localizzazione vedere Sezione 8.4, «La localizzazione».

    Nota
   
    In un sistema Debian assicurarsi di installare il pacchetto
    locales-all per usare tutte le localizzazioni.

    Nota

    "LANG=en_US" non è "LANG=C" né "LANG=en_US.UTF-8". È "LANG=
    en_US.ISO-8859-1" (vedere Sezione 8.4.1, «Nozioni base sulla
    codifica»).

    Tabella 1.18. Elenco di localizzazioni raccomandate

    +---------------------------------------------------------------+
    |localizzazione raccomandata|           lingua (zona)           |
    |---------------------------+-----------------------------------|
    |en_US.UTF-8                |inglese (USA)                      |
    |---------------------------+-----------------------------------|
    |en_GB.UTF-8                |inglese (Gran Bretagna)            |
    |---------------------------+-----------------------------------|
    |fr_FR.UTF-8                |francese (Francia)                 |
    |---------------------------+-----------------------------------|
    |de_DE.UTF-8                |tedesco (Germania)                 |
    |---------------------------+-----------------------------------|
    |it_IT.UTF-8                |italiano (Italia)                  |
    |---------------------------+-----------------------------------|
    |es_ES.UTF-8                |spagnolo (Spagna)                  |
    |---------------------------+-----------------------------------|
    |ca_ES.UTF-8                |catalano (spagna)                  |
    |---------------------------+-----------------------------------|
    |sv_SE.UTF-8                |svedese (Svezia)                   |
    |---------------------------+-----------------------------------|
    |pt_BR.UTF-8                |portoghese (Brasile)               |
    |---------------------------+-----------------------------------|
    |ru_RU.UTF-8                |russo (Russia)                     |
    |---------------------------+-----------------------------------|
    |zh_CN.UTF-8                |cinese (Repubblica Popolare Cinese)|
    |---------------------------+-----------------------------------|
    |zh_TW.UTF-8                |cinese (Taiwan Repubblica di Cina) |
    |---------------------------+-----------------------------------|
    |ja_JP.UTF-8                |giapponese (Giappone)              |
    |---------------------------+-----------------------------------|
    |ko_KR.UTF-8                |coreano (Corea del Sud)            |
    |---------------------------+-----------------------------------|
    |vi_VN.UTF-8                |vietnamita (Vietnam)               |
    +---------------------------------------------------------------+


    Una tipica esecuzione di un comando usa una sequenza sulla riga
    della shell come la seguente.

    $ date
    Sun Jun  3 10:27:39 JST 2007
    $ LANG=fr_FR.UTF-8 date
    dimanche 3 juin 2007, 10:27:33 (UTC+0900)

    In questo caso il programma date(1) viene eseguito con valori
    differenti della variabile d'ambiente "$LANG".

      * Per il primo comando "$LANG" è impostata al valore di
        localizzazione predefinito di sistema: "en_US.UTF-8".
   
      * Per il secondo comando "$LANG" è impostata al valore di
        localizzazione UTF-8 francese: fr_FR.UTF-8".

    La maggior parte delle invocazioni di comandi non è solitamente
    preceduta da definizioni di variabili d'ambiente. In alternativa
    all'esempio precedente, si può eseguire quanto segue.

    $ LANG=fr_FR.UTF-8
    $ date
    dimanche 3 juin 2007, 10:27:33 (UTC+0900)

    Come si può vedere, l'output del comando è in questo caso
    influenzato dalla variabile d'ambiente per produrre output in
    francese. Se si desidera che una variabile d'ambiente venga
    ereditata da sottoprocessi, ad esempio quando si invocano script
    di shell, è necessario invece esportarla nel modo seguente.

    $ export LANG

    Nota

    Quando si usa un tipico terminale in console, la variabile
    d'ambiente "$LANG" è solitamente impostata per essere esportata
    dall'ambiente desktop. Perciò quello sopra non è veramente un
    buon esempio per testare l'effetto di export.

    Suggerimento

    Quando si segnala un bug, è una buona idea, se si usa un ambiente
    non inglese, eseguire e controllare il comando nella
    localizzazione "LANG=en_US.UTF-8".

    Vedere locale(5) e locale(7) per "$LANG" e variabili d'ambiente
    correlate.

    Nota

    Io raccomando di configurare l'ambiente di sistema usando solo la
    variabile "$LANG" e di tenersi alla larga dalle variabili "$LC_*"
    a meno che non sia strettamente necessario.

%

1.5.3. La variabile "$PATH"

    Quando si digita un comando nella shell, questa cerca il comando
    nelle directory nell'elenco contenuto nella variabile d'ambiente
    "$PATH". Il valore della variabile d'ambiente "$PATH" è anche
    chiamato percorso di ricerca della shell.

    In una installazione Debian standard, la variabile d'ambiente
    "$PATH" degli account utente può non includere "/sbin" e "/usr/
    sbin". Il comando ifconfig, per esempio, deve essere eseguito con
    il percorso completo, come in "/sbin/ifconfig". (Il comando
    simile ip si trova in "/bin".)

    Si può modificare la variabile d'ambiente "$PATH" della shell
    Bash tramite il file "~/.bash_profile" o "~/.bashrc".

%

1.5.4. La variabile "$HOME"

    Molti comandi memorizzano una configurazione specifica per
    l'utente nella directory home e cambiano il loro comportamento in
    base al suo contenuto. La directory home è identificata dalla
    variabile d'ambiente "$HOME".

    Tabella 1.19. Elenco di valori di "$HOME"

    +---------------------------------------------------------------+
    |   valore di    |    situazione di esecuzione del programma    |
    |    "$HOME"     |                                              |
    |----------------+----------------------------------------------|
    |/               |programma eseguito da processo init (demone)  |
    |----------------+----------------------------------------------|
    |/root           |programma eseguito dalla normale shell di root|
    |----------------+----------------------------------------------|
    |/home/          |programma eseguito dalla shell di un utente   |
    |<utente_normale>|normale                                       |
    |----------------+----------------------------------------------|
    |/home/          |programma eseguito dal menu del desktop       |
    |<utente_normale>|grafico di un utente normale                  |
    |----------------+----------------------------------------------|
    |/home/          |programma eseguito come root con "sudo        |
    |<utente_normale>|programma"                                    |
    |----------------+----------------------------------------------|
    |/root           |programma eseguito come root con "sudo -H     |
    |                |programma"                                    |
    +---------------------------------------------------------------+


    Suggerimento

    La shell espande "~/ nella directory home dell'utente attuale,
    cioè "$HOME/". La shell espande "~pippo/" nella directory home di
    pippo, cioè "/home/pippo/".

%

1.5.5. Opzioni della riga di comando

    Alcuni comandi accettano argomenti. Gli argomenti che iniziano
    con "-" o "--" sono chiamati opzioni e controllano il
    comportamento del comando.

    $ date
    dom apr 18 23:22:36 CEST 2010
    $ date -R
    Sun, 18 Apr 2010 23:23:08 +0200

    In questo caso l'opzione "-R" sulla riga di comando cambia il
    comportamento di date(1) producendo in output la data in una
    stringa conforme alla RFC2822.

%

1.5.6. Glob della shell

    Spesso si desidera che un comando abbia effetto su un gruppo di
    file senza dover digitarli tutti. I modelli di espansione dei
    nomi di file che usano i glob della shell, a volte detti 
    metacaratteri o caratteri jolly, facilitano questo compito.

    Tabella 1.20. Modelli di glob della shell

    +---------------------------------------------------------------+
    |  modello di  |                                                |
    |  glob della  |   descrizione della regola di corrispondenza   |
    |    shell     |                                                |
    |--------------+------------------------------------------------|
    |*             |nome file (segmento) che non inizia con "."     |
    |--------------+------------------------------------------------|
    |.*            |nome file (segmento) che inizia con "."         |
    |--------------+------------------------------------------------|
    |?             |esattamente un carattere                        |
    |--------------+------------------------------------------------|
    |[…]           |esattamente un carattere tra quelli racchiusi   |
    |              |tra le parentesi quadre                         |
    |--------------+------------------------------------------------|
    |[a-z]         |esattamente un carattere che sia un carattere   |
    |              |compreso tra "a" e "z"                          |
    |--------------+------------------------------------------------|
    |              |esattamente un carattere che non sia uno di     |
    |[^…]          |quelli racchiusi tra parentesi quadre (non      |
    |              |contando "^")                                   |
    +---------------------------------------------------------------+


    Per esempio, provare a fare quanto segue.

    $ mkdir prova; cd prova; touch 1.txt 2.txt 3.c 4.h .5.txt ..6.txt
    $ echo *.txt
    1.txt 2.txt
    $ echo *
    1.txt 2.txt 3.c 4.h
    $ echo *.[hc]
    3.c 4.h
    $ echo .*
    . .. .5.txt ..6.txt
    $ echo .*[^.]*
    .5.txt ..6.txt
    $ echo [^1-3]*
    4.h
    $ cd ..; rm -rf prova

    Vedere glob(7).

    Nota

    A differenza della normale espansione dei nomi della shell, il
    modello shell "*" cercato dal comando find(1) con la ricerca
    "-name" ecc., trova corrispondenza anche con nomi di file che
    iniziano con ".". (Nuova funzionalità POSIX.)

    Nota

    Si può manipolare il comportamento di BASH in relazione ai
    modelli di glob usando le sue opzioni shopt incorporate come
    "dotglob", "noglob", "nocaseglob", "nullglob", "extglob", ecc.
    Vedere bash(1).

%

1.5.7. Valore restituito dal comando

    Ogni comando restituisce il suo stato di uscita (variabile "$?")
    come valore restituito.

    Tabella 1.21. Codici di uscita dei comandi

    +---------------------------------------------------------------+
    | stato di uscita del |   valore numerico   |   valore logico   |
    |       comando       |     restituito      |    restituito     |
    |---------------------+---------------------+-------------------|
    |successo             |zero, 0              |VERO               |
    |---------------------+---------------------+-------------------|
    |errore               |non-zero, -1         |FALSO              |
    +---------------------------------------------------------------+


    Per esempio provare quanto segue.

    $ [ 1 = 1 ] ; echo $?
    0
    $ [ 1 = 2 ] ; echo $?
    1

    Nota

    Notare che, nel contesto logico della shell, il successo è
    trattato come il valore logico VERO che ha valore numerico 0
    (zero). Questo è in qualche modo non intuitivo ed è bene
    rimarcarlo.

%

1.5.8. Sequenze tipiche di comandi e ridirezione della shell

    È bene cercare di ricordare i seguenti idiomi per comandi di
    shell che vengono digitati sulla stessa riga come parte del
    comando di shell.

    Tabella 1.22. Idiomi per comandi di shell

    +---------------------------------------------------------------+
    | idioma per |                   descrizione                    |
    |  comando   |                                                  |
    |------------+--------------------------------------------------|
    |comando &   |esegue comando sullo sfondo in una sotto-shell    |
    |------------+--------------------------------------------------|
    |comando1 |  |invia tramite pipe lo standard output di comando1 |
    |comando2    |allo standard input di comando2 (esecuzione       |
    |            |concorrente)                                      |
    |------------+--------------------------------------------------|
    |comando1 2>&|invia tramite pipe sia lo standard output sia lo  |
    |1 | comando2|standard error di comando1 allo standard input di |
    |            |comando2 (esecuzione concorrente)                 |
    |------------+--------------------------------------------------|
    |comando1 ;  |esegue comando1 e comando2 in sequenza            |
    |comando2    |                                                  |
    |------------+--------------------------------------------------|
    |comando1 && |esegue comando1; se ha successo, esegue comando2  |
    |comando2    |in sequenza (restituisce lo stato di successo se  |
    |            |sia comando1 sia comando2 hanno successo)         |
    |------------+--------------------------------------------------|
    |comando1 || |esegue comando1; se non ha successo, esegue       |
    |comando2    |comando2 in sequenza (restituisce lo stato di     |
    |            |successo se comando1 o comando2 ha successo)      |
    |------------+--------------------------------------------------|
    |comando >   |ridirige lo standard output di comando al file    |
    |pippo       |"pippo" (sovrascrivendolo)                        |
    |------------+--------------------------------------------------|
    |comando 2>  |ridirige lo standard error di comando al file     |
    |pippo       |"pippo" (sovrascrivendolo)                        |
    |------------+--------------------------------------------------|
    |comando >>  |ridirige lo standard output di comando al file    |
    |pippo       |"pippo" (aggiungendo in coda)                     |
    |------------+--------------------------------------------------|
    |comando 2>> |ridirige lo standard error di comando al file     |
    |pippo       |"pippo" (aggiungendo in coda)                     |
    |------------+--------------------------------------------------|
    |comando >   |ridirige sia lo standard output sia lo standard   |
    |pippo 2>&1  |error di comando al file pippo                    |
    |------------+--------------------------------------------------|
    |comando <   |usa come standard input di comando il file "pippo"|
    |pippo       |                                                  |
    |------------+--------------------------------------------------|
    |comando <<  |usa come standard input di comando le righe che   |
    |delimitatore|seguono fino a che non viene incontrato il testo  |
    |            |"delimitatore" (inserire un documento)            |
    |------------+--------------------------------------------------|
    |            |usa come standard input di comando le righe che   |
    |comando <<- |seguono fino a che non viene incontrato il testo  |
    |delimitatore|"delimitatore"; i caratteri di tabulazione        |
    |            |iniziali vengono eliminate dal testo (inserire un |
    |            |documento)                                        |
    +---------------------------------------------------------------+


    Il sistema Debian è un sistema multi-tasking. I compiti sullo
    sfondo permettono agli utenti di eseguire più programmi in una
    singola shell. La gestione dei processi sullo sfondo coinvolge i
    comandi interni della shell jobs, fg, bg e kill. Leggere le
    sezioni "SIGNALS" e "JOB CONTROL" di bash(1) e builtins(1).

    Per esempio, provare a fare quanto segue.

    $ </etc/motd pager

    $ pager </etc/motd

    $ pager /etc/motd

    $ cat /etc/motd | pager

    Benché tutti i 4 esempi di ridirezione della shell mostrino la
    stessa cosa, l'ultimo esempio esegue un comando cat aggiuntivo e
    spreca risorse senza motivo.

    La shell permette di aprire file usando il comando interno
    execcon un descrittore di file arbitrario.

    $ echo Hello >pippo
    $ exec 3<pippo 4>pluto  # apre i file
    $ cat <&3 >&4       # ridirige lo stdin in 3, lo stdout in 4
    $ exec 3<&- 4>&-    # chiude i file
    $ cat pluto
    Hello

    I descrittori di file 0-2 sono predefiniti.

    Tabella 1.23. Descrittori di file predefiniti

    +-------------------------------------------+
    |device|  descrizione  |descrittore del file|
    |------+---------------+--------------------|
    |stdin |standard input |0                   |
    |------+---------------+--------------------|
    |stdout|standard output|1                   |
    |------+---------------+--------------------|
    |stderr|standard error |2                   |
    +-------------------------------------------+


%

1.5.9. Alias di comandi

    Si possono impostare alias per i comandi usati di frequente.

    Per esempio, provare a fare quanto segue.

    $ alias la='ls -la'

    Ora "la" funziona da scorciatoia per "ls -la" che elenca tutti i
    file nel formato di elencazione esteso.

    Si possono elencare tutti gli alias esistenti con alias (vedere
    la sezione "SHELL BUILTIN COMMANDS" in bash(1)).

    $ alias
    ...
    alias la='ls -la'

    Si può identificare il percorso esatto o l'identità di un comando
    con type (vedere la sezione "SHELL BUILTIN COMMANDS") di bash(1)
    ).

    Per esempio, provare a fare quanto segue.

    $ type ls
    ls is hashed (/bin/ls)
    $ type la
    la is aliased to ls -la
    $ type echo
    echo is a shell builtin
    $ type file
    file is /usr/bin/file

    In questo caso ls era stato cercato di recente mentre "file" no,
    percio "ls" risulta "hashed", cioè la shell ha un record interno
    per un accesso veloce alla posizione del comando "ls".

    Suggerimento
   
    Vedere Sezione 9.2.7, «Comandi colorati».

%

1.6. Elaborazione di testo stile Unix

    Nell'ambiente di lavoro Unix, l'elaborazione del testo viene
    fatta instradando il testo tramite pipe attraverso catene di
    strumenti standard per l'elaborazione del testo. Questa è stata
    un'altra fondamentale innovazione di Unix.

%

1.6.1. Strumenti Unix per il testo

    Ci sono alcuni strumenti di elaborazione del testo che sono usati
    molto spesso in un sistema *nix.

      * Senza l'uso di alcuna espressione regolare:

          + cat(1) concatena file e produce in output il contenuto
            totale.

          + tac(1) concatena file e produce l'output in senso
            inverso.

          + cut(1) seleziona parti di righe e le produce in output.

          + head(1) produce in output la prima parte di file.

          + tail(1) produce in output l'ultima parte di file.

          + sort(1) ordina righe in file di testo.

          + uniq(1) rimuove righe duplicate da un file ordinato.

          + tr(1) trasforma o elimina caratteri.

          + diff(1) paragona file riga per riga.

      * Con l'uso di espressioni regolari di base (BRE):

          + grep(1) trova corrispondenze di testo con modelli.

          + ed(1) è un primitivo editor di riga.

          + sed(1) è un editor di flussi.

          + vim(1) è un editor a schermo.

          + emacs(1) è un editor a schermo (con BRE un po' estese)

      * Con l'uso di espressioni regolari estese (ERE):

          + egrep(1) trova corrispondenze di testo con modelli.

          + awk(1) fa semplici elaborazioni di testo.

          + tcl(3tcl) può fare ogni elaborazione di testo
            immaginabile: vedere re_syntax(3). Spesso usato con tk
            (3tk).

          + perl(1) può fare ogni elaborazione di testo immaginabile.
            Vedere perlre(1).

          + pcregrep(1) dal pacchetto pcregrep trova corrispondenze
            di testo con modelli PCRE (Perl Compatible Regular
            Expressions).

          + python(1) con il modulo re può fare ogni elaborazione di
            testo immaginabile. Vedere "/usr/share/doc/python/html/
            index.html".

    Se non si è sicuri di cosa facciano esattamente questi comandi,
    usare "man comando" per scoprirlo.

    Nota

    Il criterio di ordinamento e le espressioni di intervalli
    dipendono dalla localizzazione. Se si desidera ottenere il
    comportamento tradizionale di un comando, usare la localizzazione
    C invece di quelle UTF-8 anteponendo al comando "LANG=C" (vedere
    Sezione 1.5.2, «La variabile "$LANG"» e Sezione 8.4, «La
    localizzazione»).

    Nota

    Le espressioni regolari Perl (perlre(1)), le PCRE (Perl
    Compatible Regular Expressions) e le espressioni regolari Python
    fornite dal modulo re hanno molte estensioni comuni delle normali
    ERE.

%

1.6.2. Espressioni regolari

    Le espressioni regolari sono usate in molti strumenti di
    elaborazione del testo. Sono analoghe ai modelli di glob della
    shell, ma sono più complesse e potenti.

    Una espressione regolare descrive il modello a cui trovare
    corrispondenza ed è composta da caratteri di testo e 
    metacaratteri.

    Un metacarattere è semplicemente un carattere con un significato
    speciale. Ci sono 2 stili principali, BRE e ERE, a seconda degli
    strumenti di testo descritti in precedenza.

    Tabella 1.24. Metacaratteri per BRE e ERE

    +---------------------------------------------------------------+
    |  BRE   | ERE  |    descrizione della espressione regolare     |
    |--------+------+-----------------------------------------------|
    |\ . [ ] |\ . [ |                                               |
    |^ $ *   |] ^ $ |metacaratteri comuni                           |
    |        |*     |                                               |
    |--------+------+-----------------------------------------------|
    |\+ \? \(|      |metacaratteri protetti dal carattere "\" di    |
    |\) \{ \}|      |escape solo di BRE                             |
    |\|      |      |                                               |
    |--------+------+-----------------------------------------------|
    |        |+ ? ( |metacaratteri non protetti dal carattere "\" di|
    |        |) { } |escape solo di ERE                             |
    |        ||     |                                               |
    |--------+------+-----------------------------------------------|
    |c       |c     |corrisponde al non metacarattere "c"           |
    |--------+------+-----------------------------------------------|
    |\c      |\c    |corrisponde al carattere letterale "c" anche se|
    |        |      |"c" è in sé stesso un metacarattere            |
    |--------+------+-----------------------------------------------|
    |.       |.     |corrisponde a qualsiasi carattere incluso il   |
    |        |      |carattere di a capo                            |
    |--------+------+-----------------------------------------------|
    |^       |^     |posizione all'inizio di una stringa            |
    |--------+------+-----------------------------------------------|
    |$       |$     |posizione alla fine di una stringa             |
    |--------+------+-----------------------------------------------|
    |\<      |\<    |posizione all'inizio di una parola             |
    |--------+------+-----------------------------------------------|
    |\>      |\>    |posizione alla fine di una parola              |
    |--------+------+-----------------------------------------------|
    |[abc…]  |[abc…]|corrisponde ad ogni carattere in "abc..."      |
    |--------+------+-----------------------------------------------|
    |[^abc…] |[^    |corrisponde ad ogni carattere eccetto a quelli |
    |        |abc…] |in "abc..."                                    |
    |--------+------+-----------------------------------------------|
    |r*      |r*    |corrisponde a zero o più occorrenze della      |
    |        |      |espressione regolare identificata da "r"       |
    |--------+------+-----------------------------------------------|
    |r\+     |r+    |corrisponde ad una o più occorrenza della      |
    |        |      |espressione regolare identificata da "r"       |
    |--------+------+-----------------------------------------------|
    |r\?     |r?    |corrisponde a zero o una occorrenza            |
    |        |      |dell'espressione regolare identificata da "r"  |
    |--------+------+-----------------------------------------------|
    |r1\|r2  |r1|r2 |corrisponde ad una occorrenza della espressione|
    |        |      |regolare identificata da "r1" o "r2"           |
    |--------+------+-----------------------------------------------|
    |        |      |corrisponde ad una occorrenza dell'espressione |
    |\(r1\|r2|(r1|  |regolare identificata da "r1" o "r2" e la      |
    |\)      |r2)   |tratta come una espressione regolare tra       |
    |        |      |parentesi                                      |
    +---------------------------------------------------------------+


    Le espressioni regolari di emacs sono fondamentalmente BRE, ma
    sono state estese per trattare "+" e "?" come i metacaratteri
    nelle ERE. Perciò, nelle espressioni regolari di emacs, non è
    necessario proteggerli con il carattere di escape "\".

    Per effettuare ricerche di testo usando espressioni regolari si
    può usare grep(1).

    Per esempio, provare a fare quanto segue.

    $ egrep 'GNU.*LICENSE|Yoyodyne' /usr/share/common-licenses/GPL
    GNU GENERAL PUBLIC LICENSE
    GNU GENERAL PUBLIC LICENSE
    Yoyodyne, Inc., hereby disclaims all copyright interest in the program

    Suggerimento
   
    Vedere Sezione 9.2.7, «Comandi colorati».

%

1.6.3. Espressioni di sostituzione

    Per le espressioni di sostituzione alcuni caratteri hanno un
    significato particolare.

    Tabella 1.25. L'espressione di sostituzione

    +---------------------------------------------------------------+
    |espressione di|      descrizione del testo che sostituirà      |
    | sostituzione |         l'espressione di sostituzione          |
    |--------------+------------------------------------------------|
    |&             |ciò che ha ha avuto corrispondenza con          |
    |              |l'espressione regolare (usare \& in emacs)      |
    |--------------+------------------------------------------------|
    |              |ciò che ha avuto corrispondenza con la n-esima  |
    |\n            |espressione regolare tra parentesi ("n" è un    |
    |              |numero)                                         |
    +---------------------------------------------------------------+


    Per le stringhe di sostituzione Perl viene usato «$&» invece di «
    &» e «$n» invece di «\n».

    Per esempio, provare a fare quanto segue.

    $ echo zzz1abc2efg3hij4 | \
    sed -e 's/\(1[a-z]*\)[0-9]*\(.*\)$/=&=/'
    zzz=1abc2efg3hij4=
    $ echo zzz1abc2efg3hij4 | \
    sed -e 's/\(1[a-z]*\)[0-9]*\(.*\)$/\2===\1/'
    zzzefg3hij4===1abc
    $ echo zzz1abc2efg3hij4 | \
    perl -pe 's/(1[a-z]*)[0-9]*(.*)$/$2===$1/'
    zzzefg3hij4===1abc
    $ echo zzz1abc2efg3hij4 | \
    perl -pe 's/(1[a-z]*)[0-9]*(.*)$/=$&=/'
    zzz=1abc2efg3hij4=

    In questo esempio si faccia particolare attenzione allo stile
    delle espressioni regolari tra parentesi e come le stringhe
    corrispondenti siano usate nel processo di sostituzione del testo
    dai diversi strumenti.

    Queste espressioni regolari possono essere usate per spostare il
    cursore e per fare sostituzioni di testo anche in alcuni editor.

    La barra inversa, "\" alla fine della prima riga nella riga di
    comando di shell protegge il carattere di a capo rendendolo uno
    spazio e continuando l'input della riga di comando di shell nella
    riga successiva.

    Leggere tutte le pagine man relative per imparare l'uso di questi
    comandi.

%

1.6.4. Sostituzione globale con espressioni regolari

    Il comando ed(1) può sostituire tutte le occorrenze di "DA_REGEX"
    con "A_TESTO" in "file".

    $ ed file <<EOF
    ,s/DA_REGEX/A_TESTO/g
    w
    q
    EOF

    Il comando sed(1) può sostituire tutte le occorrenze di
    "DA_REGEX" con "A_TESTO" in "file".

    $ sed -i -e 's/DA_REGEX/A_TESTO/g' file

    Il comando vim(1) può sostituire tutte le occorrenze di
    "DA_REGEX" with "A_TESTO" in "file" usando il comando ex(1).

    $ vim '+%s/DA_REGEX/A_TESTO/gc' '+w' '+q' file

    Suggerimento
   
    Il modificatore "c" nell'esempio soprastante assicura che venga
    chiesta la conferma interattiva per ciascuna sostituzione.

    Si possono elaborare file multipli ("file1", "file2" e "file3")
    in modo simile con vim(1) o perl(1).

    $ vim '+argdo %s/DA_REGEX/A_TESTO/ge|update' '+q' file1 file2 file3

    Suggerimento
   
    Il modificatore "e" nell'esempio soprastante evita che un errore
    di nessuna corrispondenza trovata ("No match") rompa il processo.

    $ perl -i -p -e 's/DA_REGEX/A_TESTO/g;' file1 file2 file3

    Nell'esempio perl(1), "-i" è per la modificain-situ di ciascun
    file interessato, e "-p" è perreiterare implicitamente il comando
    su tutti i file specificati.

    Suggerimento

    L'uso dell'opzione "-i.bak" invece di "-i" preserva una copia del
    file originale aggiungendo il suffisso ".bak" al suo nome file.
    Questo permette di ripristinare le cose più facilmente in caso di
    errori in sostituzioni complesse.

    Nota
   
    ed(1) e vim(1) usano BRE; perl(1) usa ERE.

%

1.6.5. Estrarre dati da file con tabelle di testo

    Considerare per esempio un file ti testo chiamato "DPL" in cui
    sono elencati, in un formato separato da spazi, alcuni nomi di
    leader del progetto Debian pre-2004 e la data della loro
    installazione.

    Ian     Murdock   Agosto  1993
    Bruce   Perens    Aprile  1996
    Ian     Jackson   Gennaio 1998
    Wichert Akkerman  Gennaio 1999
    Ben     Collins   Aprile  2001
    Bdale   Garbee    Aprile  2002
    Martin  Michlmayr Marzo   2003

    Suggerimento
   
    Vedere "Una breve storia di Debian" per la storia della Guida del
    progetto Debian aggiornata.

    Awk viene usato spesso per estrarre dati da questo tipo di file.

    Per esempio, provare a fare quanto segue.

    $ awk '{ print $3 }' <DPL                   # mese di inizio
    Agosto
    Aprile
    Gennaio
    Gennaio
    Aprile
    Aprile
    Marzo
    $ awk '($1=="Ian") { print }' <DPL          # leader del progetto chiamato Ian
    Ian     Murdock   Agosto  1993
    Ian     Jackson   Gennaio 1998
    $ awk '($2=="Perens") { print $3,$4 }' <DPL # quando ha iniziato Perens
    Aprile 1996

    Questo tipo di file può anche essere analizzato con le shell tipo
    Bash.

    Per esempio, provare a fare quanto segue.

    $ while read nome cognome mese anno; do
        echo $mese
      done <DPL
    ... stesso output del primo esempio Awk

    In questo caso, il comando incorporato read usa i caratteri in
    "$IFS" (internal field separator, separatore di campi interno)
    per suddividere le righe in parole.

    Se si modifica "$IFS" in ":", si possono analizzare facilmente
    con la shell i file "/etc/passwd".

    $ vecchioIFS="$IFS"   # salva il vecchio valore
    $ IFS=':'
    $ while read utente password uid gid resto_della_riga; do
        if [ "$utente" = "bozo" ]; then
          echo "l'ID di $utente e' $uid"
        fi
      done < /etc/passwd
    l'ID di bozo e' 1000
    $ IFS="$vecchioIFS"   # ripristina il vecchio valore

    (Se si usa Awk per fare la stessa cosa, usare "FS=':'" per
    impostare il separatore di campi.)

    IFS viene anche usato dalla shell per suddividere i risultati
    dell'espansione di parametri, sostituzione di comandi ed
    espansioni aritmetiche. Queste non avvengono all'interno delle
    virgolette singole o doppie. Il valore predefinito di IFS è la
    combinazione di <spazio>, <tab> e <a capo>.

    Essere prudenti nell'uso di questi trucchetti di shell con IFS.
    Possono accadere strane cose quando la shell interpreta alcune
    parti dello script come suo input.

    $ IFS=":,"                        # usa ":" e "," come IFS
    $ echo IFS=$IFS,   IFS="$IFS"     # echo e'  un comando interno di Bash
    IFS=  , IFS=:,
    $ date -R                         # un output di comando qualunque
    Sat, 23 Aug 2003 08:30:15 +0200
    $ echo $(date -R)                 # sotto-shell --> input alla shell principale
    Sat  23 Aug 2003 08 30 36 +0200
    $ unset IFS                       # reimposta il valore predefinito di IFS
    $ echo $(date -R)
    Sat, 23 Aug 2003 08:30:50 +0200

%

1.6.6. Frammenti di script per comandi con pipe

    Gli script seguenti fanno alcune cose carine se inseriti in una
    pipe.

    Tabella 1.26. Elenco di frammenti di script per comandi con pipe

    +---------------------------------------------------------------+
    |  frammento di script   |                                      |
    | (digitarlo in un'unica |         effetto del comando          |
    |         riga)          |                                      |
    |------------------------+--------------------------------------|
    |find /usr -print        |trova tutti i file in "/usr"          |
    |------------------------+--------------------------------------|
    |seq 1 100               |stampa da 1 a 100                     |
    |------------------------+--------------------------------------|
    |                        |esegue ripetutamente il comando con   |
    || xargs -n 1 <comando>  |ogni elemento dalla pipe come         |
    |                        |argomento                             |
    |------------------------+--------------------------------------|
    || xargs -n 1 echo       |suddivide elementi separati da spazio |
    |                        |nella pipe su righe distinte          |
    |------------------------+--------------------------------------|
    || xargs echo            |unisce tutte le righe dalla pipe in   |
    |                        |una riga                              |
    |------------------------+--------------------------------------|
    || grep -e               |estrae dalla pipe le righe che        |
    |<modello_regex>         |contengono ‪<modello_regex>           |
    |------------------------+--------------------------------------|
    || grep -v -e            |estrae dalla pipe le righe che non    |
    |<modello_regex>         |contengono <modello_regex>            |
    |------------------------+--------------------------------------|
    || cut -d: -f3 -         |estrae dalla il terzo campo, separato |
    |                        |da ":" (file passwd, ecc.)            |
    |------------------------+--------------------------------------|
    || awk '{ print $3 }'    |estrae dalla pipe il terzo campo      |
    |                        |separato da spazi                     |
    |------------------------+--------------------------------------|
    || awk -F'\t' '{ print $3|estrae dalla pipe il terzo campo      |
    |}'                      |separato da tabulazioni               |
    |------------------------+--------------------------------------|
    |                        |rimuove i caratteri backspace ed      |
    || col -bx               |espande le tabulazioni in sequenze di |
    |                        |spazi                                 |
    |------------------------+--------------------------------------|
    || expand -              |espande le tabulazioni                |
    |------------------------+--------------------------------------|
    || sort| uniq            |ordina e rimuove i duplicati          |
    |------------------------+--------------------------------------|
    || tr 'A-Z' 'a-z'        |converte le maiuscole in minuscole    |
    |------------------------+--------------------------------------|
    || tr -d '\n'            |concatena le righe in un'unica riga   |
    |------------------------+--------------------------------------|
    || tr -d '\r'            |rimuove i caratteri di a capo         |
    |------------------------+--------------------------------------|
    || sed 's/^/# /'         |aggiunge "#" all'inizio di ogni riga  |
    |------------------------+--------------------------------------|
    || sed 's/\.ext//g'      |rimuove ".ext"                        |
    |------------------------+--------------------------------------|
    || sed -n -e 2p          |stampa la seconda riga                |
    |------------------------+--------------------------------------|
    || head -n 2 -           |stampa le prime due righe             |
    |------------------------+--------------------------------------|
    || tail -n 2 -           |stampa le ultime due righe            |
    +---------------------------------------------------------------+


    Uno script di shell di una riga può operare reiteratamente su più
    file usando find(1) e xargs(1) per fare compiti piuttosto
    complicati. Vedere Sezione 10.1.5, «Esempi di invocazione per la
    selezione di file» e Sezione 9.3.9, «Ripetere un comando su
    diversi file».

    Quando usare la shell in modalità interattiva diventa troppo
    complicato, considerare la scrittura di uno script di shell
    (vedere Sezione 12.1, «Script shell»).

Capitolo 2. Gestione dei pacchetti in Debian

    Nota
   
    Questo capitolo è stato scritto assumendo che il rilascio stabile
    più recente abbia nome in codice: bullseye.

    Debian è un'organizzazione di volontari che crea distribuzioni 
    coerenti di pacchetti binari precompilati di software libero e li
    distribuisce dal suo archivio.

    L'archivio Debian viene fornito da molti siti mirror remoti per
    l'accesso con i metodi HTTP e FTP. È anche disponibile come
    CD-ROM/DVD.

    Il sistema di gestione dei pacchetti di Debian, se usato in modo
    corretto, permette all'utente di installare dall'archivio insiemi
    coerenti di pacchetti binari sul sistema. Attualmente ci sono
    62716 pacchetti disponibili per l'architettura amd64.

    Il sistema di gestione dei pacchetti di Debian ha una storia
    ricca e fornisce molti programmi con interfacce per l'utente
    finale e molti metodi di backend per l'accesso agli archivi tra
    cui scegliere. Attualmente le scelte raccomandate sono le
    seguenti.

      * apt(8) per tutte le operazioni interattive dalla riga di
        comando, incluse le installazioni e le rimozioni di pacchetti
        nonché gli aggiornamenti dist-upgrade. Disponibile a partire
        da Debian Jessie (Debian 8).

      * apt-get(8) per chiamare il sistema di gestione dei pacchetti
        Debian da script. È anche un'opzione di ripiego quando non è
        disponibile apt (spesso in sistemi Debian più vecchi).

      * aptitude(8) per un'interfaccia testuale interattiva per
        gestire i pacchetti installati e per cercare i pacchetti
        disponibili.

    Tabella 2.1. Elenco degli strumenti Debian di gestione dei
    pacchetti

    +---------------------------------------------------------------+
    |     pacchetto     |popcon|dimensione|       descrizione       |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Advanced Packaging Tool  |
    |                   |      |          |(APT), frontend per dpkg |
    |                   |V:868,|          |che fornisce i metodi    |
    |apt                |I:999 |4299      |«http», «ftp» e «file»   |
    |                   |      |          |per 'accesso agli archivi|
    |                   |      |          |(inclusi i comandi apt/  |
    |                   |      |          |apt-get/apt-cache)       |
    |-------------------+------+----------+-------------------------|
    |                   |V:80, |          |gestore di pacchetti     |
    |aptitude           |I:431 |4249      |interattivo basato su    |
    |                   |      |          |terminale con aptitude(8)|
    |-------------------+------+----------+-------------------------|
    |                   |      |          |strumento per selezionare|
    |                   |V:36, |          |attività per             |
    |tasksel            |I:975 |393       |l'installazione sul      |
    |                   |      |          |sistema Debian (frontend |
    |                   |      |          |per APT)                 |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |pacchetto di estensione  |
    |                   |      |          |per APT per abilitare    |
    |unattended-upgrades|V:324,|325       |l'installazione          |
    |                   |I:447 |          |automatica degli         |
    |                   |      |          |aggiornamenti di         |
    |                   |      |          |sicurezza                |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |gestore di pacchetti     |
    |                   |V:3,  |          |basato su terminale      |
    |dselect            |I:32  |2591      |(standard precedente,    |
    |                   |      |          |frontend per APT e altri |
    |                   |      |          |vecchi metodi di accesso)|
    |-------------------+------+----------+-------------------------|
    |dpkg               |V:925,|6856      |sistema di gestione dei  |
    |                   |I:999 |          |pacchetti per Debian     |
    |-------------------+------+----------+-------------------------|
    |                   |V:47, |          |gestore grafico dei      |
    |synaptic           |I:320 |7873      |pacchetti (front-end     |
    |                   |      |          |GNOME per APT)           |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |programmi di utilità APT:|
    |apt-utils          |V:339,|1162      |apt-extracttemplates(1), |
    |                   |I:996 |          |apt-ftparchive(1) e      |
    |                   |      |          |apt-sortpkgs(1)          |
    |-------------------+------+----------+-------------------------|
    |                   |V:369,|          |strumento di notifica    |
    |apt-listchanges    |I:851 |421       |dello storico dei        |
    |                   |      |          |cambiamenti dei pacchetti|
    |-------------------+------+----------+-------------------------|
    |                   |V:7,  |          |elenca i bug critici     |
    |apt-listbugs       |I:12  |465       |prima di ogni            |
    |                   |      |          |installazione di APT     |
    |-------------------+------+----------+-------------------------|
    |                   |V:18, |          |utilità APT per ricerca  |
    |apt-file           |I:78  |90        |di pacchetti, interfaccia|
    |                   |      |          |a riga di comando        |
    |-------------------+------+----------+-------------------------|
    |                   |V:0,  |          |elenca le dipendenze dei |
    |apt-rdepends       |I:6   |40        |pacchetti in modo        |
    |                   |      |          |ricorsivo                |
    +---------------------------------------------------------------+


2.1. Prerequisiti per la gestione dei pacchetti Debian

%

2.1.1. Configurazione dei pacchetti

    Questi sono alcuni punti fondamentali per la configurazione dei
    pacchetti in un sistema Debian.

      * La configurazione manuale fatta dall'amministratore di
        sistema viene rispettata. In altre parole, il sistema di
        configurazione dei pacchetti non fa configurazioni invadenti
        per ragioni di comodità.

      * Ogni pacchetto viene fornito con un proprio script di
        configurazione per l'interfaccia utente standard debconf(7),
        per aiutare nel processo di configurazione iniziale del
        pacchetto.

      * I Debian Developer cercano di fare del loro meglio per
        rendere l'aggiornamento un'esperienza senza problemi grazie
        agli script di configurazione dei pacchetti.

      * Sono disponibili per l'amministratore di sistema le complete
        funzionalità di un pacchetto software, ma quelle con rischi
        per la sicurezza sono disabilitate nella installazione
        predefinita.

      * Se si attiva manualmente un servizio con rischi per la
        sicurezza, si è responsabili del contenimento del rischio.

      * L'amministratore di sistema può abilitare manualmente
        configurazioni esotiche; questo può creare interferenze con
        popolari programmi generici di supporto per la configurazione
        del sistema.

%

2.1.2. Precauzioni base

    Avvertimento

    Non installare pacchetti da una miscela casuale di suite.
    Probabilmente si disgrega la coerenza tra i pacchetti che
    richiede una conoscenza approfondita dalla gestione del sistema,
    come dell'ABI del compilatore, versione delle librerie,
    funzionalità dell'interprete, ecc.

    L'amministratore di sistema novizio dovrebbe rimanere con il
    rilascio stable di Debian ed applicare solo gli aggiornamenti di
    sicurezza. Ciò significa che alcune delle azioni spiegate in
    seguito, seppur valide, sono, come precauzione, da evitare fino a
    che non si capisce il sistema Debian molto bene. Ecco alcune cose
    da ricordare.

      * Non includere testing o unstable in "/etc/apt/sources.list".

      * Non mescolare gli archivi standard Debian con altri archivi
        non Debian, come quelli di Ubuntu, in "/etc/apt/
        sources.list".

      * Non creare il file "/etc/apt/preferences".

      * Non cambiare il comportamento degli strumenti di gestione dei
        pacchetti attraverso i loro file di configurazione senza
        capire a pieno il loro effetto.
   
      * Non installare pacchetti presi qua e là con "dpkg -i
        <pacchetto_a_caso>".

      * Non installare mai pacchetti presi qua e là con "dpkg
        --force-all -i <pacchetto_a_caso>".

      * Non cancellare o alterare i file in "/var/lib/dpkg/".

      * Non sovrascrivere file di sistema, installando direttamente
        programmi software compilati dai sorgenti.

          + Se necessario, installarli in "/usr/local" o "/opt".

    Gli effetti causati dalle azioni descritte sopra al sistema di
    gestione dei pacchetti di Debian portano a incompatibilità che
    possono lasciare il sistema in uno stato inutilizzabile.

    Gli amministratori di sistema Debian seri, che gestiscono server
    di importanza critica, dovrebbero usare particolari precauzioni.

      * Non installare alcun pacchetto, compresi quelli di
        aggiornamenti di sicurezza di Debian, senza averli
        attentamente testati con la propria particolare
        configurazione in condizioni sicure.
   
          + Alla fin fine è l'amministratore di sistema ad essere
            responsabile del proprio sistema.

          + La lunga tradizione di stabilità dei sistemi Debian non è
            di per sé una garanzia.

%

2.1.3. Una vita di aggiornamenti senza fine

    Nonostante le avvertenze dette prima, si sa che molti lettori di
    questo documento desiderano usare le suite testing o unstable di
    Debian come loro sistema principale per ambienti Desktop
    auto-amministrati. Ciò accade perché funzionano molto bene, sono
    aggiornate di frequente e offrono le più recenti funzionalità.

    Attenzione

    Per i server di produzione, è raccomandata la suite stable con
    gli aggiornamenti di sicurezza. Lo stesso vale per i PC desktop
    su cui si investono sforzi di amministrazione limitati.

    Non serve far altro che impostare semplicemente la stringa
    relativa alla distribuzione nel file "/etc/apt/sources.list" con
    il nome della suite voluta: "testing" o "unstable", o con il suo
    nome in codice: "bookworm o "sid". Questo farà vivere una vita di
    aggiornamenti senza fine.

    L'uso di testing o unstable è molto divertente ma comporta
    qualche rischio. Anche se la suite unstable del sistema Debian
    sembra molto stabile per la maggior parte del tempo, ci sono
    stati alcuni problemi con i pacchetti delle suite testing e
    unstable e qualcuno di questi non era affatto banale da
    risolvere. Può essere piuttosto doloroso per l'utente. A volte si
    hanno pacchetti con dipendenze non soddisfatte o funzionalità
    mancanti per qualche settimana.

    Ecco alcune idee per assicurare un recupero facile e veloce da
    bug nei pacchetti Debian.

      * Impostare il sistema per avere due partizioni avviabili
        installando la suite stable di Debian in un'altra partizione

      * Tenere a portata di mano il CD di installazione per l'avvio
        di ripristino

      * Considerare l'installazione di apt-listbugs per controllare
        le informazioni del Sistema Debian di tracciamento dei Bug
        (BTS) prima degli aggiornamenti

      * Imparare l'infrastruttura del sistema dei pacchetti
        abbastanza bene da poter aggirare il problema.

      * Creare un ambiente chroot o simile ed eseguire prima lì il
        sistema più recente (vedere Sezione 9.10, «Sistema
        virtualizzato»)

    (Se non si è in grado di intraprendere nessuna di queste azioni
    precauzionali, probabilmente non si è pronti per le suite testing
    e unstable.)

    L'illuminazione data dalla lettura di ciò che segue salva
    l'utente dall'eterna lotta karmica con l'inferno degli
    aggiornamenti e gli fa raggiungere il nirvana Debian.

%

2.1.4. Nozioni di base sugli archivi Debian

    Guardiamo l'archivio Debian dalla prospettiva dell'utente.

    Suggerimento
   
    La politica ufficiale per gli archivi Debian è definita nel
    Capitolo 2 - "L'archivo Debian", del manuale Debian Policy.

    Per il normale accesso HTTP, l'archivio viene specificato nel
    file "/etc/apt/sources.list" come nell'esempio seguente per
    l'attuale sistema stable = bullseye.

    deb http://deb.debian.org/debian/ bullseye main contrib non-free
    deb-src http://deb.debian.org/debian/ bullseye main contrib non-free
   
    deb http://security.debian.org/ bullseye/updates main contrib
    deb-src http://security.debian.org/ bullseye/updates main contrib

    Viene qui usato il nome in codice "bullseye invece del nome della
    suite "stable" per evitare sorprese una volta che venga
    rilasciata la nuova stable.

    La struttura di "/etc/apt/sources.list" è descritta in 
    sources.list(5) ed i punti chiave sono i seguenti.

      * Le righe "deb" definiscono voci per pacchetti binari.

      * Le righe "deb-src" definiscono voci per i pacchetti sorgenti.

      * Il primo argomento è l'URL radice dell'archivio Debian.
   
      * Il secondo argomento è il nome della distribuzione, o il nome
        della suite o il nome in codice.

      * Il terzo argomento e quelli seguenti sono l'elenco dei nomi
        di aree valide dell'archivio Debian.

    Le righe "deb-src" possono essere tranquillamente omesse (o
    commentate aggiungendo il carattere "#" all'inizio della riga) se
    si usa solo aptitude che non accede ai metadati relativi ai
    sorgenti. Si velocizza così l'aggiornamento dei metadati
    dell'archivio. L'URL può essere "http://", "ftp://", "file://",
    ….

    Suggerimento

    Se nell'esempio precedente si usa "sid" invece di "bullseye, in "
    /etc/apt/sources.list" non è richiesta la riga "deb: http://
    security.debian.org/ …" per gli aggiornamenti di sicurezza. Ciò è
    dovuto al fatto che non esiste un archivio per gli aggiornamenti
    di sicurezza per "sid" (unstable).

    Ecco l'elenco dei siti degli archivi Debian e dei nomi di suite e
    nomi in codice usati nel file di configurazione.

    Tabella 2.2. Elenco dei siti con l'archivo Debian

    +---------------------------------------------------------------+
    | URL dell'archivio |  nome suite (nome in  |       scopo       |
    |                   |        codice)        |                   |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |rilascio stable    |
    |deb.debian.org/    |stable (bullseye)      |(bullseye)         |
    |debian/            |                       |                   |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |rilascio testing   |
    |deb.debian.org/    |testing (bookworm)     |(bookworm)         |
    |debian/            |                       |                   |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |rilascio unstable  |
    |deb.debian.org/    |unstable (sid)         |(sid)              |
    |debian/            |                       |                   |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |pre-rilascio       |
    |deb.debian.org/    |experimental           |sperimentale       |
    |debian/            |                       |(opzionale, solo   |
    |                   |                       |per sviluppatori)  |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |aggiornamenti per  |
    |deb.debian.org/    |stable-proposed-updates|il prossimo        |
    |debian/            |                       |rilascio stabile   |
    |                   |                       |minore (opzionale) |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |aggiornamenti di   |
    |security.debian.org|stable/updates         |sicurezza per il   |
    |/                  |                       |rilascio stable    |
    |                   |                       |(importante)       |
    |-------------------+-----------------------+-------------------|
    |http://            |                       |aggiornamenti di   |
    |security.debian.org|testing/updates        |sicurezza per il   |
    |/                  |                       |rilascio testing   |
    |                   |                       |(importante)       |
    |-------------------+-----------------------+-------------------|
    |                   |                       |aggiornamenti      |
    |                   |                       |compatibili per    |
    |http://            |                       |filtri anti-spam,  |
    |deb.debian.org/    |bullseye-updates       |client di          |
    |debian/            |                       |messaggistica      |
    |                   |                       |istantanea, ecc.   |
    |                   |                       |per bullseye       |
    |-------------------+-----------------------+-------------------|
    |                   |                       |pacchetti più      |
    |http://            |                       |recenti in versione|
    |deb.debian.org/    |bullseye-backports     |backport per       |
    |debian/            |                       |bullseye           |
    |                   |                       |(opzionale)        |
    +---------------------------------------------------------------+


    Attenzione

    Solo il rilascio stable puro con gli aggiornamenti di sicurezza
    fornisce la massima stabilità. Avere un sistema basato per lo più
    sul rilascio stable con mescolati alcuni pacchetti dai rilasci 
    testing o unstable è più rischioso che avere un sistema basato su
    un puro rilascio unstable per ciò che riguarda conflitti tra le
    versioni di libreria, ecc. Se si ha veramente bisogno, nel
    rilascio stable, dell'ultima versione di qualche programma usare
    pacchetti dai servizi bullseye-updates e http://
    backports.debian.org (vedere Sezione 2.7.4, «Updates e Backports»
    ). Questi servizi devono essere usati con estrema cautela.

    Attenzione

    Fondamentalmente si dovrebbe mettere una sola tra le suite
    stable, testing o unstable nelle righe "deb". Se si elenca una
    combinazione delle suite stable, testing e unstable nelle righe
    "deb", il programma APT verrà rallentato e solo l'archivio più
    recente avrà effetto. Elencare più di una voce ha senso quando
    viene usato il file "/etc/apt/preferences" con scopi ben precisi
    (vedere Sezione 2.7.3, «Modificare la versione candidata»).

    Suggerimento

    Per i sistemi Debian con le suite stable e testing è una buona
    norma includere nel file "/etc/apt/sources.list" le righe con
    "http://security.debian.org/" per abilitare gli aggiornamenti di
    sicurezza, come nell'esempio prededente.

    Nota

    I bug che riguardano la sicurezza per l'archivio stable vengono
    risolti dal Debian Security Team, la cui attività è piuttosto
    rigorosa ed affidabile. I bug per l'archivio testing possono
    essere risolti dal Debian Security Team. Per svariate ragioni
    questa attività non è così rigorosa come quella per stable e
    potrebbe essere necessario attendere la migrazione di pacchetti
    unstable corretti. I bug per l'archivio unstable sono corretti
    dal manutentore del pacchetto; i pacchetti unstable attivamente
    mantenuti sono solitamente in una forma piuttosto buona dato che
    sfruttano le più recenti correzioni a monte relative alla
    sicurezza. Per informazioni sul modo in cui Debian gestisce i bug
    relativi alla sicurezza, vedere le FAQ Debian sulla sicurezza.

    Tabella 2.3. Elenco delle aree dell'archivio Debian

    +---------------------------------------------------------------+
    |  area  |   numero di   |criterio dei componenti del pacchetto |
    |        |   pacchetti   |                                      |
    |--------+---------------+--------------------------------------|
    |main    |61595          |aderenti alle DFSG e senza dipendenze |
    |        |               |da non-free                           |
    |--------+---------------+--------------------------------------|
    |contrib |349            |aderenti alle DFSG ma con dipendenze  |
    |        |               |da non-free                           |
    |--------+---------------+--------------------------------------|
    |non-free|772            |non aderenti alle DFSG                |
    +---------------------------------------------------------------+


    Nella tabella soprastante il numero dei pacchetti è per
    l'architettura amd64. L'area main fornisce il sistema Debian
    (vedere Sezione 2.1.5, «Debian è al 100% software libero»).

    L'organizzazione dell'archivio Debian può essere studiata meglio
    puntando il proprio browser a ciascuno degli URL dell'archivio
    con aggiunto in coda dists o pool.

    Ci si riferisce alla distribuzione in due modi, con la suite o
    con il nome in codice. In alternativa la parola distribuzione
    viene usata come sinonimo di suite in molta documentazione. La
    relazione tra la suite e il nome in codice può essere riassunta
    nel modo seguente.

    Tabella 2.4. Relazione tra suite e nome in codice

    +---------------------------------------------------------------+
    |    periodo     | suite = stable |suite = testing |  suite =   |
    |                |                |                |  unstable  |
    |----------------+----------------+----------------+------------|
    |dopo il rilascio|nome in codice =|nome in codice =|nome in     |
    |bullseye        |bullseye        |bookworm        |codice = sid|
    |----------------+----------------+----------------+------------|
    |dopo il rilascio|nome in codice =|nome in codice =|nome in     |
    |bookworm        |bookworm        |trixie          |codice = sid|
    +---------------------------------------------------------------+


    La storia dei nomi in codice è descritta nelle FAQ Debian: 6.2.1
    Quali altri nomi in codice sono stati usati in passato?

    Nella terminologia per gli archivi Debian più precisa, la parola
    "sezione" è usata specificatamente per la categorizzazione dei
    pacchetti in base all'area di applicazione. (Anche se
    l'espressione "sezione main" può essere a volte usata per
    descrivere l'area dell'archivio Debian chiamata "main".)

    Ogni volta che uno sviluppatore Debian (DD) carica un nuovo
    pacchetto nell'archivio unstable (passando per incoming), gli
    viene richiesto di assicurare che i pacchetti caricati siano
    compatibili con l'insieme più recente di pacchetti nell'archivio
    unstable più recente.

    Se un DD rompe questa compatibilità intenzionalmente per
    importanti aggiornamenti di librerie, ecc. di solito viene fatto
    un annuncio nella mailing list debian-devel, ecc.

    Prima di muovere un insieme di pacchetti dall'archivio unstable
    all'archivio testing, lo script di gestione degli archivio Debian
    non solo controlla la maturità (circa 10 giorni di età) e lo
    stato delle segnalazioni di bug RC per i pacchetti, ma cerca
    anche di assicurare che siano compatibili con il più recente
    insieme di pacchetti nell'archivio testing. Questo processo rende
    l'archivio testing molto aggiornato e usabile.

    Attraverso il graduale processo di freeze dell'archivio, giudato
    dal team di rilascio, l'archivio testing viene fatto maturare con
    un po' di intervento manuale per renderlo completamente coerente
    e libero da bug. Quindi viene creato il nuovo rilascio stable
    assegnando il nome in codice per il vecchio archivio testing al
    nuovo archivio stable e creando il nuovo nome in codice per il
    nuovo archivio testing. Il contenuto iniziale del nuovo archivio
    testing è esattamente lo stesso dell'archivio stable appena
    rilasciato.

    Sia l'archivio unstable sia l'archivio testing possono soffrire
    di problemi temporanei a causa di diversi fattori.

      * Pacchetti difettosi caricati nell'archivio (principalmente
        per unstable)

      * Ritardo nell'accettazione di nuovi pacchetti nell'archivio
        (principalmente per unstable)
   
      * Problemi nei tempi di sincronizzazione degli archivi (sia per
        testing sia per unstable)

      * Interventi manuali all'archivio, come rimozione di pacchetti
        (più per testing) ecc.

    Perciò se si decide di usare questi archivi, si dovrebbe essere
    in grado di risolvere o aggirare questo tipo di problemi.

    Attenzione

    Per qualche mese circa dopo un nuovo rilascio stable, la maggior
    parte degli utenti desktop dovrebbe usare l'archivio stable con i
    suoi aggiornamenti di sicurezza, anche se di solito usano gli
    archivi unstable o testing. Durante questo periodo di
    transizione, entrambi gli archivi unstable e testing non sono
    adatti alla maggior parte degli utenti. È difficile mantenere il
    proprio sistema in condizioni buone di funzionamento con
    l'archivio unstable dato che è affetto da ondate di aggiornamenti
    importanti di pacchetti fondamentali. Anche l'archivio testing
    non è molto utile perché contiene per lo più le stesse cose
    dell'archivio stable senza il suo supporto per la sicurezza
    (Debian testing-security-announce 2008-12). Dopo circa un mese,
    l'archivio unstable potrebbe essere utilizzabile se si è cauti.

    Suggerimento

    Quando si usa l'archivio testing, i problemi causati da un
    pacchetto rimosso vengono solitamente aggirati installando il
    corrispondente pacchetto dall'archivio unstable che è caricato
    per risolvere un bug.

    Vedere il manuale Debian Policy per le definizioni degli archivi.

      * "Sezioni"

      * "Priorità"
   
      * "Sistema base"

      * "Pacchetti essenziali"

%

2.1.5. Debian è al 100% software libero

    Debian è al 100% software libero perché:

      * Debian installa in modo predefinito solo software libero per
        rispettare le libertà dell'utente.

      * Debian fornisce in main solo software libero.
   
      * Debian raccomanda l'esecuzione del solo software libero
        contenuto in main.

      * Nessun pacchetto in main dipende o raccomanda pacchetti in
        non-free o contrib.

    Alcune persone si chiedono se i seguenti due fatti siano in
    contraddizione o meno tra loro.

      * «Debian rimarrà libera al 100%». (Prima voce del Contratto
        sociale Debian)

      * I server Debian ospitano alcuni pacchetti non-free e contrib.

    Queste due cose non sono in contraddizione, perché:

      * Il sistema Debian è libero al 100% e i suoi pacchetti sono
        ospitati dai server Debian nell'area main.
   
      * I pacchetti esterni al sistema Debian sono ospitati dai
        server Debian nelle aree non-free e contrib.

    Queste sono spiegate in dettaglio nella quarta e nella quinta
    voce del Contratto sociale Debian:

      * Le nostre priorità sono gli utenti ed il software libero

          + Ci faremo guidare dai bisogni dei nostri utenti e della
            comunità del software libero. Metteremo al primo posto i
            loro interessi. Supporteremo le necessità dei nostri
            utenti di operare in molti diversi tipi di ambienti di
            calcolo. Non ci opporremo alle opere non libere che siano
            state pensate per l'uso in sistemi Debian e non
            richiederemo compensi a chi crea o usa queste opere.
            Permetteremo ad altri di creare distribuzioni contenenti
            sia il sistema Debian che altre opere, senza richiedere
            compensi. Per raggiungere questi scopi, forniremo un
            sistema integrato di materiali di alta qualità senza
            alcuna restrizione legale che limiti qualsiasi uso del
            sistema.

      * Opere che non rispettano i nostri standard free software

          + Ci rendiamo conto che alcuni dei nostri utenti richiedono
            di usare opere non conformi alle Debian Free Software
            Guidelines. Abbiamo creato le aree «contrib» e «non-free»
            nel nostro archivio per queste opere. I pacchetti in
            queste aree non fanno parte del sistema Debian, sebbene
            siano stati configurati per l'uso con Debian. Invitiamo i
            realizzatori di CD a leggere le licenze dei pacchetti in
            queste aree per determinare se possono distribuire i
            pacchetti sui loro CD. Inoltre, anche se le opere non
            libere non fanno parte di Debian, supporteremo il loro
            uso e forniremo infrastrutture per i pacchetti non liberi
            (come il nostro bug tracking system e le mailing list).

    Gli utenti dovrebbero essere a conoscenza dei rischi correlati
    all'uso di pacchetti nelle aree non-free e contrib:

      * mancanza di libertà legata a tali pacchetti software

      * mancanza di supporto da parte di Debian per tali pacchetti
        software (Debian non può supportare del software in maniera
        adeguata senza avere accesso al suo codice sorgente)

      * contaminazione del sistema Debian libero al 100%

    Il documento Debian Free Software Guidelines è lo standard di
    Debian per il software libero. Debian interpreta la parola
    "software" nel suo senso più ampio includendo documentazione,
    firmware, logo e dati artistici nel pacchetto. Questo fa sì che
    gli standard Debian per il software libero siano molto severi.

    Per potere rimanere conforme a questi severi standard per il
    software libero richiesti per main, Debian una volta toglieva il
    marchio Mozilla dai pacchetti software Mozilla come Firefox,
    Thunderbird e Seamonkey, rimuovendo i loro logo e alcuni elementi
    artistici e li forniva come Iceweasel, Icedove e Iceape
    rispettivamente. Questi pacchetti sono stati riportati ai loro
    nomi originali con il rilascio di Debian Stretch (Debian 9) dopo
    che tali problemi sono stati risolti.

    I pacchetti non-free e contribu tipici includono pacchetti
    liberamente distribuibili dei seguenti tipi:

      * Pacchetti di documentazione distribuiti sotto la GNU Free
        Documentation License con sezioni invarianti come quelli per
        GCC e Make (per lo più presenti nella sezione non-free/doc).

      * Pacchetti di firmware contenenti dati binari senza sorgenti
        come quelli elencati in Sezione 9.9.6, «Driver per hardware e
        firmware» come non liberi (per lo più presenti nella sezione
        non-free/kernel).

      * Pacchetti di giochi e tipi di carattere con restrizioni
        sull'uso a scopo commerciale o sulla modifica dei contenuti.

    Notare che il numero dei pacchetti non-free e contrib è meno del
    2% di quello dei pacchetti in main. Permettere l'accesso alle
    aree non-free e contrib non oscura la fonte dei pacchetti. L'uso
    interattivo a schermo intero di aptitude(8) fornisce piena
    visibilità e controllo su quali pacchetti vengano installati e da
    quali aree, per permettere di mantenere il proprio sistema libero
    quanto lo si desidera.

%

2.1.6. Dipendenze dei pacchetti

    Il sistema Debian offre un insieme coerente di pacchetti binari
    grazie al suo meccanismo di dichiarazione, nei campi di controllo
    dei file, delle dipendenze binarie basate su versioni . Ecco una
    definizione molto semplificata delle dipendenze.

      * "Depends" (Dipende)

          + Dichiara una dipendenza assoluta e tutti i pacchetti
            elencati in questo campo devono essere installati insieme
            a quello scelto o prima.

      * "Pre-Depends" (Pre-dipende)

          + È come "Depends", tranne che richiede l'installazione
            completa dei pacchetti elencati in anticipo.

      * "Recommends" (Raccomanda)

          + Dichiara una dipendenza forte, ma non assoluta. La
            maggior parte degli utenti non vorrà il pacchetto in
            esame a meno che tutti i pacchetti elencati non siano
            installati.

      * "Suggests" (Consiglia)

          + Dichiara una dipendenza debole. La maggior parte degli
            utenti del pacchetto potrebbe trarre vantaggio
            dall'installazione dei pacchetti elencati in questo
            campo, ma può ottenere una funzionalità adeguata senza di
            essi.
   
      * "Enhances" (Migliora)

          + Dichiara una dipendenza debole come "Suggests" ma in
            verso opposto.

      * "Breaks" (Rompe)

          + Dichiara un'incompatibilità del pacchetto di solito con
            qualche specifica versione. Generalmente la soluzione è
            di aggiornare tutti i pacchetti elencati in questo campo.

      * "Conflicts" (Va in conflitto)

          + Dichiara una incompatibilità assoluta. Tutti i pacchetti
            elencati in questo campo devono essere rimossi per
            installare il pacchetto in esame.

      * "Replaces" (Sostituisce)

          + Viene dichiarata quando i file installati dal pacchetto
            in esame sostituiscono i file nei pacchetti elencati.

      * "Provides" (Fornisce)

          + Viene dichiarata quando il pacchetto fornisce tutti i
            file e le funzionalità nei pacchetti elencati.

    Nota

    Notare che una buona configurazione per un pacchetto virtuale
    deve avere "Provides", "Conflicts" e "Replaces" simultaneamente
    definiti. Questo assicura che in un dato momento possa essere
    installato un solo pacchetto reale che fornisce il pacchetto
    virtuale.

    La definizione ufficiale, compresa quella di dipendenza dei
    sorgenti, può essere trovata nel manuale Debian Policy, Capitolo
    7, Dichiarare le relazioni tra i pacchetti.

%

2.1.7. Il flusso di eventi nella gestione dei pacchetti

    Ecco un riassunto semplificato del flusso di eventi nella
    gestione dei pacchetti con APT.

      * Aggiornamento informazioni ("apt update", "aptitude update" o
        "apt-get update"):

         1. Recupera i metadati dell'archivio dall'archivio remoto

         2. Ricostruisce e aggiorna i metadati locali usati da APT

      * Aggiornamento («apt upgrade» e «apt full-upgrade» o «aptitude
        safe-upgrade» e «aptitude full-upgrade», o «apt-get upgrade»
        e «apt-get dist-upgrade»):

         1. Sceglie la versione candidata, che è solitamente la più
            recente disponibile, per tutti i pacchetti installati
            (per le eccezioni vedere Sezione 2.7.3, «Modificare la
            versione candidata»)

         2. Risolve le dipendenze dei pacchetti

         3. Se la versione candidata è diversa da quella installata,
            scarica i pacchetti binari selezionati dall'archivio
            remoto

         4. Spacchetta i pacchetti binari scaricati

         5. Esegue gli script preinst

         6. Installa i file binari

         7. Esegue gli script postinst

      * Installazione («apt install …», «aptitude install …» o
        «apt-get install …»):

         1. Sceglie i pacchetti elencati nella riga di comando

         2. Risolve le dipendenze dei pacchetti
   
         3. Scarica i pacchetti binari selezionati dall'archivio
            remoto

         4. Spacchetta i pacchetti binari scaricati

         5. Esegue gli script preinst

         6. Installa i file binari

         7. Esegue gli script postinst

      * Rimozione («apt remove …», «aptitude remove …» o «apt-get
        remove …»):

         1. Sceglie i pacchetti elencati nella riga di comando

         2. Risolve le dipendenze dei pacchetti

         3. Esegue gli script prerm

         4. Rimuove i file installati tranne i file di configurazione

         5. Esegue gli script postrm

      * Rimozione completa («apt purge», «aptitude purge …» o
        «apt-get purge …»):

         1. Sceglie i pacchetti elencati nella riga di comando

         2. Risolve le dipendenze dei pacchetti

         3. Esegue gli script prerm

         4. Rimuove i file installati inclusi i file di
            configurazione

         5. Esegue gli script postrm

    Sono stati intenzionalmente omessi dettagli tecnici a favore di
    una più chiara vista d'insieme.

%

2.1.8. Prima risposta a problemi di gestione dei pacchetti

    Si dovrebbe leggere la bella documentazione ufficiale. Il primo
    documento da leggere è il file specifico per Debian, "/usr/share/
    doc/<nome_pacchetto>/README.Debian". Andrebbe consultata anche
    l'altra documentazione in "/usr/share/doc/<nome_pacchetto>/. Se
    la shell è impostata come in Sezione 1.4.2, «Personalizzare bash»
    , digitare quanto segue.

    $ cd <nome_pacchetto>
    $ pager README.Debian
    $ mc

    Per informazioni dettagliate potrebbe essere necessario
    installare il pacchetto di documentazione corrispondente il cui
    nome ha il suffisso "-doc".

    Se si stanno avendo problemi con un pacchetto specifico,
    ricordarsi come prima cosa di controllare il sito del Sistema
    Debian di tracciamento dei bug (BTS).

    Tabella 2.5. Elenco dei siti web importanti per la risoluzione di
    problemi con un pacchetto specifico

    +---------------------------------------------------------------+
    |           sito web            |            comando            |
    |-------------------------------+-------------------------------|
    |Pagina web del Sistema Debian  |sensible-browser "http://      |
    |di tracciamento dei bug (BTS)  |bugs.debian.org/"              |
    |-------------------------------+-------------------------------|
    |Segnalazioni di bug di un      |sensible-browser "http://      |
    |pacchetto specifico            |bugs.debian.org/               |
    |                               |<nome_pacchetto>"              |
    |-------------------------------+-------------------------------|
    |Segnalazione di bug            |sensible-browser "http://      |
    |corrispondente ad un numero di |bugs.debian.org/<numero_bug>"  |
    |bug                            |                               |
    +---------------------------------------------------------------+


    Cercare con Google con parole chiave e aggiungendo
    "site:debian.org", "site:wiki.debian.org",
    "site:lists.debian.org", ecc.

    Quando si invia una segnalazione di bug, usare il comando 
    reportbug(1).

%

2.2. Operazioni base per la gestione dei pacchetti

    Le operazioni di gestione dei pacchetti basate sui repository sul
    sistema Debian possono essere eseguite da molti strumenti di
    gestione dei pacchetti basati su APT disponibili sul sistema
    Debian. Qui, verranno spiegati 3 strumenti base di gestione dei
    pacchetti: apt, apt-get / apt-cache e aptitude.

    Per operazioni di gestione dei pacchetti che comportano
    l'installazione o l'aggiornamento dei metadati dei pacchetti, è
    necessario avere privilegi di root.

%

2.2.1. Confronti apt - apt-get / apt-cache - aptitude

    Anche se aptitude è uno strumento interattivo molto bello ed è
    quello principalmente usato dall'autore, si dovrebbero conoscere
    alcuni avvertimenti:

      * Il comando aptitude non è raccomandato per l'aggiornamento
        del sistema da un rilascio ad un altro sul sistema Debian
        stable dopo un nuovo rilascio.

          + Per questo è raccomandato l'uso di «apt full-upgrade» o
            «apt-get dist-upgrade». Vedere il Bug nr. 411280.

      * Il comando aptitude a volte suggerisce rimozioni in massa di
        pacchetti per l'aggiornamento del sistema sui sistemi Debian
        testing o unstable.
   
          + Questa situazione ha spaventato molti amministratori di
            sistema. Niente panico.

          + Ciò sembra essere dovuto soprattutto ad una non
            corrispondenza tra le versioni di pacchetti da cui
            dipende un metapacchetto o che sono raccomandate da un
            metapacchetto, come gnome-core.

          + Ciò può essere risolto selezionando «Annulla azioni in
            attesa» nel menu dei comandi di aptitude, uscendo da
            aptitude e usando «apt full-upgrade».

    I comandi apt-get e apt-cache sono gli strumenti di gestione dei
    pacchetti basati su APT più a livello base.

      * apt-get e apt-cache offrono solo l'interfaccia utente a riga
        di comando.

      * apt-get è più adatto per gli aggiornamenti principali del
        sistema tra rilasci diversi, ecc.

      * apt-get offre un sistema robusto di risoluzione delle
        dipendenze dei pacchetti.
   
      * apt-get è meno avido di risorse di sistema. Consuma meno
        memoria ed è più veloce durante l'esecuzione.

      * apt-cache offre una ricerca standard, basata su espressioni
        regolari, nei nomi e nelle descrizioni dei pacchetti.

      * apt-get e apt-cache possono gestire più versioni dei
        pacchetti usando /etc/apt/preferences, ma è piuttosto
        elaborato farlo.

    Il comando apt è un'interfaccia a riga di comando di alto livello
    per la gestione dei pacchetti. Fondamentalmente è un wrapper di
    apt-get, apt-cache e comandi simili, originariamente pensata come
    interfaccia per l'utente finale e abilita in modo predefinito
    alcune opzioni più adatte per l'uso interattivo.

      * apt fornisce una comoda barra di avanzamento quando si
        installano pacchetti usando apt install.
   
      * apt elimina in modo predefinito i pacchetti .deb nella cache
        dopo l'installazione con successo dei pacchetti scaricati.

    Suggerimento

    È raccomandato agli utenti di usare il nuovo comando apt(8) per
    l'uso interactive e di usare i comandi apt-get(8) e apt-cache(8)
    negli script di shell.

    Il comando aptitude è lo strumento di gestione dei pacchetti
    basato su APT più versatile.

      * aptitude offre un'interfaccia utente testuale interattiva a
        schermo intero.

      * aptitude offre anche un'interfaccia utente a riga di comando.

      * aptitude è più adatto per la gestione interattiva quotidiana
        dei pacchetti, come l'ispezione dei pacchetti installati e la
        ricerca dei pacchetti disponibili.
   
      * aptitude è più avido di risorse di sistema. Consuma più
        memoria ed è più lento durante l'esecuzione.

      * apt-cache offre una ricerca migliorata, basata su espressioni
        regolari, su tutti i metadati dei pacchetti.

      * aptitude può gestire più versioni dei pacchetti senza usare /
        etc/apt/preferences e farlo è piuttosto intuitivo.

2.2.2. Operazioni base per la gestione dei pacchetti dalla riga di
comando

    Ecco alcune operazioni base di gestione dei pacchetti dalla riga
    di comando usando apt(8), aptitude(8) e apt-get(8) /apt-cache(8).

    Tabella 2.6. Operazioni base di gestione dei pacchetti dalla riga
    di comando usando aptitude(8) e apt-get(8) /apt-cache(8)

    +---------------------------------------------------------------+
    |sintassi per|sintassi per|sintassi per|                        |
    |    apt     |  aptitude  |  apt-get/  |      descrizione       |
    |            |            | apt-cache  |                        |
    |------------+------------+------------+------------------------|
    |            |aptitude    |apt-get     |aggiorna i metadati     |
    |apt update  |update      |update      |dell'archivio dei       |
    |            |            |            |pacchetti               |
    |------------+------------+------------+------------------------|
    |            |aptitude    |apt-get     |installa la versione    |
    |apt install |install     |install     |candidata del pacchetto |
    |pippo       |pippo       |pippo       |"pippo" con le sue      |
    |            |            |            |dipendenze              |
    |------------+------------+------------+------------------------|
    |            |            |            |installa le versioni    |
    |            |aptitude    |apt-get     |candidate dei pacchetti |
    |apt upgrade |safe-upgrade|upgrade     |installati senza        |
    |            |            |            |rimuovere altri         |
    |            |            |            |pacchetti               |
    |------------+------------+------------+------------------------|
    |            |            |            |installa le versioni    |
    |apt         |aptitude    |apt-get     |candidate dei pacchetti |
    |full-upgrade|full-upgrade|dist-upgrade|installati e rimuove, se|
    |            |            |            |necessario, altri       |
    |            |            |            |pacchetti               |
    |------------+------------+------------+------------------------|
    |apt remove  |aptitude    |apt-get     |rimuove il pacchetto    |
    |pippo       |remove pippo|remove pippo|"pippo" lasciando i suoi|
    |            |            |            |file di configurazione  |
    |------------+------------+------------+------------------------|
    |            |            |            |rimuove i pacchetti     |
    |apt         |N/D         |apt-get     |installati              |
    |autoremove  |            |autoremove  |automaticamente che non |
    |            |            |            |sono più necessari      |
    |------------+------------+------------+------------------------|
    |            |            |            |elimina completamente il|
    |apt purge   |aptitude    |apt-get     |pacchetto "pippo" con i |
    |pippo       |purge pippo |purge pippo |suoi file di            |
    |            |            |            |configurazione          |
    |------------+------------+------------+------------------------|
    |            |            |            |pulisce completamente il|
    |apt clean   |aptitude    |apt-get     |repository locale dei   |
    |            |clean       |clean       |file dei pacchetti      |
    |            |            |            |scaricati               |
    |------------+------------+------------+------------------------|
    |            |            |            |pulisce il repository   |
    |apt         |aptitude    |apt-get     |locale dei file dei     |
    |autoclean   |autoclean   |autoclean   |pacchetti scaricati che |
    |            |            |            |sono obsoleti           |
    |------------+------------+------------+------------------------|
    |apt show    |aptitude    |apt-cache   |mostra informazioni     |
    |pippo       |show pippo  |show pippo  |dettagliate sul         |
    |            |            |            |pacchetto "pippo"       |
    |------------+------------+------------+------------------------|
    |            |aptitude    |apt-cache   |cerca i pacchetti che   |
    |apt search  |search      |search      |corrispondono           |
    |<regex>     |<regex>     |<regex>     |all'espressione regolare|
    |            |            |            |<regex>                 |
    |------------+------------+------------+------------------------|
    |            |            |            |spiega le ragioni per   |
    |            |aptitude why|            |cui i pacchetti che     |
    |N/D         |<regex>     |N/D         |corrispondono a <regex> |
    |            |            |            |dovrebbero essere       |
    |            |            |            |installati              |
    |------------+------------+------------+------------------------|
    |            |            |            |spiega le ragioni per   |
    |            |aptitude    |            |cui i pacchetti che     |
    |N/D         |why-not     |N/D         |corrispondono a <regex> |
    |            |<regex>     |            |non dovrebbero essere   |
    |            |            |            |installati              |
    |------------+------------+------------+------------------------|
    |            |aptitude    |apt-mark    |elenca i pacchetti      |
    |N/D         |search '~i! |showmanual  |installati manualmente  |
    |            |~M'         |            |                        |
    +---------------------------------------------------------------+


    Nota

    Sebbene il comando aptitude sia dotato di moltissime funzionalità
    come il suo risolutore avanzato di conflitti tra pacchetti,
    questa complessità ha causato (o può ancora causare) alcune
    regressioni quali i Bug nr. 411123, Bug nr. 514930 e Bug nr.
    570377. In caso di dubbio, preferire i comandi apt, apt-get e
    apt-cache al comando aptitude.

    Nota

    Dato che apt / apt-get e aptitude, a partire da lenny,
    condividono le informazioni suipacchetti installati
    automaticamente (vedere Sezione 2.5.5, «Lo stato dei pacchetti
    per APT»), si può mescolare l'uso diquesti strumenti senza
    particolari problemi (vedere il Bug nr.594490).

    «aptitude why <regex>» può mostrare ancor più informazioni se
    usato come «aptitude -v why <regex>». Informazioni simili possono
    essere ottenute con «apt rdepends <package>» o «apt-cache
    rdepends <package>».

    Quando il comando aptitude è avviato in modalità a riga di
    comando e si trova davanti a problemi come conflitti tra
    pacchetti, si può passare alla modalità interattiva a tutto
    schermo premendo successivamente il tasto "e" al prompt.

    Si possono usare opzioni per il comando immediatamente dopo
    "aptitude".

    Tabella 2.7. Opzioni degne di nota per il comando aptitude(8)

    +---------------------------------------------------------------+
    |opzione per il|                  descrizione                   |
    |   comando    |                                                |
    |--------------+------------------------------------------------|
    |-s            |simula il risultato del comando                 |
    |--------------+------------------------------------------------|
    |-d            |scarica solamente ma non installa/aggiorna      |
    |--------------+------------------------------------------------|
    |-D            |mostra delle brevi spiegazioni prima di         |
    |              |installazioni e rimozioni automatiche           |
    +---------------------------------------------------------------+


    Per maggiori informazioni vedere aptitude(8) e il "manuale utente
    di aptitude" in "/usr/share/doc/aptitude/README".

    Suggerimento

    Il pacchetto dselect è ancora disponibile ed è stato lo strumento
    a tutto schermo interattivo di gestione dei pacchetti dei rilasci
    passati.

%

2.2.3. Uso interattivo di aptitude

    Per la gestione interattiva dei pacchetti, si avvia aptitude in
    modalità interattiva dal prompt di shell della console nel modo
    seguente.

    $ sudo aptitude -u
    Password:

    In questo modo si aggiorna la copia locale delle informazioni
    sull'archivio e viene mostrato l'elenco dei pacchetti in una
    schermata a pieno schermo. Aptitude posiziona la sua
    configurazione in "~/.aptitude/config".

    Suggerimento

    Se si desidera usare la configurazione di root, invece di quella
    dell'utente, usare "sudo -H aptitude …" invece di "sudo aptitude
    …", come nell'esempio precedente.

    Suggerimento

    Aptitude imposta automaticamente le azioni pendenti quando viene
    avviato in modalità interattiva. Se ciò non piace, si può
    reimpostarlo usando il menu: "Azioni" → "Annulla azioni in
    attesa".

%

2.2.4. Associazioni dei tasti per aptitude

    Quelle che seguono sono le associazioni di tasti degne di nota
    usate, nella modalità a schermo intero, per sfogliare lo stato
    dei pacchetti e per impostare "azioni pianificate" su di essi.

    Tabella 2.8. Elenco delle associazioni di tasti per aptitude

    +---------------------------------------------------------------+
    |     tasto      |               azione associata               |
    |----------------+----------------------------------------------|
    |F10 o Ctrl-t    |menu                                          |
    |----------------+----------------------------------------------|
    |?               |mostra l'aiuto per i tasti (elenco più        |
    |                |completo)                                     |
    |----------------+----------------------------------------------|
    |F10 → Aiuto →   |mostra il Manuale utente                      |
    |Manuale utente  |                                              |
    |----------------+----------------------------------------------|
    |u               |aggiorna le informazioni sull'archivio dei    |
    |                |pacchetti                                     |
    |----------------+----------------------------------------------|
    |+               |segna il pacchetto per l'aggiornamento o l'   |
    |                |installazione                                 |
    |----------------+----------------------------------------------|
    |-               |segna il pacchetto per la rimozione (mantiene |
    |                |i file di configurazione)                     |
    |----------------+----------------------------------------------|
    |_               |segna il pacchetto per l'eliminazione completa|
    |                |(rimuove i file di configurazione)            |
    |----------------+----------------------------------------------|
    |=               |blocca il pacchetto                           |
    |----------------+----------------------------------------------|
    |U               |segna tutti i pacchetti aggiornabili (funziona|
    |                |come full-upgrade)                            |
    |----------------+----------------------------------------------|
    |g               |inizia a scaricare e installare i pacchetti   |
    |                |selezionati                                   |
    |----------------+----------------------------------------------|
    |q               |esce dalla schermata attuale e salva i        |
    |                |cambiamenti                                   |
    |----------------+----------------------------------------------|
    |x               |esce dalla schermata attuale e scarta i       |
    |                |cambiamenti                                   |
    |----------------+----------------------------------------------|
    |Invio           |visualizza le informazioni su un pacchetto    |
    |----------------+----------------------------------------------|
    |C               |visualizza il registro dei cambiamenti di un  |
    |                |pacchetto                                     |
    |----------------+----------------------------------------------|
    |l               |cambia la limitazione dei pacchetti           |
    |                |visualizzati                                  |
    |----------------+----------------------------------------------|
    |/               |cerca la prima corrispondenza                 |
    |----------------+----------------------------------------------|
    |\               |ripete l'ultima ricerca                       |
    +---------------------------------------------------------------+


    Le espressioni regolari usate per specificare il nome di
    pacchetto nella riga di comando e nel prompt del menu dopo aver
    premuto "l" o "//" sono descritte in seguito. Le espressioni
    regolari di aptitude possono esplicitamente trovare
    corrispondenze con nomi di pacchetto usando una stringa che
    inizia con "~n seguita dal nome del pacchetto.

    Suggerimento

    È necessario premere "U" per aggiornare tutti i pacchetti
    installati alla versione candidata nell'interfaccia interattiva.
    Altrimenti vengono aggiornati alla versione candidata solo i
    pacchetti selezionati e quelli da una cui particolare versione
    dipendono altri.

%

2.2.5. Viste dei pacchetti in aptitude

    Nella modalità interattiva a tutto schermo di aptitude(8), i
    pacchetti nell'elenco vengono mostrati come nell'esempio
    seguente.

    idA   libsmbclient                             -2220kB 3.0.25a-1  3.0.25a-2

    Il significato degli elementi di questa riga, partendo da
    sinistra, è il seguente.

      * Il flag di "stato attuale" (la prima lettera)

      * Il flag di "azione pianificata" (la seconda lettera)

      * Il flag "automatico" (la terza lettera)

      * Il nome del pacchetto

      * Il cambiamento in termini di uso dello spazio su disco
        collegato dall'"azione pianificata"

      * La versione attuale del pacchetto

      * La versione candidata del pacchetto

    Suggerimento
   
    L'elenco completo dei flag è fornito alla fine della schermata
    mostrata di Aiuto mostrata se si preme "?".

    La versione candidata è scelta in base alle preferenze locali
    attuali (vedere apt_preferences(5) e Sezione 2.7.3, «Modificare
    la versione candidata»).

    Diversi tipi di viste per i pacchetti sono disponibili nel menu
    "Viste".

    Tabella 2.9. Elenco delle viste di aptitude

    +---------------------------------------------------------------+
    |    vista    |  stato  |        descrizione della vista        |
    |-------------+---------+---------------------------------------|
    |Vista dei    |         |vedere Tabella 2.10, «Organizzazione   |
    |pacchetti    |Buona    |delle viste standard dei pacchetti»    |
    |             |         |(vista standard)                       |
    |-------------+---------+---------------------------------------|
    |             |         |elenca i pacchetti che sono            |
    |Controlla    |Buona    |raccomandati da alcuni dei pacchetti   |
    |Raccomandati |         |installati, ma non sono ancora         |
    |             |         |installati                             |
    |-------------+---------+---------------------------------------|
    |Elenco unico |         |elenca i pacchetti senza organizzarli  |
    |dei pacchetti|Buona    |in gruppi (per l'uso con espressioni   |
    |             |         |regolari)                              |
    |-------------+---------+---------------------------------------|
    |Consultazione|Molto    |elenca i pacchetti organizzati in base |
    |per «Debtags»|usabile  |alle loro voci Debtags                 |
    |-------------+---------+---------------------------------------|
    |Consultazione|         |elenca i pacchetti organizzati in base |
    |per categorie|Deprecata|alla loro categoria (usare al suo posto|
    |             |         |Consultazione per «Debtags»)           |
    +---------------------------------------------------------------+


    Nota
   
    È estremamente benvenuto ogni aiuto per migliorare l'assegnazione
    di etichette Debtags ai pacchetti!

    La "Vista dei pacchetti" standard organizza i pacchetti un po'
    nello stile di dselect con alcune funzionalità extra.

    Tabella 2.10. Organizzazione delle viste standard dei pacchetti

    +---------------------------------------------------------------+
    |     categoria     |          descrizione della vista          |
    |-------------------+-------------------------------------------|
    |Pacchetti          |elenca i pacchetti organizzati in sezione →|
    |aggiornabili       |area → pacchetto                           |
    |-------------------+-------------------------------------------|
    |Pacchetti nuovi    |" "                                        |
    |-------------------+-------------------------------------------|
    |Pacchetti          |" "                                        |
    |installati         |                                           |
    |-------------------+-------------------------------------------|
    |Pacchetti non      |" "                                        |
    |installati         |                                           |
    |-------------------+-------------------------------------------|
    |Pacchetti obsoleti |" "                                        |
    |e creati localmente|                                           |
    |-------------------+-------------------------------------------|
    |Pacchetti virtuali |elenca i pacchetti con la stessa funzione  |
    |-------------------+-------------------------------------------|
    |                   |elenca i pacchetti con funzioni diverse    |
    |Task               |solitamente necessarie per una stessa      |
    |                   |attività                                   |
    +---------------------------------------------------------------+


    Suggerimento
   
    La vista dei Task può essere usata per scegliere a uno a uno i
    pacchetti per le proprie attività.

%

2.2.6. Opzioni per i metodi di ricerca in aptitude

    Aptitude offre diverse opzioni per cercare pacchetti usando il
    suo schema di espressioni regolari.

      * Nella riga di comando della shell:

          + "aptitude search '<regex_aptitude>'" per elencare lo
            stato di installazione, il nome del pacchetto ed una
            descrizione breve dei pacchetti che corrispondono.

          + "aptitude show '<nome_pacchetto>'" per elencare una
            descrizione dettagliata del pacchetto

      * Nella modalità interattiva a tutto schermo:
   
          + "l" per limitare la vista dei pacchetti ai pacchetti che
            corrispondono

          + "/" per cercare un pacchetto che corrisponda

          + "\" per cercare all'indietro un pacchetto che corrisponda

          + "n" per trovare il successivo

          + "N" per trovare il successivo (all'indietro)

    Suggerimento

    La stringa <package_name> viene usata per trovare una
    corrispondenza esatta con il nome di pacchetto a meno che non
    venga esplicitamente fatta iniziare con "~" per indicare una
    espressione regolare.

%

2.2.7. La struttura delle espressioni regolari di aptitude

    La struttura delle espressioni regolari di aptitude è quella di 
    ERE (vedere Sezione 1.6.2, «Espressioni regolari») estese in
    stile mutt ed il significato delle speciali regole estese di
    corrispondenza, specifiche di aptitude, è il seguente.

    Tabella 2.11. Elenco delle regole per espressioni regolari di
    aptitude

    +-----------------------------------------------------------------------+
    | descrizione della  |                                                  |
    |  regola estesa di  |       struttura della espressione regolare       |
    |   corrispondenza   |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~n<regex_nome>                                    |
    |il nome di pacchetto|                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~d<regex_descrizione>                             |
    |la descrizione      |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~t<regex_task>                                    |
    |il nome del task    |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~G<regex_debtag>                                  |
    |il debtag           |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~m<regex_mantainer>                               |
    |il manutentore      |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |la sezione del      |~s<regex_sezione>                                 |
    |pacchetto           |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |la versione del     |~V<regex_versione>                                |
    |pacchetto           |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~A{bullseye,bookworm,sid}                         |
    |l'archivio          |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~O{debian,…}                                      |
    |l'origine           |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~p{extra,important,optional,required,standard}    |
    |la priorità         |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~E                                                |
    |pacchetti essenziali|                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~v                                                |
    |pacchetti virtuali  |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~N                                                |
    |pacchetti nuovi     |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~a                                                |
    |azioni pendenti     |{install,upgrade,downgrade,remove,purge,hold,keep}|
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |~i                                                |
    |pacchetti installati|                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti installati|                                                  |
    |e con l'indicatore A|~M                                                |
    |(pacchetti          |                                                  |
    |installati          |                                                  |
    |automaticamente)    |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con i|                                                  |
    |pacchetti installati|                                                  |
    |e senza l'indicatore|~i!~M                                             |
    |A (pacchetti        |                                                  |
    |selezionati         |                                                  |
    |dall'amministratore)|                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti installati|~U                                                |
    |che sono            |                                                  |
    |aggiornabili        |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti rimossi ma|~c                                                |
    |non eliminati       |                                                  |
    |completamente       |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti rimossi,  |                                                  |
    |eliminati o che     |~g                                                |
    |possono essere      |                                                  |
    |rimossi             |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti che       |~b                                                |
    |dichiarano problemi |                                                  |
    |di dipendenze       |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti con       |                                                  |
    |problemi di         |~B<tipogt;                                        |
    |dipendenze di tipo  |                                                  |
    |<tipo>              |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti <modello> |~D[<tipo>:]<modello>                              |
    |con dipendenze di   |                                                  |
    |tipo <tipo>         |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti <modello> |                                                  |
    |con dipendenze non  |~DB[<tipo>:]<modello>                             |
    |soddisfatte di tipo |                                                  |
    |<tipo>              |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti verso i   |                                                  |
    |quali il pacchetto  |                                                  |
    |che corrisponde a   |~R[<tipo>:]<modello>                              |
    |<modello> dichiara  |                                                  |
    |una dipendenza di   |                                                  |
    |tipo <tipo>         |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti verso i   |                                                  |
    |quali il pacchetto  |                                                  |
    |<termine> dichiara  |~RB[<tipo>:]<modello>                             |
    |una dipendenza non  |                                                  |
    |soddisfatta di tipo |                                                  |
    |<tipo>              |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti da cui    |                                                  |
    |dipende un qualche  |~R~i                                              |
    |altro pacchetto     |                                                  |
    |installato          |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti da cui non|!~R~i                                             |
    |dipende alcun       |                                                  |
    |pacchetto installato|                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetti da cui    |                                                  |
    |dipende o che       |~R~i|~Rrecommends:~i                              |
    |vengono raccomandati|                                                  |
    |da qualche altro    |                                                  |
    |pacchetto           |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |pacchetto <modello> |~S filtro <modello>                               |
    |con filtro sulle    |                                                  |
    |versioni            |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |tutti i pacchetti   |~T                                                |
    |(vero)              |                                                  |
    |--------------------+--------------------------------------------------|
    |corrispondenza con  |                                                  |
    |nessun pacchetto    |~F                                                |
    |(falso)             |                                                  |
    +-----------------------------------------------------------------------+


      * Il formato dell'espressione regolare è la stessa di quello 
        ERE usato nei tipici strumenti per il testo in stile Unix "^
        ", ".*", "$", ecc. come in egrep(1), awk(1) e perl(1).

      * Il <tipo> di relazione è uno tra depends, predepends,
        recommends, suggests, conflicts, replaces, provides, e
        definisce la relazione tra i pacchetti.

      * Il <tipo> di dipendenza predefinito è "depends".

    Suggerimento
   
    Quando <modello_regex> è una stringa vuota, mettere "~T"
    immediatamente dopo il comando.

    Ecco alcune scorciatoie.

      * "~P<termine>" == "~Dprovides:<termine>"

      * "~C<termine>" == "~Dconflicts:<termine>"

      * "…~W termine" == "(…|termine)"

    Gli utenti che hanno familiarità con mutt imparano presto, dato
    che la sintassi per le espressioni si è ispirata a mutt. Vedere
    "SEARCHING, LIMITING, AND EXPRESSIONS" nel "Manuale utente", "/
    usr/share/doc/aptitude/README".

    Nota

    Con la versione lenny di aptitude(8), può essere usata la nuova
    sintassi in forma lunga come "?broken" invece del vecchio
    equivalente in forma breve " "~b". Il carattere di spazio " " è
    ora considerato uno dei caratteri che terminano l'espressione
    regolare, oltre al carattere tilde "~". Vedere il "Manuale
    utente" per la sintassi della nuova forma lunga.

%

2.2.8. Risoluzione delle dipendenze di aptitude

    Se la voce di menuF10 → Opzioni → Preferenze → Gestione delle
    dipendenze" è impostata in modo appropriato, selezionando un
    pacchetto in aptitude non si richiamano solamente i pacchetti
    definiti nel suo elenco "Depends:", ma anche quelli nell'elenco
    "Recommends:". Questi pacchetti installati automaticamente vengo
    rimossi automaticamente se non sono più necessari secondo
    aptitude.

    L'opzione che controlla il comportamento di "installazione
    automatica" del comando aptitude può anche essere manipolata
    usando il comando apt-mark(8) dal pacchetto apt.

%

2.2.9. Registri delle attività sui pacchetti

    Si può controllare lo storico delle attività sui pacchetti nei
    file di registro.

    Tabella 2.12. File di registro per le attività sui pacchetti

    +---------------------------------------------------------------+
    |     file     |                   contenuto                    |
    |--------------+------------------------------------------------|
    |/var/log/     |Registro delle attività a livello dpkg per tutte|
    |dpkg.log      |le attività sui pacchetti                       |
    |--------------+------------------------------------------------|
    |/var/log/apt/ |Registro delle attività APT generiche           |
    |term.log      |                                                |
    |--------------+------------------------------------------------|
    |/var/log/     |Registro delle attività di comandi aptitude     |
    |aptitude      |                                                |
    +---------------------------------------------------------------+


    In realtà non è facile ottenere delle informazioni immediatamente
    comprensibili da questi file di registro. Vedere Sezione 9.2.10,
    «Registrare i cambiamenti a file di configurazione» per un metodo
    più facile.

%

2.3. Esempi di operazioni con aptitude

    Ecco alcuni esempi di operazioni con aptitude(8).

2.3.1. Elencare pacchetti in base alla corrispondenza del nome con
espressioni regolari

    Il seguente comando elenca i pacchetti i cui nomi corrispondono
    alle espressioni regolari specificate.

    $ aptitude search '~n(pam|nss).*ldap'
    p libnss-ldap - NSS module for using LDAP as a naming service
    p libpam-ldap - Pluggable Authentication Module allowing LDAP interfaces

    È piuttosto utile se si desidera trovare il nome esatto di un
    pacchetto.

%

2.3.2. Sfogliare le corrispondenze ad una espressione regolare

    L'espressione regolare "~dipv6" nel prompt di "l" nella vista
    "Nuovo elenco unico dei pacchetti", limita la visualizzazione dei
    pacchetti a quelli la cui descrizione corrisponde all'espressione
    "ipv6" e permette di sfogliare interattivamente le loro
    informazioni.

%

2.3.3. Eliminare completamente i pacchetti rimosssi

    Si possono eliminare tutti i file di configurazione rimasti di
    pacchetti rimossi.

    Controllare il risultato del comando seguente.

    # aptitude search '~c'

    Se si pensa che sia giusto rimuover i pacchetti elencati,
    eseguire il comando seguente.

    # aptitude purge '~c'

    Si può fare la stessa cosa in modalità interattiva per avere un
    controllo più dettagliato.

    Fornire l'espressione regolare "~c" al prompt di "l" nella vista
    "Nuova vista dei pacchetti". In questo modo si limita la
    visualizzazione a quei pacchetti che corrispondono
    all'espressione regolare, cioè "rimossi ma non eliminati
    completamente". Tutte le corrispondenze trovate possono essere
    mostrate premendo "[" nelle intestazioni di primo livello.

    Premere poi "_" nell'intestazione di primo livello, come
    "Pacchetti non installati". In questo modo vengono selezionati
    per l'eliminazione completa solo quei pacchetti contenuti sotto
    l'intestazione che hanno fatto corrispondenza con l'espressione
    regolare. Si possono escludere alcuni pacchetti in modo
    interattivo dall'eliminazione premendo "=" per ciascuno di essi.

    Questa tecnica è piuttosto comoda e funziona per molti altri
    tasti di comando.

2.3.4. Mettere ordine nello stato di installazione automatico/non
automatico

    Ecco come faccio per mettere ordine nello stato di installazione
    automatico/non automatico per i pacchetti (dopo aver usato un
    installatore che non sia aptitude, ecc.).

     1. Avviare da root aptitude in modalità interattiva.

     2. Digitare "u", "U", "f" e "g" per aggiornare l'elenco dei
        pacchetti e i pacchetti stessi.

     3. Digitare "l" per impostare la limitazione della
        visualizzazione con "~i(~R~i|~Rrecommends:~i)" e digitare "M"
        su "Pacchetti installati" per marcarli come installati
        automaticamente.

     4. Digitare "l" per impostare la limitazione della
        visualizzazione dei pacchetti con "~prequired|~pimportant|
        ~pstandard|~E" e digitare "m" su "Pacchetti installati" per
        marcarli come installati manualmente.

     5. Digitare "l" per impostare la limitazione della
        visualizzazione dei pacchetti con "~i!~M" e rimuovere i
        pacchetti inutilizzati digitando "-" su ciascuno di essi dopo
        averli visualizzati digitando "[" su "Pacchetti installati".
   
     6. Digitare "l" per impostare la limitazione della
        visualizzazione dei pacchetti con "~i"; poi digitare "m" su
        "Task" per marcare quei pacchetti come installati
        manualmente.

     7. Uscire da aptitude.

     8. Avviare "apt-get -s autoremove|less" da root per controllare
        quelli che non sono usati.

     9. Riavviare aptitude in modalità interattiva e segnare i
        pacchetti necessari con "m".

    10. Riavviare "apt-get -s autoremove|less" da root per
        controllare che in REMOVED siano contenuti soltanto i
        pacchetti attesi.

    11. Avviare "apt-get autoremove|less" da root per rimuovere
        automaticamente i pacchetti non utilizzati.

    L'azione "m" sopra "Task" è opzionale e server per prevenire
    situazioni di rimozioni di massa di pacchetti in futuro.

%

2.3.5. Aggiornamento di tutto il sistema

    Nota

    Quando si passa ad un nuovo rilascio, ecc. si dovrebbe
    considerare una installazione pulita di un nuovo sistema anche se
    è possibile aggiornare Debian nel modo descritto in seguito. Ciò
    dà la possibilità di rimuovere la spazzatura raccolta nel tempo e
    fornisce la migliore combinazione dei pacchetti più nuovi.
    Naturalmente si dovrebbe fare un backup completo del sistema in
    un posto sicuro (vedere Sezione 10.2, «Backup e ripristino»)
    prima di farlo. Raccomando di creare una configurazione con due
    sistemi avviabili usando due diverse partizioni per avere una
    transizione il più lineare possibile.

    Si può fare l'aggiornamento completo del sistema ad un nuovo
    rilascio cambiando il contenuto del file «/etc/apt/sources.list»
    facendolo puntare al nuovo rilascio ed eseguendo il comando «apt
    update; apt dist-upgrade».

    Per aggiornare da stable a testing o unstable, sostituire
    ""bullseye" nel file "/etc/apt/sources.list" di esempio descritto
    in Sezione 2.1.4, «Nozioni di base sugli archivi Debian» con
    "bookworm" o "sid".

    In realtà si possono dover affrontare alcune complicazioni a
    causa di problemi di transizione dei pacchetti, per lo più a
    causa di dipendenze. Più è grande la differenza
    nell'aggiornamento, più è probabile dover affrontare problemi più
    grossi. Per la transizione dal vecchio rilascio stable al nuovo
    stable si possono leggere le nuove Note di rilascio e seguire
    esattamente la procedura che vi è descritta per minimizzare i
    problemi.

    Quando si decide di passare da stable a testing prima del suo
    rilascio formale non ci sono Note di rilascio che possano
    aiutare. La differenza tra stable e testing potrebbe essere
    diventata piuttosto grande dopo il precendente rilascio stable e
    potrebbe rendere l'aggiornamento complicato.

    SI dovrebbero prendere misure precauzionali per l'aggiornamento
    completo raccogliendo le informazioni più aggiornate da mailing
    list ed usando il buon senso.

     1. Leggere le "Note di rilascio" precedenti.

     2. Fare il backup dell'intero sistema (specialmente dei dati e
        della configurazione).

     3. Tenere a portata di mano supporti avviabili in caso di
        problemi con il bootloader.

     4. Informare con un buon anticipo gli utenti nel sistema.

     5. Registrare l'attività di aggiornamento con script(1).

     6. Applicare l'opzione "unmarkauto" ai pacchetti richiesti, ad
        esempio "aptitude unmarkauto vim, per prevenire la loro
        rimozione.

     7. Minimizzare i pacchetti installati per ridurre le probabilità
        di conflitti tra i pacchetti, ad esempio rimuovere i
        pacchetti dell'attività desktop.

     8. Rimuovere il file "/etc/apt/preferences" (disabilitare
        apt-pinning).

     9. Cercare di aggiornare per gradi: oldstable → stable → testing
        → unstable.

    10. Aggiornare il file "/etc/apt/sources.list per farlo puntare
        solamente al nuovo archivio ed eseguire "aptitude update".

    11. Installare, opzionalmente i nuovi pacchetti partendo dai 
        pacchetti fondamentali, ad esempio "aptitude install perl".

    12. Eseguire il comando "apt-get -s dist-upgrade" per avere
        un'idea dell'impatto dell'aggiornamento.

    13. Eseguire da ultimo il comando "apt-get dist-upgrade".

    Attenzione
   
    Non è saggio saltare un rilascio principale Debian quando si
    aggiorna da un rilascio stable ad un altro.

    Attenzione

    Nelle "Note di rilascio" precedenti GCC, il kernel Linux,
    initrd-tools, Glibc, Perl, APT tool chain, ecc. hanno richiesto
    un po' di attenzione particolare per gli aggiornamenti
    dell'intero sistema.

    Per gli aggiornamenti quotidiani in unstable, vedere
    Sezione 2.4.3, «Salvaguardarsi da problemi coi pacchetti».

2.4. Operazioni avanzate per la gestione dei pacchetti

2.4.1. Operazioni avanzate per la gestione dei pacchetti dalla riga
di comando

    Ecco un elenco di altre operazioni di gestione dei pacchetti per
    i quali aptitude è di livello troppo altro o manca delle
    funzionalità richieste.

    Tabella 2.13. Elenco delle operazioni avanzate per la gestione
    dei pacchetti

    +---------------------------------------------------------------+
    |        comando         |                azione                |
    |------------------------+--------------------------------------|
    |COLUMNS=120 dpkg -l     |elenca lo stato di un pacchetto       |
    |<modello_nome_pacchetto>|installato per una segnalazione di bug|
    |------------------------+--------------------------------------|
    |dpkg -L <nome_pacchetto>|elenca il contenuto di un pacchetto   |
    |                        |installato                            |
    |------------------------+--------------------------------------|
    |dpkg -L <nome_pacchetto>|elenca le pagine man di un pacchetto  |
    || egrep '/usr/share/man/|installato                            |
    |man.*/.+'               |                                      |
    |------------------------+--------------------------------------|
    |dpkg -S                 |elenca i pacchetti installati che uno |
    |<modello_nome_file>     |un file con un nome che corrisponde al|
    |                        |modello                               |
    |------------------------+--------------------------------------|
    |apt-file search         |elenca i pacchetti nell'archivio che  |
    |<modello_nome_file>     |hanno un file con un nome che         |
    |                        |corrisponde al modello                |
    |------------------------+--------------------------------------|
    |apt-file list           |elenca il contenuto dei pacchetti     |
    |<modello_nome_pacchetto>|nell'archivio che corrispondono al    |
    |                        |modello                               |
    |------------------------+--------------------------------------|
    |dpkg-reconfigure        |riconfigura il pacchetto con          |
    |<nome_pacchetto>        |esattamente quel nome                 |
    |------------------------+--------------------------------------|
    |dpkg-reconfigure -p=low |riconfigura il pacchetto con          |
    |<nome_pacchetto>        |esattamente quel nome ponendo le      |
    |                        |domande più dettagliate               |
    |------------------------+--------------------------------------|
    |configure-debian        |riconfigura i pacchetti da            |
    |                        |un'interfaccia a tutto schermo a menu |
    |------------------------+--------------------------------------|
    |dpkg --audit            |controlla il sistema alla ricerca di  |
    |                        |pacchetti parzialmente installati     |
    |------------------------+--------------------------------------|
    |dpkg --configure -a     |configura tutti i pacchetti           |
    |                        |parzialmente installati               |
    |------------------------+--------------------------------------|
    |apt-cache policy        |mostra la versione disponibile, la    |
    |<nome_pacchetto_binario>|priorità e le informazioni            |
    |                        |nell'archivio di un pacchetto binario |
    |------------------------+--------------------------------------|
    |apt-cache madison <nome |mostra la versione disponibile e le   |
    |pacchetto>              |informazioni nell'archivio di un      |
    |                        |pacchetto                             |
    |------------------------+--------------------------------------|
    |apt-cache showsrc       |mostra informazioni sul pacchetto     |
    |<nome_pacchetto_binario>|sorgente di un pacchetto binario      |
    |------------------------+--------------------------------------|
    |apt-get build-dep       |installa i pacchetti richiesti per    |
    |<nome_pacchetto>        |compilare un pacchetto                |
    |------------------------+--------------------------------------|
    |aptitude build-dep      |installa i pacchetti richiesti per    |
    |<nome_pacchetto>        |compilare un pacchetto                |
    |------------------------+--------------------------------------|
    |apt-get source          |scarica un sorgente (da un archivio   |
    |<nome_pacchetto>        |standard)                             |
    |------------------------+--------------------------------------|
    |dget <URL del file dsc> |scarica un pacchetto sorgente (da un  |
    |                        |altro archivio)                       |
    |------------------------+--------------------------------------|
    |dpkg-source -x          |crea un albero dei sorgenti a partire |
    |<nome_pacchetto>_       |da un insieme di pacchetti sorgenti   |
    |<versione>-             |("*.orig.tar.gz" e "*.debian.tar.gz"/ |
    |<versione_debian>.dsc   |"*.diff.gz")                          |
    |------------------------+--------------------------------------|
    |debuild binary          |compila pacchetti da un albero dei    |
    |                        |sorgenti locale                       |
    |------------------------+--------------------------------------|
    |make-kpkg               |compila un pacchetto kernel a partire |
    |immagine_kernel         |da un albero dei sorgenti del kernel  |
    |------------------------+--------------------------------------|
    |make-kpkg --initrd      |compila un pacchetto kernel con       |
    |immagine_kernel         |initramfs abilitato, a partire da un  |
    |                        |albero dei sorgenti                   |
    |------------------------+--------------------------------------|
    |dpkg -i <nome_pacchetto>|                                      |
    |_<versione>-            |installa un pacchetto locale nel      |
    |<versione_debian>_      |sistema                               |
    |<arch>.deb              |                                      |
    |------------------------+--------------------------------------|
    |apt install /percorso/di|installa un pacchetto locale nel      |
    |/                       |sistema, cercando al contempo di      |
    |<nomefile_pacchetto>.deb|risolvere automaticamente le          |
    |                        |dipendenze                            |
    |------------------------+--------------------------------------|
    |debi <nome_pacchetto>_  |                                      |
    |<versione>-             |installa pacchetti locali nel sistema |
    |<versione_debian>_      |                                      |
    |<arch>.dsc              |                                      |
    |------------------------+--------------------------------------|
    |dpkg --get-selections   |salva le informazioni di stato sui    |
    |'*' >selection.txt      |pacchetti selezionati a livello di    |
    |                        |dpkg                                  |
    |------------------------+--------------------------------------|
    |dpkg --set-selections   |imposta le informazioni di stato sui  |
    |<selection.txt          |pacchetti selezionati a livello di    |
    |                        |dpkg                                  |
    |------------------------+--------------------------------------|
    |echo <nome_pacchetto>   |imposta lo stato di selezione di un   |
    |hold | dpkg             |pacchetto a livello di dpkg a hold    |
    |--set-selections        |(equivalente a "aptitude hold         |
    |                        |<nome_pacchetto>")                    |
    +---------------------------------------------------------------+


    Nota

    Per un pacchetto con la funzionalità multi-arch, può essere
    necessario specificare l'architettura per alcuni comandi. Per
    esempio, usare «dpkg -L libglib2.0-0:amd64» per elencare il
    contenuto del pacchetto libglib2.0-0 per l'architettura amd64.

    Attenzione

    Gli strumenti per i pacchetti a più basso livello, come "dpkg -i
    …" e "debi …" dovrebbero essere usati con molta cura
    dall'amministratore di sistema. Non si prendono cura in modo
    automatico delle dipendenze richieste dai pacchetti. Le opzioni
    "--force-all" e simili, per la riga di comando di dpkg (vedere
    dpkg(1), sono pensate per essere usate solamente da utenti
    esperti. Usarle senza comprenderne pienamente l'effetto potrebbe
    portare tutto il sistema in uno stato problematico.

    Notare quanto segue.

      * Tutti i comandi di configurazione ed installazioni di sistema
        devono essere eseguiti da root.

      * A differenza di aptitude che usa espressioni regolari (vedere
        Sezione 1.6.2, «Espressioni regolari»), gli altri comandi di
        gestione dei pacchetti usano espansioni di modelli in stile
        shell (vedere Sezione 1.5.6, «Glob della shell»).

      * Per apt-file(1), fornito dal pacchetto apt-file, è necessario
        eseguire prima "apt-file update".

      * configure-debian(8), fornito dal pacchetto configure-debian
        esegue dpkg-reconfigure(8) come suo backend.

      * dpkg-reconfigure(8) esegue gli script dei pacchetti usando 
        debconf(1) come suo backend.
   
      * I comandi "apt-get build-dep", "apt-get source" e "apt-cache
        showsrc" richiedono la voce "deb-src" in "/etc/apt/
        sources.list".

      * dget(1), debuild(1) e debi(1) richiedono il pacchetto
        devscripts.

      * Vedere la procedura per (ri)creare pacchetti usando "apt-get
        source" in Sezione 2.7.13, «Fare il port di un pacchetto nel
        sistema stabile».

      * Il comando make-kpkg richiede il pacchetto kernel_package
        (vedere Sezione 9.9, «Il kernel»).

      * Vedere Sezione 12.11, «Creare pacchetti Debian» per
        informazioni generali sulla creazione di pacchetti.

%

2.4.2. Verifica dei pacchetti installati

    L'installazione di debsums permette la verifica dei file di
    pacchetto installati in base ai valori delle somme di controllo
    MD5sum nei file "/var/lib/dpkg/info/*.md5sums" con debsums(1).
    Per il funzionamento di MD5sum vedere Sezione 10.3.5, «Somme di
    controllo MD5».

    Nota

    Dato che il database MD5sum può essere manomesso da un intruso,
    debsums ha un'utilità limitata come strumento di sicurezza. È
    adatto solo per controllare modifiche fatte dall'amministratore o
    danni dovuti ad errori dei supporti.

%

2.4.3. Salvaguardarsi da problemi coi pacchetti

    Molti utenti preferiscono usare il rilascio unstable del sistema
    Debian per avere le nuove funzionalità ed i nuovi pacchetti.
    Questo rende il sistema più esposto a bug critici sui pacchetti.

    L'installazione del pacchetto apt-listbugs salvaguarda il sistema
    dai bug critici controllando automaticamente, al momento degli
    aggiornamenti fatti con il sistema APT, il BTS Debian alla
    ricerca dei bug critici.

    L'installazione del pacchetto apt-listchanges fornisce importanti
    notizie contenute in NEWS.Debian quando si fanno aggiornamenti
    con il sistema APT.

%

2.4.4. Cercare tra i metadati dei pacchetti

    Sebbene visitare il sito Debian https://packages.debian.org/
    faciliti oggi giorno la ricerca nei metadati dei pacchetti, ci
    sono metodi più tradizionali per farlo.

    I comandi grep-dctrl(1), grep-status(1) e grep-available(1)
    possono essere usati per cercare in qualsiasi file che sia nel
    formato generico dei file di controllo dei pacchetti di Debian.

    "dpkg -S <modello_nome_file>" può essere usato per cercare i
    pacchetti che contengono al loro interno file installati da dpkg
    il cui nome corrisponde al modello. Ma non trova i file creati
    dagli script dei manutentori.

    Se è necessario fare ricerche più elaborate sui metadati dei
    pacchetti, è necessario eseguire il comando "grep -e
    modello_regex *" nella directory "/var/lib/dpkg/info/". In questo
    modo si cercano le parole indicate negli script e nei testi con
    le domande di installazione dei pacchetti.

    Se si desiderano vedere in modo ricorsivo le dipendenze dei
    pacchetti, si dovrebbe usare apt-rdepends(8).

%

2.5. Aspetti tecnici della gestione dei pacchetti in Debian

    Verranno ora trattati alcuni aspetti tecnici interni del
    funzionamento del sistema di gestione dei pacchetti Debian.
    Queste informazioni dovrebbero aiutare a trovare soluzioni
    proprie ai problemi con i pacchetti.

%

2.5.1. Metadati degli archivi

    I file con i metadati per ciascuna distribuzione sono archiviati
    in "dists/<codename>" su ciascun sito mirror di Debian, ad
    esempio "http://deb.debian.org/debian/". La struttura del suo
    archivio può essere navigata con il browser web. Ci sono 6 tipi
    di metadati.

    Tabella 2.14. Il contenuto dei metadati dell'archivio Debian

    +---------------------------------------------------------------+
    |     file     |        posizione         |      contenuto      |
    |--------------+--------------------------+---------------------|
    |              |directory della           |descrizione          |
    |Release       |distribuzione di più alto |dell'archivio e      |
    |              |livello                   |informazioni         |
    |              |                          |sull'integrità       |
    |--------------+--------------------------+---------------------|
    |              |directory della           |file di firma per il |
    |Release.gpg   |distribuzione di più alto |file "Release"       |
    |              |livello                   |firmato con la chiave|
    |              |                          |dell'archivio        |
    |--------------+--------------------------+---------------------|
    |              |directory della           |elenca tutti i file  |
    |Contents-     |distribuzione di più alto |per tutti i pacchetti|
    |<architettura>|livello                   |nell'archivio        |
    |              |                          |relativo             |
    |--------------+--------------------------+---------------------|
    |              |directory più elevata per |descrizione          |
    |Release       |ciascuna combinazione     |dell'archivio usata  |
    |              |distribuzione/area/       |per le regole di     |
    |              |architettura              |apt_preferences(5)   |
    |--------------+--------------------------+---------------------|
    |              |directory più elevata per |dati debian/control  |
    |Packages      |ciascuna combinazione     |concatenati dei      |
    |              |distribuzione/area/       |pacchetti binari     |
    |              |architettura-binaria      |                     |
    |--------------+--------------------------+---------------------|
    |              |directory più elevata per |dati debian/control  |
    |Sources       |ciascuna combinazione     |concatenati dei      |
    |              |distribuzione/area/source |pacchetti sorgenti   |
    +---------------------------------------------------------------+


    Negli archivi recenti questi metadati sono memorizzati come file
    compressi e file di differenze per ridurre il traffico di rete.

%

2.5.2. File "Release" nella directory principale ed autenticità

    Suggerimento
   
    Il file "Release" nella directory di livello più alto è usato per
    firmare gli archivi nel sistema secure APT.

    Ogni suite dell'archivio Debian ha un file "Release" nella sua
    directory di livello più alto, ad esempio "http://deb.debian.org/
    debian/dists/unstable/Release", di questo tipo.

    Origin: Debian
    Label: Debian
    Suite: unstable
    Codename: sid
    Date: Sat, 14 May 2011 08:20:50 UTC
    Valid-Until: Sat, 21 May 2011 08:20:50 UTC
    Architectures: alpha amd64 armel hppa hurd-i386 i386 ia64 kfreebsd-amd64 kfreebsd-i386 mips mipsel powerpc s390 sparc
    Components: main contrib non-free
    Description: Debian x.y Unstable - Not Released
    MD5Sum:
     bdc8fa4b3f5e4a715dd0d56d176fc789 18876880 Contents-alpha.gz
     9469a03c94b85e010d116aeeab9614c0 19441880 Contents-amd64.gz
     3d68e206d7faa3aded660dc0996054fe 19203165 Contents-armel.gz
    ...

    Nota

    Qui si può scoprire il motivo per cui in questa guida si è scelto
    di usare "suite" e "codename" (nome in codice) in Sezione 2.1.4,
    «Nozioni di base sugli archivi Debian». Il termine
    "distribuzione" è usato per riferirsi sia a "suite" sia a
    "codename". Tutti i nomi delle "aree" dell'archivio offerte da un
    archivio sono elencate in "Componente".

    L'integrità del file "Release" nella directory base viene
    verificata usando l'infrastruttura crittografica chiamata secure
    apt.

      * Il file "Release.gpg" con la firma crittografica viene creato
        a partire dal file "Release" nella directory base e dalla
        chiave segreta dell'archivio Debian.

      * La chiave pubblica dell'archivio Debian può essere inserita
        in "/etc/apt/trusted.gpg"

          + automaticamente installando il portachiavi con il file
            base-files più recente o

          + manualmente dagli strumenti gpg o apt-key con la più
            recente chiave pubblica dell'archivio pubblicata su
            ftp-master.debian.org .

      * Il sistema secure APT verifica crittograficamente l'integrità
        del file "Release" di più alto livello scaricato con questo
        file "Release.gpg" e la chiave pubblica dell'archivio Debian
        in "/etc/apt/trusted.gpg".

    L'integrità di tutti i file "Packages" e "Sources" viene
    verificata usando i valori MD5sum nel file "Release" nella
    ripsettiva directory base. L'integrità di tutti i file di
    pacchetto viene verificata usando i valori MD5sum nei file
    "Packages" e "Sources". Vedere debsums(1) e Sezione 2.4.2,
    «Verifica dei pacchetti installati».

    Dato che la verifica crittografica della firma è un processo
    molto più dispendioso in termini di uso della CPU rispetto al
    calcolo di valori MD5sum, l'uso di valori MD5sum per ciascun
    pacchetto mentre viene usata la firma crittografica per il file
    "Release" principale, fornisce una buona sicurezza con buone
    prestazioni (vedere Sezione 10.3, «Infrastruttura di sicurezza
    dei dati»).

%

2.5.3. File "Release" a livello di archivio

    Suggerimento
   
    I file "Release" a livello di archivio sono usati per le regole
    di apt_preferences(5).

    Ci sono file "Release" a livello di archivio per tutte le
    posizioni nell'archivio specificate dalla riga "deb" in "/etc/apt
    /sources.list", come "http://ftp.us.debian.org/debian/dists/
    unstable/main/binary-amd64/Release" o "http://deb.debian.org/
    debian/dists/sid/main/binary-amd64/Release" nell'esempio
    seguente.

    Archive: unstable
    Origin: Debian
    Label: Debian
    Component: main
    Architecture: amd64

    Attenzione

    Nell'archivio Debian, per la voce «Archive:» vengono usati i nomi
    di suite («stable», «testing», «unstable», …), mentre vengono
    usati i nomi in codice («trusty», «xenial», «artful», …)
    nell'archivio Ubuntu.

    Per alcuni archivi, come experimental e bullseye-backports, che
    contengono pacchetti che non dovrebbero essere installati
    automaticamente, c'è una riga aggiuntiva, come "http://
    deb.debian.org/debian/dists/experimental/main/binary-amd64/
    Release" nell'esempio seguente.

    Archive: experimental
    Origin: Debian
    Label: Debian
    NotAutomatic: yes
    Component: main
    Architecture: amd64

    Notare che per gli archivi normali senza la riga "NotAutomatic:
    yes", il valore predefinito per la priorità di Pin è 500, mentre
    per gli archivi speciali con "NotAutomatic: yes", il valore
    predefinito per la priorità di Pin è 1 (vedere apt_preferences(5)
    e Sezione 2.7.3, «Modificare la versione candidata»).

%

2.5.4. Recuperare i metadati per un pacchetto

    Quando si usano strumenti APT, quali aptitude, apt-get, synaptic,
    apt-file, auto-apt, … è necessario aggiornare le copie locali dei
    metadati contenenti le informazioni sull'archivio Debian. Queste
    copie locali hanno i seguenti nomi di file che corrispondono ai
    nomi di distribuzione, area e architettura specificati in "/etc/
    apt/sources.list" (vedere Sezione 2.1.4, «Nozioni di base sugli
    archivi Debian»).

      * "/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribuzione>_Release"

      * "/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribuzione>_Release.gpg"

      * "/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribuzione>_<area>_binary-<architettura>_Packages"

      * "/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribuzione>_<area>_source_Sources"

      * "/var/cache/apt/apt-file/deb.debian.org_debian_dists_
        <distribuzione>_Contents-<architettura>.gz" (per apt-file)

    I primi quattro tipi di file sono condivisi da tutti i comandi
    APT pertinenti e vengono aggiornati dalla riga di comando con
    "apt-get update" e "aptitude update". I metadati "Packages" sono
    aggiornati se esiste la riga "deb" in "/etc/apt/sources.list". I
    metadati "Sources" sono aggiornati se esiste la riga "deb-src" in
    "/etc/apt/sources.list".

    I metadati "Packages" e "Sources" contengono la voce "Filename:"
    che punta alla posizione dei file dei pacchetti binari e
    sorgenti. Attualmente questi pacchetti sono posizionati
    nell'albero di directory "pool/" per una transizione migliore tra
    i rilasci.

    Le copie locali dei metadati "Packages" possono essere ricercate
    interattivamente con l'aiuto di aptitude. Il comando
    specializzato di ricerca grep-dctrl(1) può cercare nelle copie
    locai dei metadati "Packages" e "Sources".

    La copia locale dei metadati "Contents-<architettura>" può essere
    aggiornata con "apt-file update" e la sua posizione è diversa da
    quella degli altri quattro file. Vedere apt-file(1). (auto-apt
    usa in modo predefinito una posizione differente per la copia
    locale di "Contents-<architettura>.gz".)

%

2.5.5. Lo stato dei pacchetti per APT

    In aggiunta ai metadati recuperati da remoto, lo strumento APT, a
    partire da lenny, memorizza le informazioni generate localmente
    sullo stato delle installazioni in "/var/lib/apt/extended_states"
    che è usato da tutti gli strumenti APT per tenere traccia dei
    pacchetti installati automaticamente.

%

2.5.6. Lo stato dei pacchetti per aptitude

    In aggiunta ai metadati recuperati da remoto, il comando aptitude
    memorizza le informazioni generate localmente sullo stato delle
    installazioni in "/var/lib/aptitude/pkgstates" che è usato solo
    da esso.

%

2.5.7. Copie locali dei pacchetti scaricati

    Tutti i pacchetti scaricati da remoto attraverso il meccanismo
    APT vengono salvati nella directory "/var/cache/apt/archives"
    fino a che non vengono cancellati.

    Questa politica di pulizia dei file della cache per aptitude può
    essere impostata in "Opzioni" → "Preferenze" e può essere forzata
    usando la sua voce di menu "Pulisci la cache dei pacchetti" o
    "Cancella i file vecchi" in "Azioni".

%

2.5.8. Nomi dei file di pacchetto di Debian

    I file di pacchetto Debian hanno nomi con una particolare
    struttura.

    Tabella 2.15. La struttura dei nomi dei pacchetti Debian

    +---------------------------------------------------------------+
    |     tipo di pacchetto     |        struttura del nome         |
    |---------------------------+-----------------------------------|
    |                           |<nome-pacchetto>_                  |
    |Il pacchetto binario (alias|<versione-originale gt;-           |
    |deb)                       |<versione-debian>_                 |
    |                           |<architettura>.deb                 |
    |---------------------------+-----------------------------------|
    |Il pacchetto binario per   |<nome-pacchetto>_                  |
    |l'installatore Debian      |<versione-originale>-              |
    |(alias udeb)               |<versione-debian>_                 |
    |                           |<architettura>.udeb                |
    |---------------------------+-----------------------------------|
    |Il pacchetto sorgente      |<nome-pacchetto>_                  |
    |(sorgenti originali)       |<versione-originale>-              |
    |                           |<versione-debian>.orig.tar.gz      |
    |---------------------------+-----------------------------------|
    |Il pacchetto sorgente 1.0  |<nome-pacchetto>_                  |
    |(modifiche Debian)         |<versione-originale>-              |
    |                           |<versione-debian>.diff.gz          |
    |---------------------------+-----------------------------------|
    |Il pacchetto sorgente 3.0  |<nome-pacchetto>_                  |
    |(quilt) (modifiche Debian) |<versione-originale>-              |
    |                           |<versione-debian>.debian.tar.gz    |
    |---------------------------+-----------------------------------|
    |Il pacchetto sorgente      |<nome-pacchetto>_                  |
    |(descrizione)              |<versione-originale>-              |
    |                           |<versione-debian>.dsc              |
    +---------------------------------------------------------------+


    Suggerimento
   
    Sono qui descritti solamente i formati base dei pacchetti
    sorgenti. Per ulteriori informazioni vedere dpkg-source(1).

    Tabella 2.16. I caratteri utilizzabili all'interno di ciascuna
    porzione del nome dei pacchetti Debian

    +---------------------------------------------------------------+
    |   nome porzione    |     caratteri utilizzabili     |presenza |
    |                    |     (espressione regolare)     |         |
    |--------------------+--------------------------------+---------|
    |<nome-pacchetto>    |[a-z,A-Z,0-9,.,+,-]+            |richiesta|
    |--------------------+--------------------------------+---------|
    |<epoca>:            |[0-9]+:                         |opzionale|
    |--------------------+--------------------------------+---------|
    |<versione-originale>|[a-z,A-Z,0-9,.,+,-,:]+          |richiesta|
    |--------------------+--------------------------------+---------|
    |<versione.debian>   |[a-z,A-Z,0-9,.,+,~]+            |opzionale|
    +---------------------------------------------------------------+


    Nota

    Si può controllare l'ordine delle versioni dei pacchetti con dpkg
    (1), per esempio con "dpkg --compare-versions 7.0 gt 7.~pre1 ;
    echo $?".

    Nota

    L'installatore Debian (d-i) usa come estensione per i suoi
    pacchetti binari udeb invece della normale deb. Un pacchetto udeb
    è un pacchetto deb ridotto al minimo, con rimossi alcuni
    contenuti non essenziali come la documentazione, per risparmiare
    spazio seguendo meno rigorosamente i requisiti richiesti dalle
    norme per i pacchetti. Entrambi i pacchetti deb e udeb
    condividono la stessa struttura di pacchetto. La "u" sta per
    micro.

%

2.5.9. Il comando dpkg

    dpkg(1) è lo strumento di più basso livello per la gestione dei
    pacchetti Debian. È molto potente e deve essere usato con
    cautela.

    Quando installa un pacchetto chiamato "<nome_pacchetto>", dpkg fa
    nell'ordine elencato le seguenti operazioni.

     1. Spacchetta il file deb (equivalente di "ar -x")

     2. Esegue "<nome_pacchetto>.preinst" usando debconf(1)
   
     3. Installa il contenuto del pacchetto nel sistema (equivalente
        di "tar -x")

     4. Esegue "<nome_pacchetto>.postinst" usando debconf(1)

    Il sistema debconf fornisce un'interazione standard con l'utente
    con supporto per internazionalizzazione e localizzazione (
    Capitolo 8, I18N e L10N).

    Tabella 2.17. I file degni di nota creati da dpkg

    +---------------------------------------------------------------+
    |           file           |     descrizione del contenuto      |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |elenco di file di configurazione    |
    |<nome_pacchetto>.conffiles|(modificabile dall'utente)          |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |elenco dei file e delle directory   |
    |<nome_pacchetto>.list     |installate dal pacchetto            |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |elenco dei valori degli hash MD5 per|
    |<nome_pacchetto>.md5sums  |i file installati dal pacchetto     |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |script del pacchetto da eseguire    |
    |<nome_pacchetto>.preinst  |prima dell'installazione del        |
    |                          |pacchetto                           |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |script del pacchetto da eseguire    |
    |<nome_pacchetto>.postinst |dopo l'installazione del pacchetto  |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |script del pacchetto da eseguire    |
    |<nome_pacchetto>.prerm    |prima della rimozione del pacchetto |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |script del pacchetto da eseguire    |
    |<nome_pacchetto>.postrm   |dopo la rimozione del pacchetto     |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/info/       |script per il sistema debconf       |
    |<nome_pacchetto>.config   |                                    |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/alternatives|informazioni sulle alternative usate|
    |/<nome_pacchetto>         |dal comando update-alternatives     |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/available   |informazioni sulla disponibilità per|
    |                          |tutti i pacchetti                   |
    |--------------------------+------------------------------------|
    |                          |le informazioni sulle deviazioni    |
    |/var/lib/dpkg/diversions  |usate da dpkg(1) e impostate da     |
    |                          |dpkg-divert(8)                      |
    |--------------------------+------------------------------------|
    |                          |le informazioni per la              |
    |/var/lib/dpkg/statoverride|sovrascrittura dello stato usate da |
    |                          |dpkg(1) e impostate da              |
    |                          |dpkg-statoverride(8)                |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/status      |le informazioni sullo stato per     |
    |                          |tutti i pacchetti                   |
    |--------------------------+------------------------------------|
    |/var/lib/dpkg/status-old  |la prima generazione di backup del  |
    |                          |file "var/lib/dpkg/status"          |
    |--------------------------+------------------------------------|
    |                          |la seconda generazione e le         |
    |/var/backups/dpkg.status* |generazioni precedenti di backup del|
    |                          |file "var/lib/dpkg/status"          |
    +---------------------------------------------------------------+


    Il file "status" è anche usato da altri strumenti come dpkg(1):
    "dselect update" e "apt-get -u dselect-upgrade".

    Il comando di ricerca specializzato grep-dctrl(1) può ricercare
    nelle copie locali dei metadati "status" e "available".

    Suggerimento

    Nell'ambiente dell'installatore Debian, viene usato il comando
    udpkg per aprire i pacchetti udeb. Il comando udpkg è una
    versione ridotta al minimo del comando dpkg.

%

2.5.10. Il comando update-alternatives

    Il sistema Debian ha un meccanismo per installare senza problemi
    programmi che si sovrappongono nelle loro funzioni usando 
    update-alternatives(1). Per esempio, si può far sì che il comando
    vi esegua vim quando si sono installati entrambi i pacchetti vim
    e nvi.

    $ ls -l $(type -p vi)
    lrwxrwxrwx 1 root root 20 2007-03-24 19:05 /usr/bin/vi -> /etc/alternatives/vi
    $ sudo update-alternatives --display vi
    ...
    $ sudo update-alternatives --config vi
      Selezione    Percorso
     ----------------------------------------------
          1        /usr/bin/vim
    *+    2        /usr/bin/nvi

    Premere Invio per mantenere il valore predefinito[*] o digitare il numero della selezione: 1

    Il sistema delle alternative Debian mantiene le proprie selezioni
    in forma di collegamenti simbolici in "/etc/alternatives/". Il
    procedimento di selezione usa i file corrispondenti in "/var/lib/
    dpkg/alternatives/".

%

2.5.11. Il comando dpkg-statoverride

    La sovrascrittura dello stato fornita dal comando 
    dpkg-statoverride(8) è un modo per dire a dpkg(1) di usare un
    proprietario o una modalità diversa per un file quando viene
    installato un pacchetto. Se viene specificato "--update" e il
    file esiste già, viene immediatamente impostato con il
    prorpietario e la modalità nuovi.

    Attenzione

    La modifica diretta del proprietario o della modalità, usando
    chmod o chown, di un file che appartiene ad un pacchetto da parte
    dell'amministratore del sistema viene vanificata dal successivo
    aggiornamento del pacchetto.

    Nota

    È stata usata la parola file, ma in realtà si può trattare di un
    qualsiasi oggetto nel file system gestito da dpkg, inclusi
    directory, device, ecc.

%

2.5.12. Il comando dpkg-divert

    Le deviazioni per i file fornite dal comando dpkg-divert(8) sono
    un modo per forzare dpkg(1) a non installare un file nella sua
    posizione predefinita, ma in una posizione deviata. L'uso di
    dpkg-divert è pensato per gli script di manutenzione dei
    pacchetti. Il suo uso in maniera superficiale da parte
    dell'amministratore di sistema è deprecato.

%

2.6. Ripristino da un sistema con problemi

    Quando si usa il sistema unstable, l'amministratore deve saper
    ripristinare le cose da una situazione problematica di gestione
    dei pacchetti.

    Attenzione
   
    Alcuni dei metodi descritti comportano azioni ad alto rischio. Ci
    si consideri avvertiti!

%

2.6.1. Incompatibilità con vecchie configurazioni utente

    Se un programma con interfaccia grafica per il desktop presenta
    problemi di instabilità dopo un importante aggiornamento della
    versione originale, si dovrebbero sospettare interferenze con
    vecchi file locali di configurazione creati da esso. Se è stabile
    per account utente creati da zero, questa ipotesi è confermata.
    (Questo è un bug nella creazione del pacchetto e viene
    solitamente evitato dal curatore del pacchetto.)

    Per ripristinare la stabilità, si dovrebbero spostare i
    corrispondenti file locali di configurazione e riavviare il
    programma GUI. Potrebbe essere necessario leggere il contenuto
    dei vecchi file di configurazione per ripristinare
    successivamente le informazioni di configurazione. (Non
    cancellarli troppo di fretta.)

%

2.6.2. Pacchetti diversi con file sovrapposti

    I sistemi di gestione dei pacchetti a livello dell'archivio, come
    aptitude(8) o apt-get(1) non provano nemmeno ad installare
    pacchetti con file sovrapposti, basandosi sulle dipendenze dei
    pacchetti (vedere Sezione 2.1.6, «Dipendenze dei pacchetti»).

    Errori dei manutentori dei pacchetti o l'uso di fonti degli
    archivi mescolate in modo incoerente (vedere Sezione 2.7.2,
    «Pacchetti da fonti mescolate di archivi») dall'amministratore di
    sistema possono creare una situazione con dipendenze dei
    pacchetti non correttamente definite. Quando, in una situazione
    di questo tipo, si installa un pacchetto con file sovrapposti
    usando aptitude(8) o apt-get(1), dpkg(1) che spacchetta i
    pacchetti si assicura di restituire un errore al programma che lo
    ha invocato senza sovrascrivere file esistenti.

    Attenzione

    L'uso di pacchetti di terze parti introduce significativi rischi
    per il sistema attraverso gli script dei manutentori che sono
    eseguiti con privilegi di root e che possono fare qualsiasi cosa
    nel sistema. Il comando dpkg(1) protegge solo contro la
    sovrascrittura in fase di spacchettamento.

    Si possono risolvere installazioni problematiche di questo tipo
    rimuovendo prima il vecchio pacchetto che crea problemi:
    <vecchio-pacchetto>.

    $ sudo dpkg -P <vecchio-pacchetto>

%

2.6.3. Risolvere problemi negli script di pacchetto

    Quando un comando nello script di un pacchetto restituisce un
    errore per una qualche ragione e lo script finisce con un errore,
    il sistema di gestione dei pacchetti cancella l'azione e finisce
    con pacchetti parzialmente installati. Quando un pacchetto
    contiene bug nei suoi script di rimozione, il pacchetto può
    diventare impossibile da rimuovere e fonte di problemi.

    Per i problemi di script di pacchetto di "<nome_pacchetto>", si
    dovrebbe guardare negli script di pacchetto seguenti.

      * "/var/lib/dpkg/info/<nome_pacchetto>.preinst"

      * "/var/lib/dpkg/info/<nome_pacchetto>.postinst"
   
      * "/var/lib/dpkg/info/<nome_pacchetto>.prerm"

      * "/var/lib/dpkg/info/<nome_pacchetto>.postrm"

    Modificare dall'account root lo script di pacchetto che causa
    problemi usando le tecniche seguenti.

      * disabilitare la riga che causa problemi facendola precedere
        da "#"
   
      * forzare la restituzione di esecuzione con successo
        aggiungendo in fondo alla riga che causa problemi "|| true"

    Configurare tutti i pacchetti parzialmente installati con il
    comando seguente.

    # dpkg --configure -a

%

2.6.4. Ripristinare con il comando dpkg

    Dato che dpkg è uno strumento per pacchetti a livello molto
    basso, può funzionare anche in situazioni molto brutte come un
    sistema non avviabile senza una connessione di rete. Assumiamo,
    per esempio, che il pacchetto pippo sia difettoso e debba essere
    sostituito.

    Si possono trovare copie di versioni più vecchie del pacchetto
    pippo, libere dal bug, nella directory della cache dei pacchetti:
    «/var/cache/apt/archives/». (Se non ci sono, se ne può scaricare
    una dall'archivio di https://snapshot.debian.org/ o copiarla
    dalla cache dei pacchetti di una macchina funzionante.)

    Se si può avviare il sistema, lo si può installare con il comando
    seguente.

    # dpkg -i /percorso/di/pippo_<vecchia_versione>_<arch>.deb

    Suggerimento

    Se il danno al sistema è piccolo, si può in alternativa
    retrocedere tutto il sistema ad una versione precedente come in
    Sezione 2.7.10, «Retrocessione di emergenza alla versione
    precedente», usando il sistema di più alto livello APT.

    Se il sistema non è avviabile dal disco fisso, si dovrebbe
    cercare un altro modo per fare l'avvio.

     1. Avviare il sistema usando il CD dell'installatore Debian in
        modalità ripristino.

     2. Montare il sistema non avviabile sul disco fisso in "/
        destinazione".

     3. Installare una versione più vecchia del pacchetto pippo con
        il comando seguente.

    # dpkg --root /destinazione -i /percorso/di/pippo_<vecchia_versione>_<arch>.deb

    Questo esempio funziona persino se il comando dpkg sul disco
    fisso è danneggiato.

    Suggerimento

    Per ripristinare il sistema danneggiato, può essere usato in modo
    simile qualsiasi sistema GNU/Linux avviato da un altro sistema
    sul disco fisso, CD live GNU/Linux, chiavetta USB avviabile o
    avvio di rete.

    Se il tentativo di installare un pacchetto in questo modo
    fallisce a causa di qualche violazione di dipendenze e si deve
    necessariamente farlo come ultima spiaggia, si possono
    sovrascrivere le dipendenze usando "--ignore-depends",
    "--force-depends" e altre opzioni di dpkg. Se lo si fa, è
    necessario in seguito fare tutti gli sforzi possibili per
    ripristinare le dipendenze corrette. Per i dettagli vedere dpkg
    (8).

    Nota

    Se il sistema è seriamente danneggiato, se ne dovrebbe fare un
    backup completo in un posto sicuro (vedere Sezione 10.2, «Backup
    e ripristino») e fare un'installazione pulita. Ciò comporta meno
    perdita di tempo e alla fine produce un risultato migliore.

%

2.6.5. Ripristinare i dati sui pacchetti selezionati

    Se "/var/lib/dpkg/status" diventa corrotto per una qualsiasi
    ragione, il sistema Debian perde i dati sulla selezione dei
    pacchetti e ne ha grave danno. Cercare il vecchio file "/var/lib/
    dpkg/status" in "/var/lib/dpkg/status-old" o "/var/backups/
    dpkg.status.*".

    Mantenere "/var/backups/" in una partizione separata può essere
    una buona idea dato che questa directory contiene molti dati
    importanti per il sistema.

    Per danni molto seri, raccomando di fare una re-installazione
    pulita dopo aver fatto il backup del sistema. Anche se tutto ciò
    che era in "/var/" è andato perduto, è sempre possibile
    recuperare alcune informazioni dalle directory in "/usr/share/doc
    /" per guidare le nuove installazioni.

    Reinstallare un sistema (desktop) minimale

    # mkdir -p /percorso/del/vecchio/sistema

    Montare il vecchio sistema in "percorso/del/vecchio/sistema/".

    # cd /percorso/del/vecchio/sistema/usr/share/doc
    # ls -1 >~/ls1.txt
    # cd /usr/share/doc
    # ls -1 >>~/ls1.txt
    # cd
    # sort ls1.txt | uniq | less

    Verranno mostrati i nomi dei pacchetti da installare. (Ci
    potrebbero essere alcuni nomi non di pacchetto, come "texmf".)

2.7. Suggerimenti per la gestione dei pacchetti

%

2.7.1. Come scegliere i pacchetti Debian

    Si possono cercare i pacchetti che soddisfano i propri bisogni
    con aptitude in base alla descrizione del pacchetto o dall'elenco
    in "Task".

    Quando si incontrano più di due pacchetti simili e non si sa
    quale installare senza doverli installare per prova, si dovrebbe
    usare un po' di buon senso. Considero i punti seguenti un buon
    consiglio per i paccchetti da preferire.

      * Essenziale: sì > no

      * Area: main > contrib > non-free

      * Priorità: richiesto > importante > standard > opzionale >
        extra

      * Task: pacchetti elencati in task come "Ambiente desktop"

      * Pacchetti selezionati da pacchetti di dipendenze (es,
        python2.4 selezionato da python)
   
      * Popcon: maggior numero di voti e di installazioni

      * Changelog: aggiornamenti regolari da parte del manutentore

      * BTS: nessun bug RC (nessun bug critico, grave o serio)

      * BTS: manutentore sensibile alle segnalazioni di bug

      * BTS: maggior numero di bug risolti di recente

      * BTS: minor numero di bug rimanenti non wishlist

    Essendo Debian un progetto di volontari con modello di sviluppo
    distribuito, i suoi archivi contengono molti pacchetti con scopi
    e qualità molto differenti. Si deve scegliere con la propria
    testa che uso farne.

%

2.7.2. Pacchetti da fonti mescolate di archivi

    Attenzione

    Installare pacchetti da fonti mescolate di archivi non è
    supportato dalla distribuzione Debian ufficiale, tranne che per
    particolari combinazioni supportate ufficialmente, come stable
    con security updates e bullseye-updates.

    Ecco un esempio di operazioni da fare per includere,
    sporadicamente, versioni originali più recenti di specifici
    pacchetti presenti in unstable pur mantenendo testing.

     1. Cambiare temporaneamente il file "/etc/apt/sources.list" ad
        una singola voce "unstable".

     2. Eseguire "aptitude update".

     3. Eseguire "aptitude install <nome-pacchetto>".

     4. Ripristinare il file "/etc/apt/sources.list" originale per
        testing.

     5. Eseguire "aptitude update".

    Con questo approccio manuale non si deve creare il file "/etc/apt
    /preferences" né ci si deve preoccupare dei pin di apt. Ma è
    piuttosto laborioso.

    Attenzione

    Quando si usano fonti di archivi mescolate, si deve assicurare la
    compatibilità tra i pacchetti da soli, dato che Debian non la
    garantisce. Se esistono incompatibilità tra i pacchetti, si può
    danneggiare il sistema. Si deve essere in grado di giudicare
    queste esigenze tecniche. L'uso di fonti mescolate di archivi non
    correlati è una modalità di funzionamento del tutto facoltativa e
    il suo uso non è per nulla raccomandato.

    Le regole generali per installare pacchetti da archivi diversi
    sono le seguenti.

      * L'installazione di pacchetti non binari ("Architecture: all")
        è più sicura.

          + pacchetti di documentazione: nessun requisito particolare

          + pacchetti programma per interpreti: deve essere
            disponibile un interprete compatibile

      * L'installazione di pacchetti binari (non "Architecture: all")
        di solito comporta molte difficoltà e non è sicura.
   
          + compatibilità di versione con librerie (inclusa "libc")

          + compatibilità di versione con programmi applicativi
            correlati

          + compatibilità con l'ABI del kernel

          + compatibilità con l'ABI C++

          + …

    Nota

    Per rendere l'installazione di un pacchetto più sicura, possono
    essere forniti alcuni pacchetti binari applicativi commerciali
    non liberi con librerie completamente statiche. Si dovrebbe anche
    per essi controllare in ogni caso la compatibilità con ABI, ecc.

    Nota

    Installare pacchetti binari da archivi non ufficialmente
    supportati è generalmente una cattiva idea, tranne che per
    evitare pacchetti danneggiati per un breve tempo. Questo è vero
    anche se si usano i pin di APT (vedere Sezione 2.7.3, «Modificare
    la versione candidata»). Si dovrebbe considerare chroot o
    tecniche simili (vedere Sezione 9.10, «Sistema virtualizzato»)
    per eseguire programmi da archivi differenti.

%

2.7.3. Modificare la versione candidata

    Senza il file "/etc/apt/preferences", il sistema APT sceglie la
    versione più recente disponibile come versione candidata usando
    la stringa di versione. Questa è la situazione normale e l'uso
    raccomandato del sistema APT. Tutte le combinazioni di archivi
    supportate ufficialmente non necessitano del file "/etc/apt/
    preferences", dato che gli archivi che non dovrebbero essere
    usati come fonti automatica per gli aggiornamenti sono marcati
    come NotAutomatic e trattati in modo appropriato.

    Suggerimento

    La regola di comparazione della stringa di versione può essere
    verificata con, ad esempio, "dpkg --compare-versions ver1.1 gt
    ver1.1~1; echo $?" (vedere dpkg(1)).

    Quando si installano regolarmente pacchetti da fonti di archivi
    mescolate (vedere Sezione 2.7.2, «Pacchetti da fonti mescolate di
    archivi»), si possono automatizzare queste operazioni complicate
    creando il file "/etc/apt/preferences" con le voci appropriate e
    modificando la regola di selezione dei pacchetti per le versioni
    candidate come descritto in apt_preferences(5). Questo è chiamato
    usare i pin di APT.

    Avvertimento

    L'uso dei pin di APT da parte di un utente inesperto è una fonte
    sicura di grossi problemi. Si dovrebbe evitare l'uso dei pin di
    APT se non strettamente necessario.

    Attenzione

    Quando si usano i pin di APT si deve assicurare la compatibilità
    dei pacchetti da soli dato che Debian non la garantisce. L'uso
    dei pin di APT è una modalità di funzionamento del tutto
    facoltativa e il suo uso non è per nulla consigliato.

    Attenzione

    Per le regole di apt_preferences(5) sono usati i file Release a
    livello di archivio (vedere Sezione 2.5.3, «File "Release" a
    livello di archivio»). I pin di APT perciò funzionano solo con il
    nome della "suite" per i normali archivi Debian e per gli archivi
    di sicurezza Debian. (Ciò è diverso per gli archivi Ubuntu.) Per
    esempio nel file "/etc/apt/preferences" si può usare "Pin:
    release a=unstable", ma non "Pin: release a=sid".

    Attenzione

    Quando si usano archivi non Debian con i pin di APT si dovrebbe
    controllare quale sia il loro scopo e la loro credibilità. Ubuntu
    e Debian, per esempio, non sono fatti per essere mescolati.

    Nota

    Anche se non si crea il file "/etc/apt/preferences" si possono
    fare operazioni piuttosto complesse (vedere Sezione 2.6.4,
    «Ripristinare con il comando dpkg» e Sezione 2.7.2, «Pacchetti da
    fonti mescolate di archivi») senza l'uso dei pin di APT.

    Quella che segue è una spiegazione semplificata delluso dei pin
    di APT.

    Il sistema APT sceglie, dalle fonti per i pacchetti disponibili
    definite nel file "/etc/apt/sources.list", il pacchetto di 
    aggiornamento con la priorità di pin più elevata come versione
    candidata del pacchetto. Se la priorità di pin del pacchetto è
    maggiore di 1000, la restrizione a versioni di aggiornamento non
    viene considerata per permettere la retrocessione ad una versione
    precedente (vedere Sezione 2.7.10, «Retrocessione di emergenza
    alla versione precedente»).

    Il valore della priorità di pin per ciascun pacchetto è definito
    dalle voci "Pin-Priority" nel file "/etc/apt/preferences o viene
    usato il valore predefinito.

    Tabella 2.18. Elenco di valori di priorità di pin che
    esemplificano la tecnica d'uso dei pin di APT.

    +---------------------------------------------------------------+
    |Priorità |        Effetti del pin di APT sul pacchetto         |
    | di pin  |                                                     |
    |---------+-----------------------------------------------------|
    |1001     |installa il pacchetto anche se ciò costituisce il    |
    |         |ritorno ad una versione precedente                   |
    |---------+-----------------------------------------------------|
    |990      |usato come valore predefinito per l'archivio del     |
    |         |rilascio prescelto                                   |
    |---------+-----------------------------------------------------|
    |500      |usato come valore predefinito per l'archivio normale |
    |---------+-----------------------------------------------------|
    |100      |usato come valore predefinito per l'archivio         |
    |         |NonAutomatico e MaConAggiornamentiAutomatici         |
    |---------+-----------------------------------------------------|
    |100      |usato per i pacchetti installati                     |
    |---------+-----------------------------------------------------|
    |1        |usato come valore predefinito per l'archivio         |
    |         |NonAutomatico                                        |
    |---------+-----------------------------------------------------|
    |-1       |non installa mai il pacchetto nemmeno se raccomandato|
    +---------------------------------------------------------------+


    L'archivio del rilascio definito può essere impostato in svariati
    modi.

      * nel file di configurazione "/etc/apt/apt.conf" con la riga
        "APT::Default-Release "stable";"
   
      * con l'opzione per la riga di comando, ad esempio, "apt-get
        install -t testing qualche-pacchetto"

    Gli attributi di archivio NonAutomatico e 
    MaConAggiornamentiAutomatici vengono impostati dal server
    dell'archivio che ha il file Release a livello di archivio
    (vedere Sezione 2.5.3, «File "Release" a livello di archivio»)
    che contiene sia "NotAutomatic: yes" sia "ButAutomaticUpgrades:
    yes". L'archivio NonAutomatico viene impostato dal server
    dell'archivio che ha il file Release a livello di archivio che
    contiene solamente "NotAutomatic: yes".

    La situazione dei pin di APT di <pacchetto> da diverse fonti di
    archivi viene mostrata con "apt-cache policy <pacchetto>".

      * Una riga che inizia con "pacchetto pin:" elenca la versione
        del pacchetto di pin se è definita un'associazione specifica
        per <pacchetto>, ad esempio "Package pin: 0.190".

      * Non esiste alcuna riga con "Package pin:" se non è definita
        alcuna associazione solamente con <pacchetto>.

      * Il valore di priorità di pin associato solamente con
        <pacchetto> viene mostrato alla destra di tutte le sringhe di
        versione, ad esempio "0.181 700".

      * Se non è definita un'associazione specifica con <pacchetto>
        viene mostrato "0" alla destra di tutte le stringhe di
        versione.

      * I valori di priorità di pin degli archivi (definiti come
        "Package: *" nel file "/etc/apt/preferences") sono elencati
        alla sinistra di tutti i percorsi di archivio, ad esempio
        "100 http://deb.debian.org/debian/bullseye-backports/main
        Packages".

%

2.7.4. Updates e Backports

    Esistono gli archivi di bullseye-updates e backports.debian.org
    che forniscono pacchetti di aggiornamento per stable (bullseye).

    Per usare questi archivi, si devono elencare tutti quelli
    richiesti nel file "/etc/apt/sources.list" nel modo seguente.

    deb http://deb.debian.org/debian/ bullseye main contrib non-free
    deb http://security.debian.org/ bullseye/updates main contrib
    deb http://deb.debian.org/debian/ bullseye-updates main contrib non-free
    deb http://deb.debian.org/debian/ bullseye-backports main contrib non-free

    Non è necessario impostare esplicitamente un valore di priorità
    di pin nel file "/etc/apt/preferences". Quando nuovi pacchetti
    diventano disponibili, la configurazione predefinita fornisce gli
    aggiornamenti più ragionevoli (vedere Sezione 2.5.3, «File
    "Release" a livello di archivio»).

      * Tutti i vecchi pacchetti installati vengono aggiornati con
        quelli più nuovi da bullseye-updates.
   
      * Solo i vecchi pacchetti installati manualmente da
        bullseye-backports vengono aggiornati a quelli più nuovi da
        bullseye-backports.

    Ogni volta che si desidera installare manualmente un pacchetto
    chiamato "<nome-pacchetto>" con le sue dipendenze dall'archivio
    bullseye-backports, usare questo comando che sposta il rilascio
    stabilito con l'opzione "-t".

    $ sudo apt-get install -t bullseye-backports <nome-pacchetto>

%

2.7.5. Bloccare i pacchetti da installare perché "Raccomandati"

    Se non si desidera installare pacchetti particolari richiamati
    automaticamente perché "Raccomandati", è necessario creare il
    file "/etc/apt/preferences" ed elencarvi esplicitamente
    all'inizio tutti quei pacchetti nel modo seguente.

    Package: <package-1>
    Pin: version *
    Pin-Priority: -1
   
    Package: <package-2>
    Pin: version *
    Pin-Priority: -1

%

2.7.6. Usare e aggiornare testing con alcuni pacchetti da unstable

    Quello che segue è un esempio di uso dei pin di APT per includere
    pacchetti specifici con versioni originali più recenti presenti
    in unstable aggiornandoli regolarmente pur mantenendo testing. Si
    devono elencare nel file "/etc/apt/sources.list" tutti gli
    archivi necessari nel modo seguente.

    deb http://deb.debian.org/debian/ testing main contrib non-free
    deb http://deb.debian.org/debian/ unstable main contrib non-free
    deb http://security.debian.org/ testing/updates main contrib

    Impostare il file "/etc/apt/preferences" come segue.

    Package: *
    Pin: release a=unstable
    Pin-Priority: 100

    Quando, con questa configurazione, si desidera installare un
    pacchetto chiamato "<nome-pacchetto>" con le sue dipendenze
    dall'archivio unstable, usare il comando seguente che cambia il
    rilascio definito con l'opzione "-t" (la priorità di pin di
    unstable diventa 990).

    $ sudo apt-get install -t unstable <nome-pacchetto>

    Con quessta configurazione, la normale esecuzione di "apt-get
    upgrade" e "apt-get dist-upgrade" (o "aptitude safe-upgrade" e
    "aptitude full-upgrade") aggiorna i pacchetti che erano stati
    installati dall'archivio testing usando l'attuale archivio
    testing e i pacchetti che erano stati installati dall'archivio
    unstable usando l'attuale archivio unstable.

    Attenzione

    Fare attenzione a non rimuovere la voce "testing" dal file "/etc/
    apt/sources.list". Senza di essa il sistema APT aggiorna i
    pacchetti usando l'archivio unstable più recente.

    Suggerimento

    Io di solito modifico il file "/etc/apt/sources.list per
    commentare le voci relative all'archivio "unstable immediatamente
    dopo l'azione descritta sopra. Questo evita il rallentamento del
    processo di aggiornamento dovuto a troppe voci nel file "/etc/apt
    /sources.list" anche se impedisce l'aggiornamento, usando
    l'attuale archivio unstable dei pacchetti che erano stati
    installati dall'archivio unstable.

    Suggerimento

    Se viene usato "Pin-Priority: 1" invece di "Pin-Priority: 100"
    nel file "/etc/apt/preferences", i pacchetti già installati che
    hanno 100 come valore della priorità di pin, non vengono
    aggiornati dall'archivio unstable nemmeno se viene rimossa la
    voce "testing" dal file "/etc/apt/sources.list".

    Se si desidera tenere traccia automaticamente di particolari
    pacchetti in unstable senza l'iniziale installazione con "-t
    unstable", si deve creare il file "/etc/apt/preferences" ed
    elencarvi esplicitamente tutti i pacchetti voluti nel modo
    seguente.

    Package: <pacchetto-1>
    Pin: release a=unstable
    Pin-Priority: 700
   
    Package: <pacchetto-2>
    Pin: release a=unstable
    Pin-Priority: 700

    Questo imposta il valore della priorità di pin per ciascun
    pacchetto specifico. Per esempio, per tenere traccia della
    versione più recente in unstable di questo manuale "Debian
    Reference" in inglese, si dovrebbero avere, nel file "/etc/apt/
    preferences" le voci seguenti.

    Package: debian-reference-en
    Pin: release a=unstable
    Pin-Priority: 700
   
    Package: debian-reference-common
    Pin: release a=unstable
    Pin-Priority: 700

    Suggerimento

    Questo modo di usare i pin di APT è valido anche quando si segue
    l'archivio stable. Per la mia esperienza, installare i pacchetti
    di documentazione dall'archivio unstable è sempre sicuro.

2.7.7. Usare e aggiornare unstable con alcuni pacchetti da
experimental

    Quello che segue è un esempio di uso dei pin di APT per includere
    pacchetti specifici con versioni originali più recenti presenti
    in experimental pur mantenendo unstable. Si devono elencare nel
    file "/etc/apt/sources.list" tutti gli archivi necessari nel modo
    seguente.

    deb http://deb.debian.org/debian/ unstable main contrib non-free
    deb http://deb.debian.org/debian/ experimental main contrib non-free
    deb http://security.debian.org/ testing/updates main contrib

    Il valore predefinito della priorità di pin per l'archivio
    experimental è sempre 1 (<<100) dato che è un archivio Non
    automatico (vedere Sezione 2.5.3, «File "Release" a livello di
    archivio»). Per usare semplicemente l'archivio experimental non
    c'è alcun bisogno di impostare il valore di priorità di pin
    esplicitamente nel file "/etc/apt/preferences", a meno che non si
    desideri aggiornare automaticamente da esso in futuro particolari
    pacchetti.

%

2.7.8. Scaricare ed aggiornare automaticamente i pacchetti

    Il pacchetto apt viene fornito con il proprio script di cron, "/
    etc/cron.daily/apt" per permettere di scaricare automaticamente i
    pacchetti. Questo script può essere migliorato, installando il
    pacchetto unattended-upgrades, per effettuare l'aggiornamento
    automatico dei pacchetti. Può essere personalizzato dai parametri
    in "/etc/apt/apt.conf.d/02backup" e "/etc/apt/apt.conf.d/
    50unattended-upgrades" come descritto in "/usr/share/doc/
    unattended-upgrades/README".

    Il pacchetto "unattended-upgrades è pensato principalmente per
    gli aggiornamenti di sicurezza del sistema stable. Se il rischio
    di danneggiare un sistema stable esistente con gli aggiornamenti
    automatici è minore di quello che il sistema venga danneggiato da
    un intruso, usando una falla nella sicurezza chiusa
    dall'aggiornamento di sicurezza, si dovrebbe considerare l'uso di
    questi aggiornamenti automatici con parametri simili ai seguenti.

    APT::Periodic::Update-Package-Lists "1";
    APT::Periodic::Download-Upgradeable-Packages "1";
    APT::Periodic::Unattended-Upgrade "1";

    Se si sta usando un sistema unstable, non è bene usare gli
    aggiornamenti automatici perché certamente prima o poi
    danneggeranno il sistema. Anche per unstable però, per
    risparmiare tempo nell'aggiornamento interattivo, si può volere
    scaricare i pacchetti in anticipo usando parametri di
    configurazione come i seguenti.

    APT::Periodic::Update-Package-Lists "1";
    APT::Periodic::Download-Upgradeable-Packages "1";
    APT::Periodic::Unattended-Upgrade "0";

%

2.7.9. Limitare l'uso di banda di APT per gli scaricamenti

    Se si desidera limitare l'uso della banda da parte di APT per gli
    scaricamenti, per esempio a 800Kib/sec (=100kiB/sec), si devono
    usare i parametri di configurazione di APT nel modo seguente.

    APT::Acquire::http::Dl-Limit "800";

%

2.7.10. Retrocessione di emergenza alla versione precedente

    Attenzione

    La retrocessione ad una versione precedente non è ufficialmente
    supportata da Debian. Dovrebbe essere fatta solamente come parte
    di un processo di ripristino di emergenza. Nonostante questo è
    noto che funziona bene in caso di molti incidenti. Per i sistemi
    critici, si dovrebbe fare un backup di tutti i dati importanti
    sul sistema dopo l'operazione di ripristino e reinstallare un
    nuovo sistema da zero.

    Si potrebbe essere fortunati e riuscire a retrocedere da un
    archivio più recente ad uno più vecchio per ripristinare un
    aggiornamento di sistema andato male, manipolando le versioni
    candidate (vedere Sezione 2.7.3, «Modificare la versione
    candidata»). Questa è l'alternativa pigra al lavoro tedioso di
    dover usare molti comandi "dpkg -i <pacchetto-danneggiato>_
    <vecchia-versione>.deb" (vedereSezione 2.6.4, «Ripristinare con
    il comando dpkg»).

    Cercare le righe nel file "/etc/apt/sources.list" che rimandano a
    unstable, come la seguente.

    deb http://deb.debian.org/debian/ sid main contrib non-free

    Sostituirle con la seguente per puntare a testing.

    deb http://deb.debian.org/debian/ bookworm main contrib non-free

    Impostare il file "/etc/apt/preferences" come segue.

    Package: *
    Pin: release a=testing
    Pin-Priority: 1010

    Eseguire "apt-get update; apt-get dist-upgrade" per forzare la
    retrocessione dei pacchetti in tutto il sistema.

    Rimuovere questo file speciale "/etc/apt/preferences" dopo la
    retrocessione di emergenza.

    Suggerimento

    È una buona idea rimuovere (non eliminare completamente!) il
    maggior numero di pacchetti per minimizzare i problemi di
    dipendenza. Potrebbe essere necessario rimuovere o installare
    manualmente alcuni pacchetti per retrocedere il sistema. Il
    kernel Linux, il bootloader, udev, PAM, APT e i pacchetti
    relativi alla rete ed i loro file di configurazione richiedono
    particolare attenzione.

%

2.7.11. Chi ha caricato il pacchetto?

    Anche se i nomi dei manutentori elencati in "/var/lib/dpkg/
    available" e"/usr/share/doc/package_name/changelog" forniscono
    alcune informazioni su "chi stia dietro la pacchettizzazione",
    l'identità di chi ha effettivamente caricato il pacchetto è un
    po' oscura. who-uploads(1) nel pacchetto devscripts identifica
    l'effettivo autore del caricamento dei pacchetti sorgenti Debian.

%

2.7.12. Il pacchetto equivs

    Se si ha intenzione di compilare un programma dai sorgenti per
    rimpiazzare un pacchetto Debian, la cosa migliore è creare un
    vero pacchetto debianizzato locale (*.deb) e usare un archivio
    privato.

    Se si sceglie di compilare un programma dai sorgenti e di
    installarlo invece in "/usr/local", si può usare equivs come
    ultima spiaggia per soddisfare le dipendenze mancanti del
    pacchetto.

    Package: wi
    Priority: optional
    Section: admin
    Description-it: aggira le dipendenze dei pacchetti Debian
     Questo pacchetto fornisce uno strumento per creare pacchetti Debian banali.
     Tipicamente questi pacchetti contengono solo informazioni di dipendenza, ma
     possono anche includere file installati normalmente come fanno gli altri
     pacchetti..
     .
     Uno degli usi è quello di creare un metapacchetto: un pacchetto il cui
     unico scopo è di dichiarare le dipendenze e i conflitti con altri
     pacchetti in modo che questi saranno installati, aggiornati o rimossi
     automaticamente.
     .
     Un altro uso è quello di aggirare il controllo delle dipendenze: facendo
     credere a dpkg che sia installata una specifica versione di un dato
     pacchetto quando in realtà non lo è, si possono aggirare dei bug nelle
     dipendenze di altri pacchetti.
     (Si continui a segnalare però questi tipi di bug.)

%

2.7.13. Fare il port di un pacchetto nel sistema stabile

    Per aggiornamenti parziali del sistema stable, è una buona idea
    ricompilare un pacchetto, usando il pacchetto sorgente,
    all'interno del suo ambiente. Questo evita massicci aggiornamenti
    di pacchetti a causa delle dipendenze.

    Aggiungere le voci seguenti al file "/etc/apt/sources.list" di un
    sistema stable.

    deb-src http://deb.debian.org/debian unstable  main contrib non-free

    Installare i pacchetti richiesti per la compilazione e scaricare
    il pacchetto sorgente, come nell'esempio seguente.

    # apt-get update
    # apt-get dist-upgrade
    # apt-get install fakeroot devscripts build-essential
    # apt-get build-dep pippo
    $ apt-get source pippo
    $ cd pippo*

    Aggiornare alcuni pacchetti con catene di strumenti come dpkg e
    debhelper dai pacchetti backport se sono necessari per fare il
    backport.

    Eseguire quanto segue.

    $ dch -i

    Incrementare la versione del pacchetto, ad esempio aggiungendo
    "+bp1" in "debian/changelog"

    Compilare i pacchetti ed installarli nel sistema nel modo
    seguente.

    $ debuild
    $ cd ..
    # debi pippo*.changes

%

2.7.14. Server proxy per APT

    Dato che fare il mirror di intere sottosezioni dell'archivio
    Debian spreca spazio su disco e banda, l'utilizzo di un server
    proxy locale per APT è una buona idea quando si amministrano
    molti sistemi in una LAN. APT può essere configurato per usare
    server proxy web generici (http), quale squid (vedere
    Sezione 6.10, «Altri server di rete») come descritto in apt.confo
    (5) ed in "/usr/share/doc/apt/examples/configure-index.gz". La
    variabile d'ambiente "$http_proxy" può essere usata per
    scavalcare l'impostazione del server proxy nel file "/etc/apt/
    apt.conf".

    Ci sono strumenti proxy specifici per l'archivio Debian. Prima di
    usarli si dovrebbe contollare il BTS.

    Tabella 2.19. Elenco degli strumenti proxy specifici per
    l'archivio Debian

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|          descrizione          |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |server proxy con cache per i   |
    |approx       |I:0   |6317      |file di archivio Debian        |
    |             |      |          |(programma OCaml compilato)    |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |proxy con cache per file di    |
    |apt-cacher   |I:0   |289       |pacchetto e sorgenti Debian    |
    |             |      |          |(programma Perl)               |
    |-------------+------+----------+-------------------------------|
    |             |      |          |proxy con cache per la         |
    |apt-cacher-ng|V:5,  |1488      |distribuzione di pacchetti     |
    |             |I:5   |          |software (programma in C++     |
    |             |      |          |compilato)                     |
    +---------------------------------------------------------------+


    Attenzione

    Quando Debian riorganizza la struttura del suo archivio, questi
    strumenti proxy specializzati tendono ad aver bisogno di ritocchi
    al codice da parte del manutentore del pacchetto e possono non
    essere funzionanti per un po' di tempo. D'altra parte i server
    proxy web generici (http) sono più robusti e gestiscono questi
    cambiamenti più facilmente.

%

2.7.15. Piccolo archivio pubblico per i pacchetti

    Suggerimento

    Impostare manualmente un archivio di pacchetti è complicato. Sono
    disponibili diversi strumenti di gestione di repository. Un
    elenco esaustivo è disponibile online.

    Ecco una dimostrazione di come creare manualmente un piccolo
    archivio pubblico di pacchetti compatibile con il sistema APT
    sicuro (vedere Sezione 2.5.2, «File "Release" nella directory
    principale ed autenticità»). Consideriamo la situazione seguente.

      * Nome account: "pippo"

      * Nome host: "www.esempio.com"

      * Pacchetti necessari: apt-utils, gnupg ed altri

      * URL: "http://www.esempio.com/~pippo/" ( → "/home/pippo/
        public_html/index.html")

      * Architettura dei pacchetti: "amd64"

    Creare una chiave per l'archivio APT di Pippo nel sistema server,
    nel modo seguente.

    $ ssh pippo@www.esempio.com
    $ gpg --gen-key
    ...
    $ gpg -K
    ...
    sec   1024D/3A3CB5A6 2008-08-14
    uid                  Pippo (ARCHIVE KEY) <pippo@www.esempio.com>
    ssb   2048g/6856F4A7 2008-08-14
    $ gpg --export -a 3A3CB5A6 >pippo.public.key

    Pubblicare il file della chiave dell'archivio per Pippo,
    "pippo.public.key", con l'ID di chiave "3A3CB5A6"

    Creare un albero di archivio chiamato "Origin: Pippo", nel modo
    seguente.

    $ umask 022
    $ mkdir -p ~/public_html/debian/pool/main
    $ mkdir -p ~/public_html/debian/dists/unstable/main/binary-amd64
    $ mkdir -p ~/public_html/debian/dists/unstable/main/source
    $ cd ~/public_html/debian
    $ cat > dists/unstable/main/binary-amd64/Release << EOF
    Archive: unstable
    Version: 4.0
    Component: main
    Origin: Pippo
    Label: Pippo
    Architecture: amd64
    EOF
    $ cat > dists/unstable/main/source/Release << EOF
    Archive: unstable
    Version: 4.0
    Component: main
    Origin: Pippo
    Label: Pippo
    Architecture: source
    EOF
    $ cat >aptftp.conf <<EOF
    APT::FTPArchive::Release {
      Origin "Pippo";
      Label "Pippo";
      Suite "unstable";
      Codename "sid";
      Architectures "amd64";
      Components "main";
      Description "Archivio pubblico di Pippo";
    };
    EOF
    $ cat >aptgenerate.conf <<EOF
    Dir::ArchiveDir ".";
    Dir::CacheDir ".";
    TreeDefault::Directory "pool/";
    TreeDefault::SrcDirectory "pool/";
    Default::Packages::Extensions ".deb";
    Default::Packages::Compress ". gzip bzip2";
    Default::Sources::Compress "gzip bzip2";
    Default::Contents::Compress "gzip bzip2";

    BinDirectory "dists/unstable/main/binary-amd64" {
      Packages "dists/unstable/main/binary-amd64/Packages";
      Contents "dists/unstable/Contents-amd64";
      SrcPackages "dists/unstable/main/source/Sources";
    };

    Tree "dists/unstable" {
      Sections "main";
      Architectures "amd64 source";
    };
    EOF

    Si possono automatizzare aggiornamenti regolari del contenuto
    dell'archivio APT nel proprio sistema server configurando
    dupload.

    Mettere tutti i file pacchetto in "~pippo/public_html/debian/pool
    /main/" eseguendo "dupload -t pippo changes_file" nel client ed
    avendo il file "~/.dupload.conf" che contiene quanto segue.

    $cfg{'pippo'} = {
      fqdn => "www.esempio.com",
      method => "scpb",
      incoming => "/home/pippo/public_html/debian/pool/main",
      # dinstall su ftp-master invia esso stesso email
      dinstall_runs => 1,
    };
   
    $cfg{'pippo'}{postupload}{'changes'} = "
      echo 'cd public_html/debian ;
      apt-ftparchive generate -c=aptftp.conf aptgenerate.conf;
      apt-ftparchive release -c=aptftp.conf dists/unstable >dists/unstable/Release ;
      rm -f dists/unstable/Release.gpg ;
      gpg -u 3A3CB5A6 -bao dists/unstable/Release.gpg dists/unstable/Release'|
      ssh pippo@www.esempio.com  2>/dev/null ;
      echo 'Archivio dei pacchetti creato!'";

    Lo script automatico postupload avviato da dupload(1) crea file
    di archivio aggiornati per ciascun caricamento.

    Si può aggiungere questo piccolo archivio pubblico nelle righe di
    apt del proprio sistema client con i comandi seguenti.

    $ sudo bash
    # echo "deb http://www.esempio.com/~pippo/debian/ unstable main" \
       >> /etc/apt/sources.list
    # apt-key add pippo.public.key

    Suggerimento
   
    Se l'archivio si trova sul file system locale, si può usare
    invece "deb file:///home/pippo/debian/ …".

%

2.7.16. Registrare e copiare la configurazione di sistema

    Si può creare una copia locale dello stato delle selezioni dei
    pacchetti e di debconf nel modo seguente

    # dpkg --get-selections '*' > selection.dpkg
    # debconf-get-selections    > selection.debconf

    In questo esempio "*" fa sì che "selection.dpkg" includa anche le
    voci dei pacchetti "eliminati".

    Questi 2 file possono essere trasferiti su un altro computer ed i
    pacchetti installati lì con i comandi seguenti.

    # dselect update
    # debconf-set-selections < miaselezione.debconf
    # dpkg --set-selections  < miaselezione.dpkg
    # apt-get -u dselect-upgrade    # o dselect install

    Se si ha in progetto di gestire molti server in un cluster con
    praticamente la stessa configurazione, si dovrebbe considerare
    l'uso di pacchetti specifici come fai per gestire l'intero
    sistema.

%

2.7.17. Convertire o installare un pacchetto binario alieno

    alien(1) permette la conversione di pacchetti binari forniti in
    file in formato Red Hat rpm, Stampede slp, Slackware tgz e
    Solaris pkg in pacchetti Debian deb. Se si vuole usare un
    pacchetto da una distribuzione Linux diversa da quella installata
    sul proprio sistema, si può usare alien per convertire il formato
    di pacchetto ed installarlo. alien supporta anche pacchetti LSB.

    Avvertimento

    alien(1) non dovrebbe essere usato per rimpiazzare pacchetti di
    sistema essenziali, come sysvinit, libc66, libpam-modules, ecc.
    In pratica, alien(1) dovrebbe essere usato solamente per
    pacchetti solo-binari non-free che sono conformi a LSB o con link
    statico. Per i software liberi si dovrebbero usare i loro
    pacchetti sorgenti per creare veri pacchetti Debian.

%

2.7.18. Estrarre pacchetti senza dpkg

    In qualsiasi ambiente *nix i contenuti di un pacchetto
    "dpkg*.deb" possono essere estratti senza usare dpkg(1)
    utilizzando le utilità standard ar(1) e tar(1).

    # ar x /percorso/di/dpkg_<versione>_<arch>.deb
    # ls
    total 24
    -rw-r--r-- 1 bozo bozo  1320 2007-05-07 00:11 control.tar.gz
    -rw-r--r-- 1 bozo bozo 12837 2007-05-07 00:11 data.tar.gz
    -rw-r--r-- 1 bozo bozo     4 2007-05-07 00:11 debian-binary
    # mkdir control
    # mkdir data
    # tar xvzf control.tar.gz -C control
    # tar xvzf data.tar.gz -C data

    I contenuti degli altri pacchetti «*.deb»possono essere estratti
    come descritto sopra dal comando dpkg-deb(1) ottenuto dal
    pacchetto «dpkg*.deb», oppure usando in modo simile a prima lo
    standard ar(1) e il più nuovo GNU tar(1) con il supporto per la
    decompressione xz(1).

    Si può anche navigare il contenuto del pacchetto usando il
    comando mc.

%

2.7.19. Ulteriori letture sulla gestione dei pacchetti

    Si possono ottenere molte altre informazioni sulla gestione dei
    pacchetti dalla documentazione seguente.

      * Documentazione principale sulla gestione dei pacchetti:

          + aptitude(8), dpkg(1), tasksel(8), apt(8), apt-get(8), 
            apt-config(8), apt-key(8), sources.list(5), apt.conf(5) e
            apt_preferences(5);

          + "/usr/share/doc/apt-doc/guide.html/index.html" e "/usr/
            share/doc/apt-doc/offline.html/index.html" dal pacchetto
            apt-doc e

          + "/usr/share/doc/aptitude/html/en/index.html" dal
            pacchetto aptitude-doc-en.

      * Documentazione ufficiale dettagliata sull'archivio Debian:
   
          + "Manuale Debian Policy, capitolo 2 - L'archivio Debian",

          + "Debian Developer's Reference, capitolo 4 - Risorse per
            gli sviluppatori Debian, 4.6 L'archivio Debian" e

          + "FAQ Debian GNU/Linux, capitolo 6 - Gli archivi FTP
            Debian".

      * Tutorial per gli utenti Debian sulla creazione di un
        pacchetto Debian:

          + «Debian New Maintainers' Guide».

          + «Guida per i manutentori Debian».

Capitolo 3. Inizializzazione del sistema

    È bene che l'amministratore di sistema conosca almeno a grandi
    linee come viene avviato e configurato il sistema Debian. Anche
    se i dettagli precisi sono nei file sorgenti dei pacchetti
    installati e nella loro documentazione, essi sono un po' troppo
    per la maggior parte degli utenti.

    Ho cercato di fornire una veloce panoramica dei punti chiave del
    sistema Debian e della loro configurazione, come punto di
    riferimento per l'utente, in base alle conoscenze attuali e
    passate mie e di altri. Dato che il sistema Debian è in costante
    evoluzione, la situazione potrebbe essere cambiata. Prima di fare
    qualsiasi modifica al sistema, si dovrebbe far riferimento alla
    documentazione più recente per ciascun pacchetto.

    Suggerimento
   
    bootup(7) descrive il processo di avvio del sistema basato su
    systemd (Debian recenti).

    Suggerimento
   
    boot(7) descrive il processo di avvio del sistema basato su UNIX
    System V Release 4 (Debian più vecchie).

%

3.1. Panoramica del processo di avvio

    Il sistema del computer passa attraverso varie fasi del processo
    di avvio, dall'accensione a quando offre all'utente il sistema
    operativo (SO) pienamente funzionante.

    Per semplicità la spiegazione è limitata alla piattaforma PC
    tipica con l'installazione standard.

    Il normale processo di avvio è come un razzo a quattro stadi.
    Ogni stadio del razzo passa il controllo del sistema allo stadio
    successivo.

      * Sezione 3.1.1, «Stadio 1: il BIOS»

      * Sezione 3.1.2, «Stadio 2: il bootloader»
   
      * Sezione 3.1.3, «Stadio 3: il mini-sistema Debian»

      * Sezione 3.1.4, «Stadio 4: il normale sistema Debian»

    Naturalmente questo può essere configurato in modo diverso. Per
    esempio, se è stato compilato un kernel personalizzato, si
    potrebbe saltare la fase con il mini-sistema Debian. Non dare per
    scontato che quanto detto valga per il proprio sistema fino a che
    non si abbia controllato direttamente.

    Nota

    Per piattaforme PC non sorpassate, come il sistema SUN o
    Macintosh, il BIOS nella ROM e la partizione sul disco possono
    essere alquanto differenti (Sezione 9.5.2, «Configurazione del
    partizionamento dei dischi»). In questi casi, cercare la
    documentazione piattaforma specifica altrove.

%

3.1.1. Stadio 1: il BIOS

    Il BIOS è il primo stadio del processo di avvio che viene avviato
    dall'accensione. Il BIOS, che risiede nella ROM (read only
    memory, memoria in sola lettura) è eseguito da un particolare
    indirizzo di memoria al quale è inizializzato, dall'accensione,
    il contatore di programma della CPU.

    Il BIOS effettua l'inizializzazione base dell'hardware (POST
    (power on self test, auto-test di accensione) e passa il
    controllo del sistema allo stadio successivo fornito dall'utente.
    Il BIOS è di solito fornito con l'hardware.

    La schermata di avvio del BIOS indica solitamente quale tasto o
    tasti premere per entrare nella schermata di impostazioni del
    BIOS, per configurarne il comportamento. Tasti comunemente usati
    sono F1, F2, F10, Esc, Ins e Canc. Se la schermata di avvio del
    BIOS è nascosta da una bella schermata grafica, si può premere
    dei tasti, come Esc, per disabilitarla. Quali tasti vadano
    premuti dipende fortemente dall'hardware.

    Dalla schermata di impostazioni del BIOS si può scegliere la
    posizione hardware e la priorità del codice avviato dal BIOS.
    Tipicamente vengono caricati in memoria i primi pochi settori del
    primo dispositivo selezionato trovato (disco fisso, dischetto
    floppy, CD-ROM, ...) e viene eseguito questo codice iniziale che
    può essere una qualsiasi tra le cose seguenti.

      * Il codice del bootloader

      * Il codice del kernel di SO di passaggio come FreeDOS

      * Il codice del kernel del sistema operativo finale, se può
        essere contenuto in questo piccolo spazio

    Tipicamente il sistema viene avviato dalla partizione specificata
    del disco fisso primario. I primi 2 settori del disco fisso nei
    PC vecchi contengono ilmaster boot record (MBR). Le informazioni
    sulle partizioni del disco, inclusa la selezione per l'avvio sono
    memorizzate alla fine di questo MBR. Il primo codice boot loader
    eseguito dal BIOS occupa la parte restante di questo MBR.

%

3.1.2. Stadio 2: il bootloader

    Il bootloader è il secondo stadio del processo di avvio che è
    iniziato dal BIOS. Carica l'immagine kernel del sistema e
    l'immagine initrd in memoria e passa il controllo ad essi.
    L'immagine initrd è l'immagine del file system radice ed il suo
    supporto dipende dal bootloader usato.

    Il sistema Debian normalmente usa il kernel Linux come kernel
    predefinito del sistema. L'immagine initrd dell'attuale kernel
    Linux 2.6/3.x è tecnicamente l'immagine initramfs (initial RAM
    filesystem, file system RAM iniziale). L'immagine initrd di base
    è un archivio cpio compresso dei file nel file system root. Il
    kernel può aggiornare microcodice nelle primissime fasi
    dell'avvio prima di caricare l'immagine initrd di base. Ciò è
    facilitato dall'immagine initrd combinata che è un frammento di
    microcodice binario in formato cpio non compresso seguito
    dall'immagine initrd di base.

    Suggerimento

    Si può ispezionare il contenuto del file di immagine initrd
    usando lsinitramfs(8) e unmkinitramfs(8) dal pacchetto
    initramfs-tools-core. Vedere ulteriori informazioni su https://
    wiki.debian.org/initramfs.

    L'installazione predefinita del sistema Debian posiziona, per la
    piattaforma PC, il codice di primo stadio del bootloader GRUB
    nell'MBR. Sono disponibili molti bootloader e opzioni di
    configurazione.

    Tabella 3.1. Elenco di bootloader

    +--------------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|  initrd  |bootloader| descrizione |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Intelligente |
    |              |      |          |          |          |abbastanza da|
    |              |      |          |          |          |capire       |
    |grub-legacy   |V:0,  |735       |Supportato|GRUB      |partizioni su|
    |              |I:2   |          |          |Legacy    |disco e      |
    |              |      |          |          |          |filesystem   |
    |              |      |          |          |          |come vfat,   |
    |              |      |          |          |          |ext3, ...    |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Intelligente |
    |              |      |          |          |          |abbastanza da|
    |              |      |          |          |          |capire       |
    |              |V:28, |          |          |          |partizioni su|
    |grub-pc       |I:774 |533       |Supportato|GRUB 2    |disco e      |
    |              |      |          |          |          |filesystem   |
    |              |      |          |          |          |come vfat,   |
    |              |      |          |          |          |ext4, ….     |
    |              |      |          |          |          |(predefinito)|
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |È l'immagine |
    |              |      |          |          |          |di ripristino|
    |              |V:0,  |          |          |          |avviabile di |
    |grub-rescue-pc|I:1   |6367      |Supportato|GRUB 2    |GRUB 2 (CD e |
    |              |      |          |          |          |floppy)      |
    |              |      |          |          |          |(versione PC/|
    |              |      |          |          |          |BIOS)        |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Si basa sulla|
    |              |      |          |          |          |posizione dei|
    |lilo          |V:0,  |697       |Supportato|Lilo      |settori dei  |
    |              |I:2   |          |          |          |dati sul     |
    |              |      |          |          |          |disco fisso. |
    |              |      |          |          |          |(Vecchio)    |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Capisce il   |
    |              |V:4,  |          |          |          |filesystem   |
    |syslinux      |I:48  |343       |Supportato|Isolinux  |ISO 9660.    |
    |              |      |          |          |          |Usato dal CD |
    |              |      |          |          |          |di avvio.    |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Capisce il   |
    |              |      |          |          |          |filesystem   |
    |              |V:4,  |          |          |          |MSDOS (FAT). |
    |syslinux      |I:48  |343       |Supportato|Syslinux  |Usato dai    |
    |              |      |          |          |          |dischetti    |
    |              |      |          |          |          |floppy di    |
    |              |      |          |          |          |avvio.       |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Il nuovo     |
    |              |      |          |          |          |sistema viene|
    |loadlin       |V:0,  |90        |Supportato|Loadlin   |avviato dal  |
    |              |I:1   |          |          |          |sistema      |
    |              |      |          |          |          |FreeDOS/     |
    |              |      |          |          |          |MSDOS.       |
    |--------------+------+----------+----------+----------+-------------|
    |              |      |          |          |          |Software     |
    |              |      |          |          |          |libero che   |
    |              |V:0,  |          |Non       |MBR di    |sostituisce  |
    |mbr           |I:7   |50        |supportato|Neil      |MBR MSDOS.   |
    |              |      |          |          |Turton    |Capisce solo |
    |              |      |          |          |          |le partizioni|
    |              |      |          |          |          |su disco.    |
    +--------------------------------------------------------------------+


    Avvertimento

    Non mettere mano ai bootloader senza aver creato supporti
    avviabili di ripristino (chiavette USB, CD o floppy) create da
    immagini nel pacchetto grub-rescue-pc. Questo permette di avviare
    il sistema anche senza un bootloader funzionante sul disco fisso.

    Per GRUB Legacy, il file di configurazione del menu è "/boot/grub
    /menu.lst". Contiene, per esempio, delle voci come quella
    seguente.

    title           Debian GNU/Linux
    root            (hd0,2)
    kernel          /vmlinuz root=/dev/hda3 ro
    initrd          /initrd.img

    Per GRUB 2, il file di configurazione del menu è "/boot/grub/
    grub.cfg". Viene generato automaticamente da "/usr/sbin/
    update-grub" usando modelli da "/etc/grub.d/*" e impostazioni da
    "/etc/default/grub". Contiene, per esempio, delle voci come
    quella seguente.

    menuentry "Debian GNU/Linux" {
            set root=(hd0,3)
            linux /vmlinuz root=/dev/hda3
            initrd /initrd.img
    }

    Negli esempi precedenti i parametri di GRUB hanno i seguenti
    significati.

    Tabella 3.2. Significato dei parametri di GRUB

    +---------------------------------------------------------------+
    |parametro|                     significato                     |
    | di GRUB |                                                     |
    |---------+-----------------------------------------------------|
    |         |usa la terza partizione sul primo disco fisso        |
    |root     |indicandola come "(hd0,2)" in GRUB legacy o come "   |
    |         |(hd0,3)" in GRUB 2                                   |
    |---------+-----------------------------------------------------|
    |kernel   |usa il kernel che si trova in "/vmlinuz" con i       |
    |         |parametri "root=/dev/hda3 ro"                        |
    |---------+-----------------------------------------------------|
    |initrd   |usa l'immagine initrd/initramfs che si trova in "/   |
    |         |initrd.img"                                          |
    +---------------------------------------------------------------+


    Nota

    Il valore per il numero di partizione usato dal programma GRUB
    Legacy è minore di uno rispetto a quello normale usato dal kernel
    Linux e dagli strumenti di utilità. il programma GRUB 2 ha
    risolto questo problema.

    Suggerimento

    Per identificare un particolare dispositivo a blocchi si può
    usare il suo UUID (vedere Sezione 9.5.3, «Accedere alle
    partizioni usando UUID») invece del suo nome file come "/dev/
    hda3", ad esempio "root=UUID=81b289d5-4341-4003-9602-e254a17ac232
    ro".

    Suggerimento

    Se viene usato GRUB, il parametro di avvio del kernel viene
    impostato in /boot/grub/grub.cfg. Nei sistemi Debian non si
    dovrebbe modificare direttamente il file /boot/grub/grub.cfg. Si
    dovrebbe modificare il valore GRUB_CMDLINE_LINUX_DEFAULT in /etc/
    default/grub ed eseguire update-grub(8) per aggiornare /boot/grub
    /grub.cfg.

    Suggerimento
   
    Si può avviare un bootloader da un altro bootloader usando una
    tecnica chiamata caricamento a catena.

    Vedere "info grub" e grub-install(8).

%

3.1.3. Stadio 3: il mini-sistema Debian

    Il mini-sistema Debian è il terzo stadio del processo di avvio
    che viene iniziato dal bootloader. Esegue il kernel del sistema
    con il suo filesystem root in memoria. Questo è uno stadio
    opzionale preparatorio del processo di avvio.

    Nota

    L'espressione "sistema Debian mini" è stata coniata per
    descrivere il terzo stadio del processo di avvio in questo
    documento. Normalmente ci si riferisce a questo sistema come
    sistema initrd o initramfs. Un sistema simile in memoria è usato
    dall'installatore Debian.

    Il programma "/init" viene eseguito come primo programma in
    questo file system root in memoria. È un programma che
    inizializza il kernel in spazio utente e passa il controllo allo
    stadio successivo. Questo mini-sistema Debian offre flessibilità
    al processo di avvio, come la possibilità di aggiungere moduli
    del kernel prima del processo di avvio principale o di montare il
    file system root come cifrato.

      * Il programma "/init" è uno script di shell se initramfs è
        stato creato da initramfs-tools.

          + Si può interrompere questa parte del processo di avvio
            per ottenere una shell di root fornendo il parametro di
            avvio per il kernel "break=init" etc. Vedere lo script "/
            init" per ulteriori condizioni di interruzione. Questo
            ambiente shell è abbastanza sofisticato da fare una buona
            ispezione dell'hardware della macchina.
   
          + I comandi disponibili in questo mini-sistema Debian sono
            versioni minimali e vengono principalmente forniti da uno
            strumento GNU chiamato busybox(1).

      * Il programma "/init" è un programma binario di systemd se
        initramfs è stato creato da dracut.

          + I comandi disponibili in questo mini-sistema Debian sono
            un ambiente systemd(1) ridotto al minimo.

    Attenzione
   
    È necessario usare l'opzione "-n" per il comando mount quando si
    è nel filesystem root in sola lettura.

%

3.1.4. Stadio 4: il normale sistema Debian

    Il sistema Debian normale è il quarto stadio del processo di
    avvio che viene iniziato dal mini-sistema Debian. Il kernel di
    sistema del mini-sistema Debian continua ad essere in esecuzione
    anche in questo ambiente. Il filesystem root viene cambiato da
    quello in memoria all'effettivo filesystem sul disco fisso.

    Il programma init viene eseguito come primo programma con PID=1
    per effettuare il processo principale di avvio di far partire
    molti programmi. Il percorso di file predefinito per il programma
    init è «/sbin/init», ma può essere cambiato con un parametro di
    avvio del kernel come in «init=/percorso/del/programma_init».

    Il programma init predefinito ha subito cambiamenti:

      * Prima di squeeze Debian usava il semplice init in stile SysV.

      * Debian wheezy migliora l'init in stile SysV ordinando la
        sequenza con intestazioni LSB e avviando gli script di avvio
        in parallelo.

      * Debian jessie è passata come init predefinito a systemd per
        l'inizializzazione pilotata da eventi e in parallelo.

    Suggerimento
   
    Si può verificare quale è l'effettivo comando init nel proprio
    sistema con il comando «ps --pid 1 -f».

    Suggerimento
   
    "/sbin/init" è un collegamento simbolico a "/lib/systemd/systemd"
    da Debian jessie in avanti.

    Tabella 3.3. Elenco di utilità di avvio per il sistema Debian

    +---------------------------------------------------------------+
    |     pacchetto     |popcon|dimensione|       descrizione       |
    |-------------------+------+----------+-------------------------|
    |                   |V:810,|          |demone init(8) basato su |
    |systemd            |I:916 |15998     |eventi per concorrenza   |
    |                   |      |          |(alternativa a sysvinit) |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |le pagine di manuale e i |
    |systemd-sysv       |V:802,|138       |collegamenti necessari   |
    |                   |I:914 |          |affinché systemd         |
    |                   |      |          |sostituisca sysvinit     |
    |-------------------+------+----------+-------------------------|
    |                   |V:1,  |          |unità systemd per fornire|
    |systemd-cron       |I:1   |143       |il demone cron e la      |
    |                   |      |          |funzionalità anacron     |
    |-------------------+------+----------+-------------------------|
    |                   |V:675,|          |strumenti ausiliari per  |
    |init-system-helpers|I:930 |131       |commutare tra sysvinit e |
    |                   |      |          |systemd                  |
    |-------------------+------+----------+-------------------------|
    |initscripts        |V:91, |176       |script per inizializzare |
    |                   |I:323 |          |ed arrestare il sistema  |
    |-------------------+------+----------+-------------------------|
    |sysvinit-core      |V:7,  |276       |utilità init(8) in stile |
    |                   |I:9   |          |System-V                 |
    |-------------------+------+----------+-------------------------|
    |                   |V:183,|          |meccanismo di cambiamento|
    |sysv-rc            |I:335 |81        |del runlevel in stile    |
    |                   |      |          |System-V                 |
    |-------------------+------+----------+-------------------------|
    |                   |V:494,|          |utilità in stile System-V|
    |sysvinit-utils     |I:999 |79        |(startpar(8), bootlogd(8)|
    |                   |      |          |, …)                     |
    |-------------------+------+----------+-------------------------|
    |                   |V:881,|          |funzionalità di script   |
    |lsb-base           |I:999 |49        |init Linux Standard Base |
    |                   |      |          |3.2                      |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |strumento per organizzare|
    |insserv            |V:210,|150       |la sequenza di avvio     |
    |                   |I:330 |          |usando dipendenze LSB    |
    |                   |      |          |negli script init.d      |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |strumenti per usare la   |
    |uswsusp            |V:3,  |714       |sospensione software in  |
    |                   |I:8   |          |spazio utente fornita da |
    |                   |      |          |Linux                    |
    |-------------------+------+----------+-------------------------|
    |                   |V:1,  |          |strumento kexec per      |
    |kexec-tools        |I:8   |278       |riavvii kexec(8) (riavvio|
    |                   |      |          |a caldo)                 |
    |-------------------+------+----------+-------------------------|
    |                   |V:0,  |          |analizzatore delle       |
    |systemd-bootchart  |I:1   |128       |prestazioni del processo |
    |                   |      |          |di avvio                 |
    |-------------------+------+----------+-------------------------|
    |                   |V:0,  |          |analizzatore delle       |
    |bootchart2         |I:0   |94        |prestazioni del processo |
    |                   |      |          |di avvio                 |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |analizzatore delle       |
    |pybootchartgui     |V:0,  |177       |prestazioni del processo |
    |                   |I:0   |          |di avvio                 |
    |                   |      |          |(visualizzazione)        |
    |-------------------+------+----------+-------------------------|
    |mingetty           |V:0,  |38        |getty(8) solo console    |
    |                   |I:3   |          |                         |
    |-------------------+------+----------+-------------------------|
    |mgetty             |V:0,  |315       |rimpiazzio di getty(8)   |
    |                   |I:1   |          |per smart modem          |
    +---------------------------------------------------------------+


    Suggerimento

    Vedere la pagina del Wiki Debian sulla velocizzazione del
    processo di avvio per i più recenti suggerimenti su come
    velocizzare il processo di avvio.

%

3.2. Init systemd

    Questa sezione describe come viene avviato il sistema dal
    programma systemd(1) con PID=1 (cioè processo init).

    Il processo di init systemd lancia processi in parallelo sulla
    base dei file di configurazione delle unità (vedere systemd.unit
    (5)) che sono scritti in stile dichiarativo invece che in stile
    procedurale come per SysV. Sono caricati da un insieme di
    percorsi (vedere systemd-system.conf(5)) nel modo seguente:

      * "/lib/systemd/system": file di configurazione predefiniti del
        sistema operativo

      * "/etc/systemd/system": file di configurazione
        dell'amministratore di sistema che scavalcano i file di
        configurazione predefiniti del sistema operativo

      * "/run/systemd/system": file di configurazione generati al
        momento dell'esecuzione che scavalcano i file di
        configurazione installati

    Le loro inter-dipendenze sono specificate dalle direttive "Wants=
    ", "Requires=", "Before=", "After=", … (vedere "MAPPING OF UNIT
    PROPERTIES TO THEIR INVERSES" in systemd.unit(5)). Sono definiti
    anche i controlli delle risorse (vedere systemd.resource-control
    (5)).

    Il suffisso dei file di configurazione delle unità codifica il
    loro tipo in questo modo:

      * *.service descrive un processo controllato e supervisionato
        da systemd. Vedere systemd.service(5).

      * *.device descrive un device esposto in sysfs(5) come albero
        di device udev(7). Vedere systemd.device(5).

      * *.mount descrive un punto di mount del file system
        controllato e supervisionato da systemd. Vedere systemd.mount
        (5).

      * *.automount descrive un punto di mount automatico del file
        system controllato e supervisionato da systemd. Vedere 
        systemd.automount(5).

      * *.swap descrive un device o file di swap controllato e
        supervisionato da systemd. Vedere systemd.swap(5).

      * *.path descrive un percorso monitorato da systemd per
        l'attivazione basata su percorso. Vedere systemd.path(5).

      * *.socket descrive un socket controllato e supervisionato da
        systemd per l'attivazione basata su socket. Vedere 
        systemd.socket(5).

      * *.timer descrive un timer controllato e supervisionato da
        systemd per l'attivazione basata su timer. Vedere 
        systemd.timer(5).

      * *.slice gestisce risorse con cgroups(7). Vedere systemd.slice
        (5).

      * *.scope viene creato programmaticamente usando le interfacce
        di bus di systemd per gestire un insieme di processi di
        sistema. Vedere systemd.scope(5).

      * *.target raggruppa altri file di configurazione di unità per
        creare punti di sincronizzazione durante l'avvio. Vedere 
        systemd.target(5).

    All'avvio del sistema (cioè init) il processo systemd cerca di
    avviare "/lib/systemd/system/default.target" (normalmente un
    collegamento simbolico a "graphical.target"). Come prima cosa
    alcune speciali unità target (vedere systemd.special(7)) come
    "local-fs.target", "swap.target" e "cryptsetup.target" sono
    richiamate per montare i file system. Poi altre unità target
    vengono anch'esse richiamate dalle dipendenze delle unità target.
    Per i dettagli leggere bootup(7).

    systemd offre funzionalità di compatibilità all'indietro. Gli
    script di avvio in stile SysV in "/etc/init.d/rc[0123456S].d/[KS]
    <name>" sono comunque analizzati e telinit(8) viene tradotto in
    richieste di attivazione di unità systemd.

    Attenzione
   
    Run level emulati da 2 a 4 hanno tutti collegamenti simbolici al
    corrispondente "multi-user.target".

%

3.2.1. Il nome host

    Il kernel gestisce il nome host del sistema. L'unità systemd
    avviata dasystemd-hostnamed.service imposta il nome host del
    sistema all'avvio al nome memorizzato in "/etc/hostname". Questo
    file dovrebbe contenere solamente il nome host del sistema, non
    un nome di dominio pienamente qualificato.

    Per visualizzare il nome host attuale eseguire hostname(1) senza
    alcun argomento.

%

3.2.2. Il filesystem

    Le opzioni usate per montare i file system normali dei dischi e
    di rete sono impostate in "/etc/fstab". Vedere fstab(5) e
    Sezione 9.5.7, «Ottimizzare il file system con opzioni di mount».

    La configurazione dei file system cifrati è impostata in "/etc/
    crypttab". Vedere crypttab(5)

    Vedere wvdial(1) e wvdial.conf(5).

    Avvertimento
   
    Dopo aver montato tutti i filesystem, i file temporanei in "/
    tmp", "/var/lock" e "/var/run" vengono ripuliti ad ogni avvio.

%

3.2.3. Inizializzazione delle interfacce di rete

    Le interfacce di rete sono tipicamente inizializzate in
    "networking.service" per l'interfaccia lo e
    "NetworkManager.service" per le altre interfacce nei moderni
    sistemi desktop Debian che usano systemd.

    Vedere Capitolo 5, Impostazione della rete per come configurarle.

%

3.2.4. I messaggi del kernel

    I messaggi di errore del kernel visualizzati nella console
    possono essere configurati impostando il loro livello di soglia.

    # dmesg -n3

    Tabella 3.4. Elenco dei livelli di errore del kernel

    +---------------------------------------------------------------+
    |valore del livello | nome del livello |      significato       |
    |     di errore     |    di errore     |                        |
    |-------------------+------------------+------------------------|
    |0                  |KERN_EMERG        |il sistema è            |
    |                   |                  |inutilizzabile          |
    |-------------------+------------------+------------------------|
    |1                  |KERN_ALERT        |bisogna agire           |
    |                   |                  |immediatamente          |
    |-------------------+------------------+------------------------|
    |2                  |KERN_CRIT         |condizione critica      |
    |-------------------+------------------+------------------------|
    |3                  |KERN_ERR          |condizione di errore    |
    |-------------------+------------------+------------------------|
    |4                  |KERN_WARNING      |condizione di           |
    |                   |                  |avvertimento            |
    |-------------------+------------------+------------------------|
    |5                  |KERN_NOTICE       |condizione normale ma   |
    |                   |                  |significativa           |
    |-------------------+------------------+------------------------|
    |6                  |KERN_INFO         |messaggio informativo   |
    |-------------------+------------------+------------------------|
    |7                  |KERN_DEBUG        |messaggio a livello di  |
    |                   |                  |debug                   |
    +---------------------------------------------------------------+


%

3.2.5. I messaggi di sistema

    Sotto systemd sia i messaggi del kernel sia quelli di sistema
    sono registrati nei log dal servizio journal
    systemd-journald.service (alias journald) o in dati binari
    persistenti dentro "/var/log/journal" o in dati binari volatili
    dentro "/run/log/journal/". A questi dati binari di log si può
    accedere tramite il comando journalctl(1).

    Sotto systemd l'utilità di log del sistema rsyslogd(8) cambia il
    proprio comportamento per leggere i dati di log vinari volatili
    (invece dello standard pre-systemd "/dev/log") e per creare dati
    di log di sistema ASCII tradizionali permanenti.

    I messaggi di sistema possono essere personalizzati da "/etc/
    default/rsyslog" e "/etc/rsyslog.conf" sia per il file di
    registro sia per la visualizzazione a schermo. Vedere rsyslogd(8)
    e rsyslog.conf(5). Vedere anche Sezione 9.2.2, «Analizzatori di
    registro».

%

3.2.6. Gestione del sistema sotto systemd

    systemd offre non solo un sistema init, ma anche funzionalità
    generiche di gestione del sistema, come registrazione di log,
    gestione dei login, gestione del tempo e della rete, ecc.

    systemd(1) è gestito da vari comandi:

      * il comando systemctl(1) controlla il gestore di sistemi e
        servizi systemd (CLI),

      * il comando systemsdm(1) controlla il gestore di sistemi e
        servizi systemd (GUI),

      * il comando journalctl(1) interroga il giornale di log di
        systemd,

      * il comando loginctl(1) controlla il gestore di login di
        systemd e

      * systemd-analyze(1) analizza le prestazioni di avvio del
        sistema.

    Ecco un elenco di esempi di comandi tipici per la gestione di
    systemd.

    Tabella 3.5. Elenco di tipici esempi di comandi per gestione di
    systemd

    +---------------------------------------------------------------+
    |           Operazione           |  Tipo  | Esempio di comando  |
    |--------------------------------+--------+---------------------|
    |                                |        |"systemadm"          |
    |GUI per gestore del servizio    |GUI     |(pacchetto           |
    |                                |        |systemd-ui)          |
    |--------------------------------+--------+---------------------|
    |Elencare tutte le configurazioni|Unità   |"systemctl list-units|
    |delle unità target              |        |--type=target"       |
    |--------------------------------+--------+---------------------|
    |Elencare tutte le configurazioni|Unità   |"systemctl list-units|
    |delle unità service             |        |--type=service"      |
    |--------------------------------+--------+---------------------|
    |Elencare tutti i tipi di        |Unità   |"systemctl list-units|
    |configurazioni delle unità      |        |--type=help"         |
    |--------------------------------+--------+---------------------|
    |Elencare tutte le unità socket  |Unità   |"systemctl           |
    |in memoria                      |        |list-sockets"        |
    |--------------------------------+--------+---------------------|
    |Elencare tutte le unità timer in|Unità   |"systemctl           |
    |memoria                         |        |list-timers"         |
    |--------------------------------+--------+---------------------|
    |Avviare "$unit"                 |Unità   |"systemctl start     |
    |                                |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Fermare "$unit"                 |Unità   |"systemctl stop      |
    |                                |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Ricaricare la configurazione    |Unità   |"systemctl reload    |
    |specifica di un servizio        |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Fermare e riavviare tutte le    |Unità   |"systemctl restart   |
    |"$unit"                         |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Avviare "$unit" e fermare tutte |Unità   |"systemctl isolate   |
    |le altre                        |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Passare alla modalità           |Unità   |"systemctl isolate   |
    |"graphical" (sistema GUI)       |        |graphical"           |
    |--------------------------------+--------+---------------------|
    |Passare alla modalità           |Unità   |"systemctl isolate   |
    |"multi-user" (sistema CLI)      |        |multi-user"          |
    |--------------------------------+--------+---------------------|
    |Passare alla modalità "rescue"  |Unità   |"systemctl isolate   |
    |(sistema CLI a singolo utente)  |        |rescue"              |
    |--------------------------------+--------+---------------------|
    |Inviare il segnale kill a       |Unità   |"systemctl kill      |
    |"$unit"                         |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Controllare se il servizio      |Unità   |"systemctl is-active |
    |"$unit" è attivo                |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Controllare se il servizio      |Unità   |"systemctl is-failed |
    |"$unit" è fallito               |        |$unit"               |
    |--------------------------------+--------+---------------------|
    |Controllare lo stato di "$unit| |Unità   |"systemctl status    |
    |$PID|device"                    |        |$unit|$PID|$device"  |
    |--------------------------------+--------+---------------------|
    |Mostrare le proprietà di "$unit||Unità   |"systemctl show $unit|
    |$job"                           |        ||$job"               |
    |--------------------------------+--------+---------------------|
    |Ripristinare "$unit" fallita    |Unità   |"systemctl           |
    |                                |        |reset-failed $unit"  |
    |--------------------------------+--------+---------------------|
    |Elencare le dipendenze di tutti |        |"systemctl           |
    |i servizi unità                 |Unità   |list-dependencies    |
    |                                |        |--all"               |
    |--------------------------------+--------+---------------------|
    |Elencare i file di unità        |File    |"systemctl           |
    |installati sul sistema          |unità   |list-unit-files"     |
    |--------------------------------+--------+---------------------|
    |Abilitare "$unit" (aggiungere   |File    |"systemctl enable    |
    |collegamento simbolico)         |unità   |$unit"               |
    |--------------------------------+--------+---------------------|
    |Disabilitare "$unit" (rimuovere |File    |"systemctl disable   |
    |collegamento simbolico)         |unità   |$unit"               |
    |--------------------------------+--------+---------------------|
    |Togliere maschera a "$unit"     |File    |"systemctl unmask    |
    |(rimuovere collegamento         |unità   |$unit"               |
    |simbolico a"/dev/null")         |        |                     |
    |--------------------------------+--------+---------------------|
    |Mascherare "$unit" (aggiungere  |File    |"systemctl mask      |
    |collegamento simbolico a"/dev/  |unità   |$unit"               |
    |null")                          |        |                     |
    |--------------------------------+--------+---------------------|
    |Ottenere l'impostazione del     |File    |"systemctl           |
    |target predefinito              |unità   |get-default"         |
    |--------------------------------+--------+---------------------|
    |Impostare default-target a      |File    |"systemctl           |
    |"graphical" (sistema GUI)       |unità   |set-default          |
    |                                |        |graphical"           |
    |--------------------------------+--------+---------------------|
    |Impostare default-target a      |File    |"systemctl           |
    |"multi-user" (sistema CLI)      |unità   |set-default          |
    |                                |        |multi-user"          |
    |--------------------------------+--------+---------------------|
    |Mostrare l'ambiente del lavoro  |Ambiente|"systemctl           |
    |                                |        |show-environment"    |
    |--------------------------------+--------+---------------------|
    |Impostare la variabile          |        |"systemctl           |
    |"variable" dell'ambiente di     |Ambiente|set-environment      |
    |lavoro al valore "value"        |        |variable=value"      |
    |--------------------------------+--------+---------------------|
    |Disimpostare la variabile       |        |"systemctl           |
    |"variable" dell'ambiente di     |Ambiente|unset-environment    |
    |lavoro                          |        |variable"            |
    |--------------------------------+--------+---------------------|
    |Ricaricare tutti i file di unità|Ciclo di|"systemctl           |
    |e i demoni                      |vita    |daemon-reload"       |
    |--------------------------------+--------+---------------------|
    |Spegnere il sistema             |Sistema |"systemctl poweroff" |
    |--------------------------------+--------+---------------------|
    |Spegnere e riavviare il sistema |Sistema |"systemctl reboot"   |
    |--------------------------------+--------+---------------------|
    |Sospendere il sistema           |Sistema |"systemctl suspend"  |
    |--------------------------------+--------+---------------------|
    |Ibernare il sistema             |Sistema |"systemctl hibernate"|
    |--------------------------------+--------+---------------------|
    |Visualizzare il log di lavoro di|Registro|"journalctl -u $unit"|
    |"$unit"                         |        |                     |
    |--------------------------------+--------+---------------------|
    |Visualizzare il log di lavoro di|Registro|"journalctl -u $unit |
    |"$unit" (in stile "tail -f")    |        |-f"                  |
    |--------------------------------+--------+---------------------|
    |Mostrare il tempo utilizzato per|Analisi |"systemd-analyze     |
    |ogni passo di inizializzazione  |        |time"                |
    |--------------------------------+--------+---------------------|
    |Elencare tutte le unità col     |Analisi |"systemd-analyze     |
    |tempo di inizializzazione       |        |blame"               |
    |--------------------------------+--------+---------------------|
    |Carica e rileva gli errori nel  |Analisi |"systemd-analyze     |
    |file "$unit"                    |        |verify $unit"        |
    |--------------------------------+--------+---------------------|
    |Traccia il processo di avvio con|Cgroup  |"systemd-cgls"       |
    |cgroups(7)                      |        |                     |
    |--------------------------------+--------+---------------------|
    |Traccia il processo di avvio con|Cgroup  |"ps xawf -eo         |
    |cgroups(7)                      |        |pid,user,cgroup,args"|
    |--------------------------------+--------+---------------------|
    |Traccia il processo di avvio con|        |Leggere sysfs in "/  |
    |cgroups(7)                      |Cgroup  |sys/fs/cgroup/systemd|
    |                                |        |/"                   |
    +---------------------------------------------------------------+


    Negli esempi soprastanti "$unit" può essere un singolo nome di
    unità (suffissi come .service e .target sono opzionali) o, in
    molti casi, la specifica di più unità (con glob in stile shell
    "*", "?", "[]" usando fnmatch(3) con corrispondenze con i nomi
    primari di tutte le unità attualmente in memoria).

    I comandi che cambiano lo stato del sistema negli esempi
    soprastanti sono tipicamente preceduti da "sudo" per ottenere i
    privilegi amministrativi necessari.

    L'output di "systemctl status $unit|$PID|$device" usa il colore
    del puntino ("●") per riassumere lo stato dell'unità a prima
    vista.

      * Un "●" bianco indica uno stato "inattivo" o "deattivato".

      * Un "●" rosso indica uno stato di "fallimento" o "errore".

      * Un "●" verde indica uno stato "attivo", "in ricaricamento" o
        "in attivazione".

%

3.2.7. Personalizzare systemd

    Con l'installazione predefinita molti servizi di rete (vedere
    Capitolo 6, Applicazioni per la rete) vengono avviati come
    processi demone dopo network.target al momento dell'avvio di
    sistema da systemd. "sshd non fa eccezione. Come esempio di
    personalizzazione cambiamo questo comportamento nell'avvio
    on-demand di "sshd".

    Come prima cosa disabilitare l'unità di servizio installata dal
    sistema.

     $ sudo systemctl stop sshd.service
     $ sudo systemctl mask sshd.service

    Il sistema di attivazione on-demand dei socket dei servizi
    classici Unix avveniva attraverso il superserver inetd. Con
    systemd il comportamento equivalente può essere abilitato
    aggiungendo file di configurazione di unità *.socket e *.service.

    sshd.socket per specificare un socket su cui restare in ascolto

    [Unit]
    Description=SSH Socket for Per-Connection Servers

    [Socket]
    ListenStream=22
    Accept=yes

    [Install]
    WantedBy=sockets.target

    sshd@.service come file di servizio corrispondente di sshd.socket

    [Unit]
    Description=SSH Per-Connection Server
   
    [Service]
    ExecStart=-/usr/sbin/sshd -i
    StandardInput=socket

    Poi ricaricare.

     $ sudo systemctl daemon-reload

%

3.3. Il sistema udev

    Per i kernel Linux 2.6 e successivi, il sistema udev fornisce un
    meccanismo di rilevazione e inizializzazione automatiche
    dell'hardware (vedere udev(7)). Per ogni dispositivo rilevato dal
    kernel, il sistema udev avvia un processo utente che usa le
    informazioni del filesystem sysfs (vedere Sezione 1.2.12, «procfs
    e sysfs»), carica, usando modprobe(8) (vedere Sezione 3.3.1,
    «L'inizializzazione dei moduli del kernel»), i moduli del kernel
    necessari per il supporto del dispositivo e crea i nodi di device
    corrispondenti.

    Suggerimento

    Se, per una qualche ragione "/lib/modules/<versione-kernel>/
    modules.dep non viene generato in modo appropriato dal depmod(8),
    i moduli non possono essere caricati come dovuto dal sistema
    udev. Per risolvere il problema eseguire "depmod -a".

    Il nome dei nodi di device può essere configurato dai file di
    regole di udev in "/etc/udev/rules.d/". Le regole predefinite
    attuali tendono a creare nomi generati dinamicamente che hanno
    come risultato nomi di device non fissi, tranne che per
    dispositivi CD e di rete. Aggiungendo le proprie regole
    personalizzate, in modo simile a quelle per i dispositivi CD e di
    rete, si possono creare nomi di device statici anche per altri
    dispositivi, come chiavette USB. Vedere "Scrivere regole udev" o
    "/usr/share/doc/udev/writing_udev_rules/index.html".

    Dato che il sistema udev è in qualche modo in costante
    evoluzione, in questo documento sono fornite informazioni base,
    lasciando i dettagli ad altra documentazione.

    Suggerimento

    Per le regole di montaggio in "/etc/fstab", non è necessario che
    i nodi di device siano statici. Si possono usare gli UUID per
    montare i dispositivi, al posto dei nomi di device come "/dev/
    sda". Vedere Sezione 9.5.3, «Accedere alle partizioni usando
    UUID».

%

3.3.1. L'inizializzazione dei moduli del kernel

    Il programma modprobe(8) permette di configurare il kernel Linux
    in esecuzione da processi utente, aggiungendo e rimuovendo moduli
    del kernel. Il sistema udev (vedere Sezione 3.3, «Il sistema
    udev») automatizza la sua invocazione per facilitare
    l'inizializzazione dei moduli del kernel.

    Ci sono moduli non-hardware e speciali moduli con driver
    hardware, come quelli elencati in seguito, che devono essere
    precaricati elencandoli nel file "/etc/modules" (vedere modules
    (5)).

      * moduli TUN/TAP che forniscono device virtuali di rete
        Point-to-Point (TUN) e device virtuali di rete Ethernet
        (TAP),

      * moduli netfilter che forniscono funzionalità di firewall
        netfilter (iptables(8), Sezione 5.10, «Infrastruttura
        netfilter» e

      * moduli driver watchdog timer.

    I file di configurazione per il programma modprobe(8) sono
    contenuti nella directory "/etc/modprobes.d/", come spiegato in 
    modprobe.conf(5). (Se si desidera evitare l'autocaricamento di
    alcuni moduli del kernel, considerare la loro aggiunta nella
    lista nera nel file "/etc/modprobes.d/blacklist".)

    Il file "/lib/modules/<versione>/modules.dep" generato dal
    programma depmod(8) descrive le dipendenze dei moduli usate dal
    programma modprobe(8).

    Nota

    Se si hanno problemi di caricamento dei moduli all'avvio o con 
    modprobe(8), "depmod -a" potrebbe risolverli rigenerando il file
    "modules.dep".

    Il programma modinfo(8) mostra informazioni su un modulo del
    kernel Linux.

    Il programma lsmod(8) formatta in un bel modo i contenuti di "/
    proc/modules", mostrando quali moduli del kernel siano
    attualmente caricati.

    Suggerimento
   
    Si può identificare l'esatto hardware sul proprio sistema. Vedere
    Sezione 9.4.3, «Identificazione dell'hardware».

    Suggerimento

    Si può configurare l'hardware all'avvio per attivare le
    funzionalità dell'hardware desiderate. Vedere Sezione 9.4.4,
    «Configurazione dell'hardware».

    Suggerimento

    Si può probabilmente aggiungere il supporto per il proprio
    speciale dispositivo ricompilando il kernel. Vedere Sezione 9.9,
    «Il kernel».

Capitolo 4. Autenticazione

    Quando una persona (o un programma) richiede l'accesso al
    sistema, l'autenticazione verifica che l'identità sia fidata.

    Avvertimento

    Errori di configurazione di PAM possono lasciare l'utente fuori
    dal proprio sistema. Si deve avere un CD di ripristino a portata
    di mano o impostare una partizione di avvio alternativa. Per fare
    il ripristino, avviare il sistema con uno di essi e correggere le
    cose da lì.

    Avvertimento
   
    Questo capito sta diventando non aggiornato dato che è basato su
    Debian 7.0 (Wheezy), rilasciata nel 2013.

%

4.1. Autenticazione Unix normale

    L'autenticazione Unix normale è fornita dal modulo pam_unix(8)
    sotto PAM (Pluggable Authentication Modules). I suoi 3 importanti
    file di configurazione, con voci separate da ":", sono i
    seguenti.

    Tabella 4.1. I 3 importanti file di configurazione per pam_unix
    (8)

    +---------------------------------------------------------------+
    | file  | permessi |utente|gruppo|         descrizione          |
    |-------+----------+------+------+------------------------------|
    |/etc/  |-rw-r--r--|root  |root  |informazioni sugli account    |
    |passwd |          |      |      |utente (ripulite)             |
    |-------+----------+------+------+------------------------------|
    |/etc/  |-rw-r-----|root  |shadow|informazioni sicure sugli     |
    |shadow |          |      |      |account utente                |
    |-------+----------+------+------+------------------------------|
    |/etc/  |-rw-r--r--|root  |root  |informazioni sui gruppi       |
    |group  |          |      |      |                              |
    +---------------------------------------------------------------+


    "/etc/passwd" contiene righe come le seguenti.

     ...
    utente1:x:1000:1000:Utente1 Nome,,,:/home/utente1:/bin/bash
    utente2:x:1001:1001:Utente2 Nome,,,:/home/utente2:/bin/bash
     ...

    Come spiegato in "passwd(5), le voci separate da ": in questo
    file hanno il significato seguente.

      * Nome di login

      * Voce di specificazione della password

      * ID numerico dell'utente

      * ID numerico del gruppo

      * Nome dell'utente o campo di commento

      * Directory home dell'utente

      * Voce opzionale per l'interprete di comandi utente

    La seconda voce del file "/etc/passwd" era usata per la password
    cifrata. Dopo l'introduzione di "/etc/shadow", questa voce è
    usata per la specificazione della password.

    Tabella 4.2. Il contenuto della seconda voce di "/etc/passwd"

    +------------------------------------------------+
    |contenuto|             significato              |
    |---------+--------------------------------------|
    |(vuoto)  |account senza password                |
    |---------+--------------------------------------|
    |x        |la password cifrata è in "/etc/shadow"|
    |---------+--------------------------------------|
    |*        |nessun login per questo account       |
    |---------+--------------------------------------|
    |!        |nessun login per questo account       |
    +------------------------------------------------+


    "/etc/shadow" contiene righe come le seguenti.

     ...
    utente1:$1$Xop0FYH9$IfxyQwBe9b8tiyIkt2P4F/:13262:0:99999:7:::
    utente2:$1$vXGZLVbS$ElyErNf/agUDsm1DehJMS/:13261:0:99999:7:::
     ...

    Come spiegato in "shadow(5), le voci separate da ": in questo
    file hanno il significato seguente.

      * Nome di login

      * Password cifrata (I caratteri "$1$" iniziali indicano l'uso
        della cifratura MD5. "*" indica nessun login.)

      * Data dell'ultimo cambiamento di password, espressa come
        numero di giorni trascorsi dall'1 gennaio 1970

      * Numero di giorni che l'utente deve aspettare prima di essere
        autorizzato a cambiare nuovamente la password

      * Numero di giorni trascorsi i quali l'utente dovrà cambiare la
        propria password

      * Numero di giorni di preavviso per avvisare l'utente che la
        password è in scadenza

      * Numero di giorni dopo che una password è scaduta in cui la
        password viene sempre accettata

      * Data di scadenza dell'account, espressa come numero di giorni
        trascorsi dall'1 gennaio 1970.

      * …

    "/etc/group" contiene righe come le seguenti.

    gruppo1:x:20:utente1,utente2

    Come spiegato in "group(5), le voci separate da ": in questo file
    hanno il significato seguente.

      * Nome del gruppo

      * Password cifrata (non realmente usato)
   
      * ID numerico del gruppo

      * Elenco di nomi utente separati da ","

    Nota
   
    "/etc/gshadow" fornisce funzioni simili a "/etc/shadow" per "/etc
    /group", ma non è realmente usato.

    Nota

    Può essere dinamicamente aggiunta la reale appartenenza di un
    utente ad un gruppo se viene aggiunta la riga "auth optional
    pam_group.so al file "/etc/pam.d/common-auth" e se viene
    impostata in "/etc/security/group.conf". Vedere pam_group(8).

    Nota
   
    Il pacchetto base-passwd contiene una lista autorevole di utenti
    e gruppi: "/usr/share/doc/base-passwd/users-and-groups.html".

%

4.2. Gestire le informazioni su account e password

    Quelli che seguono sono alcuni comandi degni di nota per gestire
    le informazioni sugli account

    Tabella 4.3. Elenco di comandi per gestire informazioni su
    account

    +---------------------------------------------------------------+
    |      comando      |                 funzione                  |
    |-------------------+-------------------------------------------|
    |getent passwd      |sfoglia le informazioni sull'account di "  |
    |<nome_utente>      |<nome_utente>"                             |
    |-------------------+-------------------------------------------|
    |getent shadow      |sfoglia le informazioni shadow sull'account|
    |<nome_utente>      |di "<nome_utente>"                         |
    |-------------------+-------------------------------------------|
    |getent group       |sfoglia le informazioni sul gruppo "       |
    |<nome_gruppo>      |<nome_gruppo>"                             |
    |-------------------+-------------------------------------------|
    |passwd             |gestisce la password per l'account         |
    |-------------------+-------------------------------------------|
    |passwd -e          |imposta una password usa e getta per       |
    |                   |l'attivazione dell'account                 |
    |-------------------+-------------------------------------------|
    |chage              |gestisce le informazioni sulla scadenza    |
    |                   |della password                             |
    +---------------------------------------------------------------+


    Può essere necessario avere i privilegi di root per far
    funzionare alcune di queste funzioni. Vedere crypt(3) per la
    cifratura di password e dati.

    Nota

    Nei sistemi configurati con PAM e NSS, come la macchina Debian
    salsa Debian, il contenuto dei file locali "/etc/passwd", "/etc/
    group" ed "/etc/shadow" può non essere attivamente usato dal
    sistema. I comandi sopra descritti sono validi anche in un
    ambiente di questo tipo.

%

4.3. Password buone

    Quando si crea un account, durante l'installazione del sistema o
    con il comando passwd(1), si dovrebbe scegliere una buona
    password che consiste, secondo passwd(1), di un numero di
    caratteri da almeno 6 a 8, incluso uno o più caratteri da
    ciascuno dei seguenti insiemi.

      * Lettere dell'alfabeto minuscole

      * Cifre da 0 a 9

      * Segni di punteggiatura

    Avvertimento

    Non scegliere parole indovinabili come password. Il nome
    dell'account, il codice fiscale, il numero di telefono,
    l'indirizzo, il giorno del compleanno, il nome di membri della
    propria famiglia o di animali, parole del dizionario, semplici
    sequenze di caratteri come "12345" o "qwerty", … sono tutte
    scelte pessime come password.

%

4.4. Creare password cifrate

    Ci sono strumenti indipendenti per generare password cifrate con
    salt.

    Tabella 4.4. Elenco di strumenti per generare password

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|comando |         funzione         |
    |---------+------+----------+--------+--------------------------|
    |         |V:35, |          |        |frontend ricco di         |
    |whois    |I:393 |364       |mkpasswd|funzionalità per la       |
    |         |      |          |        |libreria crypt(3)         |
    |---------+------+----------+--------+--------------------------|
    |openssl  |V:794,|1465      |openssl |calcola hash di password  |
    |         |I:993 |          |passwd  |(OpenSSL). passwd(1ssl)   |
    +---------------------------------------------------------------+


%

4.5. PAM e NSS

    I moderni sistemi *nix come il sistema Debian, forniscono
    all'amministratore di sistema i meccanismi PAM (Pluggable
    Authentication Modules) e NSS (Name Service Switch) per
    configurare il sistema. Il ruolo di questi meccanismi può essere
    riassunto nel modo seguente.

      * PAM offre un meccanismo di autenticazione flessibile usato
        dal software applicativo e comporta pertanto scambio di dati
        sulle password
   
      * NSS offre un meccanismo di servizio dei nomi flessibile che è
        usato di frequente dalla libreria standard C per ottenere i
        nomi di utenti e gruppi per programmi come ls(1) e id(1).

    Questi sistemi PAM e NSS devono essere configurati in modo
    coerente.

    I pacchetti degni di nota relativi ai sistemi PAM e NSS sono i
    seguenti.

    Tabella 4.5. Elenco dei pacchetti degni di nota per i sistemi PAM
    e NSS

    +---------------------------------------------------------------+
    |     pacchetto     |popcon|dimensione|       descrizione       |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Pluggable Authentication |
    |libpam-modules     |V:807,|1032      |Modules, moduli di       |
    |                   |I:999 |          |autenticazione inseribili|
    |                   |      |          |(servizio base)          |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Pluggable Authentication |
    |                   |      |          |Module, modulo di        |
    |libpam-ldap        |I:12  |249       |autenticazione           |
    |                   |      |          |inseribile, che permette |
    |                   |      |          |interfacce LDAP          |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Pluggable Authentication |
    |                   |      |          |Module, modulo di        |
    |libpam-cracklib    |I:16  |115       |autenticazione           |
    |                   |      |          |inseribile, che permette |
    |                   |      |          |il supporto di cracklib  |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Pluggable Authentication |
    |                   |      |          |Module, modulo di        |
    |libpam-systemd     |V:474,|573       |autenticazione           |
    |                   |I:853 |          |inseribile, per          |
    |                   |      |          |registrare sessioni      |
    |                   |      |          |utente per logind        |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Pluggable Authentication |
    |                   |      |          |Modules, moduli di       |
    |libpam-doc         |I:1   |1044      |autenticazione inseribili|
    |                   |      |          |(documentazione in html e|
    |                   |      |          |testo semplice)          |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Libreria GNU C: librerie |
    |libc6              |V:935,|12771     |condivise che forniscono |
    |                   |I:999 |          |anche il servizio "Name  |
    |                   |      |          |Service Switch"          |
    |-------------------+------+----------+-------------------------|
    |glibc-doc          |I:11  |3161      |Libreria GNU C: pagine   |
    |                   |      |          |man                      |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Libreria GNU C: manuale  |
    |glibc-doc-reference|I:5   |12740     |di riferimento nei       |
    |                   |      |          |formati info, pdf e html |
    |                   |      |          |(non-free)               |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Modulo NSS per la        |
    |libnss-mdns        |I:526 |150       |risoluzione dei nomi DNS |
    |                   |      |          |Multicast                |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Modulo NSS per l'uso di  |
    |libnss-ldap        |I:11  |265       |LDAP come servizio per i |
    |                   |      |          |nomi                     |
    |-------------------+------+----------+-------------------------|
    |                   |      |          |Modulo NSS per l'uso di  |
    |libnss-ldapd       |I:14  |153       |LDAP come servizio per i |
    |                   |      |          |nomi (nuovo fork di      |
    |                   |      |          |libnss-ldap)             |
    +---------------------------------------------------------------+


      * La guida per l'amministratore di sistema di Linux-PAM, "The
        Linux-PAM System Administrators' Guide", in libpam-doc è
        essenziale per imparare la configurazione di PAM.
   
      * La sezione "System Databases and Name Service Switch" in
        glibc-doc-reference è essenziale per imparare la
        configurazione di NSS.

    Nota

    Si può ottenere un elenco più esteso ed aggiornato usando il
    comando "aptitude search 'libpam-|libnss-'". L'acronimo NSS può
    anche significare "Network Security Service" che è una cosa
    diversa da "Name Service Switch".

    Nota

    PAM è il metodo più basilare per inizializzare le variabili
    d'ambiente per ciascun programma con valori predefiniti a livello
    di sistema.

    Con systemd, il pacchetto libpam-systemd viene installato per
    gestire il login degli utenti registrando le sessioni utente
    nella gerarchia dei gruppi di controllo di systemd per logind.
    Vedere systemd-logind(8), logind.conf(5) e pam_systemd(8).

%

4.5.1. File di configurazione letti da PAM e NSS

    Quelli che seguono sono alcuni file degni di nota letti da PAM e
    NSS.

    Tabella 4.6. Elenco di file di configurazione letti da PAM e NSS

    +---------------------------------------------------------------+
    |    file di     |                   funzione                   |
    | configurazione |                                              |
    |----------------+----------------------------------------------|
    |/etc/pam.d/     |imposta la configurazione PAM per il programma|
    |<nome_programma>|"<nome_programma>"; vedere pam(7) e pam.d(5)  |
    |----------------+----------------------------------------------|
    |/etc/           |imposta la configurazione NSS con la voce per |
    |nsswitch.conf   |ciascun servizio. Vedere nsswitch.conf(5)     |
    |----------------+----------------------------------------------|
    |/etc/nologin    |limita il login utente con il modulo          |
    |                |pam_nologin(8)                                |
    |----------------+----------------------------------------------|
    |/etc/securetty  |limita la tty per l'accesso root con il modulo|
    |                |pam_securetty(8)                              |
    |----------------+----------------------------------------------|
    |/etc/security/  |imposta il limite di accesso con il modulo    |
    |access.conf     |pam_access(8)                                 |
    |----------------+----------------------------------------------|
    |/etc/security/  |imposta restrizioni basate su gruppi con il   |
    |group.conf      |modulo pam_group(8)                           |
    |----------------+----------------------------------------------|
    |/etc/security/  |imposta le variabili d'ambiente con il modulo |
    |pam_env.conf    |pam_env(8)                                    |
    |----------------+----------------------------------------------|
    |/etc/environment|imposta variabili d'ambiente aggiuntive con il|
    |                |modulo pam_env(8) con l'argomento "readenv=1" |
    |----------------+----------------------------------------------|
    |/etc/default/   |imposta la localizzazione con il modulo       |
    |locale          |pam_env(8) con l'argomento "readenv=1 envfile=|
    |                |/etc/default/locale" (Debian)                 |
    |----------------+----------------------------------------------|
    |/etc/security/  |imposta limitazioni alle risorse (ulimit,     |
    |limits.conf     |core, …) con il modulo pam_limits(8)          |
    |----------------+----------------------------------------------|
    |/etc/security/  |imposta limitazioni temporali con il modulo   |
    |time.conf       |pam_time(8)                                   |
    |----------------+----------------------------------------------|
    |/etc/systemd/   |imposta la configurazione del gestore di login|
    |logind.conf     |di systemd (vedere logind.conf(5) e           |
    |                |systemd-logind.service(8))                    |
    +---------------------------------------------------------------+


    Le restrizioni sulla scelta delle password sono implementate dai
    moduli PAM pam_unix(8) e pam_cracklib(8). Possono essere
    configurati tramite i loro argomenti.

    Suggerimento
   
    I moduli PAM usano il suffisso ".so" nei loro nomi file.

%

4.5.2. La moderna gestione centralizzata del sistema

    La moderna gestione centralizzata del sistema può essere messa in
    atto usando il server del Protocollo LDAP (Lightweight Directory
    Access Protocol) per amministrare molti sistemi *nix e non *nix
    in rete. L'implementazione open source del protocollo LDAP è il
    software OpenLDAP.

    Il server LDAP fornisce le informazioni sugli account attraverso
    l'uso di PAM e NSS con i pacchetti per il sistema Debian
    libpam-ldap e libnss-ldap. Per abilitare ciò sono necessarie
    diverse azioni. (Non ho mai usato questa configurazione e le
    informazioni che seguono sono di seconda mano. Tenerlo a mente
    quando si legge quanto segue.)

      * Si configura un server LDAP centralizzato eseguendo un
        programma come il demone LDAP autonomo slapd(8).

      * Si modificano i file di configurazione di PAM nella directory
        "/etc/pam.d/" per usare "pam_ldap.so" invece del predefinito
        "pam_unix.so".

          + Debian usa "/etc/pam_ldap.conf" come file di
            configurazione per libpam-ldap e "/etc/pam_ldap.secret"
            come file per archiviare la password di root.

      * Si modifica la configurazione di NSS nel file "/etc/
        nsswitch.conf" per usare "ldap" invece della scelta
        predefinita ("compat" o "file").

          + Debian usa "/etc/libnss-ldap.conf" come file di
            configurazione per libnss-ldap.

      * Per la sicurezza delle password è necessario far sì che
        libpam-ldap usi una connessione SSL (o TLS).

      * Per assicurare l'integrità dei dati, si può far sì che
        libnss-ldap usi una connessione SSL (o TLS) a prezzo di un
        maggiore carico sulla rete LDAP.

      * Si dovrebbe eseguire nscd(8) localmente per mettere nella
        cache ogni risultato di ricerche LDAP in modo da ridurre il
        traffico di rete LDAP.

    Vedere la documentazione in pam_ldap.conf(5) e "/usr/share/doc/
    libpam-doc/html/" fornita dal pacchetto libpam-doc e in "info
    libc 'Name Service Switch'" fornita dal pacchetto glibc-doc.

    In modo simile si possono impostare sistemi centralizzati
    alternativi con altri metodi.

      * Integrazione di utenti e gruppi con il sistema Windows.

          + Accesso ai servizi di dominio Windows con i pacchetti
            winbind e libpam_winbind.

          + Vedere winbindd(8) e Integrare reti MS Windows con Samba.
   
      * Integrazione di utenti e gruppi con sistemi simil-Unix datati

          + Accesso a NIS (chiamato in origine YP) o NIS+ con il
            pacchetto nis.

          + Vedere il Linux NIS(YP)/NYS/NIS+ HOWTO.

%

4.5.3. "Perché GNU su non supporta il gruppo wheel"

    Questa è la famosa sezione scritta da Richard M. Stallman, alla
    fine della vecchia pagina "info su. Non c'è da preoccuparsi:
    l'attuale comando su in Debian usa PAM, perciò questo può
    limitare la possibilità di usare su verso il gruppo root
    abilitando la riga con "pam_wheel.so" in "/etc/pam.d/su".

%

4.5.4. Regole più stringenti per le password

    L'installazione del pacchetto libpam-cracklib permette di imporre
    regole più stringenti sulle password, per esempio usando righe
    attive nel file "/etc/pam.d/common-password" come le seguenti.

    Per squeeze:

    password required pam_cracklib.so retry=3 minlen=9 difok=3
    password [success=1 default=ignore] pam_unix.so use_authtok nullok md5
    password requisite pam_deny.so
    password required pam_permit.so

%

4.6. Altri controlli sugli accessi

    Nota
   
    Vedere Sezione 9.3.15, «Tasto Alt-SysRq» per limitare la
    funzionalità SAK (Secure Attention Key) del kernel.

%

4.6.1. sudo

    sudo(8) è un programma progettato per permettere ad un
    amministratore di sistema di dare privilegi di root limitati ad
    utenti, e di registrare l'attività come root. sudo richiede solo
    la password di un utente regolare. Installare il pacchetto sudo e
    attivarlo impostando le opzioni in "/etc/sudoers". Vedere esempi
    di configurazione in "/usr/share/doc/sudo/examples/sudoers" e
    Sezione 1.1.12, «Configurazione di sudo».

    Il mio uso di sudo per un sistema con un singolo utente (vedere
    Sezione 1.1.12, «Configurazione di sudo») è mirato a proteggere
    me stesso dalla mia stupidità. Personalmente condidero l'uso di
    sudo come un'alternativa migliore all'uso costante del sistema
    dall'account root. Per esempio, il comando seguente cambia il
    proprietario di "<un_certo_file>" in "<mio_nome>".

    $ sudo chown <mio_nome> <un_certo_file>

    Naturalmente se si conosce la password di root (come accade per
    ogni utente Debian che ha installato il proprio sistema),
    qualsiasi comando può essere eseguito come utente root da
    qualsiasi account utente usando "su -c".

%

4.6.2. PolicyKit

    PolicyKit è un componente del sistema operativo per controllare
    privilegi a livello di sistema in sistemi operativi simil-Unix.

    Le applicazioni GUI più recenti non sono pensate per essere
    eseguite come processi privilegiati. Per effettuare operazioni
    amministrative comunicano con processi privilegiati attraverso
    PolicyKit.

    PolicyKit limita tali operazioni agli account utente che
    appartengono al gruppo sudo, in sistemi Debian.

    Vedere polkit(8).

%

4.6.3. SELinux

    SELinux (Security-Enhanced Linux) è un'infrastruttura per rendere
    il modello basato su privilegi più restrittivo del modello
    ordinario di sicurezza in stile Unix, usando politiche di
    controllo obbligatorio degli accessi (MAC, mandatory access
    control). I poteri di root possono essere limitati in determinate
    condizioni.

%

4.6.4. Limitare l'accesso ad alcuni servizi server

    Per la sicurezza del sistema è una buona idea disabilitare il
    maggior numero di programmi server possibile. Questo aspetto
    diventa critico per i server di rete. Avere server inutilizzati,
    attivati direttamente come demoni o attraverso un programma
    super-server, è considerato un rischio per la sicurezza.

    Molti programmi, come sshd(8), usano un controllo degli accessi
    basato su PAM. Ci sono molti modi per limitare gli accessi ad un
    qualche servizio server.

      * file di configurazione: "/etc/default/<nome_programma>"

      * configurazione dell'unità di servizio per il demone

      * PAM (Pluggable Authentication Modules)

      * "/etc/inetd.conf" per il super-server

      * "/etc/hosts.deny" e "/etc/hosts.allow" per il wrapper TCP, 
        tcpd(8)

      * "/etc/rpc.conf" per Sun RPC

      * "/etc/at.allow" e "/etc/at.deny" per atd(8)

      * "/etc/cron.allow" e "/etc/cron.deny" per crontab(1)

      * il firewall di rete della infrastruttura netfilter

    Vedere Sezione 3.2.6, «Gestione del sistema sotto systemd»,
    Sezione 4.5.1, «File di configurazione letti da PAM e NSS» e
    Sezione 5.10, «Infrastruttura netfilter».

    Suggerimento
   
    I servizi Sun RPC devono essere attivi per i programmi NFS ed
    altri programmi basati su RPC.

    Suggerimento

    Se si hanno problemi con l'accesso remoto in sistemi Debian
    recenti, commentare la configurazione responsabile come "ALL:
    PARANOID" in "/etc/hosts.deny", se esiste. (Essere però
    consapevoli dei rischi per la sicurezza che questo tipo di azione
    comporta.)

%

4.7. Sicurezza dell'autenticazione

    Nota

    Le informazioni fornite in questo documento potrebbero non essere
    sufficienti per le proprie necessità di sicurezza ma dovrebbero
    essere un buon punto di partenza.

%

4.7.1. Password sicure in Internet

    Molti servizi per livello di trasporto popolari comunicano i loro
    messaggi, compresa l'autenticazione con password, in puro testo.
    È una pessima idea trasmettere password in puro testo attraverso
    l'Internet selvaggia dove possono essere intercettate. Si possono
    eseguire questi servizi attraverso "TLS" (Transport Layer
    Security, sicurezza del livello di trasporto), o il suo
    predecessore "SSL" (Secure Sockets Layer, livello per socket
    sicuri), per rendere sicura tramite cifratura tutta la
    comunicazione, compresa la password.

    Tabella 4.7. Elenco di servizi e porte sicuri e non sicuri

    +---------------------------------------------------------------+
    |   nome del servizio non   |porta|   nome del servizio   |porta|
    |          sicuro           |     |        sicuro         |     |
    |---------------------------+-----+-----------------------+-----|
    |www (http)                 |80   |https                  |443  |
    |---------------------------+-----+-----------------------+-----|
    |smtp (posta)               |25   |ssmtp (smtps)          |465  |
    |---------------------------+-----+-----------------------+-----|
    |ftp-data                   |20   |ftps-data              |989  |
    |---------------------------+-----+-----------------------+-----|
    |ftp                        |21   |ftps                   |990  |
    |---------------------------+-----+-----------------------+-----|
    |telnet                     |23   |telnets                |992  |
    |---------------------------+-----+-----------------------+-----|
    |imap2                      |143  |imaps                  |993  |
    |---------------------------+-----+-----------------------+-----|
    |pop3                       |110  |pop3s                  |995  |
    |---------------------------+-----+-----------------------+-----|
    |ldap                       |389  |ldaps                  |636  |
    +---------------------------------------------------------------+


    La cifratura ha un costo in termini di tempo CPU. Come
    alternativa leggera per la CPU, si può mantenere la comunicazione
    in testo semplice, rendendo allo stesso tempo sicura la sola
    password con un protocollo di autenticazione sicura come "APOP"
    (Authenticated Post Office Protocol) per POP e "CRAMD-MD5"
    (Challenge-Response Authentication Mechanism MD5) per SMTP e
    IMAP. (Per inviare messaggi di posta elettronica via Internet dal
    proprio programma di posta al proprio server di posta è diventato
    popolare recentemente l'uso per SMTP della porta 587 invece della
    porta tradizionale 25, per evitare il blocco da parte del
    fornitore del servizio Internet della porta 25 autenticandosi
    allo stesso tempo con CRAM-MD5.)

%

4.7.2. Secure Shell, shell sicura

    Il programma Secure Shell (SSH fornisce comunicazioni sicure
    cifrate tra due host non fidati attraverso una rete non sicura,
    grazie ad un'autenticazione sicura. Consiste del client OpenSSH, 
    ssh(1) e del demone OpenSSH, sshd(8). SSH può essere usato per
    fare da tunnel sicuro attraverso Internet per le comunicazioni
    con protocollo non sicuro come POP ed X, con la funzionalità di
    inoltro delle porte.

    Il client cerca di autenticarsi usando un'autenticazione basata
    sull'host, su una chiave pubblica, challenge-response o con
    password. L'uso di un'autenticazione con chiave pubblica permette
    il login remoto senza password. Vedere Sezione 6.9, «Il server e
    le utilità per l'accesso remoto (SSH)».

%

4.7.3. Misure aggiuntive di sicurezza per Internet

    Anche quando si eseguono servizi sicuri, come server SSH (Secure
    shell) e PPTP (Point-to-Point Tunneling Protocol), esiste sempre
    la possibilità di un'intrusione da Internet con attacchi basati
    sull'indovinare la password usando metodi con forza bruta, ecc.
    L'uso di una politica di firewall (vedere Sezione 5.10,
    «Infrastruttura netfilter») insieme agli strumenti di sicurezza
    elencati in seguito, può migliorare la sicurezza generale.

    Tabella 4.8. Elenco di strumenti per fornire misure aggiuntive di
    sicurezza

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|          descrizione          |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |demone, knockd(1), e client,   |
    |knockd       |I:3   |102       |knock(1) piccoli per bussare   |
    |             |      |          |alle porte                     |
    |-------------+------+----------+-------------------------------|
    |             |V:112,|          |strumento per interdire IP che |
    |fail2ban     |I:123 |2092      |causano errori di              |
    |             |      |          |autenticazione multipli        |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |blocca all'esterno gli attacchi|
    |libpam-shield|I:0   |115       |remoti che cercano di          |
    |             |      |          |indovinare le password         |
    +---------------------------------------------------------------+


%

4.7.4. Rendere sicura la password di root

    Per impedire che qualcuno possa accedere alla propria macchina
    con privilegi di root, è necessario compiere le azioni seguenti.

      * Impedire l'accesso fisico al disco fisso

      * Bloccare il BIOS ed impedire l'avvio da supporti removibili
   
      * Impostare una password per la sessione interattiva di GRUB

      * Bloccare il menu di GRUB impedendo i cambiamenti

    Avendo accesso fisico al disco fisso, reimpostare la password di
    root è relativamente semplice seguendo i passi seguenti.

     1. Spostare il disco fisso in un PC con un BIOS che permette
        l'avvio da CD

     2. Avviare il sistema con un supporto di ripristino (disco di
        avvio di Debian, CD Knoppix, CD GRUB, …).

     3. Montare la partizione root con accesso in lettura e scrittura

     4. Modificare il file "/etc/passwd" nella partizione root e
        rendere la seconda voce per l'account di root vuota.

    Se si ha l'accesso in modifica alle voci di menu di GRUB (vedere
    Sezione 3.1.2, «Stadio 2: il bootloader») per grub-rescue-pc
    all'avvio, è ancora più semplice, seguendo i passi seguenti.

     1. Avviare il sistema con i parametri del kernel modificati in
        qualcosa del tipo "root=/dev/hda6 rw init=/bin/sh".

     2. Modificare il file "/etc/passwd" e rendere la seconda voce
        per l'account di root vuota.

     3. Riavviare il sistema.

    Si può ora accedere alla shell di root del sistema senza
    password.

    Nota

    Una volta ottenuto l'accesso alla shell di root, si ha l'accesso
    a qualsiasi cosa sul sistema e si può reimpostare qualsiasi
    password. Inoltre, si possono compromettere le password per tutti
    gli account utente usando strumenti di violazione delle password
    con attacchi a forza bruta, come quelli nei pacchetti john e
    crack (vedere Sezione 9.4.11, «Verifica della sicurezza e
    dell'integrità del sistema»). Queste password violate possono
    portare alla compromissione di altri sistemi.

    L'unica soluzione software ragionevole per evitare tutte queste
    preoccupazioni è l'uso di una partizione root (o partizione "/
    etc") cifrata, usando dm-crypt e initramfs (vedere Sezione 9.8,
    «Suggerimenti per la cifratura dei dati»). Tuttavia è sempre
    necessaria la password per avviare il sistema.

Capitolo 5. Impostazione della rete

    Suggerimento
   
    Per una guida generica all'uso della rete in GNU/Linux, leggere
    la Linux Network Administrators Guide.

    Suggerimento

    Per una guida moderna sull'uso della rete specifica per Debian,
    leggere The Debian Administrator's Handbook — Configuring the
    Network.

    Avvertimento

    Invece di usare lo schema di nomi tradizionale per le interfacce
    («eth0», «eth1», «wlan0», …), il più recente systemd usa «nomi di
    interfacce di rete prevedibili (Predictable Network Interface
    Name)», come «enp0s25».

    Avvertimento
   
    Questo capito sta diventando non aggiornato dato che è basato su
    Debian 7.0 (Wheezy), rilasciata nel 2013.

    Suggerimento

    Anche se questo documento usa ancora il vecchio ifconfig(8) con
    IPv4 per i suoi esempi di configurazione della rete, Debian sta
    migrando a ip(8) con IPv4+IPv6 nel rilascio wheezy. Patch per
    aggiornare questo documento sono le benvenute.

    Suggerimento
   
    In systemd, si può usare networkd per gestire il le reti. Vedere 
    systemd-networkd(8).

%

5.1. L'infrastruttura base di rete

    In questa sezione viene descritta in breve l'infrastruttura base
    di rete in un sistema Debian moderno.

    Tabella 5.1. Elenco degli strumenti di configurazione della rete

    +-------------------------------------------------------------------------+
    |      pacchetto      |popcon|dimensione|      tipo       |  descrizione  |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento      |
    |                     |      |          |                 |standard per   |
    |ifupdown             |V:587,|217       |config::ifupdown |attivare e     |
    |                     |I:991 |          |                 |disattivare la |
    |                     |      |          |                 |rete (specifico|
    |                     |      |          |                 |di Debian)     |
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:3,  |          |                 |gestisce       |
    |ifplugd              |I:18  |217       |" "              |automaticamente|
    |                     |      |          |                 |la rete cablata|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |script per     |
    |                     |V:0,  |          |                 |testare la rete|
    |ifupdown-extra       |I:1   |106       |" "              |di supporto al |
    |                     |      |          |                 |pacchetto      |
    |                     |      |          |                 |"ifupdown"     |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |imposta la     |
    |                     |V:0,  |          |                 |metrica di     |
    |ifmetric             |I:1   |37        |" "              |routing per    |
    |                     |      |          |                 |un'interfaccia |
    |                     |      |          |                 |di rete        |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |script di      |
    |                     |      |          |                 |mappatura di   |
    |                     |      |          |                 |supporto al    |
    |                     |V:0,  |          |                 |pacchetto      |
    |guessnet             |I:0   |422       |" "              |"ifupdown",    |
    |                     |      |          |                 |attraverso il  |
    |                     |      |          |                 |file "/etc/    |
    |                     |      |          |                 |network/       |
    |                     |      |          |                 |interfaces"    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |script di      |
    |                     |V:0,  |          |                 |mappatura di   |
    |ifscheme             |I:0   |59        |" "              |supporto al    |
    |                     |      |          |                 |pacchetto      |
    |                     |      |          |                 |"ifupdown"     |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |NetworkManager |
    |                     |V:358,|          |                 |(demone):      |
    |network-manager      |I:440 |14957     |config::NM       |gestisce la    |
    |                     |      |          |                 |rete           |
    |                     |      |          |                 |automaticamente|
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:132,|          |                 |NetworkManager |
    |network-manager-gnome|I:372 |5540      |" "              |(frontend      |
    |                     |      |          |                 |GNOME)         |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |gestore della  |
    |wicd                 |I:24  |36(*)     |config::wicd     |rete cablata e |
    |                     |      |          |                 |wireless       |
    |                     |      |          |                 |(metapacchetto)|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |gestore della  |
    |                     |V:0,  |          |                 |rete cablata e |
    |wicd-cli             |I:1   |60(*)     |" "              |wireless       |
    |                     |      |          |                 |(client a riga |
    |                     |      |          |                 |di comando)    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |gestore della  |
    |wicd-curses          |V:0,  |176(*)    |" "              |rete cablata e |
    |                     |I:3   |          |                 |wireless       |
    |                     |      |          |                 |(client Curses)|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |gestore della  |
    |wicd-daemon          |V:19, |992(*)    |" "              |rete cablata e |
    |                     |I:26  |          |                 |wireless       |
    |                     |      |          |                 |(demone)       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |gestore della  |
    |wicd-gtk             |V:15, |576(*)    |" "              |rete cablata e |
    |                     |I:25  |          |                 |wireless       |
    |                     |      |          |                 |(client GTK+)  |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumenti      |
    |                     |      |          |                 |amministrativi |
    |iptables             |V:300,|2520      |config::Netfilter|per filtraggio |
    |                     |I:993 |          |                 |di pacchetti di|
    |                     |      |          |                 |rete e NAT     |
    |                     |      |          |                 |(Netfilter)    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |iproute2, IPv6 |
    |                     |      |          |                 |e altra        |
    |iproute2             |V:672,|2867      |config::iproute2 |configurazione |
    |                     |I:926 |          |                 |di rete        |
    |                     |      |          |                 |avanzata: ip(8)|
    |                     |      |          |                 |, tc(8), ecc.  |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |rinomina le    |
    |                     |      |          |                 |interfacce di  |
    |ifrename             |V:0,  |125       |" "              |rete in base a |
    |                     |I:3   |          |                 |vari criteri   |
    |                     |      |          |                 |statici:       |
    |                     |      |          |                 |ifrename(8)    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |mostra e       |
    |                     |V:102,|          |                 |modifica le    |
    |ethtool              |I:261 |597       |" "              |impostazioni   |
    |                     |      |          |                 |dei device     |
    |                     |      |          |                 |Ethernet       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |testa la       |
    |                     |      |          |                 |raggiungibilità|
    |                     |V:234,|          |                 |di rete di un  |
    |iputils-ping         |I:997 |113       |test::iproute2   |host remoto con|
    |                     |      |          |                 |nome host o    |
    |                     |      |          |                 |indirizzo IP   |
    |                     |      |          |                 |(iproute2)     |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |testa la       |
    |                     |      |          |                 |raggiungibilità|
    |                     |V:8,  |          |                 |di rete di un  |
    |iputils-arping       |I:127 |55        |" "              |host remoto    |
    |                     |      |          |                 |specificato con|
    |                     |      |          |                 |il suo         |
    |                     |      |          |                 |indirizzo ARP  |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |traccia il     |
    |iputils-tracepath    |V:4,  |72        |" "              |percorso di    |
    |                     |I:60  |          |                 |rete verso un  |
    |                     |      |          |                 |host remoto    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |toolkit di rete|
    |                     |      |          |                 |NET-3          |
    |                     |V:234,|          |                 |(net-tools,    |
    |net-tools            |I:634 |991       |config::net-tools|configurazione |
    |                     |      |          |                 |di rete IPv4): |
    |                     |      |          |                 |ifconfig(8),   |
    |                     |      |          |                 |ecc.           |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |testa la       |
    |                     |      |          |                 |raggiungibilità|
    |                     |V:0,  |          |                 |della rete di  |
    |inetutils-ping       |I:1   |359       |test::net-tools  |un host remoto |
    |                     |      |          |                 |con nome host o|
    |                     |      |          |                 |indirizzo IP   |
    |                     |      |          |                 |(datato, GNU)  |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |testa la       |
    |                     |      |          |                 |raggiungibilità|
    |                     |      |          |                 |di rete di un  |
    |arping               |V:2,  |77        |" "              |host remoto    |
    |                     |I:29  |          |                 |specificato con|
    |                     |      |          |                 |il suo         |
    |                     |      |          |                 |indirizzo ARP  |
    |                     |      |          |                 |(datato)       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |traccia il     |
    |                     |      |          |                 |percorso di    |
    |traceroute           |V:63, |159       |" "              |rete verso un  |
    |                     |I:936 |          |                 |host remoto    |
    |                     |      |          |                 |(datato,       |
    |                     |      |          |                 |console)       |
    |---------------------+------+----------+-----------------+---------------|
    |isc-dhcp-client      |V:231,|686       |config::low-level|client DHCP    |
    |                     |I:979 |          |                 |               |
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:332,|          |                 |supporto client|
    |wpasupplicant        |I:507 |3436      |" "              |per WPA e WPA2 |
    |                     |      |          |                 |(IEEE 802.11i) |
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:0,  |          |                 |client GUI Qt  |
    |wpagui               |I:2   |781       |" "              |per WPA        |
    |                     |      |          |                 |supplicant     |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumenti per  |
    |                     |V:188,|          |                 |manipolare le  |
    |wireless-tools       |I:254 |297       |" "              |estensioni     |
    |                     |      |          |                 |wireless per   |
    |                     |      |          |                 |Linux          |
    |---------------------+------+----------+-----------------+---------------|
    |ppp                  |V:206,|1054      |" "              |connessione PPP|
    |                     |I:474 |          |                 |/PPPoE con chat|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento di   |
    |                     |      |          |                 |aiuto di       |
    |pppoeconf            |V:0,  |192       |config::helper   |configurazione |
    |                     |I:8   |          |                 |per la         |
    |                     |      |          |                 |connessione    |
    |                     |      |          |                 |PPPoE          |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento di   |
    |pppconfig            |V:1,  |801       |" "              |aiuto per la   |
    |                     |I:2   |          |                 |connessione PPP|
    |                     |      |          |                 |con chat       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento di   |
    |                     |V:0,  |          |                 |aiuto per la   |
    |wvdial               |I:5   |249       |" "              |connessione PPP|
    |                     |      |          |                 |con wvdial e   |
    |                     |      |          |                 |ppp            |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |traccia il     |
    |                     |V:6,  |          |                 |percorso di    |
    |mtr-tiny             |I:54  |161       |test::low-level  |rete verso un  |
    |                     |      |          |                 |host remoto    |
    |                     |      |          |                 |(curses)       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |traccia il     |
    |                     |V:4,  |          |                 |percorso di    |
    |mtr                  |I:43  |214       |" "              |rete verso un  |
    |                     |      |          |                 |host remoto    |
    |                     |      |          |                 |(curses e GTK+)|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumenti per  |
    |                     |V:2,  |          |                 |operazioni     |
    |gnome-nettool        |I:45  |2105      |" "              |comuni sulle   |
    |                     |      |          |                 |informazioni di|
    |                     |      |          |                 |rete (GNOME)   |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento per  |
    |                     |      |          |                 |mappatura della|
    |nmap                 |V:31, |4452      |" "              |rete /         |
    |                     |I:253 |          |                 |esplorazione   |
    |                     |      |          |                 |delle porte    |
    |                     |      |          |                 |(Nmap, console)|
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |strumento per  |
    |                     |      |          |                 |mappatura della|
    |zenmap               |V:2,  |2939      |" "              |rete /         |
    |                     |I:9   |          |                 |esplorazione   |
    |                     |      |          |                 |delle porte    |
    |                     |      |          |                 |(GTK+)         |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |analizzatore   |
    |tcpdump              |V:19, |1329      |" "              |del traffico di|
    |                     |I:204 |          |                 |rete (Tcpdump, |
    |                     |      |          |                 |console)       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |analizzatore   |
    |                     |      |          |                 |del traffico di|
    |wireshark            |I:55  |64        |" "              |rete           |
    |                     |      |          |                 |(Wireshark,    |
    |                     |      |          |                 |GTK+)          |
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:3,  |          |                 |analizzatore   |
    |tshark               |I:34  |407       |" "              |del traffico di|
    |                     |      |          |                 |rete (console) |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |produce un     |
    |                     |V:0,  |          |                 |riassunto delle|
    |tcptrace             |I:3   |401       |" "              |connessioni    |
    |                     |      |          |                 |dall'output di |
    |                     |      |          |                 |tcpdump        |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |sistema        |
    |                     |      |          |                 |flessibile di  |
    |snort                |V:0,  |2206      |" "              |rilevazione    |
    |                     |I:1   |          |                 |delle          |
    |                     |      |          |                 |intrusioni di  |
    |                     |      |          |                 |rete (Snort)   |
    |---------------------+------+----------+-----------------+---------------|
    |                     |V:1,  |          |                 |mostra l'uso   |
    |ntopng               |I:2   |969       |" "              |della rete nel |
    |                     |      |          |                 |browser web    |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |client di rete |
    |                     |V:64, |          |                 |forniti con    |
    |dnsutils             |I:517 |256       |" "              |BIND: nslookup |
    |                     |      |          |                 |(8), nsupdate  |
    |                     |      |          |                 |(8), dig       |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |controlla      |
    |                     |      |          |                 |l'informazione |
    |                     |V:0,  |          |                 |DNS di zona    |
    |dlint                |I:7   |53        |" "              |usando         |
    |                     |      |          |                 |interrogazioni |
    |                     |      |          |                 |del server di  |
    |                     |      |          |                 |nomi           |
    |---------------------+------+----------+-----------------+---------------|
    |                     |      |          |                 |traccia una    |
    |dnstracer            |V:0,  |61        |" "              |catena di      |
    |                     |I:2   |          |                 |server DNS fino|
    |                     |      |          |                 |alla sorgente  |
    +-------------------------------------------------------------------------+


%

5.1.1. Risoluzione dei nomi di host

    La risoluzione del nome host è attualmente supportata dal
    meccanismo NSS (Name Service Switch). Il flusso di eventi nella
    risoluzione è il seguente.

     1. Il file "/etc/nsswitch.conf" con blocchi tipo "hosts: files
        dns" detta l'ordine di risoluzione dei nomi di host. (Questo
        rimpiazza la vecchia funzionalità del blocco "order in "/etc/
        host.conf".)

     2. Il metodo files è invocato per primo. Se il nome host viene
        trovato nel file "/etc/hosts", vengono restituiti tutti gli
        indirizzi validi per esso e il programma termina. (Il file "/
        etc/host.conf" contiene "multi on".)

     3. Viene invocato il metodo dns. Se il nome host viene trovato
        dalla interrogazione al DNS (Internet Domain Name System,
        sistema dei nomi di dominio Internet), identificato dal file
        "/etc/resolv.conf", vengono restituiti tutti gli indirizzi
        validi per esso e il programma termina.

    Per esempio, "/etc/hosts" contiene righe come le seguenti.

    127.0.0.1 localhost
    127.0.1.1 <nome_host>

    # Le righe seguenti sono desiderabili per host con supporto per IPv6
    ::1     ip6-localhost ip6-loopback
    fe00::0 ip6-localnet
    ff00::0 ip6-mcastprefix
    ff02::1 ip6-allnodes
    ff02::2 ip6-allrouters
    ff02::3 ip6-allhosts

    Ogni riga inizia con un indirizzo IP e prosegue con l'hostname
    associato.

    L'indirizzo IP 127.0.1.1 nella seconda riga dell'esempio può non
    essere presente in altri sistemi simil-Unix. L'Installatore
    Debian crea questa voce per i sistemi senza un indirizzo IP
    permanente come soluzione per alcuni software (es., GNOME) come
    documentato nel bug#719621.

    Il <nome_host> corrisponde al nome host definito in "/etc/
    hostname".

    Per un sistema con un indirizzo IP permanente, si dovrebbe usare
    qui tale indirizzo invece di 127.0.1.1.

    Per un sistema con un indirizzo IP permanente e un FQDN (Fully
    Qualified Domain Name, nome di dominio pienamente qualificato)
    fornito dal DNS (Domain Name System), dovrebbe essere usato qui
    il canonico <nome_host>.<nome_dominio>, invece del semplice
    <nome_host>.

    Il file "/etc/resolv.conf" è un file statico se non è installato
    il pacchetto resolvconf. Se invece quest'ultimo è installato il
    file è un collegamento simbolico. In ogni caso contiene le
    informazioni che inizializzano le routine del risolutore. Se il
    DNS si trova all'IP="192.168.11.1", il file conterrà la riga
    seguente.

    nameserver 192.168.11.1

    Il pacchetto resolvconf rendo questo file "/etc/resolv.conf" un
    collegamento simbolico e gestisce il suo contenuto con script
    eseguiti in automatico.

    Per le postazioni PC nei tipici ambienti LAN ad hoc, il nome host
    può essere risolto usando il Multicast DNS (mDNS, Zeroconf) in
    aggiunta ai metodi di base con file e dns.

      * Avahi fornisce un'infrastruttura per il Multicast DNS Service
        Discovery in Debian.

      * È equivalente a Apple Bonjour / Apple Rendezvous.

      * Il pacchetto plugin libnss-mdns fornisce la risoluzione dei
        nomi host attraverso mDNS per la funzionalità GNU Name
        Service Switch (NSS) della libreria C GNU (glibc).

      * Il file "/etc/nsswitch.conf" dovrebbe contenere una sezione
        simile a "hosts: files mdns4_minimal [NOTFOUND=return] dns
        mdns4".

      * I nomi host che terminano con lo pseudo-dominio di livello
        più alto (TLD) ".local" vengono risolti.

      * L'indirizzo multicast del collegamento locale mDNS IPv4
        "224.0.0.251" o il suo equivalente IPv6 "FF02::FB" vengono
        usati per fare interrogazioni DNS per un nome che termina con
        ".local".

    La risoluzione del nome host con il deprecato NETBios su TCP/IP,
    usato dai vecchi sistemi Windows può essere fornita installando
    il pacchetto winbind. Per abilitare questa funzionalità il file "
    /etc/nsswitch.conf" dovrebbe avere una sezione come "hosts: files
    mdns4_minimal [NOTFOUND=return] dns mdns4 wins". (I sistemi
    Windows moderni solitamente usano il metodo dns per la
    risoluzione del nome host.)

    Nota

    L'espansione dei gTLD (generic Top-Level Domain, domini di più
    alto livello generici) nel Domain Name System (Sistema di nomi di
    dominio) è in corso d'opera. Fare attenzione a possibili
    collisioni di nomi quando si sceglie un nome di dominio usato
    solamente all'interno di una LAN.

%

5.1.2. Il nome dell'interfaccia di rete

    Il nome dell'interfaccia di rete, ad esempio eth0, viene
    assegnato a ciascun hardware, quando viene rilevato, nel kernel
    Linux attraverso il meccanismo di configurazione in spazio utente
    udev (vedere Sezione 3.3, «Il sistema udev»). Il nome
    dell'interfaccia di rete è chiamato interfaccia fisica in ifup(8)
    e interfaces(5).

    Per garantire che ciascuna interfaccia di rete abbia un nome
    persistente ad ogni avvio, usando indirizzi MAC ecc., esiste un
    file di regole: "/etc/udev/rules.d/70-persistent-net.rules".
    Questo file viene generato automaticamente dal programma "/lib/
    udev/write_net_rules" eseguito probabilmente dal file
    "persistent-net-generator.rules". Lo si può modificare per
    cambiare le regole di assegnazione dei nomi.

    Attenzione

    Quando si modifica il file delle regole "/etc/udev/rules.d/
    70-persistent-net.rules", si deve mantenere ciascuna regola su
    una singola riga e l'indirizzo MAC in lettere minuscole. Per
    esempio, se si trova in quessto file una voce "FireWire device" e
    una "PCI device", probabilmente si vorrà chiamare "PCI device"
    eth0 e configurarla come interfaccia di rete primaria.

%

5.1.3. L'intervallo degli indirizzi di rete per la LAN

    Ecco un ripasso degli intervalli di indirizzi IPv4 a 32 bit in
    ciascuna classe, riservati per l'uso in reti locali (LAN) dalla
    rfc1918. È garantito che questi indirizzi non creino conflitti
    con altri indirizzi della vera e propria rete Internet.

    Tabella 5.2. Elenco di intervalli di indirizzi di rete

    +---------------------------------------------------------------+
    |Classe|indirizzi di rete| maschera di | maschera  | numero di  |
    |      |                 |    rete     | rete /bit | sottoreti  |
    |------+-----------------+-------------+-----------+------------|
    |A     |10.x.x.x         |255.0.0.0    |/8         |1           |
    |------+-----------------+-------------+-----------+------------|
    |B     |172.16.x.x —     |255.255.0.0  |/16        |16          |
    |      |172.31.x.x       |             |           |            |
    |------+-----------------+-------------+-----------+------------|
    |C     |192.168.0.x —    |255.255.255.0|/24        |256         |
    |      |192.168.255.x    |             |           |            |
    +---------------------------------------------------------------+


    Nota

    Se uno di questi indirizzi viene assegnato ad un host, allora
    l'host non deve accedere ad Internet direttamente, ma deve
    accedervi attraverso un gateway che agisca da proxy per i singoli
    servizi o che, in alternativa, faccia da NAT (Network Address
    Translation, traduzione degli indirizzi di rete). I router a
    banda larga di solito agiscono da NAT per l'ambiente LAN
    dell'utente finale.

%

5.1.4. Il supporto per i dispositivi di rete

    Nonostante la maggior parte dei dispositivi hardware sia
    supportata dal sistema Debian, ci sono alcuni dispositivi di rete
    che necessitano, per essere supportati, firmware non libero
    secondo la definizione nelle DFSG. Vedere Sezione 9.9.6, «Driver
    per hardware e firmware».

%

5.2. La configurazione moderna della rete per il desktop

    Le interfacce di rete sono tipicamente inizializzate in
    "networking.service" per l'interfaccia lo e
    "NetworkManager.service" per le altre interfacce nei moderni
    sistemi desktop Debian che usano systemd.

    I sistemi Debian squeeze e successivi possono gestire la
    connessione di rete attraverso software per demoni di gestione
    come NetworkManager (NM) (network-manager e pacchetti associati)
    oppure Wicd (wicd e pacchetti associati).

      * Questi sono forniti con propri programmi per l'interfaccia
        utente con GUI o a riga di comando.

      * Sono forniti con un proprio demone come sistema di backend.

      * Permettono al proprio sistema di connettersi facilmente ad
        Internet.

      * Permettono una facile gestione della configurazione delle
        reti cablate e wireless.

      * Permettono di configurare la rete in modo indipendente dal
        datato pacchetto ifupdown.

    Nota

    Non usare questi strumenti di configurazione automatica della
    rete per server. Sono pensati principalmente per utenti con
    desktop mobili su portatili.

    Questi strumenti moderni di configurazione della rete devono
    essere configurati in modo corretto per evitare conflitti con il
    datato pacchetto ifupdown e con il suo file di configurazione "/
    etc/network/interfaces".

    Nota

    Alcune funzionalità di questi strumenti automatici di
    configurazione della rete possono soffrire dei problemi. Non sono
    così robusti come il vecchio pacchetto ifupdown. Controllare il
    BTS di network-manager e il BTS di wicd per vedere i problemi e i
    limiti attuali.

%

5.2.1. Strumenti grafici di configurazione della rete

    La documentazione ufficiale per NM e Wicd su Debian è fornita
    rispettivamente in "/usr/share/doc/network-manager/README.Debian"
    e "/usr/share/doc/wicd/README.Debian".

    Fondamentalmente, la configurazione di rete per il desktop viene
    fatta nel modo seguente.

     1. Aggiungere l'utente desktop, ad esempio pippo, al gruppo
        "netdev" con il comando seguente. (In alternativa farlo
        automaticamente attraverso D-bus nei moderni ambienti desktop
        come GNOME e KDE).

        $ sudo adduser pippo netdev

     2. Mantenere la configurazione di "/etc/network/interfaces"
        semplice come la seguente.
   
        auto lo
        iface lo inet loopback

     3. Riavviare NM o Wicd con il comando seguente.

        $ sudo /etc/init.d/network-manager restart

        $ sudo /etc/init.d/wicd restart

     4. Configurare la propria rete attraverso l'interfaccia grafica.

    Nota

    Solo le interfacce che non sono elencate in "/etc/network/
    interfaces" sono gestite da NM o Wicd, per evitare conflitti con
    ifupdown.

    Suggerimento

    Se si desirano estendere le capacità di configurazione della rete
    di NM, cercare i moduli plugin appropriati e i pacchetti
    supplementari, quali network-manager-openconnect,
    network-manager-openvpn-gnome, network-manager-pptp-gnome,
    mobile-broadband-provider-info, gnome-bluetooth, ecc. Lo stesso
    vale per quelli di Wicd.

    Attenzione

    Questi strumenti di configurazione automatica della rete possono
    non essere compatibili con alcune configurazioni esotiche del
    datato ifupdown contenute in "/etc/network/interfaces", come
    quelle in Sezione 5.6, «Configurazione base della rete con
    ifupdown (metodo vecchio)» e Sezione 5.7, «Configurazione
    avanzata della rete con ifupdown (strumento datato)». Per
    informazioni sui problemi e le limitazioni attualmente esistenti,
    controllare il BTS di network-manager e il BTS di wicd.

%

5.3. La configurazione moderna della rete senza GUI

    Con systemd, la rete può essere configurata invece in /etc/
    systemd/network/. Vedere systemd-resolved(8), resolved.conf(5) e 
    systemd-networkd(8).

    Ciò permette la configurazione moderna della rete senza GUI.

    Una configurazione di client DHCP può essere impostata creando "/
    etc/systemd/network/dhcp.network". Es.:

    [Match]
    Name=en*
   
    [Network]
    DHCP=yes

    Una configurazione di rete statica può essere impostata creando "
    /etc/systemd/network/static.network". Es.:

    [Match]
    Name=en*
   
    [Network]
    Address=192.168.0.15/24
    Gateway=192.168.0.1

%

5.4. La vecchia connessione e configurazione di rete

    Quando il metodo descritto in Sezione 5.2, «La configurazione
    moderna della rete per il desktop» non è sufficiente per le
    proprie necessità, si dovrebbe usare il metodo datato di
    connessione e configurazione della rete che combina assieme
    diversi strumenti più semplici.

    La connessione di rete in vecchio stile è specifica per ciascun
    metodo (vedere Sezione 5.5, «Il metodo di connessione alla rete
    (datato)»).

    Esistono 2 tipi di programma per la configurazione a basso
    livello della rete in Linux (vedere Sezione 5.8.1, «Comandi
    iproute2»).

      * I vecchi programmi net-tools (ifconfig(8), …) provengono dal
        sistema di rete Linux NET-3. La maggior parte di essi è ora
        superata.

      * I nuovi programmi Linux iproute2 (ip(8), …) formano l'attuale
        sistema Linux di rete.

    Anche se questi programmi di rete a basso livello sono potenti,
    sono complicati da usare. Perciò sono stati creati strumenti di
    configurazione della rete di alto livello.

    Il pacchetto ifupdown è lo standard de facto per una
    configurazione di rete di altro livello di questo tipo in Debian.
    Permette di attivare la rete semplicemente eseguendo, per
    esempio, "ifup eth0". Il suo file di configurazione è il file "/
    etc/network/interfaces" e i suoi contenuti hanno tipicamente un
    aspetto simile al seguente.

    auto lo
    iface lo inet loopback
   
    auto eth0
    iface eth0 inet dhcp

    Il pacchetto resolvconf è stato creato per fornire al sistema
    ifupdown il supporto per una riconfigurazione indolore della
    risoluzione degli indirizzi di rete, riscrivendo automaticamente
    il file "/etc/resolv.conf" di configurazione del risolutore.
    Attualmente la maggior parte dei pacchetti di configurazione
    della rete in Debian sono modificati per usare il pacchetto
    resolvconf (vedere "/usr/share/doc/resolvconf/README.Debian").

    Per automatizzare la configurazione dinamica di ambienti di rete
    come un PC portatile in una LAN cablata, sono stati creati script
    di aiuto per il pacchetto ifupdown, come ifplugd, guessnet,
    ifscheme, ecc. Essi sono relativamente difficili da usare ma si
    comportano bene con il sistema ifupdown esistente.

    Questi sono spiegati in dettaglio con esempi (vedere Sezione 5.6,
    «Configurazione base della rete con ifupdown (metodo vecchio)» e
    Sezione 5.7, «Configurazione avanzata della rete con ifupdown
    (strumento datato)»).

%

5.5. Il metodo di connessione alla rete (datato)

    Attenzione

    I metodi per testare la connessione descritti in questa sezione
    sono pensati per fare prove. Non sono pensati per essere usati
    direttamente per connettersi alla rete quotidianamente. È
    consigliato il loro uso con NM, Wicd o il pacchetto ifupdown
    (vedere Sezione 5.2, «La configurazione moderna della rete per il
    desktop» e Sezione 5.6, «Configurazione base della rete con
    ifupdown (metodo vecchio)»).

    I metodi di connessione tipici alla rete e i percorsi tipici per
    la connessione per un PC possono essere schematizzati nel modo
    seguente.

    Tabella 5.3. Elenco dei metodi di connessione alla rete e dei
    percorsi di connessione

    +---------------------------------------------------------------+
    |    PC    | metodo di |        percorso di connessione         |
    |          |connessione|                                        |
    |----------+-----------+----------------------------------------|
    |Porta     |           |⇔ modem ⇔ POTS ⇔ punto di accesso       |
    |seriale   |PPP        |dial-up ⇔ ISP                           |
    |(ppp0)    |           |                                        |
    |----------+-----------+----------------------------------------|
    |Porta     |PPPoE/DHCP/|⇔ modem BB (banda larga) ⇔ servizio BB ⇔|
    |ethernet  |Statico    |punto di accesso BB ⇔ ISP               |
    |(eth0)    |           |                                        |
    |----------+-----------+----------------------------------------|
    |Porta     |DHCP/      |⇔ LAN ⇔ router BB (banda larga) con NAT |
    |ethernet  |Statico    |(traduzione degli indirizzi di rete (⇔  |
    |(eth0)    |           |modem BB …)                             |
    +---------------------------------------------------------------+


    Quella che segue è una schematizzazione degli script di
    configurazione per ciascun metodo di connessione.

    Tabella 5.4. Elenco di configurazioni della connessione di rete

    +---------------------------------------------------------------+
    |  metodo di   |      configurazione       |pacchetto(i) backend|
    | connessione  |                           |                    |
    |--------------+---------------------------+--------------------|
    |PPP           |pppconfig per creare chat  |pppconfig, ppp      |
    |              |deterministiche            |                    |
    |--------------+---------------------------+--------------------|
    |PPP           |wvdialconf per creare chat |ppp, wvdial         |
    |(alternativo) |euristiche                 |                    |
    |--------------+---------------------------+--------------------|
    |PPPoE         |pppoeconf per creare chat  |pppoeconf, ppp      |
    |              |deterministiche            |                    |
    |--------------+---------------------------+--------------------|
    |DHCP          |descritto in "/etc/dhcp/   |isc-dhcp-client     |
    |              |dhclient.conf"             |                    |
    |--------------+---------------------------+--------------------|
    |IP statico    |descritto in "/etc/network/|iproute o net-tools |
    |(IPv4)        |interfaces"                |(obsolete)          |
    |--------------+---------------------------+--------------------|
    |IP statico    |descritto in "/etc/network/|iproute             |
    |(IPv6)        |interfaces"                |                    |
    +---------------------------------------------------------------+


    Gli acronimi per le connessioni di rete hanno il significato
    seguente.

    Tabella 5.5. Elenco di acronimi per le connessioni di rete

    +---------------------------------------------------------------+
    |   acronimo   |                  significato                   |
    |--------------+------------------------------------------------|
    |POTS          |Plain Old Telephone Service, il semplice vecchio|
    |              |servizio telefonico                             |
    |--------------+------------------------------------------------|
    |BB            |banda larga                                     |
    |--------------+------------------------------------------------|
    |servizio BB   |ad esempio, la linea digitale (DSL), la TV via  |
    |(BB-service)  |cavo o fibre ottiche                            |
    |--------------+------------------------------------------------|
    |modem BB      |ad esempio, il modem DSL, il modem via cavo o   |
    |              |l'ONT, il terminale di rete ottica              |
    |--------------+------------------------------------------------|
    |LAN           |rete locale (Local Area Network)                |
    |--------------+------------------------------------------------|
    |WAN           |rete geografica (Wide Area Network)             |
    |--------------+------------------------------------------------|
    |DHCP          |Protocollo di Configurazione Dinamica dell'Host |
    |--------------+------------------------------------------------|
    |PPP           |protocollo Point-to-Point                       |
    |--------------+------------------------------------------------|
    |PPPoE         |protocollo Point-to-Point via Ethernet          |
    |--------------+------------------------------------------------|
    |ISP           |Fornitore di servizi Internet (Internet Service |
    |              |Provider)                                       |
    +---------------------------------------------------------------+


    Nota

    I servizi di connessione WAN attraverso la TV via cavo sono
    generalmente serviti da DHCP o PPPoE. Quelli ADSL e FTTP sono
    generalmente serviti da PPPoE. Si deve consultare il proprio
    fornitore di servizi Internet per i requisiti esatti di
    configurazione della connessione WAN.

    Nota

    Quando un router BB è usato per creare un ambiente LAN domestico,
    i PC della LAN sono connessi alla WAN attraverso il router BB con
    NAT (traduzione degli indirizzi di rete). In questi casi alle
    interfacce di rete dei PC nella LAN sono assegnati dal router BB
    indirizzi IP statici o DHCP. Il router BB deve essere configurato
    per connettersi alla WAN seguendo le istruzioni del proprio
    fornitore di servizi Internet.

%

5.5.1. Connessione DHCP con Ethernet

    Le reti tipiche moderne per le abitazioni e le piccole aziende,
    cioè le LAN, sono connesse alla WAN (Internet) usando un router
    per banda larga economico. La LAN dietro questo router è di
    solito servita dal server DHCP (protocollo di configurazione
    dinamica dell'host) in esecuzione sul router.

    Installare semplicemente il pacchetto isc-dhcp-client per
    Ethernet con DHCP (protocollo di configurazione dinamica
    dell'host).

    Vedere dhclient.conf(5).

%

5.5.2. Connessione con IP statico con Ethernet

    Per Ethernet con IP statico non è necessaria alcuna azione
    particolare.

%

5.5.3. Connessione PPP con pppconfig

    Lo script di configurazione pppconfig imposta la connessione PPP
    interattivamente chiedendo all'utente di selezionare solamente
    quanto segue.

      * Il numero di telefono

      * Il nome utente per il fornitore di servizi Internet

      * La password per il fornitore di servizi Internet
   
      * La velocità della porta

      * La porta di comunicazione del modem

      * Il metodo di autenticazione

    Tabella 5.6. Elenco dei file di configurazione per la connessione
    PPP con pppconfig

    +---------------------------------------------------------------+
    |    file     |                    funzione                     |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Il file di configurazione per pppd specifico per |
    |peers/       |il fornitore di servizi <nome_isp>, generato da  |
    |<nome_isp>   |pppconfig                                        |
    |-------------+-------------------------------------------------|
    |/etc/        |Il file di configurazione per chat specifico per |
    |chatscripts/ |il fornitore di servizi <nome_isp>, generato da  |
    |<nome_isp>   |pppconfig                                        |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |I parametri generici di esecuzione per ppd       |
    |options      |                                                 |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Dati di autenticazione per PAP (rischio per la   |
    |pap-secret   |sicurezza)                                       |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Dati di autenticazione per PAP (più sicuri)      |
    |chap-secret  |                                                 |
    +---------------------------------------------------------------+


    Attenzione
   
    Se i comandi pon e poff vengono invocati senza argomenti, "
    <nome_isp>" viene impostato a "provider".

    Si può testare la configurazione usando strumenti di
    configurazione di rete a basso livello come nel modo seguente.

    $ sudo pon <nome_isp>
    ...
    $ sudo poff <nome_isp>

    Vedere "/usr/share/doc/ppp/README.Debian.gz".

%

5.5.4. Connessione PPP alternativa con wvdialconf

    Un approccio diverso all'uso di pppd(8) è la sua esecuzione
    tramite wvdial(1) che è fornito nel pacchetto "wvdial. Invece di
    essere pppd ad eseguire chat(8) per comporre il numero e
    negoziare la connessione, è wvdial che fa queste cose e poi avvia
    pppd per tutto il resto.

    Lo script di configurazione wvdialconf imposta la connessione PPP
    interattivamente chiedendo all'utente di selezionare solamente
    quanto segue.

      * Il numero di telefono

      * Il nome utente per il fornitore di servizi Internet

      * La password per il fornitore di servizi Internet

    Nella maggior parte dei casi wvdial crea la connessione con
    successo e mantiene automaticamente un elenco dei dati di
    autenticazione.

    Tabella 5.7. Elenco dei file di configurazione per la connessione
    PPP con wvdialconf

    +---------------------------------------------------------------+
    |    file     |                    funzione                     |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Il file di configurazione per pppd specifico per |
    |peers/wvdial |wvdial, generato da wvdialconf                   |
    |-------------+-------------------------------------------------|
    |/etc/        |Il file di configurazione creato da wvdialconf   |
    |wvdial.conf  |                                                 |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |I parametri generici di esecuzione per ppd       |
    |options      |                                                 |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Dati di autenticazione per PAP (rischio per la   |
    |pap-secret   |sicurezza)                                       |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Dati di autenticazione per PAP (più sicuri)      |
    |chap-secret  |                                                 |
    +---------------------------------------------------------------+


    Si può testare la configurazione usando strumenti di
    configurazione di rete a basso livello come nel modo seguente.

    $ sudo wvdial
    ...
    $ sudo killall wvdial

    Vedere wvdial(1) e wvdial.conf(5).

%

5.5.5. Connessione PPPoE con pppoeconf

    Quando il fornitore di servizi Internet dà una connessione PPPoE
    e si decide di connettere il proprio PC direttamente alla WAN, la
    rete del proprio PC deve essere configurata con PPPoE. PPPoE sta
    per "PPP over Ethernet" (PPP via Ethernet). Lo script di
    configurazione pppoeconf configura la connessione PPPoE in modo
    interattivo.

    I file di configurazione sono i seguenti.

    Tabella 5.8. Elenco dei file di configurazione per la connessione
    PPPoE con pppoeconf

    +---------------------------------------------------------------+
    |      file      |                   funzione                   |
    |----------------+----------------------------------------------|
    |/etc/ppp/peers/ |Il file di configurazione per pppd specifico  |
    |dsl-provider    |per pppoe, generato da pppoeconf              |
    |----------------+----------------------------------------------|
    |/etc/ppp/options|I parametri generici di esecuzione per ppd    |
    |----------------+----------------------------------------------|
    |/etc/ppp/       |Dati di autenticazione per PAP (rischio per la|
    |pap-secret      |sicurezza)                                    |
    |----------------+----------------------------------------------|
    |/etc/ppp/       |Dati di autenticazione per PAP (più sicuri)   |
    |chap-secret     |                                              |
    +---------------------------------------------------------------+


    Si può testare la configurazione usando strumenti di
    configurazione di rete a basso livello come nel modo seguente.

    $ sudo /sbin/ifconfig eth0 up
    $ sudo pon dsl-provider
    ...
    $ sudo poff dsl-provider
    $ sudo /sbin/ifconfig eth0 down

    Vedere "/usr/share/doc/pppoeconf/README.Debian".

%

5.6. Configurazione base della rete con ifupdown (metodo vecchio)

    La configurazione tradizionale della rete TCP/IP in un sistema
    Debian usa il pacchetto ifupdown come strumento ad alto livello.
    Ci sono 2 casi tipici.

      * Per sistemi con IP dinamico, come PC portatili, si dovrebbe
        impostare la rete TCP/IP con il pacchetto resolvconf che
        permette di cambiare facilmente la configurazione di rete
        (vedere Sezione 5.6.4, «Interfaccia di rete servita da DHCP»
        ).

      * Per sistemi con IP statico, come sever, si dovrebbe impostare
        la rete TCP/IP senza il pacchetto resolvconf e mantere
        semplice il proprio sistema (vedere Sezione 5.6.5,
        «Interfaccia di rete con IP statico»).

    Questi metodi di impostazione tradizionali sono piuttosto utili
    se si desidera impostare una configurazione avanzata; si possono
    trovare i dettagli qui di seguito.

    Il pacchetto ifupdown fornisce l'infrastruttura standard per la
    configurazione di rete di alto livello nel sistema Debian. In
    questa sezione viene descritta la configurazione base della rete
    con ifupdown con un'introduzione semplificata e molti esempi
    tipici.

%

5.6.1. Sintassi di base dei comandi

    Il pacchetto ifupdown contiene 2 comandi: ifup(8) e ifdown(8).
    Offrono una configurazione della rete di alto livello in base al
    file di configurazione "/etc/network/interfaces".

    Tabella 5.9. Elenco di comandi base per la configurazione della
    rete con ifupdown

    +---------------------------------------------------------------+
    |comando|                        azione                         |
    |-------+-------------------------------------------------------|
    |ifup   |attiva una interfaccia di rete eth0 con la             |
    |eth0   |configurazione di eth0 se esiste un blocco "iface eth0"|
    |-------+-------------------------------------------------------|
    |ifdown |disattiva una interfaccia di rete eth0 con la          |
    |eth0   |configurazione di eth0 se esiste un blocco "iface eth0"|
    +---------------------------------------------------------------+


    Avvertimento

    Non usare strumenti di configurazione a basso livello, come i
    comandi ifconfig(8) e ip(8), per configurare un'interfaccia nello
    stato attivo (up).

    Nota
   
    Non esiste un comando ifupdown.

%

5.6.2. Sintassi di base di "/etc/network/interfaces"

    La sintassi di base di "/etc/network/interfaces", come spiegato
    in interfaces(5), può essere riassunta nel modo seguente.

    Tabella 5.10. Elenco dei blocchi in "/etc/network/interfaces"

    +---------------------------------------------------------------+
    |         blocco         |             significato              |
    |------------------------+--------------------------------------|
    |"auto <nome_interfaccia>|attiva l'interfaccia                  |
    |"                       |<nome_interfaccia> all'avvio del      |
    |                        |sistema                               |
    |------------------------+--------------------------------------|
    |"allow-auto             |" "                                   |
    |<nome_interfaccia>"     |                                      |
    |------------------------+--------------------------------------|
    |                        |attiva l'interfaccia                  |
    |"allow-hotplug          |<nome_interfaccia> quando il kernel   |
    |<nome_interfaccia>"     |rileva un evento hotplug              |
    |                        |dall'interfaccia                      |
    |------------------------+--------------------------------------|
    |Le righe che iniziano   |definiscono la configurazione di rete |
    |con "iface <nome_config>|<nome_config>                         |
    |…"                      |                                      |
    |------------------------+--------------------------------------|
    |Le righe che iniziano   |definiscono i valori di mappatura di  |
    |con "mapping            |<nome_config> al corrispondente       |
    |<glob_nome_interfaccia>"|<nome_interfaccia>                    |
    |------------------------+--------------------------------------|
    |Le righe che iniziano   |sono commenti e vengono ignorate (i   |
    |con un carattere        |commenti di fine riga non sono        |
    |cancelletto "#"         |supportati)                           |
    |------------------------+--------------------------------------|
    |Le righe che terminano  |estendono la configurazione alla riga |
    |con una barra rovesciata|seguente                              |
    |"\"                     |                                      |
    +---------------------------------------------------------------+


    Le righe con un blocco iface hanno la sintassi seguente.

    iface <nome_config> <famiglia_indirizzi> <nome_metodo>
     <opzione1> <valore1>
     <opzione2> <valore2>
     ...

    Per la configurazione di base non vengono usati i blocchi mapping
    ma viene usato il nome dell'interfaccia di rete come nome della
    configurazione di rete (vedere Sezione 5.7.5, «Il blocco di
    mappatura "mapping"»).

    Avvertimento
   
    Non creare definizioni duplicate per un blocco "iface" per
    un'interfaccia di rete in "/etc/network/interfaces".

%

5.6.3. Interfaccia di rete loopback

    La voce di configurazione seguente, nel file "/etc/network/
    interfaces" attiva l'interfaccia di rete loopback, lo, all'avvio
    del sistema (attraverso il blocco auto).

    auto lo
    iface lo inet loopback

    Questo blocco esiste sempre nel file "/etc/network/interfaces".

%

5.6.4. Interfaccia di rete servita da DHCP

    Dopo aver preparato il sistema con Sezione 5.5.1, «Connessione
    DHCP con Ethernet», l'interfaccia di rete con DHCP viene
    configurata creando una voce di configurazione nel file "/etc/
    network/interfaces" nel modo seguente.

    allow-hotplug eth0
    iface eth0 inet dhcp

    Quando il kernel Linux rileva l'interfaccia fisica eth0, il
    blocco allow-hotplug fa sì che ifup attivi l'interfaccia e il
    blocco iface fa sì che ifup usi DHCP per configurare
    l'interfaccia.

%

5.6.5. Interfaccia di rete con IP statico

    L'interfaccia di rete con IP statico viene configurata creando
    una voce di configurazione nel file "/etc/network/interfaces" nel
    modo seguente.

    allow-hotplug eth0
    iface eth0 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     dns-domain example.com
     dns-nameservers 192.168.11.1

    Quando il kernel Linux rileva l'interfaccia fisica eth0, il
    blocco allow-hotplug fa sì che ifup attivi l'interfaccia e il
    blocco iface fa sì che ifup usi l'IP statico per configurare
    l'interfaccia.

    In questo esempio sono stati dati per veri i seguenti dati.

      * Intervallo di indirizzi IP della rete LAN: 192.168.11.0 -
        192.168.11.255

      * Indirizzo IP del gateway: 192.168.11.1

      * Indirizzo IP del PC: 192.168.11.100

      * Il pacchetto resolvconf è installato.

      * Nome di dominio: "example.com"

      * Indirizzo IP del server DNS: 192.168.11.1

    Quando il pacchetto resolvconf non è installato, la
    configurazione relativa al DNS deve essere fatta manualmente
    modificando "/etc/resolv.conf" nel modo seguente.

    nameserver 192.168.11.1
    domain example.com

    Attenzione

    L'indirizzo IP usato nell'esempio soprastante non deve essere
    copiato pari pari. È necessario mettere i numeri IP della reale
    configurazione della propria rete.

%

5.6.6. Informazioni di base sull'interfaccia LAN wireless

    La LAN wireless (in breve WLAN) fornisce connettività veloce
    wireless attraverso comunicazioni con espansione di spettro in
    bande radio senza licenza basate sull'insieme di standard
    chiamato IEEE 802.11.

    Le interfacce WLAN sono quasi come normali interfacce Ethernet,
    ma richiedono alcuni dati sull'identità della rete e sulla chiave
    di cifratura per essere usate una volta inizializzate. Gli
    strumenti di rete di alto livello per esse sono esattamente gli
    stessi delle interfacce di rete, tranne che i nomi delle
    interfacce sono un po' diversi come eth1, wlan0, ath0, wifi0, … a
    seconda dei driver del kernel utilizzati.

    Suggerimento
   
    Il device wmaster0 è il device master che è un device interno
    usato solamente da SoftMAC con la nuova API mac80211 di Linux.

    Quelle che seguono sono alcune parole chiave relative alla WLAN
    che è bene ricordare.

    Tabella 5.11. Elenco di acronimi per WLAN

    +---------------------------------------------------------------+
    |acronimo|    forma estesa     |          significato           |
    |--------+---------------------+--------------------------------|
    |        |Network ID (ID di    |identificativo di rete a 16 bit |
    |NWID    |rete)                |usato da reti WaveLAN pre-802.11|
    |        |                     |(molto deprecato)               |
    |--------+---------------------+--------------------------------|
    |        |(Extended) Service   |il nome di rete dei punti di    |
    |        |Set Identifier       |accesso wireless (Wireless      |
    |(E)SSID |(Identificativo di   |Access Points, AP) interconnessi|
    |        |insieme di servizi   |a formare una LAN wireless      |
    |        |(esteso))            |802.11; identificativo del      |
    |        |                     |dominio                         |
    |--------+---------------------+--------------------------------|
    |        |Wired Equivalent     |standard di cifratura per       |
    |WEP,    |Privacy (Privacy     |wireless a 64 bit (128 bit) di  |
    |(WEP2)  |equivalente alla     |prima generazione con chiave a  |
    |        |cablata)             |40-bit (deprecato)              |
    |--------+---------------------+--------------------------------|
    |        |Wi-Fi Protected      |standard di cifratura per       |
    |WPA     |Access (Accesso Wi-Fi|wireless di seconda generazione |
    |        |protetto)            |(maggior parte del 802.11i),    |
    |        |                     |compatibile con WEP             |
    |--------+---------------------+--------------------------------|
    |        |Wi-Fi Protected      |standard di cifratura per       |
    |WPA2    |Access 2 (Accesso    |wireless di terza generazione   |
    |        |Wi-Fi protetto 2)    |(tutto il 802.11i), non         |
    |        |                     |compatibile con WEP             |
    +---------------------------------------------------------------+


    Di fatto la scelta del protocollo è di solito limitata dal router
    wireless che si possiede.

%

5.6.7. Interfaccia LAN wireless con WPA/WPA2

    È necessario installare il pacchetto wpasupplicant per supportare
    la WLAN con i nuovi WPA/WPA2.

    In caso di IP DHCP per la connessione WLAN, la voce nel file "/
    etc/network/interfaces" dovrebbe essere come la seguente.

    allow-hotplug ath0
    iface ath0 inet dhcp
     wpa-ssid zonacasa
     # la chiave di cifratura, psk, esadecimale e' codificata da una passphrase in puro testo
     wpa-psk 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f

    Vedere "/usr/share/doc/wpasupplicant/README.modes.gz".

%

5.6.8. Interfaccia LAN wireless con WEP

    È necessario installare il pacchetto wireless-tools per
    supportare la rete WLAN con il vecchio WEP. (Il proprio router
    economico potrebbe usare ancora questa infrastruttura non sicura,
    ma è meglio di niente.)

    Attenzione
   
    Notare che il traffico di rete in una WLAN con WEP può essere
    spiato da altri.

    In caso di IP DHCP per la connessione WLAN, la voce nel file "/
    etc/network/interfaces" dovrebbe essere come la seguente.

    allow-hotplug eth0
    iface eth0 inet dhcp
     wireless-essid Casa
     wireless-key1 0123-4567-89ab-cdef
     wireless-key2 12345678
     wireless-key3 s:password
     wireless-defaultkey 2
     wireless-keymode open

    Vedere "/usr/share/doc/wireless-tools/README.Debian".

%

5.6.9. Connessione PPP

    È necessario come prima cosa configurare la connessione PPP come
    descritto in precedenza (vedere Sezione 5.5.3, «Connessione PPP
    con pppconfig»). Quindi aggiungere nel file "/etc/network/
    interfaces" la voce per il device PPP primario ppp0 nel modo
    seguente.

    iface ppp0 inet ppp
     provider <nome_isp>

%

5.6.10. Connessione PPP alternativa

    È necessario come prima cosa configurare la connessione PPP
    alternativa con wvdial, come descritto in precedenza (vedere
    Sezione 5.5.4, «Connessione PPP alternativa con wvdialconf»).
    Quindi aggiungere nel file "/etc/network/interfaces" la voce per
    il device PPP primario ppp0 nel modo seguente.

    iface ppp0 inet wvdial

%

5.6.11. Connessione PPPoE

    Per i PC connessi direttamente alla WAN con servizio PPPoE, è
    necessario configurare il sistema con la connessione PPPoE come
    descritto in precedenza (vedere Sezione 5.5.5, «Connessione PPPoE
    con pppoeconf»). Quindi aggiungere nel file "/etc/network/
    interfaces" la voce per il device PPPoE primario eth0 nel modo
    seguente.

    allow-hotplug eth0
    iface eth0 inet manual
     pre-up /sbin/ifconfig eth0 up
     up ifup ppp0=dsl
     down ifdown ppp0=dsl
     post-down /sbin/ifconfig eth0 down
    # Quello che segue e' usato solo internamente
    iface dsl inet ppp
     provider dsl-provider

%

5.6.12. Lo stato di configurazione della rete di ifupdown

    Il file "/etc/network/run/ifstate" memorizza gli stati previsti
    di configurazione della rete per tutte le interfacce di rete
    attualmente attive gestite dal pacchettoifupdown.
    Sfortunatamente, anche se il tentativo del sistema ifupdown di
    attivare un'interfaccia come previsto fallisce, il file "/etc/
    network/run/ifstate" la elenca come attiva.

    Se l'output del comando ifconfig(8) per un'interfaccia non ha una
    riga come quella dell'esempio seguente, l'interfaccia non può
    essere usata come parte di una rete IPV4.

      inet addr:192.168.11.2  Bcast:192.168.11.255  Mask:255.255.255.0

    Nota

    Per i dispositivi Ethernet connessi con PPPoE, l'output di 
    ifconfig(8) manca di una riga come quella dell'esempio
    precedente.

%

5.6.13. Riconfigurazione base della rete

    Quando si cerca di riconfigurare un'interfaccia, ad esempio eth0,
    per prima cosa è necessario disattivarla con il comando "sudo
    ifdown eth0". Questo rimuove la voce corrispondente ad eth0 dal
    file "/etc/network/run/ifstate". (Potrebbero essere generati
    messaggi di errore se eth0 non è attiva o se non era stata
    configurata in modo conrretto.) Per il momento, fare questa
    azione per una postazione di lavoro per singolo utente sembra
    sicuro in qualunque momento.

    Si può ora modificare liberamente il contenuto di "/etc/network/
    interfaces" in base alle proprie necessità per riconfigurare
    l'interfaccia di rete eth0.

    In seguito si può riattivare eth0 con il comando "sudo ifup eth0
    ".

    Suggerimento
   
    Si può (re)inizializzare l'interfaccia di rete semplicemente
    usando "sudo ifdown eth0;sudo ifup eth0".

%

5.6.14. Pacchetto ifupdown-extra

    Il pacchetto ifupdown-extra fornisce facili testi della
    connessione di rete per l'uso con il pacchetto ifupdown.

      * Il comando network-test(1) può essere usato dalla shell.
   
      * Gli script automatici vengono eseguiti per ogni invocazione
        del comando ifup.

    Il comando network-test libera l'utente dal faticoso compito di
    eseguire comandi a basso livello per analizzare i problemi di
    rete.

    Gli script automatici vengono installati in "/etc/network/*/" e
    effettuano le azioni seguenti.

      * Verifica della connessione del cavo di rete

      * Verifica dell'eventuale uso duplicato di indirizzi IP

      * Impostazione di instradamenti statici del sistema in base
        alle definizioni in "/etc/network/routes"

      * Verifica della raggiungibilità del gateway di rete

      * Registrazione dei risultati nel file "/var/log/syslog"

    Queste voci nel syslog sono piuttosto utili per l'amministrazione
    di problemi di rete nel sistema remoto.

    Suggerimento

    Il comportamento automatico del pacchetto ifupdown-extra è
    configurabile con "/etc/default/network-test". Alcuni di questi
    controlli automatici rallentano un po' il sistema all'avvio dato
    che è necessario un po' di tempo per restare in ascolto per le
    risposte ARP.

5.7. Configurazione avanzata della rete con ifupdown (strumento
datato)

    Le funzionalità del pacchetto ifupdown possono essere migliorate
    andando oltre quanto è stato descritto in Sezione 5.6,
    «Configurazione base della rete con ifupdown (metodo vecchio)»,
    con qualche informazione più avanzata.

    Le funzionalità descritte in questa sezione sono completamente
    opzionali. Essendo io pigro e minimalista, raramente faccio lo
    sforzo di usarle.

    Attenzione

    Se non si è riusciti a configurare la connessione di rete usando
    le informazioni in Sezione 5.6, «Configurazione base della rete
    con ifupdown (metodo vecchio)», cercare una soluzione nelle
    informazioni che seguono non farà che peggiorare le cose.

%

5.7.1. Il pacchetto ifplugd

    Il pacchetto ifplugd è un vecchio strumento di configurazione
    della rete che può gestire soltanto connessioni Ethernet. Risolve
    problemi di cavi Ethernet sconnessi/ricconessi per PC portatili,
    ecc. Se è installato NetworkManager o Wicd (vedere Sezione 5.2,
    «La configurazione moderna della rete per il desktop»), questo
    pacchetto non è necessario.

    Questo pacchetto esegue un demone e rimpiazza le funzionalità 
    auto o allow-hotplug (vedere Tabella 5.10, «Elenco dei blocchi in
    "/etc/network/interfaces"») ed abilita le interfacce quando
    queste vengono connesse alla rete.

    Ecco come usare il pacchetto ifplugd per la porta Ethernet
    interna, ad esempio eth0.

     1. Rimuovere il blocco "auto eth0" o "allow-hotplug eth0" dal
        file "/etc/network/interfaces".

     2. Mantenere i blocchi "iface eth0 inet …" e "mapping …" nel
        file "/etc/network/interfaces".
   
     3. Installare il pacchetto ifplugd.

     4. Eseguire "sudo dpkg-reconfigure ifplugd".

     5. Indicare eth0 come "interfaccia statica che ifplugd deve
        osservare".

    Ora, dopo la riconfigurazione, la rete funziona come voluto.

      * All'avvio o al rilevamento dell'hardware, l'interfaccia non
        viene attivata da sé stessa.

          + Procedura di avvio veloce senza lunghi tempi di attesa
            per DHCP.

          + Nessuna interfaccia attivata in modo inconsueto senza un
            appropriato indirizzo IPv4 (vedere Sezione 5.6.12, «Lo
            stato di configurazione della rete di ifupdown»).
   
      * Quando viene rilevato il cavo Ethernet l'interfaccia viene
        attivata.

      * Dopo un certo intervallo di tempo dalla disconnessione del
        cavo Ethernet, l'interfaccia viene automaticamente
        disattivata.

      * Quando viene inserito un altro cavo Ethernet, l'interfaccia è
        attivata nel nuovo ambiente.

    Suggerimento

    Gli argomenti del comando ifplugd(8) possono impostare il suo
    comportamento, come il ritardo nella riconfigurazione delle
    interfacce.

%

5.7.2. Il pacchetto ifmetric

    Il pacchetto ifmetric permette di manipolare la metrica di
    instradamenti a posteriori, anche per DHCP.

    Le azioni seguenti impostano l'interfaccia eth0 come preferita
    rispetto alla interfaccia wlan0.

     1. Installare il pacchetto ifmetric.

     2. Aggiungere una riga con l'opzione "metric 0" immediatamente
        sotto alla riga "iface eth0 inet dhcp" in "/etc/network/
        interfaces".

     3. Aggiungere una riga con l'opzione "metric 1" immediatamente
        sotto alla riga "iface wlan0 inet dhcp" in "/etc/network/
        interfaces".

    "metric 0" significa instradamento con la più alta priorità ed è
    quello predefinito. Un valore di metrica più alto indica
    instradamenti con priorità più bassa. L'indirizzo IP
    dell'interfaccia attiva con il valore di metrica più basso
    diventa quello di origine. Vedere ifmetric(8).

%

5.7.3. L'interfaccia virtuale

    Una singola interfaccia fisica Ethernet può essere configurata
    come interfacce virtuali multiple con indirizzi IP differenti. Di
    solito ciò ha lo scopo di connettere un'interfaccia a diverse
    sottoreti di IP. Per esempio, un'applicazione di questo tipo è
    l'hosting web virtuale basato su indirizzi IP con una singola
    interfaccia di rete.

    Per esempio, si supponga quanto segue.

      * Una singola interfaccia Ethernet dell'host è connessa ad un
        hub Ethernet (non al router a banda larga).

      * L'hub Ethernet è connesso sia ad Internet sia alla rete LAN.

      * La rete LAN usa la sottorete 192.168.0.x/24.

      * L'host usa per Internet indirizzi IP DHCP sull'interfaccia
        fisica eth0.

      * L'host usa 192.168.0.1 con l'interfaccia virtuale eth0:0 per
        la LAN.

    I blocchi seguenti in " /etc/network/interfaces" configurano la
    rete.

    iface eth0 inet dhcp
     metric 0
    iface eth0:0 inet static
     address 192.168.0.1
     netmask 255.255.255.0
     network 192.168.0.0
     metric 1

    Attenzione

    Anche se questo esempio di configurazione con traduzione degli
    indirizzi di rete (NAT) usando netfilter/iptables (vedere
    Sezione 5.10, «Infrastruttura netfilter») può fornire un router a
    basso prezzo per la LAN usando una sola interfaccia, non c'è
    alcuna reale funzionalità di firewall con una configurazione di
    questo tipo. Si dovrebbero usare 2 interfacce fisiche con NAT per
    rendere sicura la rete locale rispetto ad Internet.

%

5.7.4. Sintassi avanzata dei comandi

    Il pacchetto ifupdown offre funzionalità di configurazione
    avanzata della rete usando il nome di configurazione della rete e
    il nome dell'interfaccia di rete. Viene qui usata una
    terminologia leggermente diversa da quella usata in ifup(8) e 
    interfaces(5).

    Tabella 5.12. Elenco della terminologia per i device di rete

    +----------------------------------------------------------------+
    |  terminologia  |terminologia di | esempi nel testo |descrizione|
    |delle pagine man|questo documento|     seguente     |           |
    |----------------+----------------+------------------+-----------|
    |                |                |                  |nome dato  |
    |nome dell'      |nome dell'      |                  |dal kernel |
    |interfaccia     |interfaccia di  |lo, eth0,         |Linux      |
    |fisica          |rete            |<nome_interfaccia>|(usando il |
    |                |                |                  |meccanismo |
    |                |                |                  |udev)      |
    |----------------+----------------+------------------+-----------|
    |                |                |                  |elemento   |
    |                |                |                  |indicante  |
    |                |                |                  |il nome che|
    |nome dell'      |nome della      |config1, config2, |segue la   |
    |interfaccia     |configurazione  |<nome_config>     |parola     |
    |logica          |di rete         |                  |iface nel  |
    |                |                |                  |file "/etc/|
    |                |                |                  |network/   |
    |                |                |                  |interfaces"|
    +----------------------------------------------------------------+


    I comandi base per la configurazione della rete descritti in
    Sezione 5.6.1, «Sintassi di base dei comandi» richiedono che, nel
    file "/etc/network/interfaces", il nome della configurazione di
    rete indicato nel blocco iface corrisponda al nome dell'
    interfaccia di rete.

    I comandi avanzati per la configurazione della rete permettono,
    nel file "/etc/network/interfaces", la distinzione tra il nome
    della configurazione di rete e della interfaccia di rete

    Tabella 5.13. Elenco di comandi avanzati per la configurazione
    della rete con ifupdown

    +---------------------------------------------------------------+
    | comando  |                       azione                       |
    |----------+----------------------------------------------------|
    |ifup eth0=|attiva una interfaccia di rete eth0 con la          |
    |config1   |configurazione config1                              |
    |----------+----------------------------------------------------|
    |ifdown    |disattiva una interfaccia di rete eth0 con la       |
    |eth0=     |configurazione config1                              |
    |config1   |                                                    |
    |----------+----------------------------------------------------|
    |          |attiva una interfaccia di rete eth0 con la          |
    |ifup eth0 |configurazione scelta dal blocco di mappatura       |
    |          |mapping                                             |
    |----------+----------------------------------------------------|
    |ifdown    |disattiva una interfaccia di rete eth0 con la       |
    |eth0      |configurazione scelta dal blocco di mappatura       |
    |          |mapping                                             |
    +---------------------------------------------------------------+


%

5.7.5. Il blocco di mappatura "mapping"

    Nella sezione Sezione 5.6.2, «Sintassi di base di "/etc/network/
    interfaces"» è stata saltata la spiegazione del blocco mapping
    nel file "/etc/network/interfaces", per evitare complicazioni.
    Questo blocco ha la sintassi seguente.

    mapping <glob_nome_interfaccia>
     script <nome_script>
     map <script_input1>
     map <script_input2>
     map ...

    Ciò fornisce funzionalità avanzate al file "/etc/network/
    interfaces" automatizzando la scelta della configurazione con lo
    script di mappatura specificato da <nome_script>.

    Ecco cosa succede quando viene eseguito il comando seguente.

    $ sudo ifup eth0

    Quando il "<glob_nome_interfaccia> trova corrispondenza con
    "eth0", l'esecuzione di questo comando produce, per configurare
    automaticamente eth0, l'invocazione del comando seguente.

    $ sudo ifup eth0=$(echo -e '<script_input1> \n <script_input2> \n ...' | <nome_script> eth0)

    Le righe, per l'input dello script, che iniziano con "map" sono
    opzionali e possono essere ripetute.

    Nota

    L'espressione glob per il blocco mapping funziona come i
    metacaratteri dei glob per nomi di file della shell (vedere
    Sezione 1.5.6, «Glob della shell»).

%

5.7.6. Configurazione della rete commutabile manualmente

    Quella che segue è una descrizione di come commutare manualmente
    tra diverse configurazioni di rete senza dover riscrivere il file
    "/etc/network/interfaces" come in Sezione 5.6.13,
    «Riconfigurazione base della rete».

    Per tutte le configurazioni di rete alle quali si deve accedere è
    sufficiente creare una sezione distinta nel file "/etc/network/
    interfaces" come quello seguente.

    auto lo
    iface lo inet loopback

    iface config1 inet dhcp

    iface config2 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     dns-domain example.com
     dns-nameservers 192.168.11.1
   
    iface pppoe inet manual
     pre-up /sbin/ifconfig eth0 up
     up ifup ppp0=dsl
     down ifdown ppp0=dsl
     post-down /sbin/ifconfig eth0 down

    # Quanto segue viene usato solo internamente
    iface dsl inet ppp
     provider dsl-provider

    iface pots inet ppp
     provider provider

    Notare che il nome di configurazione della rete, che è l'elemento
    che viene dopo iface, non usa il nome dell'interfaccia di rete.
    Inoltre non ci sono blocchi auto, né allow-hotplug per attivare
    l'interfaccia di rete eth0 automaticamente in base ad eventi.

    Ora tutto è pronto per commutare tra le configurazioni di rete.

    Spostare il PC in una LAN con DHCP. L'interfaccia di rete
    (l'interfaccia fisica) eth0 viene attivata assegnandole il nome
    di configurazione della rete (il nome dell'interfaccia logica)
    config1 nel modo seguente.

    $ sudo ifup eth0=config1
    Password:
    ...

    L'interfaccia eth0 è attiva, configurata con DHCP e connessa alla
    LAN.

    $ sudo ifdown eth0=config1
    ...

    L'interfaccia di rete eth0 è disattivata e disconnessa dalla LAN.

    Spostare il PC in una LAN con IP statico. L'interfaccia di rete
    eth0 viene attivata assegnandole il nome di configurazione della
    rete config2 nel modo seguente.

    $ sudo ifup eth0=config2
    ...

    L'interfaccia eth0 è attiva, configurata con IP statico e
    connessa alla LAN. I parametri aggiuntivi dns-* forniti
    configurano il contenuto di "/etc/resolv.conf". Tale file "/etc/
    resolv.conf" viene gestito meglio se è installato il pacchetto
    resolvconf.

    $ sudo ifdown eth0=config2
    ...

    L'interfaccia di rete eth0 è di nuovo disattivata e disconnessa
    dalla LAN.

    Spostare il PC su una porta di un modem per banda larga connesso
    ad un servizio PPPoE. L'interfaccia di rete eth0 viene attivata
    assegnandole il nome di configurazione della rete pppoe nel modo
    seguente.

    $ sudo ifup eth0=pppoe
    ...

    L'interfaccia eth0 è attiva, configurata per la connessione PPPoE
    diretta con il fornitore di servizi Internet.

    $ sudo ifdown eth0=pppoe
    ...

    L'interfaccia di rete eth0 è di nuovo disattivata e disconnessa.

    Spostare il PC in una postazione senza LAN o modem per banda
    larga, ma con una linea telefonica ed un modem. L'interfaccia di
    rete ppp0 viene attivata assegnandole il nome di configurazione
    della rete pots nel modo seguente.

    $ sudo ifup ppp0=pots
    ...

    L'interfaccia ppp0 è attiva e connessa ad Internet con PPP.

    $ sudo ifdown ppp0=pots
    ...

    L'interfaccia di rete ppp0 è disattivata e disconnessa da
    Internet.

    Si dovrebbe controllare nel file "/etc/network/run/ifstate" lo
    stato attuale della configurazione di rete del sistema ifupdown.

    Avvertimento
   
    Potrebbe essere necessario cambiare i numeri alla fine di eth*,
    ppp*, ecc., se si ha più di un'interfaccia di rete.

%

5.7.7. Uso di script con il sistema ifupdown

    Il sistema ifupdown esegue automaticamente gli script installati
    in "/etc/network/*/" esportando le variabili d'ambiente negli
    script.

    Tabella 5.14. Elenco delle variabili d'ambiente passate dal
    sistema ifupdown

    +---------------------------------------------------------------+
    | variabile  |                  valore passato                  |
    | d'ambiente |                                                  |
    |------------+--------------------------------------------------|
    |"$IFACE"    |nome fisico (nome dell'interfaccia)               |
    |            |dell'interfaccia in fase di elaborazione          |
    |------------+--------------------------------------------------|
    |"$LOGICAL"  |nome logico (nome dell'interfaccia)               |
    |            |dell'interfaccia in fase di elaborazione          |
    |------------+--------------------------------------------------|
    |"$ADDRFAM"  |<famiglia_indirizzi> dell'interfaccia             |
    |------------+--------------------------------------------------|
    |"$METHOD"   |<nome_metodo> dell'interfaccia (es., "static")    |
    |------------+--------------------------------------------------|
    |"$MODE"     |"start" se invocato da ifup, "stop" se invocato da|
    |            |ifdown                                            |
    |------------+--------------------------------------------------|
    |            |come per "$MODE", ma in modo più dettagliato,     |
    |"$PHASE"    |distinguendo le fasi pre-up, post-up, pre-down e  |
    |            |post-down                                         |
    |------------+--------------------------------------------------|
    |"$VERBOSITY"|indica se è stato usato "--verbose"; se lo è stato|
    |            |viene impostata a 1, altrimenti a 0               |
    |------------+--------------------------------------------------|
    |"$PATH"     |percorso di ricerca dei comandi: "/usr/local/sbin:|
    |            |/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"     |
    |------------+--------------------------------------------------|
    |"$IF_       |valore della opzione corrispondente all'interno   |
    |<OPZIONE>"  |del blocco iface                                  |
    +---------------------------------------------------------------+


    In questo caso, ciascuna variabile d'ambiente di tipo "$IF_
    <OPZIONE>" viene creata a partire dal nome dell'opzione
    corrispondente, come <opzione1> e <opzione2>, preceduto da "$IF_"
    e convertendo tutte le lettere in maiuscolo, sostituendo i
    caratteri di sottolineatura con trattini e scartando i caratteri
    non alfanumerici.

    Suggerimento

    Vedere Sezione 5.6.2, «Sintassi di base di "/etc/network/
    interfaces"» per <famiglia_indirizzi>, <nome_metodo>, <opzione1>
    e <opzione2>.

    Il pacchetto ifupdown-extra (vedere Sezione 5.6.14, «Pacchetto
    ifupdown-extra») usa queste variabili d'ambiente per estendere la
    funzionalità del pacchetto ifupdown. Il pacchetto ifmetric
    (vedere Sezione 5.7.2, «Il pacchetto ifmetric») installa lo
    script "/etc/network/if-up.d/ifmetric" che imposta la metrica
    attraverso la variabile "$IF_METRIC". Anche il pacchetto guessnet
    (vedere Sezione 5.7.8, «Mappatura con guessnet»), che fornisce
    un'infrastruttura semplice e potente per la selezione automatica
    della configurazione di rete tramite il meccanismo di mappatura ,
    usa queste variabili.

    Nota

    Per esempi più dettagliati di script personalizzati per la
    configurazione della rete che usano queste variabili d'ambiente,
    controllare gli script d'esempio in "/usr/share/doc/ifupdown/
    examples/*" e gli script usati nei pacchetti ifscheme e
    ifupdown-scripts-zg2. Questi script addizionali hanno alcune
    funzionalità che si sovrappongono in parte a quelle dei pacchetti
    base ifupdown-extra e guessnet. Se si installano questi script
    addizionali, si dovrebbe personalizzarli in modo da evitare
    interferenze.

%

5.7.8. Mappatura con guessnet

    Invece di scegliere manualmente la configurazione, come descritto
    in Sezione 5.7.6, «Configurazione della rete commutabile
    manualmente», si può usare il meccanismo di mappatura descritto
    in Sezione 5.7.5, «Il blocco di mappatura "mapping"» per
    selezionare automaticamente la configurazione di rete con script
    personalizzati.

    Il comando guessnet-ifupdown(8) fornito nel pacchetto guessnet è
    pensato per essere usato come uno script di mappatura e fornisce
    un'infrastruttura potente per migliorare il sistema ifupdown.

      * Per ciascuna configurazione di rete in un blocco iface, si
        elencano delle condizioni da testare come valore per le
        opzioni di guessnet.

      * La mappatura sceglie come configurazione di rete la prima 
        iface che dà come risultato un non-ERRORE.

    Questo doppio uso del file "/etc/network/interfaces" da parte
    dello script di mappatura, guessnet-ifupdown, e
    dell''infrastruttura originale di configurazione della rete,
    ifupdown, non causa impatti negativi dato che le opzioni guessnet
    esportano solo variabili d'ambiente extra a script eseguiti dal
    sistema ifupdown. Vedere i dettagli in guessnet-ifupdown(8).

    Nota

    Quando in "/etc/network/interfaces è necessaria più di una riga
    di opzione guessnet, usare righe di opzione che iniziano con 
    guessnet1, guessnet2 e così via, dato che il pacchetto ifupdown
    non permette ripetizioni della stringa iniziale delle righe di
    opzione.

5.8. Configurazione della rete a basso livello

%

5.8.1. Comandi iproute2

    I comandi Iproute2 offrono funzionalità complete di
    configurazione della rete a basso livello. Quella che segue è una
    tabella di traduzione dai comandi obsoleti di net-tools ai nuovi
    comandi iproute2 ecc.

    Tabella 5.15. Tabella di traduzione dai comandi obsoleti
    net-tools ai nuovi comandi iproute2

    +---------------------------------------------------------------+
    | net-tools  |    nuovi    |                                    |
    |  obsoleti  |  iproute2,  |           manipolazione            |
    |            |    ecc.     |                                    |
    |------------+-------------+------------------------------------|
    |ifconfig(8) |ip addr      |indirizzo di protocollo (IP o IPv6) |
    |            |             |di un device                        |
    |------------+-------------+------------------------------------|
    |route(8)    |ip route     |voce nella tabella di instradamento |
    |------------+-------------+------------------------------------|
    |arp(8)      |ip neigh     |voce nella cache ARP o NDISC        |
    |------------+-------------+------------------------------------|
    |ipmaddr     |ip maddr     |indirizzo multicast                 |
    |------------+-------------+------------------------------------|
    |iptunnel    |ip tunnel    |tunnel over IP                      |
    |------------+-------------+------------------------------------|
    |nameif(8)   |ifrename(8)  |nomina le interfacce di rete in base|
    |            |             |all'indirizzo MAC                   |
    |------------+-------------+------------------------------------|
    |mii-tool(8) |ethtool(8)   |impostazioni del device Ethernet    |
    +---------------------------------------------------------------+


    Vedere ip(8) e IPROUTE2 Utility Suite Howto.

%

5.8.2. Operazioni sicure a basso livello sulla rete

    Si possono usare i comandi a basso livello per la rete seguenti
    in modo sicuro dato che non cambiano la configurazione della
    rete.

    Tabella 5.16. Elenco di comandi di rete a basso livello

    +---------------------------------------------------------------+
    |      comando       |               descrizione                |
    |--------------------+------------------------------------------|
    |ifconfig            |mostra lo stato del collegamento e        |
    |                    |l'indirizzo delle interfacce attive       |
    |--------------------+------------------------------------------|
    |ip addr show        |mostra lo stato del collegamento e        |
    |                    |l'indirizzo delle interfacce attive       |
    |--------------------+------------------------------------------|
    |route -n            |mostra tutta la tabella di instradamento  |
    |                    |in indirizzi numerici                     |
    |--------------------+------------------------------------------|
    |ip route show       |mostra tutta la tabella di instradamento  |
    |                    |in indirizzi numerici                     |
    |--------------------+------------------------------------------|
    |arp                 |mostra l'attuale contenuto delle tabelle  |
    |                    |cache ARP                                 |
    |--------------------+------------------------------------------|
    |ip neigh            |mostra l'attuale contenuto delle tabelle  |
    |                    |cache ARP                                 |
    |--------------------+------------------------------------------|
    |plog                |mostra il registro del demone ppp         |
    |--------------------+------------------------------------------|
    |ping yahoo.com      |controlla la connessione Internet verso   |
    |                    |"yahoo.com"                               |
    |--------------------+------------------------------------------|
    |whois yahoo.com     |controlla chi ha registrato "yahoo.com"   |
    |                    |nel database dei domini                   |
    |--------------------+------------------------------------------|
    |traceroute yahoo.com|traccia la connessione Internet verso     |
    |                    |"yahoo.com"                               |
    |--------------------+------------------------------------------|
    |tracepath yahoo.com |traccia la connessione Internet verso     |
    |                    |"yahoo.com"                               |
    |--------------------+------------------------------------------|
    |mtr yahoo.com       |traccia la connessione Internet verso     |
    |                    |"yahoo.com" (ripetutamente)               |
    |--------------------+------------------------------------------|
    |dig                 |controlla i record DNS di "esempio.com"   |
    |[@dns-server.com]   |con "dns-server.com" alla ricerca di un   |
    |esempio.com [{a|mx| |record "a", "mx" o "any"                  |
    |any}]               |                                          |
    |--------------------+------------------------------------------|
    |iptables -L -n      |controlla il filtraggio dei pacchetti     |
    |--------------------+------------------------------------------|
    |netstat -a          |trova tutte le porte aperte               |
    |--------------------+------------------------------------------|
    |netstat -l --inet   |trova le porte in ascolto                 |
    |--------------------+------------------------------------------|
    |netstat -ln --tcp   |trova le porte (numeriche) TCP in ascolto |
    |--------------------+------------------------------------------|
    |dlint esempio.com   |controlla le informazioni DNS di zona per |
    |                    |"esempio.com"                             |
    +---------------------------------------------------------------+


    Suggerimento

    Alcuni di questi strumenti di configurazione di basso livello
    della rete sono contenuti in "/sbin/". Potrebbe essere necessario
    fornire il percorso completo dei comandi, come "/sbin/ifconfig" o
    aggiungere "/sbin" all'elenco in "$PATH" nel proprio file "~
    /.bashrc".

%

5.9. Ottimizzazione della rete

    L'ottimizzazione generale della rete va oltre gli scopi che
    questo documento si prefigge. Vengono trattati solo quegli
    argomenti che interessano le connessioni dei computer personali.

    Tabella 5.17. Elenco degli strumenti di ottimizzazione della rete

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|            descrizione            |
    |---------+------+----------+-----------------------------------|
    |iftop    |V:7,  |97        |mostra informazioni sull'uso della |
    |         |I:115 |          |banda su di un'interfaccia di rete |
    |---------+------+----------+-----------------------------------|
    |iperf    |V:4,  |263       |strumento di misurazione della     |
    |         |I:55  |          |banda del protocollo Internet      |
    |---------+------+----------+-----------------------------------|
    |ifstat   |V:0,  |60        |Monitoraggio delle STATistiche     |
    |         |I:8   |          |sulle InterFacce                   |
    |---------+------+----------+-----------------------------------|
    |         |V:1,  |          |strumento portabile per            |
    |bmon     |I:17  |146       |monitoraggio della banda e stime   |
    |         |      |          |della velocità                     |
    |---------+------+----------+-----------------------------------|
    |         |V:0,  |          |script che misura velocemente la   |
    |ethstatus|I:5   |40        |quantità di dati passanti per un   |
    |         |      |          |device di rete                     |
    |---------+------+----------+-----------------------------------|
    |bing     |V:0,  |80        |tester empirico stocastico della   |
    |         |I:1   |          |banda                              |
    |---------+------+----------+-----------------------------------|
    |         |V:2,  |          |strumento piccolo e semplice basato|
    |bwm-ng   |I:17  |90        |sulla console per il monitoraggio  |
    |         |      |          |della banda                        |
    |---------+------+----------+-----------------------------------|
    |         |V:0,  |          |strumento basato su console per il |
    |ethstats |I:0   |23        |monitoraggio delle statistiche     |
    |         |      |          |Ethernet                           |
    |---------+------+----------+-----------------------------------|
    |ipfm     |V:0,  |78        |strumento di analisi della banda   |
    |         |I:0   |          |                                   |
    +---------------------------------------------------------------+


%

5.9.1. Trovare l'MTU ottimale

    Il valore di MTU (Maximum Transmission Unit, unità massima di
    trasmissione) può essere determinato sperimentalmente con ping(8)
    usando l'opzione "-M do" che invia pacchetti ICMP con una
    dimensione dei dati a partire da 1500 (con un offset di 28 byte
    per l'intestazione IP+ICMP) e trova la dimensione maggiore che
    non comporta frammentazione IP.

    Per esempio, provare a fare quanto segue.

    $ ping -c 1 -s $((1500-28)) -M do www.debian.org
    PING www.debian.org (194.109.137.218) 1472(1500) bytes of data.
    From 192.168.11.2 icmp_seq=1 Frag needed and DF set (mtu = 1454)

    --- www.debian.org ping statistics ---
    0 packets transmitted, 0 received, +1 errors

    Provare 1454 invece di 1500

    Come si può vedere ping(8) ha avuto successo con 1454.

    Questo processo si chiama "Path MTU (PMTU) discovery (RFC1191) e
    il comado tracepath(8) può automatizzarlo.

    Suggerimento

    L'esempio precedente di PMTU con un valore di 1454 è per il mio
    precedente fornitore FTTP che usava ATM (Asynchronous Transfer
    Mode) come rete backbone e forniva ai clienti un servizio PPPoE.
    Il valore effettivo di PMTU dipende dal proprio ambiente, ad
    esempio è 1500 per il mio nuovo fornitore FTTP.

    Tabella 5.18. Linee guida di base per il valore di MTU ottimale

    +---------------------------------------------------------------+
    |   ambiente di rete    |     MTU     |         motivo          |
    |-----------------------+-------------+-------------------------|
    |collegamento dial-up   |576          |standard                 |
    |(IP: PPP)              |             |                         |
    |-----------------------+-------------+-------------------------|
    |collegamento Ethernet  |1500         |standard e predefinito   |
    |(IP: DHCP o statico)   |             |                         |
    |-----------------------+-------------+-------------------------|
    |collegamento Ethernet  |1492 (=      |2 byte per l'intestazione|
    |(IP: PPPoE)            |1500-8)      |PPP e 6 byte per         |
    |                       |             |l'intestazione PPPoE     |
    |-----------------------+-------------+-------------------------|
    |collegamento Ethernet  |             |ipotesi dell'autore: 18  |
    |(backbone del fornitore|1462 (=      |byte per l'intestazione  |
    |servizi: ATM, IP: DHCP |48*31-18-8)  |Ethernet, 8 byte per la  |
    |o statico)             |             |coda SAR                 |
    |-----------------------+-------------+-------------------------|
    |collegamento Ethernet  |             |vedere Configurazione    |
    |(backbone del fornitore|1454 (=      |ottimale dell'MTU per    |
    |servizi: ATM, IP:      |48*31-8-18-8)|connessioni ADSL con     |
    |PPPoE)                 |             |PPPoE" per il            |
    |                       |             |ragionamento             |
    +---------------------------------------------------------------+


    In aggiunta a queste linee guida di base si dovrebbe sapere
    quanto segue.

      * Qualsiasi uso di metodi di tunnelling (VPN, ecc.) può ridurre
        ulteriormente l'MTU ottimale per il loro carico.

      * Il valore di MTU non dovrebbe superare il valore di PMTU
        determinato sperimentalmente.

      * A patto di seguire le indicazioni precedenti un valore
        maggiore di MTU è meglio.

%

5.9.2. Impostazione dell'MTU

    Quelli che seguono sono alcuni esempi di come impostare il valore
    di MTU dal suo valore predefinito 1500 a 1454.

    Per DHCP (vedere Sezione 5.6.4, «Interfaccia di rete servita da
    DHCP»), si possono sostituire le righe pertinenti nei blocchi 
    iface nel file "/etc/network/interfaces" con blocchi come il
    seguente.

    iface eth0 inet dhcp
     pre-up /sbin/ifconfig $IFACE mtu 1454

    Per IP statico (vedere Sezione 5.6.5, «Interfaccia di rete con IP
    statico»), si possono sostituire le righe pertinenti nei blocchi 
    iface nel file "/etc/network/interfaces" con blocchi come il
    seguente.

    iface eth0 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     mtu 1454
     dns-domain example.com
     dns-nameservers 192.168.11.1

    Per la connessione PPPoE diretta (vedere Sezione 5.5.5,
    «Connessione PPPoE con pppoeconf», si possono sostituire le riga
    "mtu" pertinente nel file "/etc/ppp/peers/dsl-provider" con la
    seguente.

    mtu 1454

    Il valore di MSS (Maximum Segment Size, dimensione massima di
    segmento)MSS è usato come misura alternativa della dimensione dei
    pacchetti. Le relazioni tra MSS e MTU sono le seguenti.

      * MSS = MTU - 40 per IPv4
   
      * MSS = MTU - 60 per IPv6

    Nota

    L'ottimizzazione basata su iptables(8) (vedere Sezione 5.10,
    «Infrastruttura netfilter») può bloccare la dimensione dei
    pacchetti al valore MSS ed è utile per il router. Vedere "TCPMSS"
    in iptables(8).

%

5.9.3. Ottimizzazione di TCP per la WAN

    Il flusso TCP può essere massimizzato regolando i parametri di
    dimensione del buffer TCP come descritto in "TCP Tuning Guide" e
    "TCP tuning" per le moderne WAN a larga banda e alta latenza. Per
    adesso, le attuali impostazioni predefinite di Debian funzionano
    bene persino per la mia LAN connessa con un servizio FTTP veloce
    a 1Gbps.

%

5.10. Infrastruttura netfilter

    Netfilter fornisce un'infrastruttura per firewall con stati e
    traduzione di indirizzi di rete (NAT) con moduli del kernel Linux
    (vedere Sezione 3.3.1, «L'inizializzazione dei moduli del kernel»
    ).

    Tabella 5.19. Elenco di strumenti per firewall

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|         descrizione         |
    |---------------+------+----------+-----------------------------|
    |               |      |          |strumenti di amministrazione |
    |iptables       |V:300,|2520      |per netfilter (iptables(8)   |
    |               |I:993 |          |per IPv4, ip6tables(8) per   |
    |               |      |          |IPv6)                        |
    |---------------+------+----------+-----------------------------|
    |               |V:0,  |          |strumenti di amministrazione |
    |arptables      |I:2   |96        |per netfilter (arptables(8)  |
    |               |      |          |per ARP)                     |
    |---------------+------+----------+-----------------------------|
    |               |V:15, |          |strumenti di amministrazione |
    |ebtables       |I:39  |265       |per netfilter (ebtables(8)   |
    |               |      |          |per bridge Ethernet)         |
    |---------------+------+----------+-----------------------------|
    |               |V:0,  |          |monitora continuamente lo    |
    |iptstate       |I:3   |116       |stato di netfilter (in modo  |
    |               |      |          |simile a top(1))             |
    |---------------+------+----------+-----------------------------|
    |shorewall-init |V:0,  |68        |inizializzazione di Shoreline|
    |               |I:0   |          |Firewall                     |
    |---------------+------+----------+-----------------------------|
    |               |V:5,  |          |generatore di file di        |
    |shorewall      |I:13  |2458      |configurazione per Shoreline |
    |               |      |          |Firewall, netfilter          |
    |---------------+------+----------+-----------------------------|
    |               |      |          |generatore di file di        |
    |shorewall-lite |V:0,  |65        |configurazione per Shoreline |
    |               |I:0   |          |Firewall, netfilter (versione|
    |               |      |          |leggera)                     |
    |---------------+------+----------+-----------------------------|
    |               |      |          |generatore di file di        |
    |shorewall6     |V:1,  |779       |configurazione per Shoreline |
    |               |I:2   |          |Firewall, netfilter (versione|
    |               |      |          |IPv6)                        |
    |---------------+------+----------+-----------------------------|
    |               |      |          |generatore di file di        |
    |shorewall6-lite|V:0,  |64        |configurazione per Shoreline |
    |               |I:0   |          |Firewall, netfilter (versione|
    |               |      |          |IPv6 leggera)                |
    +---------------------------------------------------------------+


    Il principale programma in spazio utente di netfilter è iptables
    (8). Si può configurare manualmente netfilter in modo interattivo
    dalla shell, salvare il suo stato con iptables-save(8) e
    ripristinarlo attraverso uno script di init con iptables-restore
    (8) al riavvio del sistema.

    Script di aiuto per la configurazione come shorewall facilitano
    questo processo.

    Vedere la documentazione all'indirizzo http://www.netfilter.org/
    documentation/ (o in "/usr/share/doc/iptables/html/").

      * Linux Networking-concepts HOWTO

      * Linux 2.4 Packet Filtering HOWTO

      * Linux 2.4 NAT HOWTO

    Suggerimento

    Anche se questi documenti sono stati scritti per Linux 2.4, sia
    il comando iptables(8) sia la funzione netfilter del kernel sono
    validi per gli attuali kernel Linux 2.6 e 3.x.

Capitolo 6. Applicazioni per la rete

    Dopo aver stabilito la connessione di rete (vedere Capitolo 5, 
    Impostazione della rete), si possono eseguire svariate
    applicazioni per la rete.

    Suggerimento

    Per una guida moderna sull'infrastruttura di rete specifica per
    Debian leggere The Debian Administrator's Handbook — Network
    Infrastructure.

    Suggerimento

    Se si abilita la "Verifica in 2 passaggi" con alcuni ISP è
    necessario ottenere una password di applicazione per accedere ai
    servizi POP e SMTP dal proprio programma. Può essere necessario
    approvare l'IP del proprio host in anticipo.

%

6.1. Browser web

    Ci sono molti pacchetti per browser web per accedere a contenuti
    remoti tramite HTTP (Hypertext Transfer Protocol).

    Tabella 6.1. Elenco di browser web

    +---------------------------------------------------------------+
    |   pacchetto    |popcon|dimensione|  tipo  |  descrizione del  |
    |                |      |          |        |    browser web    |
    |----------------+------+----------+--------+-------------------|
    |                |V:51, |          |        |Chromium, (browser |
    |chromium        |I:141 |180040    |per X   |open-source da     |
    |                |      |          |        |Google)            |
    |----------------+------+----------+--------+-------------------|
    |                |      |          |        |Firefox, (browser  |
    |                |V:13, |          |        |open-source da     |
    |firefox         |I:20  |205631    |" "     |Mozilla,           |
    |                |      |          |        |disponibile solo in|
    |                |      |          |        |Debian Unstable)   |
    |----------------+------+----------+--------+-------------------|
    |                |V:217,|          |        |Firefox ESR,       |
    |firefox-esr     |I:437 |198436    |" "     |(Firefox Extended  |
    |                |      |          |        |Support Release)   |
    |----------------+------+----------+--------+-------------------|
    |                |V:4,  |          |        |Epiphany, per      |
    |epiphany-browser|I:24  |3730      |" "     |GNOME, aderente    |
    |                |      |          |        |alle HIG           |
    |----------------+------+----------+--------+-------------------|
    |konqueror       |V:18, |20763     |" "     |Konqueror, per KDE |
    |                |I:100 |          |        |                   |
    |----------------+------+----------+--------+-------------------|
    |                |V:1,  |          |        |Dillo, (browser    |
    |dillo           |I:7   |1536      |" "     |leggero, basato su |
    |                |      |          |        |FLTK)              |
    |----------------+------+----------+--------+-------------------|
    |w3m             |V:31, |2289      |testuali|w3m                |
    |                |I:284 |          |        |                   |
    |----------------+------+----------+--------+-------------------|
    |lynx            |V:13, |1948      |" "     |Lynx               |
    |                |I:98  |          |        |                   |
    |----------------+------+----------+--------+-------------------|
    |elinks          |V:6,  |1767      |" "     |ELinks             |
    |                |I:28  |          |        |                   |
    |----------------+------+----------+--------+-------------------|
    |links           |V:6,  |2249      |" "     |Links (solo testo) |
    |                |I:39  |          |        |                   |
    |----------------+------+----------+--------+-------------------|
    |links2          |V:1,  |5417      |grafici |Links (grafica in  |
    |                |I:15  |          |        |console senza X)   |
    +---------------------------------------------------------------+


%

6.1.1. Configurazione del browser

    Per alcuni browser si può accedere alle loro impostazioni usando
    le seguenti stringhe URL speciali.

      * "about:"

      * "about:config"

      * "about:plugins"

    Debian offre, nell'area main dell'archivio, molti pacchetti
    liberi con plugin per browser che possono gestire non soltanto
    Java (piattaforma software) e Flash, ma anche file MPEG, MPEG2,
    MPEG4, DivX, Windows Media Video (.wmv), QuickTime (.mov), MP3
    (.mp3), file Ogg/Vorbis, DVD, VCD, ecc. Debian offre anche,
    nell'aree contrib o non-free dell'archivio, programmi di aiuto
    per installare pacchetti con plugin non liberi per il browser.

    Tabella 6.2. Elenco di pacchetti con plugin per browser

    +-----------------------------------------------------------------------------+
    |              pacchetto               |popcon|dimensione| area  |descrizione |
    |--------------------------------------+------+----------+-------+------------|
    |                                      |      |          |       |Pepper Flash|
    |pepperflashplugin-nonfree             |V:1,  |29        |contrib|Player -    |
    |                                      |I:21  |          |       |plugin per  |
    |                                      |      |          |       |browser     |
    |--------------------------------------+------+----------+-------+------------|
    |                                      |      |          |       |Adattatore  |
    |                                      |      |          |       |PPAPI-host  |
    |browser-plugin-freshplayer-pepperflash|I:9   |1135      |contrib|NPAPI-plugin|
    |                                      |      |          |       |per         |
    |                                      |      |          |       |pepperflash |
    +-----------------------------------------------------------------------------+


    Suggerimento

    Benché l'uso dei pacchetti Debian elencati sopra sia molto più
    facile, è sempre possibile abilitare i plugin manualmente
    installando i file "*.so" nelle directory dei plugin (ad esempio,
    "/usr/lib/iceweasel/plugins/") e riavviando il browser.

    Alcuni siti web rifiutano la connessione in base alla stringa
    user-agent del browser. Si può aggirare questa situazione mimando
    la stringa user-agent. Per esempio, può essere fatto aggiungendo
    nei file di configurazione, come "~/.gnome2/epiphany/mozilla/
    epiphany/user.js" o "~/.mozilla/firefox/*.default/user.js", la
    riga seguente.

    user_pref{"general.useragent.override","Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)"};

    In alternativa si può aggiungere e reimpostare questa variabile
    digitando "about:config" al posto dell'URL e cliccando con il
    pulsante destro sul suo contenuto.

    Attenzione
   
    La stringa user-agent falsificata può causare dei brutti effetti
    collaterali con Java.

%

6.2. Il sistema di posta

    Attenzione

    Se si desidera impostare il server di posta per scambiare la
    posta direttamente con Internet, si dovrebbe leggere una
    documentazione più dettagliata di questo documentazione base.

    Il sistema di posta comprende molti programmi server e molti
    programmi client in esecuzione su più host. In base alla
    funzionalità esistono 3 tipi di programmi server ("agent") per la
    posta:

      * Il Mail Transport Agent ("Agente di trasporto della posta",
        MTA, vedere Sezione 6.3, «Agente di trasporto della posta
        (MTA)») è un programma per trasferire la posta tra i diversi
        host.

      * Il Mail Delivery Agent ("Agente di consegna della posta",
        MDA, vedere Sezione 6.6, «Agente di consegna della posta
        (MDA, Mail Delivery Agent) con filtri») è un programma per
        consegnare i messaggi alle caselle di posta degli utenti
        all'interno di un host.

      * Il Mail User Agent (Agente di posta dell'utente, MUA, chiamto
        anche client o programma di posta, vedere Sezione 6.4,
        «Programma di posta (MUA, Mail User Agent)») è il programma
        per generare messaggi e per accedere ai messaggi consegnati.

    Nota

    Gli esempi di configurazione che seguono sono validi solamente
    per la postazione di lavoro mobile su connessioni Internet di
    largo consumo.

%

6.2.1. Nozioni di base sulla posta elettronica

    Un messaggio email è formato da tre componenti: la busta del
    messaggio, l'intestazione del messaggio e il corpo del messaggio.

    Le informazioni "To" e "From" nella busta del messaggio vengono
    usate dall'SMTP per consegnare l'email. (L'informazione "From"
    nella busta del messaggio è anche chiamata indirizzo di bounce,
    From_, ecc.)

    Le informazioni "To" e "From" nell'intestazione del messaggio
    vengono visualizzate dal programma di posta. (Benché nella
    maggior parte dei casi questi sono identici a quelli nella busta
    del messaggio, può non essere sempre così.)

    Il programma di posta (MUA) deve interpretare i dati
    nell'intestazione e nel corpo del messaggio usando MIME
    (Multipurpose Internet Mail Extensions) per gestire il tipo di
    dati e la codifica del contenuto.

%

6.2.2. Nozioni di base sui servizi di posta moderni

    Per minimizzare l'esposizione allo spam (posta elettronica
    indesiderata e non richiesta), molti fornitori di servizi
    Internet che forniscono connessioni Internet domestiche stanno
    implementando contromisure.

      * Il servizio smarthost per i loro clienti per inviare i
        messaggi usa la porta di inoltro dei messaggi (587)
        specificata in rfc4409, con la password (servizio SMTP AUTH)
        come specificata in rfc4954.

      * Le connessioni alla porta (25) SMTP dagli host interni della
        loro rete (tranne che per il server della posta in uscita del
        fornitore di servizi stesso) verso Internet sono bloccate.

      * Le connessioni alla porta (25) SMTP del server di posta in
        entrata del fornitore di servizi Internet da host di rete
        esterni sospetti sono bloccate. (La connessione da host su
        intervalli di indirizzi IP dinamici usati dalle connessioni
        Internet dial-up e da altre connessioni di tipo domestico
        sono le prime ad essere bloccate).

      * Tecniche anti-spam come DKIM (DomainKeys Identified Mail) e
        SPF (Sender_Policy_Framework) e DMARC (Domain-based Message
        Authentication, Reporting and Conformance) sono usate di
        frequente per il filtraggio delle email.

      * Il servizio DomainKeys Identified Mail può essere fornito per
        la propria posta inviata attraverso uno smarthost.

      * Lo smarthost può riscrivere l'indirizzo di posta dell'origine
        con l'account di posta dell'utente sullo smarthost.

    Queste nuove limitazioni vanno tenute a mente quando si configura
    il proprio server di posta o si cerca di risolvere problemi di
    consegna della posta.

    Attenzione

    Eseguire un server SMTP su una rete di un utente privato per
    inviare posta in modo diretto ad host remoti in modo affidabile
    non è un'ipotesi realistica.

    Attenzione

    Non è realistico attendersi che un singolo smarthost invii
    messaggi di indirizzi di posta di origine non correlati ad host
    remoti in modo affidabile.

    Attenzione

    Un messaggio di posta può essere rifiutato in modo silenzioso da
    qualsiasi host sul percorso verso la destinazione. Far sì che la
    propria posta appaia il più autentica possibile è l'unico modo di
    inviare posta ad un host remoto in modo affidabile.

    Alla luce di queste limitazioni e situazioni ostili in Internet,
    alcuni fornitori di servizi di posta via Internet indipendenti,
    come Yahoo.com e Gmail.com, offrono un servizio di posta sicuro a
    cui ci si può connettere da qualsiasi parte di Internet usando
    TLS (Transport Layer Security) e il suo predecessore SSL (Secure
    Sockets Layer).

      * Il servizio smarthost sulla porta 465 con il deprecato SMTP
        via SSL (protocollo SMTPS).

      * Il servizio smarthost sulla porta 587 con STARTTLS.

      * La posta in entrata è accessibile sulla porta TLS/POP3 (995)
        con POP3.

    Per semplicità, nel testo che segue si assume che lo smarthost
    sia alla posizione "smtp.hostname.dom", che richieda SMTP AUTH e
    che usi la porta di invio dei messaggi (587) con STARTTLS.

%

6.2.3. Strategia di configurazione della posta per postazione PC

    La configurazione di posta più semplice possibile è che la posta
    sia inviata allo smarthost del fornitore di servizi Internet e
    ricevuta dal server POP3 del fornitore di servizi dal programma
    di posta (vedere Sezione 6.4, «Programma di posta (MUA, Mail User
    Agent)») stesso. Questo tipo di configurazione è popolare per i
    programmi di posta completi basati su interfaccia utente grafica
    come icedove(1), evolution(1), ecc. Se si necessita di filtrare
    la posta in base alla sua tipologia, si usano le funzioni di
    filtro del programma di posta. In questo caso l'MTA (vedere
    Sezione 6.3, «Agente di trasporto della posta (MTA)») locale deve
    solo fare la consegna locale della posta (quando il mittente e il
    destinatario sono sullo stesso host).

    Notare che il sistema Debian è un sistema multiutente. Anche se
    si è l'unico utente, ci sono molti programmi che vengono eseguiti
    come utente root e che possono inviare un messaggio di posta.

    La configurazione di posta alternativa prevede che la posta sia
    inviata attraverso l'MTA locale allo smarthost del fornitore di
    servizi Internet e ricevuta dal server POP3 del fornitore di
    servizi dal programma di recupero della posta (vedere
    Sezione 6.5, «L'utilità per il recupero della posta da remoto e
    l'inoltro») che la mette nella casella di posta locale. Se si
    necessita di filtrare la posta in base alla sua tipologia, si usa
    un MDA con filtri (vedere Sezione 6.6, «Agente di consegna della
    posta (MDA, Mail Delivery Agent) con filtri») per smistare la
    posta in caselle diverse. Questo tipo di configurazione è
    popolare con i semplici programmi di posta basati sulla console
    come mutt(1), mew(1), ecc., anche se è possibile con qualsiasi
    programma di posta (vedere Sezione 6.4, «Programma di posta (MUA,
    Mail User Agent)»). In questo caso l'MTA (vedere Sezione 6.3,
    «Agente di trasporto della posta (MTA)») locale deve fare sia la
    consegna allo smarthost sia quella locale. Dato che le postazioni
    di lavoro mobile non hanno un FQDN valido, è necessario
    configurare l'MTA locale in modo che nasconda e falsifichi il
    vero nome locale del sistema di posta nei messaggi di posta in
    uscita per evitare errori nella consegna della posta (vedere
    Sezione 6.3.3, «La configurazione dell'indirizzo di posta»).

    Suggerimento

    Si potrebbe voler configurare i MUA e MDA in modo che usino il
    formato Maildir per archiviare i messaggi di posta elettronica da
    qualche parte nella propria directory home.

%

6.3. Agente di trasporto della posta (MTA)

    Per le normali postazioni PC, la scelta più comune per il server
    di posta (MTA) sono i pacchetti exim4-* o postfix. La scelta
    spetta all'utente.

    Tabella 6.3. Elenco di pacchetti base relativi ai server di
    trasporto della posta per postazioni PC

    +---------------------------------------------------------------+
    |    pacchetto     |popcon|dimensione|       descrizione        |
    |------------------+------+----------+--------------------------|
    |                  |V:342,|          |agente di trasporto della |
    |exim4-daemon-light|I:367 |1493      |posta Exim4 (MTA          |
    |                  |      |          |predefinito in Debian)    |
    |------------------+------+----------+--------------------------|
    |                  |V:349,|          |documentazione (formato   |
    |exim4-base        |I:377 |1704      |testo) e file comuni per  |
    |                  |      |          |Exim4                     |
    |------------------+------+----------+--------------------------|
    |exim4-doc-html    |I:1   |3662      |documentazione per Exim4  |
    |                  |      |          |(in formato HTML)         |
    |------------------+------+----------+--------------------------|
    |exim4-doc-info    |I:1   |624       |documentazione per Exim4  |
    |                  |      |          |(in formato info)         |
    |------------------+------+----------+--------------------------|
    |                  |V:145,|          |agente di trasferimento   |
    |postfix           |I:160 |4182      |della posta Postfix (MTA  |
    |                  |      |          |alternativo)              |
    |------------------+------+----------+--------------------------|
    |postfix-doc       |I:9   |4444      |documentazione per Postfix|
    |                  |      |          |(formati HTML e testo)    |
    |------------------+------+----------+--------------------------|
    |                  |V:5,  |          |implementazione dell'API  |
    |sasl2-bin         |I:19  |428       |SASL Cyrus (di supporto a |
    |                  |      |          |Postfix per SMTP AUTH)    |
    |------------------+------+----------+--------------------------|
    |cyrus-sasl2-doc   |I:1   |575       |SASL Cyrus -              |
    |                  |      |          |documentazione            |
    +---------------------------------------------------------------+


    Anche dal conteggio dei voti popcon exim4-* sembra svariate volte
    più popolare di postfix, ciò non significa che postfix non sia
    popolare tra gli sviluppatori Debian. Il sistema server Debian
    usa sia exim4 sia postfix. Anche l'analisi delle intestazioni
    della posta sui messaggi delle mailing list, da parte di
    sviluppatori Debian di spicco, indica che i due MTA sono
    ugualmente popolari.

    I pacchetti exim4-* sono conosciuti per il loro consumo di
    memoria molto basso e per essere molto flessibili nella
    configurazione. Il pacchetto postfix è conosciuto per essere
    compatto, veloce, facile e sicuro. Entrambi sono forniti con
    un'ampia documentazione, sono di alta qualità ed hanno una buona
    licenza.

    Nell'archivio Debian ci sono molte scelte per i pacchetti con
    agenti di trasporto della posta (MTA) con capacità e scopi
    diversi.

    Tabella 6.4. Elenco delle scelte per l'agente di trasporto della
    posta (MTA) tra i pacchetti dell'archivio Debian

    +---------------------------------------------------------------+
    |    pacchetto     |popcon|dimensione|     capacità e scopo     |
    |------------------+------+----------+--------------------------|
    |exim4-daemon-light|V:342,|1493      |completa                  |
    |                  |I:367 |          |                          |
    |------------------+------+----------+--------------------------|
    |postfix           |V:145,|4182      |completa (sicurezza)      |
    |                  |I:160 |          |                          |
    |------------------+------+----------+--------------------------|
    |exim4-daemon-heavy|V:7,  |1643      |completa (flessibilità)   |
    |                  |I:8   |          |                          |
    |------------------+------+----------+--------------------------|
    |sendmail-bin      |V:14, |1854      |completa (solo se si ha   |
    |                  |I:15  |          |già familiarità con esso) |
    |------------------+------+----------+--------------------------|
    |nullmailer        |V:7,  |479       |ridotta, niente posta     |
    |                  |I:10  |          |locale                    |
    |------------------+------+----------+--------------------------|
    |ssmtp             |V:8,  |2         |ridotta, niente posta     |
    |                  |I:11  |          |locale                    |
    |------------------+------+----------+--------------------------|
    |courier-mta       |V:0,  |2416      |molto completa            |
    |                  |I:0   |          |(interfaccia web, ecc.)   |
    |------------------+------+----------+--------------------------|
    |masqmail          |V:0,  |337       |leggera                   |
    |                  |I:0   |          |                          |
    |------------------+------+----------+--------------------------|
    |esmtp             |V:0,  |128       |leggera                   |
    |                  |I:0   |          |                          |
    |------------------+------+----------+--------------------------|
    |                  |V:0,  |          |leggera (estensioni per la|
    |esmtp-run         |I:0   |32        |compatibilità con sendmail|
    |                  |      |          |per esmtp)                |
    |------------------+------+----------+--------------------------|
    |msmtp             |V:5,  |547       |leggera                   |
    |                  |I:10  |          |                          |
    |------------------+------+----------+--------------------------|
    |                  |V:3,  |          |leggera (estensioni per la|
    |msmtp-mta         |I:4   |86        |compatibilità con sendmail|
    |                  |      |          |per msmtp)                |
    +---------------------------------------------------------------+


%

6.3.1. La configurazione di exim4

    Attenzione

    Configurare exim4 per inviare la posta Internet usando smarthost
    multipli che corrispondono a indirizzi email di origine multipli
    non è banale. È suggerito di impostare exim4 solo per un unico
    indirizzo email per i programmi di sistema come popcon e cron e
    impostare msmtp per indirizzi email di origine multipli per i
    programmi utente come mutt.

    Per la posta di Internet attraverso uno smarthost, riconfigurare
    i pacchetti exim4-* nel modo seguente.

    $ sudo /etc/init.d/exim4 stop
    $ sudo dpkg-reconfigure exim4-config

    Selezionare "posta inviata tramite «uno smarthost», ricevuta via
    SMTP o fetchmail" per "Tipo di configurazione del sistema di
    posta".

    Impostare "Mail name del sistema:" al suo valore predefinito come
    FQDN (vedere Sezione 5.1.1, «Risoluzione dei nomi di host»).

    Impostare "indirizzi IP sui quali attendere connessioni SMTP in
    ingresso:" al suo valore predefinito "127.0.0.1 ; ::1".

    Svuotare il contenuto di "Altre destinazioni per conto delle
    quali accettare posta:".

    Svuotare il contenuto di "Sistemi per i quali fare il "relay":".

    Impostare l'"Indirizzo IP o nome host dello smarthost per la
    posta in uscita:" a "smtp.hostname.dom:587".

    Selezionare "<No>" per "Omettere il mail name locale dai messaggi
    in uscita?". (Usare invece "/etc/email-addresses" come in
    Sezione 6.3.3, «La configurazione dell'indirizzo di posta».)

    Rispondere a "Mantenere al minimo il numero di richieste DNS
    (Dial-on-Demand)?" in uno dei modi seguenti.

      * "No", se il sistema è connesso ad Internet durante l'avvio.
   
      * "Sì", se il sistema non è connesso ad Internet durante
        l'avvio.

    Impostare "Modalità di consegna per la posta locale:" a "Formato
    mbox in /var/mail/".

    Selezionare "<Sì>" per "Dividere la configurazione in molti
    piccoli file?:".

    Creare voci per la password dello smarthost modificando il file "
    /etc/exim4/passwd.client".

    $ sudo vim /etc/exim4/passwd.client
     ...
    $ cat /etc/exim4/passwd.client
    ^smtp.*\.hostname\.dom:nomeutente@hostname.dom:password

    Avviare exim4 con il comando seguente.

    $ sudo /etc/init.d/exim4 start

    Il nome host in "/etc/exim4/passwd.client" non dovrebbe essere
    l'alias. Si può controllare il vero nome host nel modo seguente.

    $ host smtp.hostname.dom
    smtp.hostname.dom is an alias for smtp99.hostname.dom.
    smtp99.hostname.dom has address 123.234.123.89

    Per aggirare il problema degli alias, io uso espressioni regolari
    nel file "/etc/exim4/passwd.client" SMTP AUTH probabilmente
    funziona anche se il fornitore di servizi Internte sposta l'host
    a cui punta l'alias.

    Si può aggiornare manualmente la configurazione di exim4 facendo
    quanto segue:

      * Aggiornare i file di configurazione di exim4 in "/etc/exim4/
        ".

          + Creare "/etc/exim4/exim4.conf.localmacros" per impostare
            le MACRO e modificare "/etc/exim4/exim4.conf.template".
            (Configurazione non suddivisa.)

          + Creare nuovi file o modificare quelli esistenti nelle
            sottodirectory "/etc/exim4/exim4.conf.d". (Configurazione
            suddivisa.)

      * Eseguire "invoke-rc.d exim4 reload".

    Leggere la guida ufficiale in "/usr/share/doc/exim4-base/
    README.Debian.gz" e update-exim4.conf(8).

    Attenzione

    Se si è scelta la ripsosta "No" (risposta predefinita) per la
    domanda di debconf "Mantenere al minino il numero di richieste
    DNS (Dial-on-Demand)?" ed il sistema non è connesso ad Internet,
    l'avvio di exim4 può richiedere un tempo molto lungo.

    Avvertimento
   
    Usare password in testo semplice senza cifratura non è sicuro,
    nemmeno se il proprio ISP lo permette.

    Suggerimento

    Benché sia raccomandato l'uso di SMTP con STARTTLS sulla porta
    587, alcuni ISP usano ancora il deprecato SMTPS (SSL sulla porta
    465). Exim4 dopo la versione 4.77 supporta questo protocollo
    SMTPS deprecato sia per il client sia per il server.

    Suggerimento

    Se si sta cercando un MTA leggero che rispetti "/etc/aliases" per
    il proprio PC portatile, si dovrebbe considerare la
    configurazione di exim4(8) con "QUEUERUNNER='queueonly'",
    "QUEUERUNNER='nodaemon' ecc. in "/etc/default/exim4".

%

6.3.2. La configurazione di Postfix con SASL

    Per la posta Internet via smarthost, si dovrebbe come prima cosa
    leggere la documentazione di Postfix e le pagine man principali.

    Tabella 6.5. Elenco delle pagine di manuale di Postfix importanti

    +---------------------------------------------------------------+
    |  comando   |                     funzione                     |
    |------------+--------------------------------------------------|
    |postfix(1)  |programma di controllo di Postfix                 |
    |------------+--------------------------------------------------|
    |postconf(1) |utilità di configurazione per Postfix             |
    |------------+--------------------------------------------------|
    |postconf(5) |parametri di configurazione di Postfix            |
    |------------+--------------------------------------------------|
    |postmap(1)  |gestione delle tabelle di consultazione di Postfix|
    |------------+--------------------------------------------------|
    |postalias(1)|gestione del database degli alias di Postfix      |
    +---------------------------------------------------------------+


    Si possono (ri)configurare i pacchetti postfix e sasl2-bin nel
    modo seguente.

    $ sudo /etc/init.d/postfix stop
    $ sudo dpkg-reconfigure postfix

    Scegliere "Internet con smarthost".

    Impostare "relay host SMTP (vuoto per nessuno):" a "
    [smtp.hostname.dom]:587" e configurarlo nel modo seguente.

    $ sudo postconf -e 'smtp_sender_dependent_authentication = yes'
    $ sudo postconf -e 'smtp_sasl_auth_enable = yes'
    $ sudo postconf -e 'smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd'
    $ sudo postconf -e 'smtp_sasl_type = cyrus'
    $ sudo vim /etc/postfix/sasl_passwd

    Creare le voci con le password per lo smarthost.

    $ cat /etc/postfix/sasl_passwd
    [smtp.hostname.dom]:587     nomeutente:password
    $ sudo postmap hash:/etc/postfix/sasl_passwd

    Avviare postfix con il comando seguente.

    $ sudo /etc/init.d/postfix start

    In questo caso l'uso di "[" e "]" nel dialogo di dpkg-reconfigure
    e in "/etc/postfix/sasl_passwd" assocura che non venga
    controllato il record MX, ma usato direttamente l'esatto nome
    host specificato. Vedere "Abilitare l'autenticazione SASL nel
    client SMTP di Postfix" in "/usr/share/doc/postfix/html/
    SASL_README.html".

%

6.3.3. La configurazione dell'indirizzo di posta

    Ci sono diversi file di configurazione dell'indirizzo di posta
    per gli strumenti di trasporto della posta, di consegna e per i
    programma di posta.

    Tabella 6.6. Elenco dei file di configurazione correlati
    all'indirizzo di posta

    +---------------------------------------------------------------+
    |     file      |     funzione      |       applicazione        |
    |---------------+-------------------+---------------------------|
    |               |nome host          |specifico di Debian,       |
    |/etc/mailname  |predefinito per la |mailname(5)                |
    |               |posta (in uscita)  |                           |
    |---------------+-------------------+---------------------------|
    |/etc/          |sostituzione del   |specifico di exim(8),      |
    |email-addresses|home host per la   |exim4-config_files(5)      |
    |               |posta in uscita    |                           |
    |---------------+-------------------+---------------------------|
    |/etc/postfix/  |sostituzione del   |specifico di postfix(1),   |
    |generic        |home host per la   |attivato dopo l'esecuzione |
    |               |posta in uscita    |del comando postmap(1)     |
    |---------------+-------------------+---------------------------|
    |               |alias dei nomi     |generale, attivato dopo    |
    |/etc/aliases   |degli account per  |l'esecuzione del comando   |
    |               |la posta in entrata|newaliases(1)              |
    +---------------------------------------------------------------+


    Il nomeposta nel file "/etc/mailname" è solitamente un nome di
    dominio pienamente qualificato (FQDN) che è risolto ad uno degli
    indirizzi IP dell'host. Per le postazioni mobili che non hanno un
    nome host con un indirizzo IP risolvibile, impostare questo 
    nomemail al valore di "hostname -f". (Questa è una scelta sicura
    e funziona sia per exim4-* sia per postfix.)

    Suggerimento

    Il contenuto di "/etc/mailname" è usato da molti programmi non
    MTA per determinare il loro comportamento predefinito. Per mutt,
    impostare le variabili "hostname" e from" nel file ~/muttrc per
    sovrascrivere il valore di mailname. Per i programmi nel
    pacchetto devscripts, come bts(1) e dch(1), esportare le
    variabili d'ambiente "$DEBFULLNAME" e "$DEBEMAIL" per
    sovrascriverlo.

    Suggerimento

    Il pacchetto popularity-contest normalmente invia posta
    dall'account di root con FQDN. È necessario impostare MAILFROM in
    /etc/popularity-contest.conf come descritto nel file /usr/share/
    popularity-contest/default.conf. In caso contrario la posta verrà
    rigettata dal server SMTP dello smarthost. Sebbene sia una
    scocciatura, questo approccio è più sicuro della riscrittura
    dell'indirizzo sorgente di tutta la posta di root da parte
    dell'MTA e dovrebbe essere usato per altri demoni e script cron.

    Qunado si imposta mailname al valore di "hostname -f", la
    modifica dell'indirizzo di posta d'origine con il MTA può essere
    fatta nel modo seguente.

      * Usando il file "/etc/email-addresses" per exim4(8), come
        spiegato in exim4-config_files(5).
   
      * Usando il file "/etc/postfix/generic" per postfix(8), come
        spiegato in generic(5).

    Per postfix sono necessarie, in aggiunta, le azioni seguenti.

    # postmap hash:/etc/postfix/generic
    # postconf -e 'smtp_generic_maps = hash:/etc/postfix/generic'
    # postfix reload

    Si può testare la configurazione dell'indirizzo di posta nel modo
    seguente.

      * per exim(8) con le opzioni -brw, -bf, -bF, -bV, …
   
      * per postmap(1) con l'opzione -q.

    Suggerimento

    Exim viene fornito con svariati programmi di utilità, come 
    exiqgrep(8) e exipick(8). Per conoscere i comandi disponibili
    vedere "dpkg -L exim4-base|grep man8/".

%

6.3.4. Operazioni di base degli MTA

    Ci sono svariate operazioni di base degli MTA. Alcune possono
    essere fatte usando l'interfaccia di compatibilità con sendmail
    (1).

    Tabella 6.7. Elenco di operazioni base degli MTA

    +---------------------------------------------------------------+
    | comando  |  comando postfix  |          descrizione           |
    |   exim   |                   |                                |
    |----------+-------------------+--------------------------------|
    |          |                   |legge la posta dallo standard   |
    |sendmail  |sendmail           |input e gestisce la consegna    |
    |          |                   |(-bm)                           |
    |----------+-------------------+--------------------------------|
    |          |                   |elenca la coda della posta con  |
    |mailq     |mailq              |stato e ID dei messaggi in coda |
    |          |                   |(-bp)                           |
    |----------+-------------------+--------------------------------|
    |newaliases|newaliases         |inizializza il database degli   |
    |          |                   |alias (-I)                      |
    |----------+-------------------+--------------------------------|
    |exim4 -q  |postqueue -f       |invia tutta la posta in attesa  |
    |          |                   |(-q)                            |
    |----------+-------------------+--------------------------------|
    |          |postsuper -r ALL   |                                |
    |exim4 -qf |deferred; postqueue|invia tutta la posta            |
    |          |-f                 |                                |
    |----------+-------------------+--------------------------------|
    |exim4 -qff|postsuper -r ALL;  |invia anche la posta congelata  |
    |          |postqueue -f       |                                |
    |----------+-------------------+--------------------------------|
    |exim4 -Mg |postsuper -h       |congela un messaggio in base al |
    |id_in_coda|id_in_coda         |suo ID nella coda               |
    |----------+-------------------+--------------------------------|
    |exim4 -Mrm|postsuper -d       |rimuove un messaggio in base al |
    |id_in_coda|id_in_coda         |suo ID nella coda               |
    |----------+-------------------+--------------------------------|
    |N/D       |postsuper -d ALL   |rimuove tutti i messaggi        |
    +---------------------------------------------------------------+


    Suggerimento
   
    Può essere una buona idea far inviare tutta la posta da uno
    script in "/etc/ppp/ip-up.d/*".

%

6.4. Programma di posta (MUA, Mail User Agent)

    Se ci si iscrive ad una mailing list relativa a Debian, può
    essere una buona idea usare programmi di posta come mutt e mew
    che sono lo standard de facto per i partecipanti e che si
    comportano come previsto.

    Tabella 6.8. Elenco di programmi di posta (MUA)

    +---------------------------------------------------------------+
    | pacchetto |popcon|dimensione|              tipo               |
    |-----------+------+----------+---------------------------------|
    |           |V:31, |          |programma per X con interfaccia  |
    |evolution  |I:229 |475       |utente grafica (GNOME3, suite    |
    |           |      |          |groupware)                       |
    |-----------+------+----------+---------------------------------|
    |           |V:57, |          |programma per X con interfaccia  |
    |thunderbird|I:138 |165180    |utente grafica (GNOME2, Mozilla  |
    |           |      |          |Thunderbird senza marchi)        |
    |-----------+------+----------+---------------------------------|
    |kmail      |V:34, |18011     |programma per X con interfaccia  |
    |           |I:88  |          |utente grafica (KDE)             |
    |-----------+------+----------+---------------------------------|
    |           |V:37, |          |programma basato su terminale a  |
    |mutt       |I:313 |7056      |caratteri probabilmente usato con|
    |           |      |          |vim                              |
    |-----------+------+----------+---------------------------------|
    |mew        |V:0,  |2325      |programma basato su terminale a  |
    |           |I:0   |          |caratteri in (x)emacs            |
    +---------------------------------------------------------------+


%

6.4.1. Programma di posta base — Mutt

    Per usare mutt come programma di posta (MUA) in combinazione con
    vim, persoonalizzare "~/.muttrc" nel modo seguente.

    #
    # File di configurazione utente per sovrascrivere le impostazioni in /etc/Muttrc
    #
    # falsifica gli indirizzi di posta sorgenti
    set use_from
    set hostname=esempio.dom
    set from="Nome Cognome <nomeutente@esempio.dom>"
    set signature="~/.signature"

    # vim: "gq" per riformattare le citazioni
    set editor="vim -c 'set tw=72 et ft=mail'"

    # "mutt" apre la posta in entrata, mentre "mutt -y" elenca le caselle di posta
    set mbox_type=Maildir           # usa il formato Maildir di qmail per creare mbox
    set mbox=~/Mail                 # mette tutte le caselle di posta in $HOME/Mail/
    set spoolfile=+Inbox            # posta consegnata in $HOME/Mail/Inbox
    set record=+Outbox              # salva la posta fcc in $HOME/Mail/Outbox
    set postponed=+Postponed        # mette la posta posposta in $HOME/Mail/postponed
    set move=no                     # non spostare gli elementi nella posta in entrata in mbox
    set quit=ask-yes                # non uscire con il semplice uso di "q"
    set delete=yes                  # all'uscita cancella sempre senza chiedere
    set fcc_clear                   # salva fcc come non cifrate

    # Caselle di posta in Maildir (aggiornamento automatico)
    mailboxes `cd ~/Mail; /bin/ls -1|sed -e 's/^/+/' | tr "\n" " "`
    unmailboxes Maillog *.ev-summary

    ## Predefinito
    #set index_format="%4C %Z %{%b %d} %-15.15L (%4l) %s"
    ## Indice con thread con mittenti (collassato)
    set index_format="%4C %Z %{%b %d} %-15.15n %?M?(#%03M)&(%4l)? %s"

    ## Predefinito
    #set folder_format="%2C %t %N %F %2l %-8.8u %-8.8g %8s %d %f"
    ## solo i nomi delle cartelle
    set folder_format="%2C %t %N %f"

    Per visualizzare la posta HTML e gli allegati MS Word all'interno
    del messaggio, aggiungere a "/etc/mailcap" o a "~/.mailcap" le
    righe seguenti.

    text/html; lynx -force_html %s; needsterminal;
    application/msword; /usr/bin/antiword '%s'; copiousoutput; description="Microsoft Word Text"; nametemplate=%s.doc

    Suggerimento

    Mutt può essere usato come client IMAP e convertitore di formato
    per le caselle di posta. Si possono marcare messaggi con "t",
    "T", ecc. Questi messaggi marcati possono essere copiati con ";C"
    tra caselle di posta diverse e cancellati in un'unica volta con
    ";d".

%

6.4.2. Programma di posta avanzato - Mutt + msmtp

    Mutt può essere configurato per usare più indirizzi email
    sorgente con smarthost multipli corrispondenti usando msmtp.

    Suggerimento

    msmtp è un emulatore di sendmail che può essere installato
    insieme ad un altro emulatore di sendmail che fornisce il comando
    /usr/sbin/sendmail. Perciò si può lasciare che la propria posta
    di sistema usi exim4 o postfix.

    Come esempio, vediamo come gestire 3 indirizzi di posta
    elettronica:

      * "Mio nome1 <myaccount1@gmail.com>"

      * "Mio nome2 <myaccount2@gmail.com>"

      * "Mio nome3 <myaccount3@example.org>"

    Ecco un esempio di personalizzazione di ~/.muttrc che gestisce 3
    smarthost per 3 differenti indirizzi di posta elettronica
    sorgente.

    set use_from
    set from="Mio Nome3 <myaccount3@example.org>"
    set reverse_name
    alternates myaccount1@gmail\.com|myaccount1@gmail\.com|myaccount3@example\.org

    # ...

    # MACRO
    macro compose "1" "<edit-from>^UMio Nome1 \<myaccount1@gmail.com\>\n"
    macro compose "2" "<edit-from>^UMio Nome2 \<myaccount2@gmail.com\>\n"
    macro compose "3" "<edit-from>^UMio Nome3 \<myaccount3@example.org\>\n"

    send2-hook '~f myaccount1@gmail.com' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"
    send2-hook '~f myaccount2@gmail.com' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"
    send2-hook '~f myaccount3@example.org' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"

    # ...

    Installare msmtp-gnome e impostare ~/.msmtprc nel modo seguente.

    defaults
    logfile ~/.msmtp.log
    domain myhostname.example.org
    tls on
    tls_starttls on
    tls_certcheck on
    tls_trust_file /etc/ssl/certs/ca-certificates.crt
    auth on
    port 587
    auto_from

    account myaccount1@gmail.com
    host smtp.gmail.com
    from  myaccount1@gmail.com
    user  myaccount1@gmail.com

    account myaccount2@gmail.com
    host smtp.gmail.com
    from  myaccount2@gmail.com
    user  myaccount2@gmail.com

    account myaccount3@example.org
    host mail.example.org
    from  myaccount3@example.org
    user  myaccount3@example.org

    account default : myaccount3@example.org

    Poi aggiungere i dati delle password nel portachiavi di Gnome.
    Per esempio:

     $ secret-tool store --label=msmtp \
         host smtp.gmail.com \
         service smtp \
         user myaccount1@gmail.com
     ...

    Suggerimento

    Se non si desidera usare il portachiavi di Gnome, si può
    installare invece il pacchetto msmtp e aggiungere una voce del
    tipo "password segreto123" ad ogni account in ~/.msmtprc. Vedere
    la documentazione di memtp per ulteriori dettagli.

%

6.5. L'utilità per il recupero della posta da remoto e l'inoltro

    Invece di eseguire un programma di posta per accedere alla posta
    remota ed elaborarli a mano, si può volere automatizzare questo
    processo per avere tutti i messaggi di posta consegnati all'host
    locale. L'utilità di recupero e inoltro della posta remota è lo
    strumento adatto allo scopo.

    Anche se fetchmail(1) è stato lo standard de facto in GNU/Linux
    per il recupero della posta da remoto, l'autore preferisce 
    getmail(1). Se si desidera rifiutare la posta prima di scaricarla
    per salvare banda, potrebbero essere utili mailfilter o mpop.
    Qualsiasi strumento di recupero della posta si usi, è una buona
    idea configurare il sistema in modo che la posta recuperata venga
    consegnata ad un MDA, come maildrop, attraverso una pipe.

    Tabella 6.9. Elenco di utilità per il recupero della posta da
    remoto e l'inoltro

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|           descrizione            |
    |----------+------+----------+----------------------------------|
    |fetchmail |V:5,  |814       |strumento di recupero della posta |
    |          |I:17  |          |(POP3, APOP, IMAP) (vecchio)      |
    |----------+------+----------+----------------------------------|
    |          |V:1,  |          |strumento di recupero della posta |
    |getmail   |I:6   |30        |(POP3, IMAP4 e SDPS) (semplice,   |
    |          |      |          |sicuro e affidabile)              |
    |----------+------+----------+----------------------------------|
    |          |V:0,  |          |strumento di recupero della posta |
    |mailfilter|I:0   |291       |(POP3) con capacità di filtraggio |
    |          |      |          |con espressioni regolari          |
    |----------+------+----------+----------------------------------|
    |          |      |          |strumento di recupero della posta |
    |mpop      |V:0,  |400       |(POP3) e MDA con capacità di      |
    |          |I:0   |          |filtraggio con espressioni        |
    |          |      |          |regolari                          |
    +---------------------------------------------------------------+


%

6.5.1. Configurazione di getmail

    La configurazione di getmail(1) è descritta nella documentazione
    di getmail. Quelle seguenti sono le mie impostazioni per accedere
    ad account POP3 multipli come utente.

    Creare il file "/usr/local/bin/getmails" nel modo seguente.

    #!/bin/sh
    set -e
    if [ -f $HOME/.getmail/running ]; then
      echo "getmail is already running ... (if not, remove $HOME/.getmail/running)" >&2
      pgrep -l "getmai[l]"
      exit 1
    else
      echo "getmail has not been running ... " >&2
    fi
    if [ -f $HOME/.getmail/stop ]; then
      echo "do not run getmail ... (if not, remove $HOME/.getmail/stop)" >&2
      exit
    fi
    if [ "x$1" = "x-l" ]; then
      exit
    fi
    rcfiles="/usr/bin/getmail"
    for file in $HOME/.getmail/config/* ; do
      rcfiles="$rcfiles --rcfile $file"
    done
    date -u > $HOME/.getmail/running
    eval "$rcfiles $@"
    rm $HOME/.getmail/running

    Configurarlo nel modo seguente.

    $ sudo chmod 755 /usr/local/bin/getmails
    $ mkdir -m 0700 $HOME/.getmail
    $ mkdir -m 0700 $HOME/.getmail/config
    $ mkdir -m 0700 $HOME/.getmail/log

    Creare i file "$HOME/.getmail/config/nome_pop3", uno per ciascun
    account POP3, nel modo seguente.

    [retriever]
    type = SimplePOP3SSLRetriever
    server = pop.example.com
    username =  nome_pop3@example.com
    password = <propria-password>

    [destination]
    type = MDA_external
    path = /usr/bin/maildrop
    unixfrom = True

    [options]
    verbose = 0
    delete = True
    delivered_to = False
    message_log = ~/.getmail/log/nome_pop3.log

    Configurarlo nel modo seguente.

    $ chmod 0600 $HOME/.getmail/config/*

    Pianificare l'esecuzione di "/usr/local/bin/getmails" ogni 15
    minuti usando cron(8), eseguendo "sudo crontab -e -u
    <nome_utente>" e aggiungendo la riga seguente alle voci di cron
    dell'utente.

    5,20,35,50 * * * * /usr/local/bin/getmails --quiet

    Suggerimento

    Eventuali problemi nell'accesso POP3 potrebbero non derivare da
    getmail. Alcuni servizi POP3 gratuiti popolari possono violare il
    protocollo POP3 e i loro filtri anti-SPAM possono non essere
    perfetti. Per esempio, possono cancellare i messaggi subito dopo
    aver ricevuto il comando RETR, prima di ricevere il comando DELE,
    e possono mettere messaggi in quarantena nella casella dello
    Spam. Si dovrebbero minimizzare i danni configurandoli in modo da
    archiviare i messaggi a cui si ha avuto accesso, senza
    cancellarli. Vedere anche Alcuni messaggi di posta non sono stati
    scaricati.

%

6.5.2. configurazione di fetchmail

    La configurazione di fetchmail(1) è determinata da "/etc/default/
    fetchmail", "/etc/fetchmailrc" e "$HOME/.fetchmailrc". Vedere il
    suo esempio di configurazione in "/usr/share/doc/fetchmail/
    examples/fetchmailrc.example".

6.6. Agente di consegna della posta (MDA, Mail Delivery Agent) con
filtri

    La maggior parte dei programmi MTA, come postfix e exim4,
    funziona anche da MDA (Mail Delivery Agent, agente di consegna
    della posta). Ci sono MDA specializzati con capacità di
    filtraggio.

    Anche se procmail(1) è stato lo standard de facto in GNU/Linux
    per ciò riguarda gli MDA con filtri, l'autore preferisce maildrop
    (1). Qualsiasi strumento di filtraggio si usi, è una buona idea
    configurare il sistema per inviare la posta filtrata ad una
    Maildir in stile qmail.

    Tabella 6.10. Elenco di MDA con filtri

    +---------------------------------------------------------------+
    |pacchetto| popcon |dimensione|           descrizione           |
    |---------+--------+----------+---------------------------------|
    |procmail |V:40,   |300       |MDA con filtri (vecchio)         |
    |         |I:277   |          |                                 |
    |---------+--------+----------+---------------------------------|
    |mailagent|V:0, I:5|1356      |MDA con filtri Perl              |
    |---------+--------+----------+---------------------------------|
    |maildrop |V:0, I:2|1141      |MDA con linguaggio strutturato   |
    |         |        |          |per i filtri                     |
    +---------------------------------------------------------------+


%

6.6.1. configurazione di maildrop

    La configurazione di maildrop(1) è descritta nella documentazione
    di maildropfilter. Quello che segue è un esempio di
    configurazione per "$HOME/.mailfilter".

    # Configurazione locale
    MAILROOT="$HOME/Mail"
    # impostare questo al contenuto di /etc/mailname
    MAILHOST="esempio.dom"
    logfile $HOME/.maildroplog

    # le regole sono fatte per sovrascrivere il valore precedente con quello successivo.

    # posta di mailing list ?
    if (     /^Precedence:.*list/:h || /^Precedence:.*bulk/:h )
    {
        # regole per la posta di mailing list
        # casella di posta predefinita per i messaggi di mailing list
        MAILBOX="Inbox-list"
        # casella di posta predefinita per i messaggi di debian.org
        if ( /^(Sender|Resent-From|Resent-Sender): .*debian.org/:h )
        {
            MAILBOX="service.debian.org"
        }
        # casella di posta predefinita per i messaggi di bugs.debian.org (BTS)
        if ( /^(Sender|Resent-From|Resent-sender): .*@bugs.debian.org/:h )
        {
            MAILBOX="bugs.debian.org"
        }
        # casella di posta per ogni mailing list correttamente mantenuta con "List-Id: pippo" o "List-Id: ...<pippo.pluto>"
        if ( /^List-Id: ([^<]*<)?([^<>]*)>?/:h )
        {
            MAILBOX="$MATCH2"
        }
    }
    else
    {
        # regole per messaggi non di mailing list
        # casella di posta in entrata predefinita
        MAILBOX="Inbox-unusual"
        # messaggi di posta locali
        if ( /Envelope-to: .*@$MAILHOST/:h )
        {
            MAILBOX="Inbox-local"
        }
        # messaggi di posta html (al 99% posta indesiderata)
        if ( /DOCTYPE html/:b ||\
             /^Content-Type: text\/html/ )
        {
            MAILBOX="Inbox-html"
        }
        # regola per la lista nera per la posta indesiderata
        if ( /^X-Advertisement/:h ||\
             /^Subject:.*BUSINESS PROPOSAL/:h ||\
             /^Subject:.*URGENT.*ASISSTANCE/:h ||\
             /^Subject: *I NEED YOUR ASSISTANCE/:h )
        {
            MAILBOX="Inbox-trash"
        }
        # regola per la lista bianca per la posta normale
        if ( /^From: .*@debian.org/:h ||\
             /^(Sender|Resent-From|Resent-Sender): .*debian.org/:h ||\
             /^Subject: .*(debian|bug|PATCH)/:h )
        {
            MAILBOX="Inbox"
        }
        # regola per la lista bianca dei messaggi relativi al BTS
        if ( /^Subject: .*Bug#.*/:h ||\
             /^(To|Cc): .*@bugs.debian.org/:h )
        {
            MAILBOX="bugs.debian.org"
        }
        # regola per la lista bianca per messaggi di cron relativi a getmail
        if ( /^Subject: Cron .*getmails/:h )
        {
            MAILBOX="Inbox-getmails"
        }
    }

    # controlla esistenza di $MAILBOX
    `test -d $MAILROOT/$MAILBOX`
    if ( $RETURNCODE == 1 )
    {
        # crea una casella di posta maildir per $MAILBOX
        `maildirmake $MAILROOT/$MAILBOX`
    }
    # consegna nella maildir $MAILBOX
    to "$MAILROOT/$MAILBOX/"
    exit

    Avvertimento

    A differenza di procmail, maildrop non crea automaticamente le
    directory maildir mancanti. Devono essere create prima
    manualmente usando maildirmake(1) come nell'esempio di file
    "$HOME/.mailfilter" precedente.

%

6.6.2. configurazione di procmail

    Quello che segue è un file di configurazione simile "$HOME
    /.procmailrc" per procmail(1).

    MAILDIR=$HOME/Maildir
    DEFAULT=$MAILDIR/Inbox/
    LOGFILE=$MAILDIR/Maillog
    # posta palesemente con brutto aspetto: gettarla in X-trash e uscire
    :0
    * 1^0 ^X-Advertisement
    * 1^0 ^Subject:.*BUSINESS PROPOSAL
    * 1^0 ^Subject:.*URGENT.*ASISSTANCE
    * 1^0 ^Subject: *I NEED YOUR ASSISTANCE
    X-trash/

    # Consegna dei messaggi di mailinglist
    :0
    * 1^0 ^Precedence:.*list
    * 1^0 ^Precedence:.*bulk
    * 1^0 ^List-
    * 1^0 ^X-Distribution:.*bulk
    {
    :0
    * 1^0 ^Return-path:.*debian-devel-admin@debian.or.jp
    jp-debian-devel/

    :0
    * ^Resent-Sender.*debian-user-request@lists.debian.org
    debian-user/

    :0
    * ^Resent-Sender.*debian-devel-request@lists.debian.org
    debian-devel/

    :0
    * ^Resent-Sender.*debian-announce-request@lists.debian.org
    debian-announce

    :0
    mailing-list/
    }

    :0
    Inbox/

%

6.6.3. Riconsegna del contenuto di mbox

    Se la propria directory home diventa piena e la consegna con 
    procmail(1) fallisce, sarà necessario consegnare manualmente la
    posta da "/var/mail/<nomeutente>" alle proprie caselle di posta
    distinte nella directory home. Dopo aver fatto spazio nella
    directory home, eseguire quanto segue.

    # /etc/init.d/${MAILDAEMON} stop
    # formail -s procmail </var/mail/<nomeutente>
    # /etc/init.d/${MAILDAEMON} start

%

6.7. Server POP3/IMAP4

    Se si deve eseguire un server privato in una LAN, si può prendere
    in considerazione l'esecuzione di un server POP3 / IMAP4 per la
    consegna della posta ai client nella LAN.

    Tabella 6.11. Elenco di server POP3/IMAP4

    +---------------------------------------------------------------+
    | pacchetto  |popcon|dimensione|tipo|        descrizione        |
    |------------+------+----------+----+---------------------------|
    |            |V:2,  |          |    |Server di posta Courier -  |
    |courier-pop |I:2   |308       |POP3|server POP3 (solo formato  |
    |            |      |          |    |maildir)                   |
    |------------+------+----------+----+---------------------------|
    |cyrus-pop3d |V:0,  |160       |POP3|sistema di posta Cyrus     |
    |            |I:0   |          |    |(supporto POP3)            |
    |------------+------+----------+----+---------------------------|
    |            |V:3,  |          |    |Server di posta Courier -  |
    |courier-imap|I:4   |589       |IMAP|server IMAP (solo formato  |
    |            |      |          |    |maildir)                   |
    |------------+------+----------+----+---------------------------|
    |cyrus-imapd |V:1,  |484       |IMAP|sistema di posta Cyrus     |
    |            |I:1   |          |    |(supporto IMAP)            |
    +---------------------------------------------------------------+


%

6.8. Server ed utilità per la stampa

    In the old Unix-like system, the BSD Line printer daemon (lpd)
    was the standard and the standard print out format of the classic
    free software was PostScript (PS). Some filter system was used
    along with Ghostscript to enable printing to the non-PostScript
    printer. See Sezione 11.4.1, «Ghostscript».

    In the modern Debian system, the Common UNIX Printing System
    (CUPS) is the de facto standard and the standard print out format
    of the modern free software is Portable Document Format (PDF).

    The CUPS uses Internet Printing Protocol (IPP). The IPP is now
    supported by other OSs such as Windows XP and Mac OS X and has
    became new cross-platform de facto standard for remote printing
    with bi-directional communication capability.

    Grazie alla funzionalità di auto-conversione in base al formato
    dei file del sistema CUPS, il semplice passaggio di qualsiasi
    tipo di dati al comando lpr dovrebbe generare l'output di stampa
    atteso. (In CUPS, il comando lpr può essere abilitato installando
    il pacchetto cups-bsd.)

    Il sistema Debian ha alcuni pacchetti degni di nota per ciò che
    riguarda i server e le utilità di stampa

    Tabella 6.12. Elenco di server e utilità di stampa

    +--------------------------------------------------------------------+
    |        pacchetto        |popcon|dimensione|   porta   |descrizione |
    |-------------------------+------+----------+-----------+------------|
    |                         |      |          |           |lpr/lpd BSD |
    |                         |      |          |           |(Line       |
    |                         |V:3,  |          |printer    |printer     |
    |lpr                      |I:4   |362       |(515)      |daemon,     |
    |                         |      |          |           |demone di   |
    |                         |      |          |           |stampa in   |
    |                         |      |          |           |linea)      |
    |-------------------------+------+----------+-----------+------------|
    |lprng                    |V:1,  |3064      |" "        |" "         |
    |                         |I:1   |          |           |(Migliorato)|
    |-------------------------+------+----------+-----------+------------|
    |                         |V:140,|          |           |server CUPS |
    |cups                     |I:395 |1141      |IPP (631)  |di stampa   |
    |                         |      |          |           |Internet    |
    |-------------------------+------+----------+-----------+------------|
    |                         |      |          |           |comandi     |
    |                         |      |          |           |System V per|
    |                         |      |          |           |la stampa   |
    |                         |      |          |           |con CUPS: lp|
    |                         |      |          |           |(1), lpstat |
    |cups-client              |V:56, |493       |" "        |(1),        |
    |                         |I:454 |          |           |lpoptions(1)|
    |                         |      |          |           |, cancel(1),|
    |                         |      |          |           |lpmove(8),  |
    |                         |      |          |           |lpinfo(8),  |
    |                         |      |          |           |lpadmin(8), |
    |                         |      |          |           |…           |
    |-------------------------+------+----------+-----------+------------|
    |                         |      |          |           |comandi BSD |
    |                         |      |          |           |per la      |
    |                         |V:36, |          |           |stampa con  |
    |cups-bsd                 |I:385 |122       |" "        |CUPS: lpr(1)|
    |                         |      |          |           |, lpq(1),   |
    |                         |      |          |           |lprm(1), lpc|
    |                         |      |          |           |(8)         |
    |-------------------------+------+----------+-----------+------------|
    |                         |V:100,|          |Non        |driver di   |
    |printer-driver-gutenprint|I:372 |937       |applicabile|stampa per  |
    |                         |      |          |           |CUPS        |
    +--------------------------------------------------------------------+


    Suggerimento
   
    Si può configurare il sistema CUPS indirizzando il proprio
    browser web all'indirizzo "http://localhost:631/".

%

6.9. Il server e le utilità per l'accesso remoto (SSH)

    SSH (Secure SHell) è il metodo sicuro per connettersi in
    Internet. Una versione libera di SSH chiamata OpenSSH è
    disponibile nei pacchetti Debian openssh-client e openssh-server.

    Tabella 6.13. Elenco dei server e delle utilità per l'accesso remoto

    +---------------------------------------------------------------------------+
    |      pacchetto       |popcon|dimensione|      strumento       |descrizione|
    |----------------------+------+----------+----------------------+-----------|
    |openssh-client        |V:803,|4298      |ssh(1)                |client SSH |
    |                      |I:996 |          |                      |           |
    |----------------------+------+----------+----------------------+-----------|
    |openssh-server        |V:690,|1567      |sshd(8)               |server SSH |
    |                      |I:834 |          |                      |           |
    |----------------------+------+----------+----------------------+-----------|
    |                      |      |          |                      |chiede     |
    |                      |      |          |                      |all'utente |
    |ssh-askpass-fullscreen|V:0,  |42        |ssh-askpass-fullscreen|una        |
    |                      |I:0   |          |(1)                   |passphrase |
    |                      |      |          |                      |per ssh-add|
    |                      |      |          |                      |(GNOME2)   |
    |----------------------+------+----------+----------------------+-----------|
    |                      |      |          |                      |chiede     |
    |                      |      |          |                      |all'utente |
    |                      |V:3,  |          |                      |una        |
    |ssh-askpass           |I:34  |106       |ssh-askpass(1)        |passphrase |
    |                      |      |          |                      |per ssh-add|
    |                      |      |          |                      |(X         |
    |                      |      |          |                      |semplice)  |
    +---------------------------------------------------------------------------+


    Attenzione
   
    Se il proprio SSH è accessibile da Internet, vedere
    Sezione 4.7.3, «Misure aggiuntive di sicurezza per Internet».

    Suggerimento

    Per permettere al processo della shell remota di sopravvivere
    all'interruzione della connessione, usare il programma screen(1)
    (vedere Sezione 9.1, «Il programma screen»).

%

6.9.1. Nozioni di base su SSH

    Avvertimento
   
    Se si desidera eseguire il server OpenSSH, non deve esistere il
    file "/etc/ssh/sshd_not_to_be_run".

    SSH ha due protocolli di autenticazione

    Tabella 6.14. Elenco dei protocolli e dei metodi di
    autenticazione di SSH

    +---------------------------------------------------------------+
    |protocollo|           metodo SSH            |   descrizione    |
    |   SSH    |                                 |                  |
    |----------+---------------------------------+------------------|
    |          |                                 |autenticazione    |
    |SSH-1     |"RSAAuthentication"              |utente RSA basata |
    |          |                                 |su chiave         |
    |          |                                 |identificativa    |
    |----------+---------------------------------+------------------|
    |          |                                 |autenticazione di |
    |          |                                 |host basata su    |
    |" "       |"RhostsAuthentication"           |".rhosts"         |
    |          |                                 |(insicura,        |
    |          |                                 |disabilitata)     |
    |----------+---------------------------------+------------------|
    |          |                                 |autenticazione di |
    |          |                                 |host basata su    |
    |" "       |"RhostsRSAAuthentication"        |".rhosts" in      |
    |          |                                 |combinazione con  |
    |          |                                 |chiave RSA per    |
    |          |                                 |host(disabilitata)|
    |----------+---------------------------------+------------------|
    |" "       |"ChallengeResponseAuthentication"|autenticazione RSA|
    |          |                                 |challenge-response|
    |----------+---------------------------------+------------------|
    |" "       |"PasswordAuthentication"         |autenticazione    |
    |          |                                 |basata su password|
    |----------+---------------------------------+------------------|
    |          |                                 |autenticazione    |
    |SSH-2     |"PubkeyAuthentication"           |utente basata su  |
    |          |                                 |chiave pubblica   |
    |----------+---------------------------------+------------------|
    |          |                                 |autenticazione di |
    |          |                                 |host basata su "~ |
    |          |                                 |/.rhosts" o "/etc/|
    |          |                                 |hosts.equiv" in   |
    |" "       |"HostbasedAuthentication"        |combinazione con  |
    |          |                                 |autenticazione    |
    |          |                                 |dell'host client  |
    |          |                                 |con chiave        |
    |          |                                 |pubblica          |
    |          |                                 |(disabilitata)    |
    |----------+---------------------------------+------------------|
    |" "       |"ChallengeResponseAuthentication"|autenticazione    |
    |          |                                 |challenge-response|
    |----------+---------------------------------+------------------|
    |" "       |"PasswordAuthentication"         |autenticazione    |
    |          |                                 |basata su password|
    +---------------------------------------------------------------+


    Attenzione
   
    Se si usa un sistema non Debian si faccia attenzione a queste
    differenze.

    Per i dettagli vedere "/usr/share/doc/ssh/README.Debian.gz", ssh
    (1), sshd(8), ssh-agent(1) e ssh-keygen(1).

    Di seguito è riportato l'elenco dei file di configurazione più
    importanti.

    Tabella 6.15. Elenco dei file di configurazione per SSH

    +---------------------------------------------------------------+
    |    file di    |    descrizione del file di configurazione     |
    |configurazione |                                               |
    |---------------+-----------------------------------------------|
    |/etc/ssh/      |impostazioni predefinite per il client SSH,    |
    |ssh_config     |vedere ssh_config(5)                           |
    |---------------+-----------------------------------------------|
    |/etc/ssh/      |impostazioni predefinite per il server SSH,    |
    |sshd_config    |vedere ssh_config(5)                           |
    |---------------+-----------------------------------------------|
    |~/.ssh/        |chiavi SSH pubbliche predefinite che i client  |
    |authorized_keys|usano per connettersi a questo account su      |
    |               |questo server SSH                              |
    |---------------+-----------------------------------------------|
    |~/.ssh/identity|chiave RSA SSH-1 segreta dell'utente           |
    |---------------+-----------------------------------------------|
    |~/.ssh/id_rsa  |chiave RSA SSH-2 segreta dell'utente           |
    |---------------+-----------------------------------------------|
    |~/.ssh/id_dsa  |chiave DSA SSH-2 segreta dell'utente           |
    +---------------------------------------------------------------+


    Suggerimento
   
    Per l'uso delle chiavi SSH pubbliche e segrete, vedere ssh-keygen
    (1), ssh-add(1) e ssh-agent(1).

    Suggerimento
   
    Assicurarsi di verificare le impostazioni testando la
    connessione. In caso di problemi, usare "ssh -v".

    Suggerimento
   
    Si può cambiare successivamente la passphrase per cifrare le
    chiavi SSH segrete locali usando "ssh-keygen -p".

    Suggerimento

    Si possono aggiungere opzioni alle voci in "~/.ssh/
    authorized_keys" per limitare gli host e per eseguire comandi
    specifici. Per i dettagli vedere sshd(8).

    I comandi seguenti avviano una connessione ssh(1) da un client.

    Tabella 6.16. Elenco di esempi di avvio di client SSH

    +---------------------------------------------------------------+
    |              comando              |        descrizione        |
    |-----------------------------------+---------------------------|
    |ssh nomeutente@nomehost.dominio.ext|connette nella modalità    |
    |                                   |predefinita                |
    |-----------------------------------+---------------------------|
    |ssh -v                             |connette nella modalità    |
    |nomeutente@nomehost.dominio.ext    |predefinita con messaggi di|
    |                                   |debug                      |
    |-----------------------------------+---------------------------|
    |ssh -1                             |forza la connessione con   |
    |nomeutente@nomehost.dominio.ext    |SSH versione 1             |
    |-----------------------------------+---------------------------|
    |ssh -1 -o RSAAuthentication=no -l  |forza l'uso di password con|
    |nomeutente nomehost.dominio.ext    |SSH versione 1             |
    |-----------------------------------+---------------------------|
    |ssh -o PreferredAuthentications=   |forza l'uso di password con|
    |password -l nomeutente             |SSH versione 2             |
    |nomehost.dominio.ext               |                           |
    +---------------------------------------------------------------+


    Se si usa lo stesso nome utente sull'host locale e su quello
    remoto, si può evitare di digitare la parte "nomeutente@". Anche
    se si usa un nome utente diverso nell'host locale rispetto a
    quello remoto, si può evitare di digitare quella parte usando il
    file "~/.ssh/config". Per il servizio Debian Salsa con nome
    account "pippo-guest", impostare "~/.ssh/config" in modo che
    contenga quanto segue.

    Host salsa.debian.org people.debian.org
        User pippo-guest

    Per l'utente ssh(1) funziona come un telnet(1) più intelligente e
    più sicuro. A differenza del comando telnet, ssh non si
    interrompe a seguito del carattere di escape di telnet
    (impostazione predefinita iniziale CTRL-]).

%

6.9.2. Forwarding della porta per tunnel SMTP/POP3

    Per stabilire una pipe per connettersi alla porta 25 del
    server-remoto dalla porta 4025 dell'host locale e alla porta 110
    del server-remoto dalla porta 4110 dell'host locale attraverso
    ssh, eseguire sull'host locale il comando seguente.

    # ssh -q -L 4025:server-remoto:25 4110:server-remoto:110 nomeutente@server-remoto

    Questo è un metodo sicuro di creare connessioni a server SMTP/
    POP3 in Internet. Impostare nel file "/etc/ssh/sshd_config"
    dell'host remoto la voce "AllowTcpForwarding" a "yes".

%

6.9.3. Connettersi senza password remote

    Si può evitare di doversi ricordare le password per sistemi
    remoti usando "RSAAuthentication" (protocollo SSH-1) o
    "PubkeyAuthentication" (protocollo SSH-2).

    Sul sistema remoto impostare nel file "/etc/ssh/sshd_config" le
    rispettive voci "RSAAuthentication yes" o "PubkeyAuthentication
    yes".

    Generare localmente le chiavi di autenticazione ed installare la
    chiave pubblica sul sistema remoto con i comandi seguenti.

      * "RSAAuthentication": chiave RSA per SSH-1 (deprecata perché
        superata)

    $ ssh-keygen
    $ cat .ssh/identity.pub | ssh utente1@remote "cat - >>.ssh/authorized_keys"

      * "PubkeyAuthentication": chiave RSA per SSH-2

    $ ssh-keygen -t rsa
    $ cat .ssh/id_rsa.pub | ssh utente1@remote "cat - >>.ssh/authorized_keys"

      * "PubkeyAuthentication": chiave DSA per SSH-2 (deprecata
        perché lenta)

    $ ssh-keygen -t dsa
    $ cat .ssh/id_dsa.pub | ssh utente1@remote "cat - >>.ssh/authorized_keys"

    Suggerimento

    L'uso di una chiave DSA per SSH-2 è deprecato perché la chiave è
    più piccola e più lenta. Non esistono più motivi per aggirare i
    brevetti RSA usando DSA, dato che essi sono scaduti. DSA sta per
    Algoritmo di firma digitale (Digital Signature Algorithm) ed è
    lento. Vedere anche DSA-1571-1.

    Nota

    Affinché "HostbasedAuthentication" funzioni con SSH-2, si deve
    impostare la voce "HostbasedAuthentication" a "yes" in entrambi i
    file "/etc/ssh/sshd_config" nell'host server e i "/etc/ssh/
    ssh_config" o "~/.ssh/config" nell'host client.

%

6.9.4. Gestire client SSH estranei

    Sono disponibili alcuni client SSH liberi per altre piattaforme.

    Tabella 6.17. Elenco di client SSH per altre piattaforme

    +---------------------------------------------------------------+
    |  ambiente   |              programma ssh libero               |
    |-------------+-------------------------------------------------|
    |Windows      |puTTY (http://www.chiark.greenend.org.uk/        |
    |             |~sgtatham/putty/) (GPL)                          |
    |-------------+-------------------------------------------------|
    |Windows      |SSH in cygwin (http://www.cygwin.com/) (GPL)     |
    |(cygwin)     |                                                 |
    |-------------+-------------------------------------------------|
    |Macintosh    |macSSH (http://www.macssh.com/) (GPL)            |
    |Classic      |                                                 |
    |-------------+-------------------------------------------------|
    |Mac OS X     |OpenSSH; usare ssh nell'applicazione Terminale   |
    |             |(GPL)                                            |
    +---------------------------------------------------------------+


%

6.9.5. Impostare ssh-agent

    È meglio per ragioni di sicurezza proteggere la propria chiave
    segreta di autenticazione SSH con una passphrase. Se non è già
    stata impostata una passphrase usare "ssh-keygen -p" per farlo.

    Mettere la propria chiav SSH pubblica (ad esempio "~/.ssh/
    id_rsa.pub") in "~/.ssh/authorized_keys" su un host remoto usando
    una connessione all'host remoto basata su password, come
    descritto in precedenza.

    $ ssh-agent bash
    $ ssh-add ~/.ssh/id_rsa
    Enter passphrase for /home/<nomeutente>/.ssh/id_rsa:
    Identity added: /home/<nomeutente>/.ssh/id_rsa (/home/<nomeutente>/.ssh/id_rsa)

    Per il comando successivo non sarà più necessaria da questo
    momento la password remota.

    $ scp pippo <nomeutente>@host.remoto:pippo

    Premere ~D per terminare la sessione ssh-agent.

    Per il server X, il normale script di avvio Debian esegue
    ssh-agent come processo genitore. Perciò è necessario eseguire
    ssh-add una volta sola. Per ulteriori informazioni, leggere 
    ssh-agent(1) e ssh-add(1).

%

6.9.6. Spegnere il sistema remoto su SSH

    È necessario proteggere il processo che esegue "shutdown -h now"
    (vedere Sezione 1.1.8, «Come spegnere il sistema») dalla
    terminazione di SSH usando il comando at(1) (vedere
    Sezione 9.3.13, «Pianificare compiti da eseguire una volta sola»)
    nel modo seguente.

    # echo "shutdown -h now" | at now

    Eseguire "shutdown -h now" in una sessione screen(1) (vedere
    Sezione 9.1, «Il programma screen») è un altro modo di ottenere
    lo stesso risultato.

%

6.9.7. Risolvere il problemi con SSH

    Se si hanno problemi, controllare i permessi dei file di
    configurazione ed eseguire ssh con l'opzione "-v".

    Se si è root e si hanno problemi con un firewall usare l'opzione
    "-p"; questo evita l'uso delle porte 1 - 1023 del server.

    Se le connessioni ssh ad un sito remoto smettono di funzionare
    improvvisamente, potrebbe essere a causa di modifiche fatte
    dall'amministratore di sistema, molto probabilmente cambiamenti
    in "host-key" durante l'amministrazione del sistema. Dopo essersi
    accertati che questa sia davvero la causa e che nessuna stia
    cercando di falsificare l'host remoto con qualche trucchetto, si
    può riottenere una connessione rimuovendo la voce "host-key" dal
    file "~/.ssh/known_hosts" sull'host locale.

%

6.10. Altri server di rete

    Ecco un elenco di altri server applicativi di rete.

    Tabella 6.18. Elenco di altri server applicativi di rete

    +---------------------------------------------------------------+
    |    pacchetto    |popcon|dimensione|protocollo|  descrizione   |
    |-----------------+------+----------+----------+----------------|
    |telnetd          |V:1,  |115       |TELNET    |server TELNET   |
    |                 |I:3   |          |          |                |
    |-----------------+------+----------+----------+----------------|
    |telnetd-ssl      |V:0,  |170       |" "       |" " (supporto   |
    |                 |I:0   |          |          |SSL)            |
    |-----------------+------+----------+----------+----------------|
    |nfs-kernel-server|V:38, |342       |NFS       |condivisione di |
    |                 |I:79  |          |          |file Unix       |
    |-----------------+------+----------+----------+----------------|
    |                 |V:102,|          |          |condivisione di |
    |samba            |I:159 |16629     |SMB       |file e stampanti|
    |                 |      |          |          |Windows         |
    |-----------------+------+----------+----------+----------------|
    |                 |      |          |          |condivisione di |
    |netatalk         |V:2,  |2077      |ATP       |file e stampanti|
    |                 |I:3   |          |          |Apple/Mac       |
    |                 |      |          |          |(AppleTalk)     |
    |-----------------+------+----------+----------+----------------|
    |proftpd-basic    |V:24, |488       |FTP       |scaricamento    |
    |                 |I:32  |          |          |generico di file|
    |-----------------+------+----------+----------+----------------|
    |apache2          |V:246,|610       |HTTP      |server web      |
    |                 |I:315 |          |          |generico        |
    |-----------------+------+----------+----------+----------------|
    |squid            |V:13, |8385      |" "       |server proxy web|
    |                 |I:15  |          |          |generico        |
    |-----------------+------+----------+----------+----------------|
    |squid3           |V:4,  |240       |" "       |" "             |
    |                 |I:10  |          |          |                |
    |-----------------+------+----------+----------+----------------|
    |bind9            |V:52, |1063      |DNS       |indirizzo IP per|
    |                 |I:65  |          |          |altri host      |
    |-----------------+------+----------+----------+----------------|
    |isc-dhcp-server  |V:18, |1471      |DHCP      |indirizzo IP per|
    |                 |I:54  |          |          |il client stesso|
    +---------------------------------------------------------------+


    CIFS (Common Internet File System Protocol) è lo stesso
    protocollo di SMB (Server Message Block) ed è ampiamente usato da
    Microsoft Windows.

    Suggerimento
   
    Vedere Sezione 4.5.2, «La moderna gestione centralizzata del
    sistema» per l'integrazione di sistemi server.

    Suggerimento

    La risoluzione del nome di host è solitamente fornita dal server
    DNS. Per l'indirizzo IP dell'host assegnato dinamicamente da
    DHCP, può essere impostato un DNS dinamico per la risoluzione del
    nome host, usando bind9 e isc-dhcp-server come descritto nella
    pagina del Wiki Debian sui DDNS.

    Suggerimento

    L'uso di server proxy come squid è molti più efficiente per
    risparmiare banda rispetto all'uso di server mirror locali con il
    completo contenuto dell'archivio Debian.

%

6.11. Altri client di rete

    Ecco un elenco di altri client applicativi di rete.

    Tabella 6.19. Elenco di altri client applicativi di rete

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|protocollo|   descrizione    |
    |---------------+------+----------+----------+------------------|
    |netcat         |I:41  |16        |TCP/IP    |coltellino        |
    |               |      |          |          |svizzero TCP/IP   |
    |---------------+------+----------+----------+------------------|
    |               |      |          |          |eseguibile SSL    |
    |               |V:794,|          |          |(Secure Socket    |
    |openssl        |I:993 |1465      |SSL       |Layer) e strumenti|
    |               |      |          |          |crittografici     |
    |               |      |          |          |relativi          |
    |---------------+------+----------+----------+------------------|
    |stunnel4       |V:5,  |507       |" "       |wrapper SSL       |
    |               |I:17  |          |          |universale        |
    |---------------+------+----------+----------+------------------|
    |telnet         |V:65, |163       |TELNET    |client TELNET     |
    |               |I:904 |          |          |                  |
    |---------------+------+----------+----------+------------------|
    |telnet-ssl     |V:0,  |210       |" "       |" " (supporto SSL)|
    |               |I:3   |          |          |                  |
    |---------------+------+----------+----------+------------------|
    |nfs-common     |V:181,|768       |NFS       |condivisione di   |
    |               |I:343 |          |          |file Unix         |
    |---------------+------+----------+----------+------------------|
    |               |      |          |          |client per        |
    |smbclient      |V:16, |2016      |SMB       |condivisione di   |
    |               |I:174 |          |          |file e stampanti  |
    |               |      |          |          |MS Windows        |
    |---------------+------+----------+----------+------------------|
    |               |V:32, |          |          |comandi mount e   |
    |cifs-utils     |I:123 |299       |" "       |umount per file MS|
    |               |      |          |          |Windows remoti    |
    |---------------+------+----------+----------+------------------|
    |ftp            |V:18, |137       |FTP       |client FTP        |
    |               |I:282 |          |          |                  |
    |---------------+------+----------+----------+------------------|
    |lftp           |V:6,  |2255      |" "       |" "               |
    |               |I:39  |          |          |                  |
    |---------------+------+----------+----------+------------------|
    |ncftp          |V:3,  |1339      |" "       |client FTP a tutto|
    |               |I:22  |          |          |schermo           |
    |---------------+------+----------+----------+------------------|
    |wget           |V:288,|3477      |HTTP e FTP|scaricatore per   |
    |               |I:988 |          |          |web               |
    |---------------+------+----------+----------+------------------|
    |curl           |V:151,|426       |" "       |" "               |
    |               |I:548 |          |          |                  |
    |---------------+------+----------+----------+------------------|
    |axel           |V:0,  |216       |" "       |scaricatore       |
    |               |I:4   |          |          |accelerato        |
    |---------------+------+----------+----------+------------------|
    |               |      |          |          |scaricatore       |
    |               |V:2,  |          |          |accelerato con    |
    |aria2          |I:19  |1854      |" "       |gestione di       |
    |               |      |          |          |BitTorrent e      |
    |               |      |          |          |Metalink          |
    |---------------+------+----------+----------+------------------|
    |               |V:382,|          |          |host(1) da bind9, |
    |bind9-host     |I:948 |365       |DNS       |"Priorità:        |
    |               |      |          |          |standard"         |
    |---------------+------+----------+----------+------------------|
    |               |V:64, |          |          |dig(1) da bind,   |
    |dnsutils       |I:517 |256       |" "       |"Priorità:        |
    |               |      |          |          |standard"         |
    |---------------+------+----------+----------+------------------|
    |isc-dhcp-client|V:231,|686       |DHCP      |ottiene indirizzo |
    |               |I:979 |          |          |IP                |
    |---------------+------+----------+----------+------------------|
    |ldap-utils     |V:14, |718       |LDAP      |ottiene dati da   |
    |               |I:75  |          |          |server LDAP       |
    +---------------------------------------------------------------+


%

6.12. Diagnosi dei demoni di sistema

    Il programma telnet permette la connessione manuale ai demoni di
    sistema e la loro diagnosi.

    Per testare il semplice servizio POP3 provare il comando
    seguente.

    $ telnet mail.nomeisp.net pop3

    Per testare il servizio POP3 con TLS/SSL abilitato di alcuni
    fornitori di servizi Internet, è necessario un client telnet con
    TLS/SSL abilitato fornito dal pacchdetto telnet-ssl o openssl.

    $ telnet -z ssl pop.gmail.com 995

    $ openssl s_client -connect pop.gmail.com:995

    Le seguenti RFC forniscono le conoscenze necessarie per ciascun
    demone di sistema.

    Tabella 6.20. Elenco di RFC popolari

    +--------------------------------------------------------------+
    |       RFC       |                descrizione                 |
    |-----------------+--------------------------------------------|
    |rfc1939 e rfc2449|servzio POP3                                |
    |-----------------+--------------------------------------------|
    |rfc3501          |servizio IMAP4                              |
    |-----------------+--------------------------------------------|
    |rfc2821 (rfc821) |servizio SMTP                               |
    |-----------------+--------------------------------------------|
    |rfc2822 (rfc822) |formato file di posta                       |
    |-----------------+--------------------------------------------|
    |rfc2045          |MIME (Multipurpose Internet Mail Extensions)|
    |-----------------+--------------------------------------------|
    |rfc819           |servizio DNS                                |
    |-----------------+--------------------------------------------|
    |rfc2616          |servizio HTTP                               |
    |-----------------+--------------------------------------------|
    |rfc2396          |definizione di URI                          |
    +--------------------------------------------------------------+


    L'uso delle porte è descritto in "/etc/services".

Capitolo 7. Il sistema X Window

    Avvertimento
   
    Questo capito sta diventando non aggiornato dato che è basato su
    Debian 7.0 (Wheezy), rilasciata nel 2013.

    Il sistema X Window in Debian è basato sui sorgenti di X.org.

%

7.1. Pacchetti fondamentali

    Per facilitare l'installazione sono forniti alcuni (meta)
    pacchetti

    Tabella 7.1. Elenco di (meta)pacchetti fondamentali per X Window

    +---------------------------------------------------------------+
    | (meta)pacchetto  |popcon|dimensione|       descrizione        |
    |------------------+------+----------+--------------------------|
    |                  |      |          |librerie X, un server X,  |
    |                  |      |          |un insieme di tipi di     |
    |xorg              |I:457 |52        |carattere e un gruppo di  |
    |                  |      |          |client e utilità X di base|
    |                  |      |          |(metapacchetto)           |
    |------------------+------+----------+--------------------------|
    |                  |V:66, |          |insieme completo del      |
    |xserver-xorg      |I:492 |238       |server X e della sua      |
    |                  |      |          |configurazione            |
    |------------------+------+----------+--------------------------|
    |xbase-clients     |I:26  |46        |vari client X assortiti   |
    |                  |      |          |(metapacchetto)           |
    |------------------+------+----------+--------------------------|
    |                  |V:372,|          |infrastruttura del        |
    |x11-common        |I:755 |308       |filesystem per il sistema |
    |                  |      |          |X Window                  |
    |------------------+------+----------+--------------------------|
    |xorg-docs         |I:6   |2036      |documentazione varia per  |
    |                  |      |          |la suite software X.Org   |
    |------------------+------+----------+--------------------------|
    |                  |V:54, |          |genera il menu Debian per |
    |menu              |I:197 |1509      |tutte le applicazioni con |
    |                  |      |          |supporto per il menu      |
    |------------------+------+----------+--------------------------|
    |                  |      |          |converte la struttura del |
    |menu-xdg          |V:31, |27        |menu Debian nella         |
    |                  |I:109 |          |struttura del menu xdg di |
    |                  |      |          |freedesktop.org           |
    |------------------+------+----------+--------------------------|
    |                  |V:229,|          |utilità per integrare     |
    |xdg-utils         |I:521 |327       |l'ambiente desktop fornito|
    |                  |      |          |da freedesktop.org        |
    |------------------+------+----------+--------------------------|
    |task-gnome-desktop|I:175 |9         |ambiente desktop GNOME    |
    |                  |      |          |standard (metapacchetto)  |
    |------------------+------+----------+--------------------------|
    |task-kde-desktop  |I:66  |6         |ambiente desktop KDE di   |
    |                  |      |          |base (metapacchetto)      |
    |------------------+------+----------+--------------------------|
    |task-xfce-desktop |I:106 |9         |ambiente desktop leggero  |
    |                  |      |          |Xfce (metapacchetto)      |
    |------------------+------+----------+--------------------------|
    |task-lxde-desktop |I:35  |9         |ambiente desktop leggero  |
    |                  |      |          |LXDE (metapacchetto)      |
    |------------------+------+----------+--------------------------|
    |                  |      |          |Fluxbox: pacchetto per un |
    |fluxbox           |V:2,  |3860      |gestore di finestre per X |
    |                  |I:9   |          |altamente configurabile e |
    |                  |      |          |con basso uso di risorse  |
    +---------------------------------------------------------------+


    Per le nozioni base su X fare riferimento a X(7) e il
    XWindow-User-HOWTO dell'LDP.

%

7.2. Impostare l'ambiente desktop

    Un ambiente desktop è solitamente una combinazione di un gestore
    di finestre per X, un gestore di file e una suite di utilità
    compatibili.

    Si può configurare un ambiente desktop completo come GNOME, KDE,
    Xfce o LXDE da aptitude nel menu dei task.

    Suggerimento

    Il menu dei task potrebbe non essere in sincrono con le più
    recenti transizioni di pacchetti negli ambienti Debian unstable/
    testing. In questo caso è necessario deselezionare alcuni (meta)
    pacchetti elencati nel menu dei task di aptitude(8) per evitare
    conflitti tra pacchetti. Quando si deselezionano (meta)pacchetti,
    è necessario selezionare manualmente alcuni pacchetti che
    forniscono le loro dipendenze per evitare che vengano
    automaticamente rimossi.

    In alternativa è possibile impostare manualmente un ambiente
    semplice con solamente un gestore di finestre per X come Fluxbox.

    Vedere Gestori di finestre per X per una guida ai gestori di
    finestre per X e agli ambienti desktop.

%

7.2.1. Menu Debian

    Il sistema del menu Debian fornisce un'interfaccia generale ai
    programmi sia testuali sia orientati ad X, tramite update-menus
    (1) nel pacchetto menu. Ciascun pacchetto installa i propri dati
    per il menu nella directory "/usr/share/menu/". Vedere "/usr/
    share/menu/README".

%

7.2.2. Menu Freedesktop.org

    Ogni pacchetto conforme al sistema di menu xdg di Freedesktop.org
    installa i propri dati di menu forniti da "*.desktop" in "/usr/
    share/applications/". Gli ambienti desktop moderni che sono
    conformi agli standard Freedesktop.org usano questi dati per
    generare i propri menu usando il pacchetto xdg-utils. Vedere "/
    usr/share/doc/xdg-utils/README".

%

7.2.3. Menu Debian dal menu di Freedesktop.org

    Per poter accedere al tradizionale menu Debian da ambienti con
    gestori delle finestre conformi con il menu di Freedesktop.org,
    come GNOME e KDE, è necessario installare il pacchetto menu-xdg.

%

7.3. La relazione client/server

    Il sistema X Window è attivato come combinazione di programmi
    server e client. Il significato delle parole server e client in
    relazione alle parole locale e remoto richiede un po' di
    attenzione.

    Tabella 7.2. Elenco della terminologia per server/client

    +---------------------------------------------------------------+
    |   tipo    |                    descrizione                    |
    |-----------+---------------------------------------------------|
    |server X   |un programma eseguito su un host locale connesso al|
    |           |display dell'utente e ai device di input           |
    |-----------+---------------------------------------------------|
    |client X   |un programma in esecuzione su un host remoto che   |
    |           |elabora dati e comunica con il server X            |
    |-----------+---------------------------------------------------|
    |application|un programma in esecuzione su un host remoto che   |
    |server     |elabora dati e comunica con le applicazioni client.|
    |-----------+---------------------------------------------------|
    |client     |un programma eseguito su un host locale connesso al|
    |applicativo|display dell'utente e ai device di input           |
    +---------------------------------------------------------------+


    I server X moderni hanno l'estensione MIT Shared Memory e
    comunicano con i loro client X locali usando la memoria condivisa
    locale. Ciò scavalca il canale di comunicazione tra i processi
    Xlib trasparente alla rete e fa guadagnare in prestazioni per
    grandi immagini.

%

7.4. Il server X

    Per informazioni sul server X vedere xorg(1).

%

7.4.1. La (ri)configurazione del server X

    Quanto segue (ri)configura un server X.

    # dpkg-reconfigure --priority=low x11-common

    Nota

    I kernel Linux recenti hanno un buon supporto per i dispositivi
    grafici e di input con DRM, KMS e udev. Il server X è stato
    riscritto per usarli. Perciò "/etc/X11/xorg.conf" è solitamente
    non presente nel sistema. Questi parametri vengono configurati
    dal kernel. Vedere "fb/modedb.txt" nella documentazione del
    kernel.

    Per monitor CRT grandi con alte risoluzioni, è una buona idea
    impostare la frequenza di aggiornamento al valore più alto
    gestito dal monitor (85 Hz è un valore ottimo, 75 Hz è OK) per
    ridurre lo sfarfallio. Per i monitor LCD frequenze di
    aggiornamento standard più basse (60Hz) vanno solitamente bene a
    causa della risposta più lenta.

    Nota
   
    Fare attenzione a non usare una frequenza di aggiornamento troppo
    alta che potrebbe causare danni hardware critici al monitor.

%

7.4.2. I metodi di connessione al server X

    Ci sono diversi modi per far sì che il "server X" (lato display)
    accetti connessioni da un "client X" (lato applicazione).

    Tabella 7.3. Elenco di metodi di connessione al server X

    +------------------------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|  utente   |cifratura|  metodo   |    uso    |
    |              |      |          |           |         |           | collegato |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |xbase-clients |I:26  |46        |non        |no       |comando    |deprecato  |
    |              |      |          |controllato|         |xhost      |           |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |           |connessione|
    |xbase-clients |I:26  |46        |controllato|no       |comando    |locale     |
    |              |      |          |           |         |xauth      |attraverso |
    |              |      |          |           |         |           |una pipe   |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |V:803,|          |           |         |comando ssh|connessione|
    |openssh-client|I:996 |4298      |controllato|sì       |-X         |di rete    |
    |              |      |          |           |         |           |remota     |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |GNOME      |connessione|
    |gdm3          |V:165,|5101      |controllato|no       |display    |locale     |
    |              |I:229 |          |           |(XDMCP)  |manager    |attraverso |
    |              |      |          |           |         |           |una pipe   |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |           |connessione|
    |sddm          |V:53, |1742      |controllato|no       |KDE display|locale     |
    |              |I:95  |          |           |(XDMCP)  |manager    |attraverso |
    |              |      |          |           |         |           |una pipe   |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |gestore    |connessione|
    |xdm           |V:3,  |686       |controllato|no       |dello      |locale     |
    |              |I:6   |          |           |(XDMCP)  |schermo di |attraverso |
    |              |      |          |           |         |X          |una pipe   |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |WindowMaker|connessione|
    |wdm           |V:31, |2289      |controllato|no       |display    |locale     |
    |              |I:284 |          |           |(XDMCP)  |manager    |attraverso |
    |              |      |          |           |         |           |una pipe   |
    |--------------+------+----------+-----------+---------+-----------+-----------|
    |              |      |          |           |         |           |connessione|
    |              |V:0,  |          |           |         |LTSP       |SSH di rete|
    |ldm           |I:0   |436       |controllato|sì       |display    |remota     |
    |              |      |          |           |         |manager    |(thin      |
    |              |      |          |           |         |           |client)    |
    +------------------------------------------------------------------------------+


    Avvertimento

    Non usare connessioni remote TCP/IP su reti non sicure per la
    connessione X a meno che non esistano ragioni molto buone per
    farlo, come l'uso di cifratura. Una connessione remota via socket
    TCP/IP senza cifratura è esposta ad attacchi di spionaggio ed è
    disabilitata in modo predefinito nel sistema Debian. Usare "ssh
    -X".

    Avvertimento

    Non usare nemmeno connessioni XDMCP su reti non sicure. Inviano
    dati attraverso UDP/ IP senza cifratura e sono esposte ad 
    attacchi di spionaggio.

    Suggerimento
   
    LTSP sta per Linux Terminal Server Project (progetto per server
    terminale Linux).

%

7.5. Avviare il sistema X Window

    Il sistema X Window è solitamente avviato come una sessione X,
    che è la combinazione di un server X e di client X connessi. Per
    un normale sistema desktop entrambe le componenti sono eseguite
    su una macchina.

    La sessione X viene avviata in uno dei modi seguenti.

      * Il comando startx avviato dalla riga di comando
   
      * Uno dei programmi demone display manager per X, *dm, avviati
        da systemd sulla base delle dipendenze di "graphical.target".

    Suggerimento

    Lo script di avvio dei demoni display manager controlla il
    contenuto del file "/etc/X11/default-display-manager" prima
    dell'effettivo avvio del demone. ciò assicura che venga attivato
    un solo programma demone per display manager di X.

    Suggerimento

    Vedere Sezione 8.4.5, «Localizzazione specifica solamente in X
    Window» per le variabili d'ambiente iniziali del display manager
    per X.

    Essenzialmente tutti questi programmi eseguono lo script "/etc/
    X11/Xsession"; poi questo script effettua un'azione simile a 
    run-parts(8) per eseguire tutti gli script nella directory "/etc/
    X11/Xsession.d/". Ciò è fondamentalmente l'esecuzione, con il
    comando interno exec, del primo programma trovato cercando
    nell'ordine seguente.

     1. Lo script specificato come argomento di "/etc/X11/Xsession"
        dal display manager di X, se definito.

     2. Lo script "~/.xsession" o "~/.Xsession", se definito.
   
     3. Il comando "/usr/bin/x-session-manager", se definito.

     4. Il comando "/usr/bin/x-window-manager", se definito.

     5. Il comando "/usr/bin/x-terminal-emulator", se definito.

    Questo processo è influenzato dal contenuto di "/etc/X11/
    Xsession.options". I programmi effettivi a cui puntano questi
    comandi "/usr/bin/x-*" sono determinati dal sistema di
    alternative di Debian e possono essere modificati con
    "update-alternatives --config x-session-manager", ecc.

    Vedere Xsession(5) per i dettagli.

%

7.5.1. Avviare la sessione X con gdm3

    gdm3(1) permette di selezionare dal suo menu il tipo di sessione
    (o l'ambiente desktop: Sezione 7.2, «Impostare l'ambiente
    desktop») e la lingua (o la localizzazione: Sezione 8.4, «La
    localizzazione») della sessione X. Archivia il valore selezionato
    predefinito in "~/.dmrc" nel formato seguente.

    [Desktop]
    Session=default
    Language=ja_JP.UTF-8

%

7.5.2. Personalizzare la sessione X (metodo classico)

    In un sistema in cui "/etc/X11/Xsession.options" contiene una
    riga "allow-user-xsession" non preceduta da nessun carattere "#,
    qualsiasi utente che configuri "~/.xsession" o "~/.Xsession" è in
    grado di personalizzare il comportamento di "/etc/X11/Xsession"
    sovrascrivendo completamente il codice del sistema. L'ultimo
    comando nel file "~/.xsession dovrebbe essere nella forma "exec
    un-qualche-gestore-di-finestre/sessione" per avviare il proprio
    gestore di finestre/sessione di X preferito.

    Se viene usata questa funzionalità, la selezione del gestore di
    display (o di login) (DM), del gestore di sessione o del gestore
    di finestre (WM) da parte dell'utilità di sistema viene ignorata.

%

7.5.3. Personalizzare la sessione X (metodo nuovo)

    Quelli che seguono sono metodi nuovi per personalizzare la
    sessione X senza sovrascrivere completamente le impostazioni di
    sistema come nell'esempio precedente.

      * Il display manager gdm3 può selezionare una specifica
        sessione ed impostarla come argomento di "/etc/X11/Xsession".

          + I file "/etc/profile", "~/.profile", "/etc/xprofile" e "~
            /.xprofile" sono eseguiti come parte del processo di
            avvio di gdm3.

      * Il file "~/.xsessionrc" è eseguito come parte del processo di
        avvio. (Indipendente dal desktop.)

          + "#allow-user-xsession" in "/etc/X11/Xsession.options" non
            restringe l'esecuzione del file "~/.xsessionrc".

      * Il file "~/.gnomerc" è eseguito come parte del processo di
        avvio (solo desktop GNOME)

    La selezione del gestore di display (o di login) (DM), del
    gestore di sessione o del gestore di finestre (WM) da parte
    dell'utilità di sistema viene rispettata.

    Questi file di configurazione non dovrebbero contenere "exec …"
    né "exit".

%

7.5.4. Connettersi ad un client X remoto via SSH

    L'uso di "ssh -X" permette una connessione sicura da un server X
    locale ad un application server remoto.

    Impostare le voci "X11Forwarding" a "yes" nel file "/etc/ssh/
    sshd_config" dell'host remoto, se si vuole evitare l'opzione "-X"
    nella riga di comando.

    Avviare il server X sull'host locale

    Aprire un xterm sull'host locale.

    Eseguire ssh(1) per stabilire una connessione con il sito remoto
    nel modo seguente.

    nomelocale @ hostlocale $ ssh -q -X nomelogin@hostremoto.dominio
    Password:

    Eseguire un comando applicativo X, ad esempio "gimp", sul sito
    remoto nel modo seguente.

    nomelogin @ hostremoto $ gimp &

    Questo metodo può mostrare l'output da un client X remoto come se
    fosse connesso localmente attraverso un socket UNIX locale.

%

7.5.5. Terminale X sicuro via Internet

    Un terminale X sicuro via Internet, che mostri in remoto l'intero
    ambiente desktop X, può essere ottenuto facilmente usando
    pacchetti specializzati, come ldm. La macchina locale diventa un
    thin client sicuro per l'application server remoto connesso via
    SSH.

%

7.6. Tipi di carattere in X Window

    Fontconfig 2.0 è stato creato nel 2002 per fornire una libreria
    indipendente dalla distribuzione per configurare e personalizzare
    l'accesso ai tipi di carattere. Debian a partire da squeeze usa
    Fontconfig 2.0 per la sua configurazione.

    Il supporto dei tipi di carattere nel sistema X Window può essere
    riassunto nel modo seguente.

      * Sistema datato di supporto dei tipi di carattere dal lato
        server X

          + Il sistema originale base di X per i caratteri fornisce
            la compatibilità all'indietro per le versioni più vecchie
            dei client X.

          + I tipi di carattere originali base di X11 sono installati
            nel server X.

      * Sistema moderno di supporto dei tipi di carattere dal lato
        client X

          + Il sistema X moderno supporta tutti i tipi di carattere
            elencati in seguito (Sezione 7.6.1, «Tipi di carattere
            base», Sezione 7.6.2, «Tipi di carattere aggiuntivi» e
            Sezione 7.6.3, «Tipi di carattere CJK») con funzionalità
            avanzate come l'anti-aliasing.

          + Xft 2.0 connette applicazioni X moderne come quelle di
            GNOME, KDE e LibreOffice con la libreria FreeType 2.0.

          + FreeType 2.0 fornisce la libreria per la rasterizzazione
            dei tipi di carattere.

          + Fontconfig fornisce la risoluzione delle specifiche per i
            tipi di carattere per Xft 2.0. Per la sua configurazione
            vedere fonts.conf(5).

          + tutte le moderne applicazioni che usano Xft 2.0 possono
            comunicare con i server X moderni usando l'estensione X
            Rendering Extension.

          + La X Rendering Extension sposta l'accesso ai tipi di
            carattere e la generazione delle immagini per i glifi dal
            server X al client X.

    Tabella 7.4. Tabella dei pacchetti che supportano i sistemi dei
    tipi di carattere in X Window

    +---------------------------------------------------------------+
    |    pacchetto    |popcon|dimensione|        descrizione        |
    |-----------------+------+----------+---------------------------|
    |                 |V:66, |          |programmi di utilità del   |
    |xfonts-utils     |I:542 |415       |sistema X Window per i tipi|
    |                 |      |          |di carattere               |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |Xft, una libreria che      |
    |                 |V:143,|          |connette le applicazioni X |
    |libxft2          |I:662 |122       |con la libreria di         |
    |                 |      |          |rasterizzazione dei        |
    |                 |      |          |caratteri FreeType         |
    |-----------------+------+----------+---------------------------|
    |                 |V:426,|          |libreria di rasterizzazione|
    |libfreetype6     |I:994 |896       |dei tipi di carattere      |
    |                 |      |          |FreeType 2.0               |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |Fontconfig, una libreria   |
    |                 |V:354,|          |generica per la            |
    |fontconfig       |I:776 |583       |configurazione dei tipi di |
    |                 |      |          |caratteri - binari di      |
    |                 |      |          |supporto                   |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |Fontconfig, una libreria   |
    |                 |V:367,|          |generica per la            |
    |fontconfig-config|I:871 |442       |configurazione dei tipi di |
    |                 |      |          |caratteri - dati di        |
    |                 |      |          |configurazione             |
    +---------------------------------------------------------------+


    È possibile controllare le informazioni sulla configurazione dei
    tipi di carattere nei modi seguenti.

      * "xset q" per il percorso dei tipi di carattere base di X11

      * "fc-match" per le impostazioni predefinite per i tipi di
        carattere di fontconfig

      * "fc-list" per l'elenco dei tipi di carattere di fontconfig
        disponibili

    Suggerimento

    "The Penguin and Unicode" è una buona panoramica sul sistema X
    Window moderno. Altra documentazione all'indirizzo http://
    unifont.org/ dovrebbe fornire buone informazioni su tipi di
    carattere Unicode, software che gestisce Unicode,
    internazionalizzazione e problematiche correlate all'uso di
    Unicode su sistemi operativi free/libre/liberi/open source
    (FLOSS).

%

7.6.1. Tipi di carattere base

    Ci sono due tipi principali di caratteri per computer.

      * I tipi di carattere bitmap (buoni per rasterizzazione a basse
        risoluzioni)
   
      * Tipi di carattere outline/stroke (buoni per rasterizzazione
        ad alte risoluzioni)

    Mentre il ridimensionamento dei caratteri bitmap causa immagini
    dentellate, il ridimensionamento dei caratteri outline/stroke
    produce un'immagine pulita.

    I caratteri bitmap nel sistema Debian sono di solito forniti da
    file di caratteri bitmap pcf per X11 compressi, la cui estensione
    è ".pcf.gz".

    I caratteri outline nel sistema Debian sono forniti dai tipi
    seguenti.

      * File di caratteri PostScript Type 1, la cui estensione è
        ".pfb" (file di caratteri binario) e ".afm" (file della
        metrica dei caratteri).

      * File di caratteri TrueType (o OpenType), la cui estensione è
        normalmente ".ttf".

    Suggerimento
   
    OpenType è pensato per rendere superati sia TrueType sia
    PostScript Type 1.

    Tabella 7.5. Tabella dei tipi di carattere PostScript Type 1

    +----------------------------------------------------------------------------------+
    | pacchetto |      |          |carattere|carattere|  carattere  |   origine del    |
    |   con i   |popcon|dimensione|  sans   |  serif  |  monospace  |    carattere     |
    | caratteri |      |          |  serif  |         |             |                  |
    |-----------+------+----------+---------+---------+-------------+------------------|
    |PostScript |N/D   |N/D       |Helvetica|Times    |Courier      |Adobe             |
    |-----------+------+----------+---------+---------+-------------+------------------|
    |           |      |          |Nimbus   |Nimbus   |             |URW (dimensione   |
    |gsfonts    |I:599 |4439      |Sans L   |Roman No9|Nimbus Mono L|Adobe-compatibile)|
    |           |      |          |         |L        |             |                  |
    |-----------+------+----------+---------+---------+-------------+------------------|
    |           |      |          |         |Nimbus   |             |supporto per i    |
    |gsfonts-x11|I:82  |95        |Nimbus   |Roman No9|Nimbus Mono L|caratteri per X   |
    |           |      |          |Sans L   |L        |             |con caratteri     |
    |           |      |          |         |         |             |PostScript Type 1 |
    |-----------+------+----------+---------+---------+-------------+------------------|
    |           |      |          |Free     |Free     |             |URW esteso        |
    |t1-cyrillic|I:19  |4878      |Helvetian|Times    |Free Courier |(dimensione       |
    |           |      |          |         |         |             |Adobe-compatibile)|
    |-----------+------+----------+---------+---------+-------------+------------------|
    |           |      |          |         |         |             |caratteri         |
    |           |V:13, |          |         |         |             |PostScript e      |
    |lmodern    |I:113 |33270     |LMSans*  |LMRoman* |LMTypewriter*|OpenType scalabili|
    |           |      |          |         |         |             |basati su Computer|
    |           |      |          |         |         |             |Modern (da TeX)   |
    +----------------------------------------------------------------------------------+


    Tabella 7.6. Tabella dei tipi di carattere TrueType

    +---------------------------------------------------------------------------------------------------+
    |pacchetto con i caratteri|popcon|dimensione|carattere |carattere |carattere |origine del carattere |
    |                         |      |          |sans serif|  serif   |monospace |                      |
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |          |          |          |Microsoft (dimensione |
    |ttf-mscorefonts-installer|V:1,  |92        |Arial     |Times New |Courier   |Adobe-compatibile)    |
    |                         |I:64  |          |          |Roman     |New       |(Installa dati non    |
    |                         |      |          |          |          |          |liberi)               |
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |Liberation|Liberation|Liberation|Progetto Liberation   |
    |fonts-liberation         |I:469 |2093      |Sans      |Serif     |Mono      |Fonts (dimensione     |
    |                         |      |          |          |          |          |Microsoft-compatibile)|
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |V:50, |          |          |          |          |GNU freefont          |
    |fonts-freefont-ttf       |I:276 |6656      |FreeSans  |FreeSerif |FreeMono  |(dimensione           |
    |                         |      |          |          |          |          |Microsoft-compatibile)|
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |DejaVu    |DejaVu    |DejaVu    |DejaVu, Bitstream Vera|
    |fonts-dejavu             |I:478 |39        |Sans      |Serif     |Sans Mono |con copertura di      |
    |                         |      |          |          |          |          |Unicode               |
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |          |          |          |DejaVu, Bitstream Vera|
    |                         |      |          |          |          |          |con copertura di      |
    |fonts-dejavu-core        |V:220,|2954      |DejaVu    |DejaVu    |DejaVu    |Unicode (sans,        |
    |                         |I:809 |          |Sans      |Serif     |Sans Mono |sans-bold, serif,     |
    |                         |      |          |          |          |          |serif-bold, mono,     |
    |                         |      |          |          |          |          |mono-bold)            |
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |          |          |          |DejaVu, Bitstream Vera|
    |                         |      |          |          |          |          |with Unicode coverage |
    |fonts-dejavu-extra       |I:516 |7493      |N/D       |N/D       |N/D       |(oblique, italic,     |
    |                         |      |          |          |          |          |bold-oblique,         |
    |                         |      |          |          |          |          |bold-italic,          |
    |                         |      |          |          |          |          |condensed)            |
    |-------------------------+------+----------+----------+----------+----------+----------------------|
    |                         |      |          |          |          |          |GNU Unifont, con tutti|
    |                         |      |          |          |          |          |i codici di carattere |
    |ttf-unifont              |I:21  |21        |N/D       |N/D       |unifont   |stampabili in Unicode |
    |                         |      |          |          |          |          |5.1 BMP (Basic        |
    |                         |      |          |          |          |          |Multilingual Plane)   |
    +---------------------------------------------------------------------------------------------------+


    Suggerimento
   
    I tipi di carattere DejaVu sono basati sui caratteri Bitstream
    Vera di cui sono un sovrainsieme.

%

7.6.2. Tipi di carattere aggiuntivi

    aptitude(8) aiuta a trovare facilmente caratteri aggiuntivi.

      * Il corto elenco di pacchetti in "Task" → "Localizzazione"

      * L'elenco unico dei pacchetti filtrato per i dati dei tipi di
        carattere usando un'espressione regolare sui debtag:
        "~Gmade-of::data:font"

      * L'elenco unico dei pacchetti filtrato per i pacchetti con
        caratteri BDF (bitmap) usando un'espressione regolare sui
        nomi di pacchetto: "~nxfonts-"

      * L'elenco unico dei pacchetti filtrato per i pacchetti con
        caratteri TrueType (outline) usando un'espressione regolare
        sui nomi di pacchetto: "~nttf-|~nfonts-"

    Dato che i tipi di carattere Liberi sono a volte limitati,
    l'installazione o la condivisione di caratteri TrueType
    commerciali è un'opzione da considerare per un utente Debian. Per
    facilitare ciò sono stati creati alcuni pacchetti di comodo.

      * mathematica-fonts
   
      * fonts-mscorefonts-installer

    Si avrà un'ottima selezione di caratteri TrueType al prezzo della
    contaminazione del proprio sistema Libero con tipi di carattere
    non-Liberi.

%

7.6.3. Tipi di carattere CJK

    In questa sezione ci sono alcune nozioni fondamentali centrate
    sull'uso di tipi di carattere con caratteri CJK.

    Tabella 7.7. Tabella delle parole chiave usate nei nomi dei tipi
    di carattere CJK per indicarne il tipo

    +---------------------------------------------------------------+
    |tipologia | nome del tipo di |nome del tipo di|nome del tipo di|
    |   del    |   carattere in   |  carattere in  |  carattere in  |
    |carattere |    giapponese    |     cinese     |    coreano     |
    |----------+------------------+----------------+----------------|
    |sans-serif|gothic, ゴチック  |hei, gothic     |dodum, gulim,   |
    |          |                  |                |gothic          |
    |----------+------------------+----------------+----------------|
    |serif     |mincho, 明朝      |song, ming      |batang          |
    +---------------------------------------------------------------+


    I tipi di carattere con nomi come "VL PGothic", dove la "P" sta
    per carattere proporzionale, sono la versione proporzionale dei
    corrispondenti caratteri a spaziatura fissa, come "VL Gothic".

    Per esempio la tabella dei codici Shift_JIS comprende 7070
    caratteri che possono essere raggruppati nel modo seguente.

      * Caratteri a byte-singolo JIS X 0201 (191 caratteri, alias
        caratteri a mezza larghezza)
   
      * Caratteri a doppio-byte JIS X 0208 (6879 caratteri, alias
        caratteri a piena larghezza)

    I caratteri a doppio-byte occupano, nei terminali console che
    usano tipi di carattere CJK a spaziatura fissa, una larghezza
    doppia. Per gestire tale situazione, possono essere usati i file
    HBF (Hanzi Bitmap Font), con estensione ".hbf", per avere tipi di
    carattere contententi caratteri a byte-singolo e doppio-byte.

    Per risparmiare spazio, per i file di caratteri TrueType, si
    possono usare file con raccolte di tipi di carattere TrueType con
    estensione ".ttc.

    Per gestire complesse spaziature dei caratteri, i tipi di
    carattere PostScript CID Type 1 sono usati con file CMap che
    iniziano con "%!PS-Adobe-3.0 Resource-CMap". Ciò viene raramente
    usato per il normale display X, ma è usato per la resa in file
    PDF, ecc. (vedere Sezione 7.7.2, «Applicazioni di utilità per X»
    ).

    Suggerimento

    Per alcuni punti della codifica Unicode sono presenti glifi
    multipli, a causa della unificazione Han. Un esmpio di glifi più
    problematici sono "U+3001 IDEOGRAPHIC COMMA" e "U+3002
    IDEOGRAPHIC FULL STOP" la cui posizione è diversa tra le nazioni
    CJK. La configurazione della priorità dei caratteri pensati per
    il giapponese, rispetto a quelli cinesi, usando " ~/.fonts.conf"
    dovrebbe dare un po' di pace agli utenti giapponesi.

7.7. Applicazioni per X

%

7.7.1. Applicazioni da ufficio per X

    Ecco un elenco di applicazioni base per l'ufficio (LO è
    LibreOffice).

    Tabella 7.8. Elenco di applicazioni base da ufficio per X

    +---------------------------------------------------------------+
    |                   |      |dimensione |     |                  |
    |     pacchetto     |popcon|    del    |tipo |   descrizione    |
    |                   |      | pacchetto |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |libreoffice-writer |V:188,|39333      |LO   |elaboratore di    |
    |                   |I:441 |           |     |testi             |
    |-------------------+------+-----------+-----+------------------|
    |libreoffice-calc   |V:188,|32973      |LO   |foglio di calcolo |
    |                   |I:436 |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |libreoffice-impress|V:176,|9934       |LO   |presentazioni     |
    |                   |I:433 |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |libreoffice-base   |V:145,|7473       |LO   |gestione di       |
    |                   |I:325 |           |     |database          |
    |-------------------+------+-----------+-----+------------------|
    |libreoffice-draw   |V:177,|14600      |LO   |editor di grafica |
    |                   |I:434 |           |     |vettoriale (draw) |
    |-------------------+------+-----------+-----+------------------|
    |                   |      |           |     |editor di         |
    |libreoffice-math   |V:174,|1963       |LO   |equazioni         |
    |                   |I:437 |           |     |matematiche e     |
    |                   |      |           |     |formule           |
    |-------------------+------+-----------+-----+------------------|
    |abiword            |V:1,  |5141       |GNOME|elaboratore di    |
    |                   |I:12  |           |     |testi             |
    |-------------------+------+-----------+-----+------------------|
    |gnumeric           |V:6,  |9933       |GNOME|foglio di calcolo |
    |                   |I:21  |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |gimp               |V:68, |22313      |GTK  |editor di grafica |
    |                   |I:341 |           |     |bitmap (paint)    |
    |-------------------+------+-----------+-----+------------------|
    |inkscape           |V:55, |84823      |GNOME|editor di grafica |
    |                   |I:209 |           |     |vettoriale (draw) |
    |-------------------+------+-----------+-----+------------------|
    |                   |V:5,  |           |     |editor di grafi e |
    |dia                |I:31  |3727       |GTK  |diagrammi di      |
    |                   |      |           |     |flusso            |
    |-------------------+------+-----------+-----+------------------|
    |planner            |V:0,  |1146       |GNOME|gestione progetti |
    |                   |I:5   |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |calligrawords      |V:0,  |5717       |KDE  |elaboratore di    |
    |                   |I:7   |           |     |testi             |
    |-------------------+------+-----------+-----+------------------|
    |calligrasheets     |V:0,  |10890      |KDE  |foglio di calcolo |
    |                   |I:6   |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |calligrastage      |V:0,  |5102       |KDE  |presentazioni     |
    |                   |I:5   |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |calligraplan       |V:0,  |15342      |KDE  |gestione progetti |
    |                   |I:2   |           |     |                  |
    |-------------------+------+-----------+-----+------------------|
    |kexi               |V:0,  |7576       |KDE  |gestione di       |
    |                   |I:2   |           |     |database          |
    |-------------------+------+-----------+-----+------------------|
    |karbon             |V:0,  |3473       |KDE  |editor di grafica |
    |                   |I:7   |           |     |vettoriale (draw) |
    +---------------------------------------------------------------+


%

7.7.2. Applicazioni di utilità per X

    Ecco un elenco di utilità base che hanno attirato la mia
    attenzione.

    Tabella 7.9. Elenco di applicazioni base di utilità per X

    +---------------------------------------------------------------+
    |         |      |dimensione|     |                             |
    |pacchetto|popcon|   del    |tipo |         descrizione         |
    |         |      |pacchetto |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |evince   |V:116,|954       |GNOME|visualizzatore di documenti  |
    |         |I:329 |          |     |(pdf)                        |
    |---------+------+----------+-----+-----------------------------|
    |okular   |V:46, |14646     |KDE  |visualizzatore di documenti  |
    |         |I:118 |          |     |(pdf)                        |
    |---------+------+----------+-----+-----------------------------|
    |         |V:9,  |          |     |convertitore e gestione di   |
    |calibre  |I:36  |54876     |KDE  |una biblioteca per libri     |
    |         |      |          |     |elettronici                  |
    |---------+------+----------+-----+-----------------------------|
    |fbreader |V:2,  |3074      |GTK  |Lettori di ebook             |
    |         |I:15  |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |         |V:31, |          |     |gestione di informazioni     |
    |evolution|I:229 |475       |GNOME|personali (groupware e posta |
    |         |      |          |     |elettronica)                 |
    |---------+------+----------+-----+-----------------------------|
    |         |V:1,  |          |     |gestione di informazioni     |
    |kontact  |I:16  |2152      |KDE  |personali (groupware e posta |
    |         |      |          |     |elettronica)                 |
    |---------+------+----------+-----+-----------------------------|
    |scribus  |V:2,  |30375     |KDE  |editor di impaginazione per  |
    |         |I:23  |          |     |il desktop                   |
    |---------+------+----------+-----+-----------------------------|
    |glabels  |V:0,  |1326      |GNOME|editor di etichette          |
    |         |I:4   |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |gnucash  |V:3,  |32304     |GNOME|contabilità personale        |
    |         |I:12  |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |homebank |V:0,  |1044      |GTK  |contabilità personale        |
    |         |I:3   |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |kmymoney |V:0,  |12036     |KDE  |contabilità personale        |
    |         |I:2   |          |     |                             |
    |---------+------+----------+-----+-----------------------------|
    |shotwell |V:19, |6451      |GTK  |organizzatore di foto        |
    |         |I:223 |          |     |digitali                     |
    |---------+------+----------+-----+-----------------------------|
    |xsane    |V:17, |2346      |GTK  |frontend per lo scanner      |
    |         |I:173 |          |     |                             |
    +---------------------------------------------------------------+


    Attenzione

    Per far sì che evince e okular visualizzino documenti PDF CJK
    usando dati Cmap (Sezione 7.6.3, «Tipi di carattere CJK»), deve
    essere installato il pacchetto poppler-data (precedentemente non
    libero, vedere Sezione 11.4.1, «Ghostscript»).

    Nota

    L'installazione di software come scribus (KDE) nell'ambiente
    desktop GNOME è piuttosto accettabile dato che le funzionalità
    corrispondenti non sono disponibili in GNOME. Tuttavia
    l'installazione di troppi pacchetti con le stesse funzionalità
    ingombra il menu.

7.8. Informazioni varie su X

%

7.8.1. Appunti

    La selezione in X usando il terzo pulsante del mouse è la
    funzionalità per appunti nativa di X (vedere Sezione 1.4.4,
    «Funzionamento del mouse in stile Unix»).

    Suggerimento
   
    Maiusc-Insert può funzionare come equivalente del clic del
    pulsante centrale del mouse.

    Tabella 7.10. Elenco di programmi di base per selezione in X

    +---------------------------------------------------------------+
    |pacchetto|popcon| dimensione  |tipo|        descrizione        |
    |         |      |del pacchetto|    |                           |
    |---------+------+-------------+----+---------------------------|
    |         |V:10, |             |per |Interfaccia a riga di      |
    |xsel     |I:44  |59           |X   |comando per la selezione in|
    |         |      |             |    |X                          |
    |---------+------+-------------+----+---------------------------|
    |         |V:9,  |             |per |Interfaccia a riga di      |
    |xclip    |I:49  |64           |X   |comando per la selezione in|
    |         |      |             |    |X                          |
    +---------------------------------------------------------------+


    Gli ambienti desktop moderni (GNOME, KDE, ...) offrono sistemi
    diversi per gli appunti per le azioni di taglio, copia e incolla,
    utilizzando il pulsante sinistro del mouse e i tasti (Ctrl-x,
    Ctrl-c e Ctrl-v).

7.8.2. Mappatura della tastiera e dei pulsanti del dispositivo di
puntamento in X

    xmodmap(1) è un'utilità per modificare mappature di tastiera e
    dei pulsanti del dispositivo di puntamento nel sistema X Window.
    Per ottenere il codice dei tasti, eseguire xev(1) in X e premere
    i tasti. Per capire il significato di keysym, guardare la
    definizione di MACRO nel file "/usr/include/X11/keysymdef.h"
    (pacchetto x11proto-core-dev). Tutte le dichiarazioni "#define"
    in questo file hanno un nome che inizia con "XK_" che è seguito
    da i nomi keysym.

%

7.8.3. Client X classici

    La maggior parte dei programmi client X tradizionali, come xterm
    (1), può essere avviata con un insieme di opzioni a riga di
    comando standard per specificare la geometria, il tipo di
    carattere e il display.

    Usano anche il database delle risorse X per configurare il loro
    aspetto. I valori predefiniti a livello di sistema delle risorse
    X sono memorizzati in "/etc/X11/Xresources/*" e i valori
    predefiniti per le singole applicazioni sono memorizzati in "/etc
    /X11/app-defaults/*". Usare queste impostazioni come punto di
    partenza.

    Il file "~/.Xresources" viene usato per memorizzare valori
    specifici dell'utente per le risorse. Questo file viene
    automaticamente unito ai valori predefiniti delle risorse X al
    momento del login. Per fare cambiamenti a queste impostazioni e
    rendere attivo immediatamente il loro effetto, unire le loro
    impostazioni al database usando il comando seguente.

    $ xrdb -merge ~/.Xresources

    Vedere x(7) e xrdb(1).

%

7.8.4. L'emulatore di terminale per X - xterm

    Si può imparare tutto ciò che c'è da sapere su xterm(1)
    all'indirizzo http://dickey.his.com/xterm/xterm.faq.html.

%

7.8.5. Eseguire client X come root

    Avvertimento

    Non avviare mai il gestore di display/sessione X dall'account
    root digitando "root al prompt di un display manager come gdm3,
    perché è considerato rischioso (non sicuro), anche quando si ha
    in mente di eseguire attività di amministrazione del sistema.
    L'intera architettura X è considerata non sicura se eseguita come
    utente root. Bisogna sempre utilizzare il livello di privilegi
    più basso possibile, come un account di un utente regolare.

    Un modo facile di eseguire un particolare client X, ad esempio
    "pippo", come root è l'uso di sudo(8) ecc., nel modo seguente.

    $ sudo pippo &

    $ sudo -s
    # pippo &

    $ ssh -X root@localhost
    # pippo &

    Attenzione
   
    L'uso di ssh(1) solo per questo scopo, come nell'esempio
    precedente, è uno spreco di risorse.

    Per fare sì che il client X si connetta al server X, tenere a
    mente quanto segue.

      * I valori delle variabili d'ambiente "$XAUTHORITY" e
        "$DISPLAY" del vecchio utente devono essere copiati nelle
        variabili del nuovo utente.

      * Il nuovo utente deve avere i permessi di lettura per il file
        a cui punta la variabile d'ambiente "$XAUTHORITY".

Capitolo 8. I18N e L10N

    Il supporto per le lingue native o M17N (Multilingualization) per
    un software applicativo è ottenuto in 2 passi.

      * L'internazionalizzazione (I18N): per rendere un software
        capace di gestire potenzialmente localizzazioni multiple.
   
      * Localizzazione (L10N): per fare gestire dal software una
        localizzazione specifica.

    Suggerimento

    Ci sono 17, 18 o 10 lettere tra le lettere "m" e "n", "i" e "n" o
    "l" e "n" in, rispettivamente, "multilingualization",
    "internazionalization" e "localization" che sono i termini
    inglesi corrispondenti a M17N, I18N e L10N.

    Il software moderno, come GNOME e KDE ha il supporto per le
    lingue native. È internazionalizzato rendendolo capace di gestire
    dati UTF-8 e localizzato fornendo i messaggi tradotti attraverso
    l'infrastruttura gettext(1). I messaggi tradotti possono essere
    forniti in pacchetti separati di localizzazione e possono essere
    selezionati semplicemente impostando al valore di localizzazione
    appropriato le variabili d'ambiente pertinenti.

    La più semplice rappresentazione di dati testuali è ASCII che è
    sufficiente per l'inglese ed usa meno di 127 caratteri
    (rappresentabili con 7 bit). Al fine di supportare molti più
    caratteri per il supporto internazionale, sono stati inventati
    molti sistemi di codifica dei caratteri. Il sistema di codifica
    moderno e intelligente è UTF-8 che può in pratica gestire tutti i
    caratteri conosciuti (vedere Sezione 8.4.1, «Nozioni base sulla
    codifica»).

    Vedere Introduzione all'i18n per i dettagli.

    Il supporto internazionale per l'hardware viene abilitato con
    dati di configurazione dell'hardware localizzati.

    Avvertimento
   
    Questo capito sta diventando non aggiornato dato che è basato su
    Debian 7.0 (Wheezy), rilasciata nel 2013.

%

8.1. L'input da tastiera

    Il sistema Debian può essere configurato per funzionare con molte
    disposizioni di tastiera internazionali usando i pacchetti
    keyboard-configuration e console-setup.

    # dpkg-reconfigure keyboard-configuration
    # dpkg-reconfigure console-setup

    Ciò configura la tastiera per la console Linux e i parametri di
    configurazione di X Windows in "/etc/default/keyboard" e "/etc/
    default/console-setup". Configura anche il tipo di carattere per
    la console Linux.

    Molti caratteri non ASCII, inclusi quelli accentati usati da
    molte lingue europee, possono essere resi disponibili con il
    "tasto morto" (dead key), il tasto AltGr e il tasto di
    composizione (compose).

    Per le lingue asiatiche è necessario il supporto per metodi di
    input più complessi, come IBus che sarà trattato in seguito.

%

8.1.1. Il supporto per metodo di input con IBus

    L'input multilingua verso l'applicazione è elaborato così:

    Tastiera                                 Applicazione
       |                                           ^
       |                                           |
       +-> kernel Linux -> metodo di input -> Gtk, Qt, o X

    La configurazione dell'input per più lingue per il sistema Debian
    è semplificato dall'uso della famiglia di pacchetti IBus con il
    pacchetto im-config. Quello che segue è un elenco dei pacchetti
    IBus.

    Tabella 8.1. Elenco dei metodi di input supportati da IBus

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|  localizzazioni supportate  |
    |---------------+------+----------+-----------------------------|
    |ibus           |V:70, |1581      |infrastruttura per metodo di |
    |               |I:87  |          |input che usa dbus           |
    |---------------+------+----------+-----------------------------|
    |ibus-mozc      |V:1,  |999       |giapponese                   |
    |               |I:2   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-anthy     |V:0,  |8723      |" "                          |
    |               |I:1   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-kkc       |V:0,  |214       |" "                          |
    |               |I:0   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-skk       |V:0,  |244       |" "                          |
    |               |I:0   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-pinyin    |V:0,  |1434      |cinese (per zh_CN)           |
    |               |I:1   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-chewing   |V:0,  |415       |" " (per zh_TW)              |
    |               |I:0   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-hangul    |V:0,  |288       |coreano                      |
    |               |I:1   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-table     |V:0,  |1801      |motore di tabelle per IBus   |
    |               |I:1   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-table-thai|I:0   |47        |thailandese                  |
    |---------------+------+----------+-----------------------------|
    |ibus-unikey    |V:0,  |318       |vietnamita                   |
    |               |I:0   |          |                             |
    |---------------+------+----------+-----------------------------|
    |ibus-m17n      |V:0,  |187       |multilingue: indico, arabico |
    |               |I:1   |          |e altri                      |
    +---------------------------------------------------------------+


    Il metodo kinput2 e altri classici metodi di input dipendenti
    dalla localizzazione per le lingue asiatiche esistono sempre, ma
    non sono raccomandati per i moderni ambienti X UTF-8. Gli insiemi
    di strumenti SCIM e uim costituiscono un approccio un po' più
    datato al metodo di input internazionale per gli ambienti X UTF-8
    moderni.

%

8.1.2. Un esempio per il giapponese

    Trovo che il metodo di input per il giapponese avviato
    dall'ambiente inglese ("en_US.UTF-8") sia molto utile. Ecco come
    farlo con IBus per GNOME3:

     1. Installare il pacchetto con gli strumenti di input per il
        giapponese ibus-anthy insieme ai pacchetti che raccomanda,
        come im-config.

     2. Eseguire "im-config" da una shell utente e selezionare "ibus"
        come metodo di input.

     3. Selezionare "Settings" → "Keyboard" → "Input Sources" → fare
        clic su "+" in "Input Sources" → "Japanese" → "Japanese
        (anthy)" e fare clic su "Add".

     4. Selezionare "Japanese" e fare clic su "Add" per supportare la
        disposizione giapponese di tastiera senza conversione di
        caratteri. (Si possono scegliere più fonti di input.)

     5. Rieseguire il login nell'account utente

     6. Verificare le impostazioni con "im-config".

     7. Impostare la fonte di input cliccando con il pulsante destro
        sull'icona della barra degli strumenti GUI.

     8. Passare da una all'altra delle fonti di input installate con
        SUPER-SPAZIO. (SUPER è solitamente il tasto Windows.)

    Notare quanto segue.

      * im-config(8) si comporta in modo diverso a seconda se è
        eseguito da root o no.

      * im-config(8) abilita il miglior metodo di input sul sistema
        come impostazione predefinita senza alcuna azione
        dell'utente.

      * La voce di menu GUI per im-config(8) è disabilitata in modo
        predefinito per evitare sovraffollamenti.

%

8.1.3. Disabilitare il metodo di input

    Se si desidera inserire dell'input senza passare da XIM
    (meccanismo usato da X), impostare il valore di "$XMODIFIERS" a
    "none" quando si avvia un programma. Una situazione di questo
    tipo potrebbe verificarsi quando si usa l'infrastruttura di input
    in giapponese egg in emacs(1) mentre è disabilitato ibus. Dalla
    shell usare il comando seguente.

    $ XMODIFIERS=none emacs

    Per modificare il comando eseguito dal menu Debian, posizionare
    una configurazione personalizzata in "/etc/menu/" seguendo il
    metodo descritto in "/usr/share/doc/menu/html".

%

8.2. L'output sul display

    La console Linux può mostrare solamente un numero limitato di
    caratteri. (È necessario usare speciali programmi per terminale
    come jfbterm(1) per mostrare lingue non Europee nella console
    non-X.)

    X Window può mostrare qualsiasi carattere in UTF-8 purché
    esistano i tipi di carattere richiesti. (La codifica dei dati dei
    tipi di carattere originali viene gestita dal sistema X Window in
    modo trasparente per l'utente.)

%

8.3. Caratteri dell'Asia dell'est con larghezza ambigua

    Nella localizzazione dell'Asia dell'est i caratteri di disegno di
    riquadri, i caratteri greci e cirillici possono essere
    visualizzati più larghi della larghezza desiderata e causare un
    output su terminale non allineato (vedere Unicode Standard Annex
    #11).

    Questo problema può essere aggirato:

      * gnome-terminal: Modifica → Preferenze → Profili → Modifica →
        Compatibilità → Caratteri a larghezza ambigua → Stretto

      * ncurses: impostare l'ambiente export NCURSES_NO_UTF8_ACS=0.

%

8.4. La localizzazione

    Questa sezione si concentra sulla localizzazione per applicazioni
    eseguite nell'ambiente X Window avviato da gdm3(1).

%

8.4.1. Nozioni base sulla codifica

    La variabile d'ambiente "LANG=xx_YY.ZZZZ" imposta la
    localizzazione al codice di lingua "xx", alla codice di nazione
    "yy" e alla codifica "ZZZZ" (vedere Sezione 1.5.2, «La variabile
    "$LANG"»).

    Il sistema Debian attuale normalmente imposta la localizzazione
    come "LANG=xx_YY.UTF-8" che fa uso della codifica UTF-8 con
    l'insieme di caratteri Unicode. Il sistema di codifica UTF-8 è un
    sistema multibyte e usa i punti del codice in modo intelligente.
    I dati ASCII, che consistono solamente di codici a 7 bit, sono
    comunque dati UTF-8 validi che usano 1 solo byte per carattere.

    I sistemi Debian precedenti impostavano la localizzazione come
    "LANG=C" o "LANG=xx_YY" (senza ".UTF-8").

      * Per "LANG=C" o "LANG=POSIX" viene usato l'insieme di
        carattteri ASCII.
   
      * Il sistema di codifica tradizionale in Unix è usato per "LANG
        =xx_YY".

    I sistemi di codifica tradizionale di fatto usati per "LANG=
    xx_YY" possono essere identificati controllando "/usr/share/i18n/
    SUPPORTED". Per esempio, "en_US" usa la codifica ISO-8859-1" e
    "it_IT@euro" usa la codifica "ISO-8859-15".

    Suggerimento
   
    Per il significato dei valori delle codifiche vedere
    Tabella 11.2, «Elenco dei valori delle codifiche e loro uso».

%

8.4.2. Logica alla base dell'uso della localizzazione UTF-8

    L'insieme di caratteri Unicode può rappresentare praticamente
    tutti i caratteri conosciuti con un intervallo di codici da 0
    a10FFFF in notazione esadecimale. La sua memorizzazione richiede
    almeno 21 bit.

    Il sistema di codifica UTF-8 fa rientrare i codici Unicode in un
    flusso di dati ragionevole a 8 bit compatibile con il sistema di
    elaborazione dei dati ASCII. UTF sta per Unicode Transformation
    Format (formato di trasformazione di Unicode).

    È raccomandato l'uso della localizzazione UTF-8 per il desktop,
    per esempio "LANG=en_US.UTF-8". La prima parte della
    localizzazione determina i messaggi presentati dalle
    applicazioni. Per esempio, gedit(1) (un editor di testi per il
    desktop GNOME) nella localizzazione "LANG=it_IT.UTF-8" può
    mostrare e modificare testi in caratteri cinesi e allo stesso
    tempo presentare i menu in italiano, a patto che siano installati
    i necessari tipi di carattere e metodi di input.

    È raccomandabile anche impostare la localizzazione usando
    solamente la variabile d'ambiente "$LANG". Non vedo la
    convenienza nell'impostare nella localizzazione UTF-8 una
    complessa combinazione di variabili "LC_*" (vedere locale(1)).

    Anche un testo in semplice inglese può contenere caratteri non
    ASCII; le virgolette singole ricurve destra e sinistra per
    esempio non sono disponibili in ASCII.

    “citazione tra virgolette doppie” non è uguale a "citazione tra virgolette doppie ASCII"
    ‘citazione tra virgolette singole’ non è uguale a 'citazione tra virgolette singole ASCII'

    Quando dati di testo in puro ASCII sono convertiti in UTF-8 hanno
    contenuto e dimensioni esattamente identici a quelli dei dati
    ASCII originali. Perciò non si può perdere nulla usando la
    localizzazione UTF-8.

    Alcuni programmi usano più memoria dopo l'inclusione del supporto
    per l'internazionalizzazione. Questo avviene perché il loro
    codice è programmato per usare internamente UTF-32(UCS4) per
    supportare Unicode al fine di ottimizzare la velocità e consumano
    4 byte per ogni dato di carattere ASCII, indipendentemente dalla
    localizzazione selezionata. Ancora una volta usando la
    localizzazione UTF-8 non si perde nulla.

    I vecchi sistemi di codifica non UTF-8 specifici di produttori,
    tendono ad avere piccolissime, ma noiose, differenze per molte
    nazioni in alcuni caratteri come quelli grafici. L'uso del
    sistema UTF-8 da parte dei sistemi operativi moderni ha
    praticamente risolto questi problemi di conflitti tra le
    codifiche.

%

8.4.3. La (ri)configurazione della localizzazione

    Per far sì che un sistema abbia accesso ad una localizzazione
    particolare, è necessario che i dati della localizzazione siano
    stati compilati a partire dal database della localizzazione. (Il
    sistema Debian non viene fornito con tutte le localizzazioni
    disponibili già compilate a meno che non sia stato installato il
    pacchetto locales-all.) L'elenco completo delle localizzazioni
    supportate disponibili per la compilazione è disponibile in "/usr
    /share/i18n/SUPPORTED" che elenca tutti i nomi esatti delle
    localizzazioni. Il comando seguente elenca tutte le
    localizzazioni UTF-8 già compilate in forma binaria.

    $ locale -a | grep utf8

    Si può riconfigurare il pacchetto locales eseguendo il comando
    seguente.

    # dpkg-reconfigure locales

    Questo processo comprende 3 passi successivi.

     1. Aggiornare l'elenco delle localizzazioni disponibili

     2. Compilarle in forma binaria
   
     3. Impostare, per l'uso da parte di PAM (vedere Sezione 4.5,
        «PAM e NSS») il valore della localizzazione di sistema nel
        file "/etc/defaults/locale".

    L'elenco delle localizzazioni disponibili dovrebbe includere
    "en_US.UTF-8" e tutte le lingue desiderate con "UTF-8".

    La localizzazione predefinita raccomandata è "en_US.UTF-8" per
    l'inglese statunitense. Per le altre lingue, assicurasi di
    scegliere la localizzazione con "UTF-8"; ognuna di queste può
    gestire qualsiasi carattere internazionale.

    Nota
   
    Benché l'impostazione della localizzazione a "C" usi i messaggi
    in inglese statunitense, gestisce solo i caratteri ASCII.

%

8.4.4. Il valore della variabile di ambiente "$LANG"

    Il valore della variabile d'ambiente "$LANG" viene impostato e
    modificato da molte applicazioni.

      * È impostato inizialmente dal meccanismo PAM di login(1) per i
        programmi nelle console Linux locali

      * È impostato inizialmente dal meccanismo PAM del display
        manager per tutti i programmi X

      * È impostato inizialmente dal meccanismo PAM per ssh(1) per i
        programmi nelle console remote
   
      * È modificato da alcuni display manager come gdm3(1) per tutti
        i programmi X

      * È modificato dal codice di avvio della sessione X tramite "~
        /.xsessionrc" per tutti i programmi X

      * È modificato dal codice di avvio della shell, ad esempio "~
        /.bashrc" per tutti i programmi in console

    Suggerimento

    È una buona idea installare la localizzazione predefinita per
    tutto il sistema come "en_US.UTF-8" per avere la massima
    compatibilità.

%

8.4.5. Localizzazione specifica solamente in X Window

    Si può scegliere una localizzazione specifica solo sotto X
    Window, indipendentemente dalla localizzazione predefinita di
    sistema, usando la personalizzazione di PAM (vedere Sezione 4.5,
    «PAM e NSS») nel modo descritto in seguito.

    Questo ambiente dovrebbe fornire la migliore esperienza desktop
    possibile mantenendo la stabilità. Si ha accesso ad un terminale
    a caratteri funzionante con messaggi leggibili, anche quando il
    sistema X Window non funziona. Ciò diventa essenziale per le
    lingue che usano caratteri non romani, come cinese, giapponese e
    coreano.

    Nota

    Potrebbe essere disponibile un modo alternativo per ottenere lo
    stesso risulato, visti i miglioramenti che avvengono nei
    pacchetti dei gestori delle sessioni X, ma la lettura di quanto
    segue fornisce un metodo generico di base per l'impostazione
    della localizzazione. Per gdm3(1), è possibile selezionare la
    localizzazione della sessione X dal suo menu.

    La riga seguente definisce la posizione del file dell'ambiente
    della lingua, nel file di configurazione di PAM, come "/etc/pam.d
    /gdm3".

    auth    required        pam_env.so read_env=1 envfile=/etc/default/locale

    Cambiare tale riga nel modo seguente

    auth    required        pam_env.so read_env=1 envfile=/etc/default/locale-x

    Per il giapponese, creare un file "/etc/default/locale-x"
    permessi "-rw-r--r-- 1 root root" contenente quanto segue.

    LANG="ja_JP.UTF-8"

    Mantenere il file predefinito "/etc/default/locale" per l'uso da
    parte di altri programmi nel modo seguente.

    LANG="en_US.UTF-8"

    Questa è la tecnica più generica per personalizzare la
    localizzazione e rende localizzato il dialogo di selezione stesso
    del menu di gdm3(1).

    In alternativa in questo caso, si può semplicemente cambiare la
    localizzazione usando il file "~/.xsessionrc".

%

8.4.6. Codifica per i nomi di file

    Per lo scambia di dati interpiattaforma (vedere Sezione 10.1.7,
    «Supporti di archiviazione removibili»), può essere necessario
    montare alcuni file system con codifiche particolari. Per
    esempio, mount(8), se usato senza opzioni, assume che venga usata
    la codifica CP437 per il file system vfat. È necessario fornire
    esplicitamente opzioni di montaggio per usare nomi di file UTF-8
    o CP932.

    Nota

    Quando una chiavetta USB inseribile a caldo viene automaticamente
    montata in un ambiente desktop moderno come GNOME, si può fornire
    una informazione di montaggio di questo tipo cliccando con il
    tasto destro sull'icona del dispositivo sul desktop, cliccare
    sulla scheda "Drive", cliccare per espandere "Impostazioni" ed
    inserire "utf8" in "Opzioni di mount:". La prossima volta che
    questa chiavetta di memoria verrà montata, sarà abilitato il
    montaggio con UTF-8.

    Nota

    Se si sta facendo l'aggiornamento di un sistema o spostando
    dischi da un sistema non UTF-8, i nomi di file con caratteri non
    ASCII potranno essere codificati con codifiche usate una volta e
    ora deprecate, come ISO-8859-1 o eucJP. Cercare aiuto sugli
    strumenti di conversione dei testi per convrtirli in UTF-8.
    Vedere Sezione 11.1, «Strumenti di conversione di dati testuali».

    Samba usa in modo predefinito Unicode per i client più moderni
    (Windows NT, 200x, XP), ma usa CP850 per client più vecchi (DOS e
    Windows 9x/Me). Questo comportamento predefinito per i client più
    vecchi può essere modificato usando "dos charset" nel file "/etc/
    samba/smb.conf", per esempio usando "CP932" per il giapponese.

%

8.4.7. Messaggi localizzati e documentazione tradotta

    Esistono le traduzioni di molti dei messaggi di testo e dei
    documenti che sono mostrati nel sistema Debian, come messaggi di
    errore, output standard dei programmi, menu e pagine di manuale.
    L'insieme di strumenti GNU gettext(1) è usato come strumento di
    backend per la maggior parte delle attività di traduzione.

    aptitude(8) fornisce in "Task" → "Localizzazione" un ampio elenco
    di utili pacchetti binari che aggiungono alle applicazioni
    messaggi localizzati e che forniscono documentazione nella
    versione tradotta.

    Per esempio, si possono ottenere i messaggi localizzati per le
    pagine man installando il pacchetto manpages-<LINGUA>. Per
    leggere le pagine man di <nomeprogramma> in italiano contenute in
    "/usr/share/man/it/", eseguire il comando seguente.

    LANG=it_IT.UTF-8 man <nomeprogramma>

%

8.4.8. Effetti della localizzazione

    La disposizione dell'ordinamento dei caratteri con sort(1) è
    influenzata dalla lingua scelta dalla localizzazione. Le
    localizzazioni spagnola e inglese ordinano in modo diverso.

    Il formato della data mostrato da ls(1) è influenzato dalla
    localizzazione. Il formato della data di "LANG=C ls -l" è
    differente da quello con "LANG=en_US.UTF-8" (vedere
    Sezione 9.2.5, «Visualizzazione personalizzata di date e orari»).

    I caratteri di punteggiatura usati per i numeri sono diversi
    nelle varie localizzazioni. Per esempio, nella localizzazione
    inglese mille virgola uno è rappresentato come "1,000.1", mentre
    nella localizzazione in italiano è mostrato come "1.000,1". Si
    può vedere questa differenza nei programmi per fogli di calcolo.

Capitolo 9. Suggerimenti per il sistema

    In questa sezione vengono descritti suggerimenti base per
    configurare e gestire il sistema, per lo più dalla console.

%

9.1. Il programma screen

    screen(1) è uno strumento molto utile per permettere alle persone
    di accedere a siti remoti attraverso una connessione non
    affidabile o intermittente, dato che supporta connessioni
    interrotte.

    Tabella 9.1. Elenco di programmi che supportano connessioni di
    rete interrotte

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|            descrizione            |
    |---------+------+----------+-----------------------------------|
    |screen   |V:127,|1013      |multiplexer per terminale con      |
    |         |I:281 |          |emulazione di terminale VT100/ANSI |
    |---------+------+----------+-----------------------------------|
    |         |V:34, |          |alternativa per multiplexer per    |
    |tmux     |I:136 |830       |terminale (usare invece            |
    |         |      |          |"Control-B")                       |
    +---------------------------------------------------------------+


%

9.1.1. Scenario di uso per screen(1)

    screen(1) non permette solamente il funzionamento di una finestra
    di terminale con processi multipli, ma permette anche ai processi
    in shell remote di sopravvivere a connessioni interrotte. Quello
    che segue è un tipico scenario di uso di screen(1).

     1. Si fa il login in una macchina remota.

     2. Si avvia screen in una console singola.

     3. Si eseguono svariati programmi in finestre screen create con
        ^A c ("Control-A" seguito da "c").

     4. Ci si sposta tra le svariate finestre screen create con ^A n
        ("Control-A" seguito da "n").

     5. All'improvviso si ha la necessità di lasciare il terminale,
        ma non si vuole perdere il lavoro attivo e si vuole mantenere
        la connessione.

     6. Si può scollegare la sessione screen in uno qualsiasi dei
        metodi seguenti.

          + Scollegare brutalmente la connessione di rete

          + Digitare ^A d ("Control-A" seguito da "d") e fare
            manualmente il log out dalla connessione remota.

          + Digitare ^A DD ("Control-A" seguito da "DD") per far si
            che screen si scolleghi e faccia il log out.

     7. Ci si ricollega alla stessa macchina remota (anche da un
        terminale diverso).

     8. Si avvia screen con "screen -r".

     9. screen magicamente ricollega tutte le finestre screen
        precedente con tutti i programmi in esecuzione attivi.

    Suggerimento

    Con screen si può risparmiare sui costi di connessione per
    connessioni a tempo, come dial-up o conteggiate a pacchetti,
    perché si può lasciare un processo attivo mentre si è disconnessi
    e poi ricollegarvisi successivamente quando è possibile
    connettersi di nuovo.

%

9.1.2. Associazioni dei tasti per il comando screen

    In una sessione screen tutto l'input da tastiera viene inviato
    alla finestra attuale, tranne per le combinazioni di tasti per i
    comandi. Tutte le combinazioni di tasti per i comandi di screen
    vengono inserite digitando ^A ("Control-A") più un singolo tasto
    [più eventuali parametri]. Ecco alcune combinazioni di tasti
    importanti da ricordare.

    Tabella 9.2. Elenco di associazioni di tasti per screen

    +---------------------------------------------------------------+
    |  azione   |                    significato                    |
    | associata |                                                   |
    |-----------+---------------------------------------------------|
    |^A ?       |mostra una schermata di aiuto (visualizza le       |
    |           |associazioni di tasti)                             |
    |-----------+---------------------------------------------------|
    |^A c       |crea una nuova finestra e si sposta in essa        |
    |-----------+---------------------------------------------------|
    |^A n       |va alla finestra successiva                        |
    |-----------+---------------------------------------------------|
    |^A p       |va alla finestra precedente                        |
    |-----------+---------------------------------------------------|
    |^A 0       |va alla finestra numero 0                          |
    |-----------+---------------------------------------------------|
    |^A 1       |va alla finestra numero 1                          |
    |-----------+---------------------------------------------------|
    |^A w       |mostra l'elenco delle finestre                     |
    |-----------+---------------------------------------------------|
    |^A a       |invia Ctrl-A alla finestra attuale come input da   |
    |           |tastiera                                           |
    |-----------+---------------------------------------------------|
    |^A h       |scrive una copia della schermata della finestra    |
    |           |attuale in un file                                 |
    |-----------+---------------------------------------------------|
    |^A H       |inizia/termina la registrazione dell'attività della|
    |           |finestra attuale in un file                        |
    |-----------+---------------------------------------------------|
    |^A ^X      |blocca il terminale (protetto da password)         |
    |-----------+---------------------------------------------------|
    |^A d       |scollega la sessione screen dal terminale          |
    |-----------+---------------------------------------------------|
    |^A DD      |scollega la sessione di screen e fa il log out     |
    +---------------------------------------------------------------+


    Vedere screen(1) per i dettagli.

9.2. Registrazione e presentazione di dati

%

9.2.1. Demoni di registro

    Molti programmi registrano le proprie attività nella directory "/
    var/log/".

      * Il demone del registro di sistema: rsyslogd(8)

    Vedere Sezione 3.2.5, «I messaggi di sistema» e Sezione 3.2.4, «I
    messaggi del kernel».

%

9.2.2. Analizzatori di registro

    Quelli che seguono sono alcuni analizzatori di registro degni di
    nota ("~Gsecurity::log-analyzer" in aptitude(8)).

    Tabella 9.3. Elenco di analizzatori del registro di sistema

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|         descrizione          |
    |--------------+------+----------+------------------------------|
    |              |V:16, |          |analizzatore di registro      |
    |logwatch      |I:18  |2265      |scritto in Perl con un        |
    |              |      |          |bell'output                   |
    |--------------+------+----------+------------------------------|
    |              |V:112,|          |strumento per interdire IP che|
    |fail2ban      |I:123 |2092      |causano errori di             |
    |              |      |          |autenticazione multipli       |
    |--------------+------+----------+------------------------------|
    |analog        |V:4,  |3534      |analizzatore del registro di  |
    |              |I:109 |          |server web                    |
    |--------------+------+----------+------------------------------|
    |              |V:9,  |          |analizzatore potente e ricco  |
    |awstats       |I:15  |6910      |di funzionalità per registro  |
    |              |      |          |di server web                 |
    |--------------+------+----------+------------------------------|
    |sarg          |V:3,  |843       |generatore di rapporti        |
    |              |I:3   |          |sull'analisi di squid         |
    |--------------+------+----------+------------------------------|
    |pflogsumm     |V:1,  |111       |strumento per riassunti delle |
    |              |I:4   |          |voci di registro di Postfix   |
    |--------------+------+----------+------------------------------|
    |syslog-summary|V:0,  |30        |riassume i contenuti di un    |
    |              |I:2   |          |file di registro di sistema   |
    |--------------+------+----------+------------------------------|
    |fwlogwatch    |V:0,  |479       |analizzatore del registro del |
    |              |I:0   |          |firewall                      |
    |--------------+------+----------+------------------------------|
    |squidview     |V:0,  |189       |monitora e analizza i file    |
    |              |I:1   |          |access.log di squid           |
    |--------------+------+----------+------------------------------|
    |              |      |          |visualizzatore di file di     |
    |swatch        |V:0,  |101       |registro con corrispondenze   |
    |              |I:0   |          |con espressioni regolari,     |
    |              |      |          |evidenziazione ed eventi      |
    |--------------+------+----------+------------------------------|
    |crm114        |V:0,  |1119      |Controllable Regex Mutilator e|
    |              |I:0   |          |filtro per spam (CRM114)      |
    |--------------+------+----------+------------------------------|
    |icmpinfo      |V:0,  |44        |interpreta i messaggi ICMP    |
    |              |I:0   |          |                              |
    +---------------------------------------------------------------+


    Nota

    CRM114 fornisce un'infrastruttura basata su un linguaggio per
    scrivere filtri fuzzy con la libreria per espressioni regolari
    TRE. Il suo utilizzo più comune è come filtro per la posta
    spazzatura, ma può anche essere usato come analizzatore di
    registro.

%

9.2.3. Registrare le attività della shell in modo pulito

    Il semplice uso di script(1) (vedere Sezione 1.4.9, «Registrare
    le attività della shell») per registrare l'attività della shell
    produce un file con caratteri di controllo. Ciò può essere
    evitato usando col(1) nel modo seguente.

    $ script
    Script è avviato, il file è typescript

    Fare tutto quello che si vuole … e poi premere Ctrl-D per uscire
    da script.

    $ col -bx <typescript >filepulito
    $ vim filepulito

    Se script non è disponibile (per esempio, durante il processo di
    avvio in initramfs), si può usare invece il comando seguente.

    $ sh -i 2>&1 | tee typescript

    Suggerimento

    Alcuni x-terminal-emulator (emulatori di terminale in X), come
    Terminale di GNOME hanno la funzione di registrazione. Si
    potrebbe voler ampliare il buffer delle righe per scorrerle
    all'indietro.

    Suggerimento

    Si può usare screen(1) con "^A H" (vedere Sezione 9.1.2,
    «Associazioni dei tasti per il comando screen») per registrare la
    console.

    Suggerimento

    È possibile usare emacs(1) con "M-x shell", "M-x eshell" o "M-x
    term" per registrare la console. Si può successivamente usare
    "C-x C-w" per scrivere il buffer in un file.

%

9.2.4. Visualizzazione personalizzata di dati di testo

    Sebbene gli strumenti di paginazione, come more(1) e less(1)
    (vedere Sezione 1.4.5, «Il paginatore») e gli strumenti
    personalizzati per l'evidenziazione e la formattazione (vedere
    Sezione 11.1.8, «Evidenziare e formattare dati in puro testo»)
    possano mostrare il testo in un modo piacevole, gli editor
    generici (vedere Sezione 1.4.6, «L'editor di testo») sono più
    versatili e personalizzabili.

    Suggerimento
   
    Per vim(1) e la sua modalità per paginatore, ossia view(1), ":set
    hls" abilita la ricerca con evidenziazione.

%

9.2.5. Visualizzazione personalizzata di date e orari

    Il formato predefinito per la visualizzazione delle date e degli
    orari per il comando "ls -l" dipende dalla localizzazione (vedere
    Sezione 1.2.6, «Orari» per il valore). Si fa dapprima riferimento
    alla variabile "$LANG" che può essere scavalcata dalla variabile
    "$LC_TIME".

    Il formato effettivo di visualizzazione predefinito per ciascuna
    localizzazione dipende dalla versione della libreria C (il
    pacchetto libc6) usata. Differenti rilasci di Debian hanno cioè
    valori predefiniti diversi.

    Se si desidera veramente personalizzare questo formato di
    visualizzazione delle date e degli orari, oltre a ciò che è fatto
    con la localizzazione, si deve impostare il valore dello stile
    degli orari con l'opzione "--time-style" o con il valore di
    "$TIME_STYLE" (vedere ls(1), date(1), "info coreutils 'ls
    invocation'").

    Tabella 9.4. Esempi di visualizzazione di date e orari per il
    comando "ls -l" per wheezy

    +---------------------------------------------------------------+
    |valore dello stile per|localizzazione|visualizzazione di data e|
    |      gli orari       |              |           ora           |
    |----------------------+--------------+-------------------------|
    |iso                   |qualsiasi     |01-19 00:15              |
    |----------------------+--------------+-------------------------|
    |long-iso              |qualsiasi     |2009-01-19 00:15         |
    |----------------------+--------------+-------------------------|
    |full-iso              |qualsiasi     |2009-01-19               |
    |                      |              |00:15:16.000000000 +0900 |
    |----------------------+--------------+-------------------------|
    |locale                |C             |Jan 19 00:15             |
    |----------------------+--------------+-------------------------|
    |locale                |en_US.UTF-8   |Jan 19 00:15             |
    |----------------------+--------------+-------------------------|
    |locale                |es_ES.UTF-8   |ene 19 00:15             |
    |----------------------+--------------+-------------------------|
    |+%d.%m.%y %H:%M       |qualsiasi     |19.01.09 00:15           |
    |----------------------+--------------+-------------------------|
    |+%d.%b.%y %H:%M       |C o           |19.Jan.09 00:15          |
    |                      |en_US.UTF-8   |                         |
    |----------------------+--------------+-------------------------|
    |+%d.%b.%y %H:%M       |es_ES.UTF-8   |19.ene.09 00:15          |
    +---------------------------------------------------------------+


    Suggerimento

    Si può evitare di digitare lunghe opzioni nella riga di comando
    usando alias, per esempio "alias ls='ls --time-style=+%d.%m.%y\
    %H:%M'" (vedere Sezione 1.5.9, «Alias di comandi»).

    Suggerimento
   
    Per i formati iso viene seguito lo standard ISO 8601.

%

9.2.6. Output colorato per la shell

    L'output inviato a schermo dalla shell nella maggior parte dei
    terminali moderni può essere colorato usando codici di escape
    ANSI (vedere "/usr/share/doc/xterm/ctlseqs.txt.gz").

    Per esempio, provare a fare quanto segue.

    $ RED=$(printf "\x1b[31m")
    $ NORMAL=$(printf "\x1b[0m")
    $ REVERSE=$(printf "\x1b[7m")
    $ echo "${RED}TESTO-ROSSO${NORMAL} ${REVERSE}TESTO-IN-NEGATIVO${NORMAL}"

%

9.2.7. Comandi colorati

    I comandi colorati sono comodi per ispezionare il loro output in
    modo interattivo. Nel mio file "~/.bashrc" io includo quanto
    segue.

    if [ "$TERM" != "dumb" ]; then
        eval "`dircolors -b`"
        alias ls='ls --color=always'
        alias ll='ls --color=always -l'
        alias la='ls --color=always -A'
        alias less='less -R'
        alias ls='ls --color=always'
        alias grep='grep --color=always'
        alias egrep='egrep --color=always'
        alias fgrep='fgrep --color=always'
        alias zgrep='zgrep --color=always'
    else
        alias ll='ls -l'
        alias la='ls -A'
    fi

    Questo uso degli alias limita gli effetti colorati all'uso
    interattivo dei comandi. Ha il vantaggio, rispetto
    all'esportazione della variabile d'ambiente "export GREP_OPTIONS=
    '--color=auto'", che i colori possono essere visti in programmi
    di paginazione come less(1). Se si desidera eliminare i colori
    quando si invia l'output con una pipe ad altri comandi, usare
    nell'esempio precedente per "~/.bashrc" "--color=auto".

    Suggerimento

    Questi alias di colorazione possono essere disattivati
    nell'ambiente interattivo invocando la shell con il comando "TERM
    =dumb bash".

%

9.2.8. Registrare le attività dell'editor per ripetizioni complesse

    È possibile registrare le attività dell'editor per ripetere
    azioni complesse.

    Per vim fare nel modo seguente.

      * "qa": avviare la registrazione dei caratteri digitati in un
        registro chiamato "a".

      * … attività nell'editor

      * "q": terminare la registrazione dei caratteri digitati.

      * "@a": eseguire il contenuto del registro "a".

    Per Emacs fare nel modo seguente.

      * "C-x (": iniziare la definizione di una macro da tastiera.

      * … attività nell'editor
   
      * "C-x )": terminare la definizione di una macro da tastiera.

      * "C-x e": eseguire la definizione di una macro da tastiera.

%

9.2.9. Registrare l'immagine grafica di un'applicazione X

    Ci sono alcuni modi per registrare l'immagine grafica di
    un'applicazione X, incluso il display di un xterm.

    Tabella 9.5. Elenco di strumenti di manipolazione di immagini
    grafiche

    +---------------------------------------------------+
    |  pacchetto  |  popcon   |dimensione|   comando    |
    |-------------+-----------+----------+--------------|
    |xbase-clients|I:26       |46        |xwd(1)        |
    |-------------+-----------+----------+--------------|
    |gimp         |V:68, I:341|22313     |menu della GUI|
    |-------------+-----------+----------+--------------|
    |imagemagick  |I:400      |218       |import(1)     |
    |-------------+-----------+----------+--------------|
    |scrot        |V:8, I:80  |70        |scrot(1)      |
    +---------------------------------------------------+


%

9.2.10. Registrare i cambiamenti a file di configurazione

    Esistono strumenti specializzati per registrare i cambiamenti nei
    file di configurazione con l'aiuto del sistema DVCS.

    Tabella 9.6. Elenco di pacchetti per registrare la cronologia
    della configurazione in VCS

    +---------------------------------------------------------------+
    | pacchetto |popcon|dimensione|           descrizione           |
    |-----------+------+----------+---------------------------------|
    |           |      |          |archivia i file di configurazione|
    |etckeeper  |V:27, |162       |ed i loro metadati con Git       |
    |           |I:32  |          |(predefinito), Mercurial o Bazaar|
    |           |      |          |(nuovo)                          |
    |-----------+------+----------+---------------------------------|
    |changetrack|V:0,  |71        |archivia i file di configurazione|
    |           |I:0   |          |con RCS (vecchio)                |
    +---------------------------------------------------------------+


    Io raccomando l'uso del pacchetto etckeeper con git(1) che mette
    l'intera directory "/etc" sotto il controllo di VCS. La sua guida
    di installazione ed il suo tutorial si trovano in "/usr/share/doc
    /etckeeper/README.gz".

    Fondamentalmente, l'esecuzione di "sudo etckeeper init"
    inizializza il repository git per "/etc", esattamente come nel
    procedimento spiegato in Sezione 10.6.5, «Git per registrare la
    cronologia della configurazione» ma con speciali script attivati
    da eventi per impostazioni più accurate.

    Quando si cambia la configurazione, si può usare normalmente git
    (1) per registrare i cambiamenti. Esso registra automaticamente i
    cambiamenti in modo comodo anche ogni volta che vengono eseguiti
    i comandi di gestione dei pacchetti.

    Suggerimento

    Si può sfogliare la cronologia dei cambiamenti di "/etc"
    eseguendo "sudo GIT_DIR=/etc/.git" ottenendo una chiara
    visualizzazione dei nuovi pacchetti installati, di quelli rimossi
    e dei cambiamenti di versione dei pacchetti.

%

9.3. Monitorare, controllare ed avviare l'attività dei programmi

    Le attività dei programmi possono essere monitorare e controllate
    usando strumenti specializzati.

    Tabella 9.7. Elenco di strumenti per monitorare e controllare
    l'attività dei programmi.

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|            descrizione            |
    |---------+------+----------+-----------------------------------|
    |         |V:891,|          |nice(1): esegue un programma con   |
    |coreutils|I:999 |17478     |priorità di schedulazione          |
    |         |      |          |modificata                         |
    |---------+------+----------+-----------------------------------|
    |         |V:673,|          |renice(1): modifica la priorità di |
    |bsdutils |I:999 |393       |schedulazione di un processo in    |
    |         |      |          |esecuzione                         |
    |---------+------+----------+-----------------------------------|
    |procps   |V:739,|792       |utilità per il file system "/proc":|
    |         |I:999 |          |ps(1), top(1), kill(1), watch(1), …|
    |---------+------+----------+-----------------------------------|
    |         |V:427,|          |utilità per il file system "/proc":|
    |psmisc   |I:845 |679       |killall(1), fuser(1), peekfd(1),   |
    |         |      |          |pstree(1)                          |
    |---------+------+----------+-----------------------------------|
    |         |V:15, |          |time(1): esegue un programma per   |
    |time     |I:279 |82        |riportare l'uso delle risorse di   |
    |         |      |          |sistema in funzione del tempo      |
    |---------+------+----------+-----------------------------------|
    |         |V:161,|          |sar(1), iostat(1), mpstat(1), …:   |
    |sysstat  |I:183 |1918      |strumenti per le prestazioni di    |
    |         |      |          |sistema per Linux                  |
    |---------+------+----------+-----------------------------------|
    |         |V:0,  |          |Interactive System Activity Grapher|
    |isag     |I:3   |116       |(tracciamento interattivo          |
    |         |      |          |dell'attivita) per sysstat         |
    |---------+------+----------+-----------------------------------|
    |         |V:391,|          |lsof(8): elenca, usando l'opzione  |
    |lsof     |I:946 |451       |"-p", i file aperti da un processo |
    |         |      |          |in esecuzione                      |
    |---------+------+----------+-----------------------------------|
    |strace   |V:16, |2367      |strace(1): traccia le chiamate e i |
    |         |I:153 |          |segnali di sistema                 |
    |---------+------+----------+-----------------------------------|
    |ltrace   |V:1,  |363       |ltrace(1): traccia le chiamate di  |
    |         |I:21  |          |libreria                           |
    |---------+------+----------+-----------------------------------|
    |xtrace   |V:0,  |353       |xtrace(1): traccia la comunicazione|
    |         |I:0   |          |tra client e server X11            |
    |---------+------+----------+-----------------------------------|
    |         |V:9,  |          |powertop(1): informazioni sull'uso |
    |powertop |I:217 |662       |dell'alimentazione da parte del    |
    |         |      |          |sistema                            |
    |---------+------+----------+-----------------------------------|
    |         |V:805,|          |esegue processi dal demone cron(8) |
    |cron     |I:997 |263       |sullo sfondo in base ad una        |
    |         |      |          |pianificazione                     |
    |---------+------+----------+-----------------------------------|
    |         |V:409,|          |pianificatore di comandi in stile  |
    |anacron  |I:482 |99        |cron, per i sistemi che non sono in|
    |         |      |          |esecuzione 24 ore al giorno        |
    |---------+------+----------+-----------------------------------|
    |         |      |          |at(1) o batch(1): esegue un compito|
    |at       |V:162,|161       |ad un orario specificato o quando  |
    |         |I:310 |          |il carico di sistema scende sotto  |
    |         |      |          |un certo livello                   |
    +---------------------------------------------------------------+


    Suggerimento

    Il pacchetto procps fornisce strumenti estremamente di base per
    monitorare, controllare ed avviare le attività dei programmi. È
    consigliabile imparare ad usarli tutti.

%

9.3.1. Cronometrare un processo

    Mostrare il tempo usato dal processo invocato da un comando.

    # time un_qualche_comando >/dev/null
    real    0m0.035s       # tempo di orologio (tempo reale trascorso)
    user    0m0.000s       # tempo in modalità utente
    sys     0m0.020s       # tempo in modalità kernel

%

9.3.2. Priorità di schedulazione

    Per controllare la priorità di schedulazione di un processo è
    usato il valore di nice.

    Tabella 9.8. Elenco di valori di nice per la priorità di
    schedulazione

    +---------------------------------------------------------------+
    | valore di |             priorità di schedulazione             |
    |   nice    |                                                   |
    |-----------+---------------------------------------------------|
    |19         |processo dalla priorità più bassa possibile (nice -|
    |           |gentile)                                           |
    |-----------+---------------------------------------------------|
    |0          |processo a priorità molto alta per l'utente        |
    |-----------+---------------------------------------------------|
    |-20        |processo a priorità molto alta per root (not-nice -|
    |           |non gentile)                                       |
    +---------------------------------------------------------------+


    # nice  -19 top                                      # molto gentile
    # nice --20 wodim -v -eject speed=2 dev=0,0 disk.img # molto veloce

    A volte un valore molto alto di nice fa più male che bene al
    sistema; usare quindi questo comando con molta cautela.

%

9.3.3. Il comando ps

    Il comando ps(1) in un sistema Debian supporta sia le
    funzionalità BSD sia quelle SystemV ed aiuta ad identificare
    l'attività dei processi in modo statico.

    Tabella 9.9. Elenco degli stili per il comando ps

    +----------------------------------------+
    | stile  |comando tipico|    funzione    |
    |--------+--------------+----------------|
    |BSD     |ps aux        |mostra %CPU %MEM|
    |--------+--------------+----------------|
    |System V|ps -efH       |mostra PPID     |
    +----------------------------------------+


    È possibile uccidere i processi figli zombie (defunti) tramite
    l'ID di processo del genitore identificato dal campo "PPID".

    Il comando pstree(1) mostra un albero dei processi.

%

9.3.4. Il comando top

    top(1) in sistemi Debian ha molte funzionalità e aiuta ad
    identificare in modo dinamico i processi che si stanno
    comportando in modo strano.

    È un programma interattivo a tutto schermo. Si possono ottenere
    le informazioni di aiuto sul suo uso premendo il tasto «h» e
    uscire premendo il tasto «q».

%

9.3.5. Elencare i file aperti da un processo

    È possibile elencare tutti i file aperti da un processo
    attraverso il suo PID (Identificativo di processo), ad esempio 1,
    con il comando seguente.

    $ sudo lsof -p 1

    Di solito il processo con PID=1 è il programma init.

%

9.3.6. Tenere traccia delle attività di un programma

    Si può tenere traccia dell'attività di un programma con strace(1)
    , ltrace(1) o xtrace(1) rispettivamente per quello che riguarda
    chiamate e segnali di sistema, chiamate di libreria o
    comunicazioni tra client e server X11.

    Si può tenere traccia delle chiamate di sistema del comando ls
    nel modo seguente.

    $ sudo strace ls

%

9.3.7. Identificazione di processi in base a file o socket

    Usando fuser(1) è anche possibile identificare i processi in base
    ai file usando, ad esempio per "/var/log/mail.log" con il comando
    seguente.

    $ sudo fuser -v /var/log/mail.log
                         USER        PID ACCESS COMMAND
    /var/log/mail.log:   root       2946 F.... rsyslogd

    Come si vede il file "/var/log/mail.log" è aperto in scrittura
    dal comando rsyslogd(8).

    Usando fuser(1) si può anche identificare i processi in base ai
    socket, ad esempio per "smtp/tcp" con il comando seguente.

    $ sudo fuser -v smtp/tcp
                         USER        PID ACCESS COMMAND
    smtp/tcp:            Debian-exim   3379 F.... exim4

    Ora si può vedere che sul sistema è in esecuzione exim4(8) per
    gestire le connessioni TCP alla porta SMTP (25).

%

9.3.8. Ripetere un comando ad intervalli costanti

    watch(1) esegue un programma in modo ripetitivo ad intervalli
    regolari mostrando il suo output sullo schermo.

    $ watch w

    Questo comando mostra chi è attualmente connesso al sistema in
    modo aggiornato ogni 2 secondi.

%

9.3.9. Ripetere un comando su diversi file

    Ci sono svariati modi di ripetere uno stesso comando su diversi
    file che rispondono ad una qualche condizione, ad esempio che
    corrispondono al modello glob "*.ext".

      * Metodo del ciclo for nella shell (vedere Sezione 12.1.4,
        «Cicli di shell»):

    for x in *.ext; do if [ -f "$x"]; then comando "$x" ; fi; done

      * Combinazione di find(1) e xargs(1):

    find . -type f -maxdepth 1 -name '*.ext' -print0 | xargs -0 -n 1 comando

      * find(1) con l'opzione "-exec" con un comando:

    find . -type f -maxdepth 1 -name '*.ext' -exec comando '{}' \;

      * find(1) con l'opzione "-exec" con un breve script di shell:

    find . -type f -maxdepth 1 -name '*.ext' -exec sh -c "comando '{}' && echo 'esecuzione con successo'" \;

    Gli esempi precedenti sono stati scritti per assicurare la
    gestione appropriata di nomi di file particolari come quelli
    contenenti spazi. Per usi più avanzati di find(1), vedere
    Sezione 10.1.5, «Esempi di invocazione per la selezione di file».

%

9.3.10. Avviare un programma dalla GUI

    Perl l'interfaccia a riga di comando (CLI), viene eseguito il
    primo programma con un nome corrispondente trovato nelle
    directory specificate nella variabile d'ambiente $PATH. Vedere
    Sezione 1.5.3, «La variabile "$PATH"».

    Per l'interfaccia utente grafica (GUI) conforme agli standard di
    freedesktop.org i file *.desktop nella directory /usr/share/
    applications/ forniscono gli attributi necessari per la
    visualizzazione di ogni programma nel menu della GUI. Vedere
    Sezione 7.2.2, «Menu Freedesktop.org».

    Per esempio, il file chromium.desktop definisce gli attributi per
    il «Browser Web Chromium» come «Name» per il nome di programma,
    «Exec» per il percorso e gli argomenti di esecuzione del
    programma, «Icon» per l'icona usata, ecc. (vedere laSpecifica per
    le voci per desktop), nel modo seguente:

    [Desktop Entry]
    Version=1.0
    Name=Chromium Web Browser
    GenericName=Web Browser
    Comment=Access the Internet
    Comment[it]=Esplorare il Web
    Exec=/usr/bin/chromium %U
    Terminal=false
    X-MultipleArgs=false
    Type=Application
    Icon=chromium
    Categories=Network;WebBrowser;
    MimeType=text/html;text/xml;application/xhtml_xml;x-scheme-handler/http;x-scheme-handler/https;
    StartupWMClass=Chromium
    StartupNotify=true

    Questa è una descrizione molto semplificata. I file *.desktop
    vengono analizzati nel modo seguente.

    L'ambiente desktop imposta le variabili d'ambiente $XDG_DATA_HOME
    e $XDG_DATA_DIR. Per esempio, in GNOME 3:

      * $XDG_DATA_HOME non è impostata. (Viene usato il valore
        predefinito: $HOME/.local/share.)
   
      * $XDG_DATA_DIRS è impostata a /usr/share/gnome:/usr/local/
        share/:/usr/share/.

    Perciò le directory base (vedere la XDG Base Directory
    Specification) e le directory applications sono le seguenti.

      * $HOME/.local/share/ → $HOME/.local/share/applications/

      * /usr/share/gnome/ → /usr/share/gnome/applications/
   
      * /usr/local/share/ → /usr/local/share/applications/

      * /usr/share/ → /usr/share/applications/

    I file *.desktop vengono analizzati all'interno di queste
    directory applications in tale ordine.

    Suggerimento

    Una voce del menu GUI personalizzata dell'utente può essere
    creata aggiungendo un file *.desktop nella directory $HOME/.local
    /share/applications/.

    Suggerimento

    In modo analogo, se viene creato un file *.desktop nella
    directory autostart all'interno di queste directory di base, il
    programma specificato nel file *.desktop viene eseguito
    automaticamente all'avvio dell'ambiente desktop. Vedere la
    specifica Desktop Application Autostart Specification.

    Suggerimento

    In modo simile, se viene creato un file *.desktop nella directory
    $HOME/Desktop e l'ambiente desktop è configurato per supportare
    la funzionalità di avviatore delle icone, il programma
    specificato in tale file viene eseguito quando si fa clic
    sull'icona. Notare che il nome effettivo della directory $HOME/
    Desktop dipende dalla localizzazione. Vedere xdg-user-dirs-update
    (1).

%

9.3.11. Personalizzare i programmi da avviare

    Alcuni programmi avviano automaticamente altri programmi. Quelli
    che seguono sono alcuni punti fondamentali per la
    personalizzazione di questo processo.

      * Menu di configurazione delle applicazioni:

          + Desktop GNOME3: "Impostazioni di sistema" → "System" →
            "Dettagli" → "Applicazioni predefinite"

          + Desktop KDE: "K" → "Centro di controllo" → "Componenti di
            KDE" → "Scelta componenti"

          + Browser Iceweasel: "Modifica" → "Preferenze" →
            "Applicazioni"

          + mc(1): "/etc/mc/mc.ext"

      * Variabili d'ambiente quali "$BROWSER", "$EDITOR", "$VISUAL" e
        "$PAGER" (vedere eviron(7))

      * Il sistema update-alternatives(1) per i programmi come
        "editor", "view", "x-www-browser", "gnome-www-browser" e
        "www-browser" (vedere Sezione 1.4.7, «Impostare un editor di
        testi predefinito»)

      * Il contenuto dei file "~/.mailcap" e "/etc/mailcap" che
        associano i tipi MIME con programmi (vedere mailcap(5))

      * Il contenuto dei file "~/.mime.types" e "/etc/mime.types" che
        associano le estensioni dei nomi di file con tipi MIME
        (vedere run-mailcap(1))

    Suggerimento
   
    update-mime(8) aggiorna il file "/etc/mailcap" usando il file "/
    etc/mailcap.order" (vedere mailcap.order(5)).

    Suggerimento

    Il pacchetto debianutils fornisce sensible-browser(1), 
    sensible-editor(1) e sensible-pager(1) che prendono decisioni
    sensate riguardo, rispettivamente, a quale browser web, editor e
    paginatore invocare. La lettura di questi script di shell è
    raccomandata.

    Suggerimento

    Per eseguire un'applicazione per console, come mutt, come
    applicazione preferita in X si dovrebbe creare un'applicazione X
    nel modo seguente ed impostare "/usr/local/bin/mutt-term" come
    applicazione preferite da avviare come descritto in precedenza.

    # cat /usr/local/bin/mutt-term <<EOF
    #!/bin/sh
    gnome-terminal -e "mutt \$@"
    EOF
    chmod 755 /usr/local/bin/mutt-term

%

9.3.12. Uccidere un processo

    Per uccidere un processo (o inviare ad esso un segnale) in base
    al suo ID (identificativo) usare kill(1).

    Per fare la stessa cosa ma in base al nome del comando del
    processo o ad altri attributi, usare killall(1) o pkill(1).

    Tabella 9.10. Elenco dei segnali usati comunemente con il comando
    kill

    +-----------------------------------------------------+
    |valore del segnale|nome del segnale|    funzione     |
    |------------------+----------------+-----------------|
    |1                 |HUP             |riavvia il demone|
    |------------------+----------------+-----------------|
    |15                |TERM            |normale uccisione|
    |------------------+----------------+-----------------|
    |9                 |KILL            |uccisione forzata|
    +-----------------------------------------------------+


%

9.3.13. Pianificare compiti da eseguire una volta sola

    Per pianificare un compito da eseguire una volta soltanto
    eseguire il comando at(1) nel modo seguente.

    $ echo 'comando -argomenti'| at 3:40 monday

%

9.3.14. Pianificare compiti in modo regolare

    Per pianificare compiti in modo regolare usare cron(8). Vedere 
    crontab(1) e crontab(5).

    Si può pianificare l'esecuzione di processi come utente normale,
    ad esempio l'utente pippo, creando un file crontab(5) come "/var/
    spool/cron/crontabs/pippo" con il comando "crontab -e".

    Quello seguente è un esempio di file crontab(5).

    # usare /bin/sh per eseguire i comandi, qualsiasi cosa dica /etc/passwd
    SHELL=/bin/sh
    # inviare per posta l'output a paolo, chiunque sia il proprietario di questo crontab
    MAILTO=paolo
    # Min Ora GiornoMese Mese GiornoSett comando (Giorni... sono combinati con OR)
    # eseguito alle 00:05, ogni giorno
    5  0  *  * *   $HOME/bin/compito.quotidiano >> $HOME/tmp/output 2>&1
    # eseguito alle 14:15 il primo giorno di ogni mese -- output inviato a paolo
    15 14 1  * *   $HOME/bin/mensile
    # eseguito alle 22:00 nei giorni infrasettimanali(1-5), disturbare Gianni. % per a capo, ultimo % per cc:
    0 22 *   * 1-5 mail -s "Sono le 10pm" giannie%Gianni,%%dove sono i tuoi ragazzi?%.%%
    23 */2  2 *   echo "eseguito 23 minuti dopo le 0am, 2am, 4am ..., il giorno 1 Feb "
    5  4 *   * sun echo "eseguito alle 04:05 ogni domenica"
    # eseguito alle 03:40 il primo lunedi' di ogni mese
    40 3 1-7 * *   [ "$(date +%a)" == "Mon" ] && comando -opzioni

    Suggerimento

    Per i sistemi non in esecuzione in maniera continuata, installare
    il pacchetto anacron per pianificare l'esecuzione di comandi
    periodici, in maniera il più possibile vicina agli intervalli
    specificati, in base a quanto permesso dal tempo di attività
    della macchina. Vedere anacron(8) e anacrontab(5).

    Suggerimento

    Gli script con compiti pianificati di amministrazione del sistema
    possono essere eseguiti periodicamente dall'account di root,
    ponendoli in "/etc/cron.hourly/", "/etc/cron.daily/", "/etc/
    cron.weekly/" o "/etc/cron.monthly/". L'orario di esecuzione di
    questi script può essere personalizzato con "/etc/crontab" e "/
    etc/anacrontab".

%

9.3.15. Tasto Alt-SysRq

    L'opzione "Magic SysRq key" (tasto R Sist), di compilazione del
    kernel, che è ora lo standard per i kernel Debian, fornisce una
    garanzia contro i malfunzionamenti del sistema. Premendo Alt-R
    Sist seguito da uno dei tasti seguenti, si ottiene magicamente di
    recuperare il controllo del sistema.

    Tabella 9.11. Elenco di tasti per il comando SAK

    +---------------------------------------------------------------+
    | tasto premuto |            descrizione dell'azione            |
    |dopo Alt-R_Sist|                                               |
    |---------------+-----------------------------------------------|
    |r              |ripristina la tastiera dalla modalità raw dopo |
    |               |un crash di X                                  |
    |---------------+-----------------------------------------------|
    |               |cambia il livello di visualizzazione del       |
    |0              |registro sulla console a 0 per ridurre i       |
    |               |messaggi di errore                             |
    |---------------+-----------------------------------------------|
    |k              |uccide (kill) tutti i processi nella console   |
    |               |virtuale attuale                               |
    |---------------+-----------------------------------------------|
    |e              |invia un segnale SIGTERM a tutti i processi,   |
    |               |tranne init(8)                                 |
    |---------------+-----------------------------------------------|
    |i              |invia un segnale SIGKILL a tutti i processi,   |
    |               |tranne init(8)                                 |
    |---------------+-----------------------------------------------|
    |s              |sincronizza tutti i file system montati per    |
    |               |evitare corruzione di dati                     |
    |---------------+-----------------------------------------------|
    |u              |monta nuovamente tutti i file system in sola   |
    |               |letturra (umount)                              |
    |---------------+-----------------------------------------------|
    |b              |riavvia (reboot) il sistema senza sincronizzare|
    |               |o smontare i file system                       |
    +---------------------------------------------------------------+


    Suggerimento
   
    Leggere le pagine di manuale signal(7), kill(1) e sync(1) per
    capire la descrizione soprastante.

    La combinazione di "Alt-SysRq s", "Alt-SysRq u" e "Alt-SysRq r" è
    buona per uscire da situazioni veramente brutte e ottenere un
    accesso utilizzabile alla tastiera senza fermare il sistema.

    Vedere "/usr/share/doc/linux-doc-3.*/Documentation/sysrq.txt.gz".

    Attenzione

    La funzione Alt-R_Sist può essere considerata un rischio per la
    sicurezza dato che permette agli utenti l'accesso a funzioni con
    privilegi di root. Per disabilitale la funzione Alt-R_Sist
    mettere "echo 0 >/proc/sys/kernel/sysrq" in "/etc/rc.local" o
    "kernel.sysrq = 0" in "/etc/sysctl.conf".

    Suggerimento

    Si può usare la funzione Alt-R_Sist da un terminale SSH, ecc.
    scrivendo su "/proc/sysrq-trigger". Per esempio, "echo s > /proc/
    sysrq-trigger; echo u > /proc/sysrq-trigger" dal prompt di shell
    di root sincronizza ed esegue umount per tutti i file system
    montati.

9.4. Suggerimenti per l'amministrazione del sistema

%

9.4.1. Chi è nel sistema?

    Si può controllare chi è connesso al sistema nei modi seguenti.

      * who(1) mostra chi ha fatto il login ed è connesso.

      * w(1) mostra l'elenco di chi ha fatto il login ed è connesso e
        cosa sta facendo.
   
      * last(1) mostra l'elenco degli utenti che hanno fatto il login
        più recentemente.

      * lastb(1) mostra l'elenco degli utenti che hanno tentato il
        login non riuscendovi più recentemente.

    Suggerimento
   
    Queste informazioni sugli utenti sono contenute in "/var/run/
    utmp" e "/var/log/wtmp". Vedere login(1) e utmp(5).

%

9.4.2. Avvertire tutti gli utenti

    Si può mandare un messaggio a tutti gli utenti che sono connessi
    al sistema con wall(1) nel modo seguente.

    $ echo "Arresto pianificato del sistema tra 1 ora" | wall

%

9.4.3. Identificazione dell'hardware

    Per i dispositivi di tipo simil-PCI (AGP, PCI-Express, CardBus,
    ExpressCard, ecc.), lspci(8) (probabilmente con l'opzione "-nn")
    è un buon punto di partenza per l'identificazione dell'hardware.

    In alternativa, si può identificare l'hardware leggendo il
    contenuto di "/proc/bus/pci/devices" o sfogliando l'albero di
    directory in "/sys/bus/pci" (vedere Sezione 1.2.12, «procfs e
    sysfs»).

    Tabella 9.12. Elenco di strumenti per l'identificazione
    dell'hardware

    +---------------------------------------------------------------+
    | pacchetto |popcon|dimensione|           descrizione           |
    |-----------+------+----------+---------------------------------|
    |pciutils   |V:195,|196       |utilità PCI Linux: lspci(8)      |
    |           |I:992 |          |                                 |
    |-----------+------+----------+---------------------------------|
    |usbutils   |V:84, |324       |utilità Linux USB: lsusb(8)      |
    |           |I:862 |          |                                 |
    |-----------+------+----------+---------------------------------|
    |pcmciautils|V:13, |97        |utilità PCMCIA per Linux:        |
    |           |I:21  |          |pccardctl(8)                     |
    |-----------+------+----------+---------------------------------|
    |           |V:0,  |          |raccosta di strumenti per la     |
    |scsitools  |I:3   |390       |gestione dell'hardware SCSI:     |
    |           |      |          |lsscsi(8)                        |
    |-----------+------+----------+---------------------------------|
    |procinfo   |V:0,  |135       |informazioni sul sistema ottenute|
    |           |I:13  |          |da "/proc": lsdev(8)             |
    |-----------+------+----------+---------------------------------|
    |lshw       |V:12, |842       |informazioni sulla configurazione|
    |           |I:94  |          |hardware: lshw(1)                |
    |-----------+------+----------+---------------------------------|
    |discover   |V:41, |90        |sistema di identificazione       |
    |           |I:947 |          |dell'hardware: discover(8)       |
    +---------------------------------------------------------------+


%

9.4.4. Configurazione dell'hardware

    Sebbene nei moderni sistemi desktop con interfaccia grafica, come
    GNOME e KDE, la maggior parte della configurazione dell'hardware
    possa essere gestita attraverso strumenti di configurazione con
    interfaccia grafica da essi forniti, è bene conoscere alcuni
    metodi di base di configurazione.

    Tabella 9.13. Elenco di strumenti di configurazione dell'hardware

    +---------------------------------------------------------------+
    |    pacchetto    |popcon|dimensione|        descrizione        |
    |-----------------+------+----------+---------------------------|
    |                 |V:137,|          |utilità Linux per i tipi di|
    |console-setup    |I:959 |411       |carattere e la mappa di    |
    |                 |      |          |tastiera in console        |
    |-----------------+------+----------+---------------------------|
    |x11-xserver-utils|V:282,|511       |utilità del server X: xset |
    |                 |I:534 |          |(1), xmodmap(1)            |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |demone per gestire eventi  |
    |                 |      |          |inviati dall'ACPI (Advanced|
    |acpid            |V:145,|176       |Configuration and Power    |
    |                 |I:318 |          |Interface, interfaccia     |
    |                 |      |          |avanzata per configurazione|
    |                 |      |          |ed energia)                |
    |-----------------+------+----------+---------------------------|
    |                 |V:17, |          |utilità per mostrare       |
    |acpi             |I:302 |45        |informazioni sui device    |
    |                 |      |          |ACPI                       |
    |-----------------+------+----------+---------------------------|
    |                 |V:0,  |          |demone per sospendere un   |
    |sleepd           |I:0   |86        |portatile durante          |
    |                 |      |          |l'inattività               |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |ottimizzazione degli       |
    |                 |V:408,|          |accessi al disco fisso     |
    |hdparm           |I:718 |256       |(vedere Sezione 9.5.9,     |
    |                 |      |          |«Ottimizzare il disco      |
    |                 |      |          |rigido»)                   |
    |-----------------+------+----------+---------------------------|
    |                 |      |          |controllo e monitoraggio   |
    |smartmontools    |V:134,|2117      |dei sistemi di             |
    |                 |I:197 |          |archiviazione usando       |
    |                 |      |          |S.M.A.R.T.                 |
    |-----------------+------+----------+---------------------------|
    |                 |V:5,  |          |raccolta di strumenti per  |
    |setserial        |I:9   |117       |la gestione delle porte    |
    |                 |      |          |seriali                    |
    |-----------------+------+----------+---------------------------|
    |                 |V:1,  |          |raccolta di strumenti per  |
    |memtest86+       |I:29  |2391      |la gestione di hardware di |
    |                 |      |          |memoria                    |
    |-----------------+------+----------+---------------------------|
    |                 |V:0,  |          |raccolta di strumenti per  |
    |scsitools        |I:3   |390       |la gestione di hardware    |
    |                 |      |          |SCSI                       |
    |-----------------+------+----------+---------------------------|
    |setcd            |V:0,  |35        |ottimizzazione dell'accesso|
    |                 |I:1   |          |alle unità CD              |
    |-----------------+------+----------+---------------------------|
    |big-cursor       |I:1   |27        |puntatori del mouse più    |
    |                 |      |          |grandi per X               |
    +---------------------------------------------------------------+


    ACPI è un'infrastruttura per il sistema di gestione dell'energia
    più nuovo di APM

    Suggerimento
   
    La modifica della frequenza della CPU nei sistemi moderni è
    controllata da moduli del kernel come acpi_cpufreq.

%

9.4.5. Orario di sistema e hardware

    I comandi seguenti impostano l'ora di sistema e hardware a MM/GG
    hh:mm, AAAA.

    # date MMGGhhmmAAAA
    # hwclock --utc --systohc
    # hwclock --show

    Nei sistemi Debian, gli orari sono mostrati normalmente come ora
    locale, ma l'ora di sistema e quella hardware usano di solito
    l'ora UTC(GMT).

    Se l'ora hardware (BIOS) è impostata ad UTC, modificare
    l'impostazione nel file "/etc/default/rcS" ad "UTC=yes".

    Il comando seguente riconfigura il fuso orario utilizzato dal
    sistema Debian.

    # dpkg-reconfigure tzdata

    Se si desidera tenere aggiornata l'ora di sistema attraverso la
    rete, si consideri l'uso del servizion NTP con pacchetti come
    ntp, ntpdate e chrony.

    Suggerimento
   
    In systemd, usare invece systemd-timesyncd per l'ora di rete.
    Vedere systemd-timesyncd(8).

    Vedere la documentazione seguente.

      * Managing Accurate Date and Time HOWTO

      * Progetto servizi NTP pubblici

      * Il pacchetto ntp-doc

    Suggerimento
   
    ntptrace(8), nel pacchetto ntp può tracciare una catena di server
    NTP all'indietro fino alla fonte originaria.

%

9.4.6. Configurazione del terminale

    Ci sono diversi componenti per configurare le funzionalità della
    console a caratteri e il sistema ncurses(3).

      * Il file "/etc/terminfo/*/*" (terminfo(5))

      * La variabile d'ambiente "$TERM" (term(7))

      * setterm(1), stty(1), tic(1) e toe(1)

    :(Se, con un xterm non Debian, la voce terminfo per xterm non
    funziona, cambiare il tipo di terminale "$TERM" da "xterm" ad una
    delle versioni con funzionalità limitate come "xterm-r6" quando
    si fa il login ad un sistema Debian da remoto. Per ulteriori
    iedere "/usr/share/doc/libncurses5/FAQ" .

%

9.4.7. L'infrastruttura audio

    I driver di dispositivo per le schede audio per l'attuale Linux
    sono forniti da ALSA (Advanced Linux Sound Architecture). ALSA
    fornisce una modalità di emulazione per la compatibilità con il
    precedente sistema OSS (Open Sound System).

    Suggerimento
   
    Per testare l'altoparlante usare "cat /dev/urandom > /dev/audio"
    oppure speaker-test(1) (^C per interrompere).

    Suggerimento

    Se non si ottiene l'audio, è possibile che l'altroparlante sia
    connesso ad un output impostato come muto. I moderni sistemi
    sonori hanno svariati output. alsamixer(1) nel pacchetto
    alsa-utils è utile per configurare le impostazioni del volume e
    di muto.

    I software applicativi possono essere configurati non solo per
    accedere direttamente a device audio, ma anche per accedervi
    attraverso un qualche sistema server sonoro standardizzato.

    Tabella 9.14. Elenco di pacchetti relativi all'audio

    +---------------------------------------------------------------+
    |    pacchetto    |popcon|dimensione|        descrizione        |
    |-----------------+------+----------+---------------------------|
    |alsa-utils       |V:341,|2283      |utilità per configurare ed |
    |                 |I:476 |          |usare ALSA                 |
    |-----------------+------+----------+---------------------------|
    |                 |V:2,  |          |compatibilità OSS in ALSA  |
    |oss-compat       |I:29  |20        |per prevenire errori "/dev/|
    |                 |      |          |dsp not found"             |
    |-----------------+------+----------+---------------------------|
    |                 |V:4,  |          |server JACK (JACK Audio    |
    |jackd            |I:27  |9         |Connection Kit) (bassa     |
    |                 |      |          |latenza)                   |
    |-----------------+------+----------+---------------------------|
    |                 |V:1,  |          |libreria JACK (JACK Audio  |
    |libjack0         |I:13  |338       |Connection Kit) (bassa     |
    |                 |      |          |latenza)                   |
    |-----------------+------+----------+---------------------------|
    |nas              |V:0,  |243       |server NAS (Network Audio  |
    |                 |I:0   |          |System)                    |
    |-----------------+------+----------+---------------------------|
    |libaudio2        |V:60, |165       |libreria NAS (Network Audio|
    |                 |I:488 |          |System)                    |
    |-----------------+------+----------+---------------------------|
    |pulseaudio       |V:350,|6398      |server PulseAudio,         |
    |                 |I:471 |          |sostituto per ESD          |
    |-----------------+------+----------+---------------------------|
    |libpulse0        |V:289,|969       |libreria client PulseAudio,|
    |                 |I:604 |          |sostituto per ESD          |
    |-----------------+------+----------+---------------------------|
    |libgstreamer1.0-0|V:372,|5280      |GStreamer: motore audio di |
    |                 |I:574 |          |GNOME                      |
    |-----------------+------+----------+---------------------------|
    |libphonon4       |I:121 |680       |Phonon: motore audio di KDE|
    +---------------------------------------------------------------+


    Normalmente esiste un motore audio comune per ciascun ambiente
    desktop. Ciascun motore audio usato dalle applicazioni può
    scegliere di connettersi a diversi server audio.

%

9.4.8. Disabilitare il salvaschermo

    Per disabilitare il salvaschermo usare i comandi seguenti.

    Tabella 9.15. Elenco di comandi per disabilitare il salvaschermo

    +---------------------------------------------------------------+
    |                ambiente                 |       comando       |
    |-----------------------------------------+---------------------|
    |Console Linux                            |setterm -powersave   |
    |                                         |off                  |
    |-----------------------------------------+---------------------|
    |X Window (disabilitare il salvaschermo)  |xset s off           |
    |-----------------------------------------+---------------------|
    |X Window (disabilitare DPMS)             |xset -dpms           |
    |-----------------------------------------+---------------------|
    |X Window (configurazione tramite GUI del |xscreensaver-command |
    |salvaschermo)                            |-prefs               |
    +---------------------------------------------------------------+


%

9.4.9. Disabilitare i bip sonori

    Per disabilitare i bip sonori è sempre possibile disconnettere
    l'altoparlante del PC; la rimozione del modulo pcspkr del kernel
    fa stessa cosa per conto dell'utente.

    Il comando seguente evita che il programma readline(3) usato da 
    bash(1) emetta suoni bip quando incontra un carattere di allerta
    (ASCII=7).

    $ echo "set bell-style none">> ~/.inputrc

%

9.4.10. Uso della memoria

    Ci sono 2 risorse disponibile per l'utente per ottenere la
    situazione dell'uso della memoria.

      * I messaggi di avvio del kernel nel file "/var/log/dmesg"
        contengono la dimensione esatta della memoria disponibile.
   
      * free(1) e top(1) mostrano informazioni sulle risorse di
        memoria nel sistema mentre è in funzione.

    Ecco un esempio.

    # grep '\] Memory' /var/log/dmesg
    [    0.004000] Memory: 990528k/1016784k available (1975k kernel code, 25868k reserved, 931k data, 296k init)
    $ free -k
                 total       used       free     shared    buffers     cached
    Mem:        997184     976928      20256          0     129592     171932
    -/+ buffers/cache:     675404     321780
    Swap:      4545576          4    4545572

    Ci si potrebbe chiedere perché dmesg dice che ci sono 990 MB
    liberi e free -k dice che sono liberi 320 MB. Ne mancano più di
    600 MB.

    Non ci si deve preoccupare della grande dimensione del valore
    "used" (usata) e del piccolo valore di "free" (libera) nella riga
    "Mem:", ma si può invece leggere la riga sottostante (con 675404
    e 321780 nell'esempio precedente) e rilassarsi.

    Per il mio MacBook con 1GB=1048576k DRAM (il sistema video ne
    ruba un po'), vedo le informazioni seguenti.

    Tabella 9.16. Elenco di dimensioni della memoria riportate

    +------------------------------------------------------------+
    |            fonte            |          dimensione          |
    |-----------------------------+------------------------------|
    |Dimensione totale in dmesg   |1016784k = 1GB - 31792k       |
    |-----------------------------+------------------------------|
    |Libera in dmesg              |990528k                       |
    |-----------------------------+------------------------------|
    |Dimensione totale nella shell|997184k                       |
    |-----------------------------+------------------------------|
    |Libera nella shell           |20256k (ma in effetti 321780k)|
    +------------------------------------------------------------+


%

9.4.11. Verifica della sicurezza e dell'integrità del sistema

    Una cattiva manutenzione del sistema può esporlo ad attacchi
    esterni.

    Per verificare la sicurezza e l'integrità del sistema, si
    dovrebbe iniziare dai punti seguenti.

      * Il pacchetto debsums; vedere debsums(1) e Sezione 2.5.2,
        «File "Release" nella directory principale ed autenticità».

      * Il pacchetto chkrootkit; vedere chkrootkit(1).

      * La famiglia di pacchetti clamav; vedere clamscan(1) e 
        freshclam(1).

      * FAQ Debian Security.

      * Manuale Securing Debian.

    Tabella 9.17. Elenco di strumenti per verificare la sicurezza e
    l'integrità del sistema

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|           descrizione            |
    |----------+------+----------+----------------------------------|
    |          |V:8,  |          |demone per inviare via posta      |
    |logcheck  |I:10  |102       |anomalie nei file di registro di  |
    |          |      |          |sistema all'amministratore        |
    |----------+------+----------+----------------------------------|
    |          |V:5,  |          |utilità per controllare i file dei|
    |debsums   |I:42  |107       |pacchetti installati con le somme |
    |          |      |          |di controllo MD5                  |
    |----------+------+----------+----------------------------------|
    |chkrootkit|V:5,  |970       |rilevatore di rootkit             |
    |          |I:24  |          |                                  |
    |----------+------+----------+----------------------------------|
    |clamav    |V:13, |774       |utilità anti-virus per Unix -     |
    |          |I:58  |          |interfaccia a riga di comando     |
    |----------+------+----------+----------------------------------|
    |tiger     |V:2,  |7822      |riporta vulnerabilità nella       |
    |          |I:3   |          |sicurezza di sistema              |
    |----------+------+----------+----------------------------------|
    |tripwire  |V:2,  |11521     |strumento di controllo            |
    |          |I:3   |          |dell'integrità di file e directory|
    |----------+------+----------+----------------------------------|
    |john      |V:2,  |452       |strumento di violazione delle     |
    |          |I:12  |          |password attive                   |
    |----------+------+----------+----------------------------------|
    |          |V:1,  |          |AIDE - ambiente avanzato di       |
    |aide      |I:2   |2063      |rilevamento delle intrusioni -    |
    |          |      |          |binario statico                   |
    |----------+------+----------+----------------------------------|
    |integrit  |V:0,  |329       |programma di controllo            |
    |          |I:0   |          |dell'integrità di file            |
    |----------+------+----------+----------------------------------|
    |crack     |V:0,  |149       |programma per indovinare password |
    |          |I:1   |          |                                  |
    +---------------------------------------------------------------+


    Con il piccolo script seguente è possibile controllare la
    presenza di tipici errori con permessi di scrittura per tutti per
    i file sbagliati.

    # find / -perm 777 -a \! -type s -a \! -type l -a \! \( -type d -a -perm 1777 \)

    Attenzione

    Data che il pacchetto debsums usa le somme di controllo MD5
    salvate localmente, non può essere completamente affidabile come
    strumento di controllo della sicurezza del sistema contro
    attacchi malevoli.

%

9.5. Suggerimenti per l'archiviazione dei dati

    L'avvio del sistema con un CD live Linux o un CD del
    debian-installer in modalità ripristino rende semplice la
    riconfigurazione dell'archiviazione dei dati sul dispositivo di
    avvio.

%

9.5.1. Uso dello spazio su disco

    L'uso dello spazio su disco può essere valutato con i programmi
    forniti dai pacchetti mount, coreutils e xdu:

      * mount(8) mostra tutti i file system (= dischi) montati.

      * df(1) mostra l'uso dello spazio su disco da parte dei file
        system.

      * du(1) mostra l'uso dello spazio su disco da parte dell'albero
        di directory.

    Suggerimento

    Si può indirizzare l'output di du(8) a xdu(1x) per far sì che che
    produca la sua rappresentazione grafica e interattiva, usando "du
    -k . |xdu", "sudo du -k -x / |xdu", ecc.

%

9.5.2. Configurazione del partizionamento dei dischi

    Per la configurazione del partizionamento dei dischi, benché 
    fdisk(8) sia considerato lo strumento standard, parted(8) merita
    un po' di attenzione. "Dati di partizionamento del disco",
    "tabella delle partizioni", "mappa delle partizioni" e "etichetta
    del disco" sono tutti sinonimi.

    La maggior parte dei PC usa il classico schema basato su MBR
    (Master Boot Record) per contenere i dati sul partizionamento del
    disco nel primo settore, cioè il settore LBA 0 (512 byte).

    Nota

    Alcuni PC più recenti con EFI (Extensible Firmware Interface),
    compresi i Mac basati su Intel, usano lo schema GPT (GUID
    Partition Table) per contenere i dati sul partizionamento del
    disco non nel primo settore.

    Sebbene fdisk(8) sia stato lo strumento standard per il
    partizionamento dei dischi, parted(8) lo sta sostituendo.

    Tabella 9.18. Elenco di pacchetti di gestione delle partizioni
    dei dischi

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|   GPT    |      descrizione      |
    |----------+------+----------+----------+-----------------------|
    |          |V:891,|          |Non       |utilità di sistema     |
    |util-linux|I:999 |4598      |supportato|varie inclusi fdisk(8) |
    |          |      |          |          |e cfdisk(8)            |
    |----------+------+----------+----------+-----------------------|
    |          |      |          |          |programma GNU Parted   |
    |parted    |V:363,|304       |Supportato|per il                 |
    |          |I:561 |          |          |ridimensionamento delle|
    |          |      |          |          |partizioni dei dischi  |
    |----------+------+----------+----------+-----------------------|
    |          |V:19, |          |          |editor delle partizioni|
    |gparted   |I:132 |2046      |Supportato|di GNOME basato su     |
    |          |      |          |          |libparted              |
    |----------+------+----------+----------+-----------------------|
    |gdisk     |V:278,|852       |Supportato|editor delle partizioni|
    |          |I:513 |          |          |per i dischi GPT       |
    |----------+------+----------+----------+-----------------------|
    |          |V:16, |          |          |programma per creare la|
    |kpartx    |I:29  |87        |Supportato|mappatura a device per |
    |          |      |          |          |le partizioni          |
    +---------------------------------------------------------------+


    Attenzione

    Sebbene parted(8) sostenga di creare e ridimensionare anche i
    file system, è più sicuro fare queste cose usando gli strumenti
    specializzati meglio mantenuti, come mkfs(8) (mkfs.msdos(8), 
    mkfs.ext2(8), mkfs.ext3(8), mkfs.ext4(8), …) e resize2fs(8).

    Nota

    Per poter commutare tra GPT e MBR, è necessario cancellare
    direttamente i primi pochi blocchi del contenuto del disco
    (vedere Sezione 9.7.6, «Pulire il contenuto di file») e usare
    "parted /dev/sdx mklabel gpt" o "parted /dev/sdx mklabel msdos",
    per fare il cambiamento. Notare che in questo contesto è usato
    "msdos" per MBR.

%

9.5.3. Accedere alle partizioni usando UUID

    Anche se la riconfigurazione delle partizioni o l'ordine di
    attivazione di supporti di archiviazione removibili può portare
    ad avere nomi diversi per le partizioni, è possibili accedere ad
    esse in modo coerente. Ciò è utile anche se si hanno più dischi
    ed il BIOS non assegna loro un nome di dispositivo costante.

      * mount(8) con l'opzione "-U" può montare un device a blocchi
        usando l'UUID invece di usare il suo nome di file come "/dev/
        sda3".
   
      * Il file "/etc/fstab" (vedere fstab(5)) può usare gli UUID.

      * Anche i bootloader (Sezione 3.1.2, «Stadio 2: il bootloader»)
        possono usare gli UUID.

    Suggerimento
   
    Si può scoprire l'UUID di un device a blocchi speciale con blkid
    (8).

    Suggerimento

    I nodi di device dei dispositivi come i supporti di archiviazione
    rimovibili possono essere resi statici usando regole udev, se
    necessario. Vedere Sezione 3.3, «Il sistema udev».

%

9.5.4. LVM2

    LVM2 è un gestore di volumi logici per il kernel Linux. Con LVM2
    si possono creare partizioni dei dischi in volumi logici invece
    che sugli hard disk fisici.

    LVM richiede quanto segue.

      * la gestione di device-mapper nel kernel Linux (predefinita
        per i kernel Debian)

      * la libreria per la gestione di device-mapper in spazio utente
        (pacchetto libdevmapper*)

      * gli strumenti LVM2 in spazio utente (pacchetto lvm2)

    Per iniziare a comprendere LVM2 guardare le pagine di manuale
    seguenti.

      * lvm(8): Principi di base del meccanismo LVM2 (elenco di tutti
        i comandi di LVM2)

      * lvm.conf(5): File di configurazione per LVM2
   
      * lvs(8): Riporta informazioni sui volumi logici

      * vgs(8): Riporta informazioni sui gruppi di volumi

      * pvs(8): Riporta informazioni sui volumi fisici

%

9.5.5. Configurazione del file system

    Per il file system ext4, il pacchetto e2fsprogs fornisce gli
    strumenti seguenti.

      * mkfs.ext3(8) per creare nuovi file system ext4

      * fsck.ext4(8) per controllare e riparare file system ext4
        esistenti

      * tune2fs(8) per configurare i superblocchi di un file system
        ext4

      * debugfs(8) per fare il debug di file system ext4 in modo
        interattivo. (Ha un comando undel per ripristinare file
        eliminati.)

    I comandi mkfs(8) e fsck(8) sono forniti dal pacchetto e2fsprogs
    come front-end per vari programmi dipendenti dal file syste
    (mkfs.tipofs e fsck.tipofs). Per il file system ext4 , sono 
    mkfs.ext4(8) e fsck.ext4(8) (sono un collegamento simbolico a 
    mke2fs(8) e e2fsck(8)).

    Sono disponibili comandi simili per ciascun file system
    supportato da Linux.

    Tabella 9.19. Elenco di pacchetti di gestione dei file system

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|          descrizione          |
    |-------------+------+----------+-------------------------------|
    |e2fsprogs    |V:576,|1449      |utilità per i file system ext2/|
    |             |I:999 |          |ext3/ext4                      |
    |-------------+------+----------+-------------------------------|
    |reiserfsprogs|V:11, |1132      |utilità per i file system      |
    |             |I:29  |          |Reiserfs                       |
    |-------------+------+----------+-------------------------------|
    |dosfstools   |V:128,|235       |utilità per i file system FAT  |
    |             |I:524 |          |(Microsoft: MS-DOS, Windows)   |
    |-------------+------+----------+-------------------------------|
    |xfsprogs     |V:21, |3191      |utilità per i file system XFS  |
    |             |I:98  |          |(SGI: IRIX)                    |
    |-------------+------+----------+-------------------------------|
    |ntfs-3g      |V:186,|1479      |utilità per i file system NTFS |
    |             |I:512 |          |(Microsoft: Windows NT, …)     |
    |-------------+------+----------+-------------------------------|
    |jfsutils     |V:1,  |1577      |utilità per i file system JFS  |
    |             |I:12  |          |(IBM: AIX, OS/2)               |
    |-------------+------+----------+-------------------------------|
    |reiser4progs |V:0,  |1373      |utilità per i file system      |
    |             |I:4   |          |Reiser4                        |
    |-------------+------+----------+-------------------------------|
    |hfsprogs     |V:0,  |356       |utilità per i file system HFS e|
    |             |I:8   |          |HFS Plus (Apple: Mac OS)       |
    |-------------+------+----------+-------------------------------|
    |btrfs-progs  |V:38, |4027      |utilità per i file system Btrfs|
    |             |I:64  |          |                               |
    |-------------+------+----------+-------------------------------|
    |             |V:3,  |          |programma per impostare a 0 i  |
    |zerofree     |I:94  |25        |blocchi liberi in file system  |
    |             |      |          |ext2/3/4                       |
    +---------------------------------------------------------------+


    Suggerimento

    Il file system Ext4 è il predefinito per il sistema Linux e il
    suo uso è caldamente raccomandato a meno che non sia abbiano
    specifiche ragioni per non farlo.

    Suggerimento

    Il file system Btrfs è disponibile nel kernel Linux 3.2 (Debian
    wheezy). Dovrebbe diventare il prossimo file system predefinito
    dopo quello ext4.

    Avvertimento

    Non si dovrebbe ancora usare il file system Btrfs per i propri
    dati importanti prima che abbia la funzionalità fsck(8) live in
    spazio kernel e il supporto nel bootloader.

    Suggerimento

    Alcuni strumenti permettono l'accesso a file system non
    supportati del kernel Linux (vedere Sezione 9.7.2, «Manipolare
    file senza montare i dischi»).

%

9.5.6. Creare file system e verificarne l'integrità

    In un sistema Linux, il comando mkfs(8) crea i file system ed il
    comando fsck(8) fornisce funzioni di controllo dell'integrità e
    di riparazione dei file system.

    Debian ora in modo predefinito non fa fsck periodici dopo la
    creazione del file system.

    Attenzione
   
    In generale l'esecuzione di fsck su file system montati non è
    sicura.

    Suggerimento

    Si può eseguire in modo sicuro il comando fsck(8) su tutti i file
    system, incluso il file system radice, al riavvio impostando
    "enable_periodic_fsck" in "/etc/mke2fs.conf" e il conteggio
    massimo di montaggi a 0 usando "tune2fs -c0 /dev/
    <nome_partizione>". Vedere mke2fs.conf(5) e tune2fs(8).

    Suggerimento
   
    Per vedere i risultati del comando fsck(8) avviato dallo script
    di avvio, controllare i file in "/var/log/fsck/".

%

9.5.7. Ottimizzare il file system con opzioni di mount

    La configurazione statica di base del file system è fornita da «/
    etc/fstab». Ad esempio,

    # <file system> <punto di mount>   <tipo>  <opzioni>       <dump>  <pass>
    proc            /proc           proc    defaults        0       0
    UUID=709cbe4c-80c1-56db-8ab1-dbce3146d2f7 / ext4 noatime,errors=remount-ro 0 1
    UUID=817bae6b-45d2-5aca-4d2a-1267ab46ac23 none swap sw  0       0
    /dev/scd0       /media/cdrom0   udf,iso9660 user,noauto 0       0

    Suggerimento

    Per identificare un dispositivo a blocchi si può usare il suo
    UUID (vedere Sezione 9.5.3, «Accedere alle partizioni usando
    UUID») invece del normale nome di device a blocchi quale «/dev/
    sda1», «/dev/sda2», …

    Le prestazioni e le caratteristiche di un file system possono
    essere ottimizzate usando per esso opzioni per il montaggio
    (vedere fstab(5) e mount(8)).Alcune opzioni importanti sono le
    seguenti.

      * L'opzione "defaults" implica le opzioni predefinite:
        "rw,suid,dev,exec,auto,nouser,async". (Uso generico)

      * L'opzione "noatime" o "relatime" è molto efficace nel
        velocizzare l'accesso in lettura. (Uso generico)

      * L'opzione "user" permette ad un normale utente di montare il
        file system. Questa opzione implica la combinazione di
        opzioni "noexec,nosuid,nodev". (Uso generico, usato per CD o
        dispositivi di archiviazione USB)
   
      * La combinazione di opzioni "noexec,nodev,nosuid" è usata per
        migliorare la sicurezza. (Uso generico)

      * L'opzione "noauto" limita il montaggio solamente a quando
        esplicitamente richiesto. (Uso generico)

      * L'opzione "data=journal" per ext3fs può migliorare la
        salvaguardia dell'integrità dei dati contro interruzioni
        dell'alimentazione a prezzo della perdita di un po' di
        velocità in scrittura.

    Suggerimento

    Per utilizzare una modalità di journaling non predefinita per il
    file system root, è necessario fornire i parametri di avvio del
    kernel (vedere Sezione 3.1.2, «Stadio 2: il bootloader»), ad
    esempio "rootflags=data=journal". Per lenny la modalità di
    journaling predefinita è "rootflags=data=ordered"; per squeeze è
    "rootflags=data=writeback".

%

9.5.8. Ottimizzare il file system tramite il superblocco

    Le caratteristiche di un file system possono essere ottimizzate
    attraverso il suo superblocco usando il comando tune2fs(8).

      * L'esecuzione di "sudo tune2fs -l /dev/hda1" mostra il
        contenuto del superblocco del file system in "/dev/hda1".

      * L'esecuzione di "sudo tune2fs -c 50 /dev/hda1" cambia per "/
        dev/hda1" la frequenza dei controlli dei file system
        (l'esecuzione di fsck all'avvio) a 50 avvii.

      * L'esecuzione di "sudo tune2fs -j /dev/hda1" aggiunge la
        funzionalità di journaling al file system in "/dev/hda1",
        cioè converte il file system da ext2 a ext3. (Eseguire questo
        comando su file system non montati.)

      * L'esecuzione di "sudo tune2fs -O extents,uninit_bg,dir_index
        /dev/hda1 && fsck -pf /dev/hda1" converte il filesystem in "/
        dev/hda1" da ext3 a ext4. (Eseguire questo comando su file
        system non montati.)

    Suggerimento
   
    Nonostante il suo nome, tune2fs(8) non funziona soltanto sui file
    system ext2, ma anche sui file system ext3 e ext4.

%

9.5.9. Ottimizzare il disco rigido

    Avvertimento

    Prima di giocare con la configurazione dei dischi controllare il
    proprio hardware e leggere la pagina man di hdparam(8), perché è
    una cosa piuttosto pericolosa per l'integrità dei dati.

    Si può testare la velocità di accesso ai dischi di un disco
    rigido, ad esempio "/dev/hda" con "hdparm -tT /dev/hda". È
    possibile velocizzare alcuni dischi fissi connessi con (E)IDE con
    "hdparm -q -c3 -d1 -u1 -m16 /dev/hda" che abilita il "supporto
    (E)IDE per I/O a 32 bit", l'uso dell'opzione "using_dma", imposta
    l'opzione "interrupt-unmask" e imposta l'"I/O di settori multipli
    a 16" (pericoloso!).

    Si possono testare le capacità della cache in scrittura di un
    disco fisso, ad esempio "/dev/sda", con "hdparm -W /dev/sda". Si
    può disabilitare la funzionalità di cache in scrittura con
    "hdparm -W 0 /dev/sda".

    Potrebbe essere possibile leggere CDROM masterizzati male in
    unità CD-ROM moderne ad alta velocità rallentandole con "setcd -x
    2".

%

9.5.10. Ottimizzare le unità a stato solido

    Le prestazioni e l'usura dei dischi delle unità a stato solido
    (SSD) possono essere ottimizzate nel modo seguente.

      * Usare il kernel Linux più recente (>= 3.2).

      * Ridurre le scritture su disco per gli accessi in lettura.

          + Impostare l'opzione di montaggio "noatime" o "relatime"
            in /etc/fstab.

      * Abilitare il comando TRIM.

          + Impostare l'opzione di montaggio "discard" in /etc/fstab
            per il file system ext4, le partizioni di swap, Btrfs,
            ecc. Vedere fstab(5).

          + Impostare l'opzione "discard" in /etc/lvm/lvm.conf per
            LVM. Vedere lvm.conf(5).

          + Impostare l'opzione "discard" in /etc/crypttab per
            dm-crypt. Vedere crypttab(5).

      * Abilitare lo schema di allocazione dello spazio su disco
        ottimizzato SSD.

          + Impostare l'opzione di mountaggio "ssd" in /etc/fstab per
            Btrfs.

      * Fare sì che il sistema muova tutti i dati su disco ogni 10
        minuti sui PC portatili.

          + Impostare l'opzione di montaggio "commit=600" in /etc/
            fstab. Vedere fstab(5).

          + Impostare pm-utils in modo che usi la modalità
            laptop-mode anche quando collegato alla rete elettrica.
            Vedere Debian BTS #659260.

    Avvertimento

    Modificare l'intervallo di scrittura dei dati dai normali 5
    secondi a 10 minuti rende i dati vulnerabili in caso di mancanza
    di corrente.

%

9.5.11. Usare SMART per prevedere danni ai dischi fissi

    Con il demone smartd (8) è possibile monitorare e registrare i
    dischi fissi che sono conformi a SMART.

     1. Abilitare la funzionalità SMART nel BIOS.

     2. Installare il pacchetto smartmontools.

     3. Identificare i dispositivi dei dischi fissi usando df(1).

          + Si supponga che uno dei dispositivi dei dischi fissi da
            monitorare sia "/dev/hda".

     4. Controllare l'output di "smartctl -a /dev/hda" per vedere se
        la funzionalità SMART è veramente abilitata.

          + Se non la è, abilitarla con "smartctl -s on -a /dev/hda".

     5. Abilitare l'esecuzione del demone smartd(8) nel modo
        seguente.

          + Rimuovere il carattere iniziale di commento dalla riga
            "start_smartd=yes" nel file "/etc/default/smartmontools".

          + Riavviare il demone smartd(8) con il comando "sudo /etc/
            init.d/smartmontools restart".

    Suggerimento

    Il demone smartd(8) può essere personalizzato con il file /etc/
    smartd.conf, incluso per ciò che riguarda le notifiche dei
    messaggi di avvertimento.

9.5.12. Specificare una directory per l'archiviazione di dati
temporanei usando $TMPDIR

    Le applicazioni creano file temporanei normalmente nella
    directory di memorizzazione temporanea «/tmp». Se «/tmp» non
    contiene abbastanza spazio, si può specificare una directory di
    memorizzazione temporanea usando la variabile $TMPDIR per i
    programmi che si comportano in modo corretto.

%

9.5.13. Espandere lo spazio di archiviazione utilizzabile con LVM

    Le partizioni create al momento dell'installazione su LVM
    (Logical Volume Manager (funzionalità di Linux) possono essere
    facilmente ridimensionate concatenando ad esse delle estensioni o
    suddividendo le loro estensioni su dispositivi di archiviazione
    multipli senza riconfigurazioni importanti del sistema.

9.5.14. Espandere lo spazio di archiviazione utilizzabile montando
un'altra partizione

    Se è disponibile una nuova partizione vuota (per esempio "/dev/
    sdx"), la si può formattare con mkfs.ext4(1) e montarla con mount
    (8) in una directory in cui è necessario avere più spazio. (È
    necessario copiare il contenuto originale della directory.)

    $ sudo mv dir-da-usare vecchia-dir
    $ sudo mkfs.ext34 /dev/sdx
    $ sudo mount -t ext4 /dev/sdx dir-da-usare
    $ sudo cp -a vecchia-dir/* dir-da-usare
    $ sudo rm -rf vecchia-dir

    Suggerimento

    In alternativa si può montare un file immagine vuoto del disco
    (vedere Sezione 9.6.5, «Creare un file con immagine di disco
    vuoto») come device loop (vedere Sezione 9.6.3, «Montare un file
    con un'immagine di disco»). Il reale uso del disco cresce mano a
    mano che vengono archiviati i dati.

9.5.15. Espandere lo spazio di archiviazione utilizzabile montando un
collegamento ad un'altra directory

    Se è disponibile una directory vuota (ad esempio "/percorso/della
    /dir-vuota") in un'altra partizione con spazio disponibile, si
    può, usando mount(8) con l'opzione "--bind", montarla in una
    directory (ad esempio "dir-di-lavoro") dove è necessario più
    spazio.

    $ sudo mount --bind /percorso/della/dir-vuota dir-di-lavoro

9.5.16. Espandere lo spazio di archiviazione utilizzabile montando
un'altra directory da sovrapporre

    Se è disponibile dello spazio utilizzabile in un'altra partizione
    (ad esempio "/percorso/della/vuota" e "/percorso/di/lavoro"), si
    può creare in essa una directory e impilarla in una vecchia
    directory (es., "/percorso/della/vecchia") in cui si ha bisogno
    di spazio usando OverlayFS con un kernel Linux 3.18 o successivo
    (Debian Stretch 9.0 o successiva).

    $ sudo mount -t overlay overlay \
      -olowerdir=/percorso/della/vecchia,upperdir=/percorso/della/vuota,workdir=/percorso/di/lavoro

    Qui, "/percorso/della/vuota" e "/percorso/di/lavoro" devono
    essere nella partizione abilitata in lettura e scrittura da
    scrivere in "/percorso/della/vecchia".

9.5.17. Espandere lo spazio di archiviazione utilizzabile usando
collegamenti simbolici

    Attenzione

    Questo è un metodo deprecato. Certo software può non funzionare
    bene con i "collegamenti simbolici ad una directory". Usare
    invece gli approcci che usano il "mount" descritti in precedenza.

    Se è disponibile una directory vuota (ad esempio "/percorso/della
    /dir-vuota" in un'altra partizione con spazio disponibile, si può
    creare un collegamento simbolico alla directory con ln(8).

    $ sudo mv dir-da-usare vecchia-dir
    $ sudo mkdir -p /percorso/della/dir-vuota
    $ sudo ln -sf /percorso/della/dir-vuota dir-da-usare
    $ sudo cp -a vecchia-dir/* dir-da-usare
    $ sudo rm -rf vecchia-dir

    Avvertimento

    Non usare un "collegamento simbolico ad una directory" per le
    directory gestite dal sistema, come "/opt". Un collegamento
    simbolico simile potrebbe essere sovrascritto quando il sistema
    viene aggiornato.

%

9.6. Immagine del disco

    Questa sezione tratta della manipolazione di immagini di dischi.

%

9.6.1. Creare un file con un'immagine di disco

    Si può creare un file di immagine del disco, "disco.img", di un
    dispositivo non montato, ad esempio la seconda unità SCSI o
    serial ATA "/dev/sdb" usando cp(1) o dd(1) nel modo seguente.

    # cp /dev/sdb disco.img
    # dd if=/dev/sdb of=disco.img

    Si può creare l'immagine del disco del MBR (master boot record)
    dei PC tradizionali (vedere Sezione 9.5.2, «Configurazione del
    partizionamento dei dischi»), che risiede nel primo settore del
    disco IDE primario usando dd(1) nel modo seguente.

    # dd if=/dev/hda of=mbr.img bs=512 count=1
    # dd if=/dev/hda of=mbr-nopart.img bs=446 count=1
    # dd if=/dev/hda of=mbr-part.img skip=446 bs=1 count=66

      * "mbr.img": MBR con tabella delle partizioni

      * "mbr-nopart.img": MBR senza tabella delle partizioni

      * "mbr-part.img": solamente la tabella delle partizioni
        nell'MBR

    Se il disco di avvio è un un dispositivo SCSI o serial ATA,
    sostituire "/dev/hda" con "/dev/sda".

    Se si sta creando l'immagine di una partizione del disco
    originale, sostituire "/dev/hda" con "/dev/hda1", ecc.

%

9.6.2. Scrivere direttamente sul disco

    Il file immagine del disco, "disco.img" può essere scritto in un
    dispositivo non montato, ad esempio la seconda unità SCSI "/dev/
    sdb" di dimensione corrispondente nel modo seguente.

    # dd if=disco.img of=/dev/sdb

    Analogamente il file immagine di una partizione del disco,
    "partizione.img" può essere scritto in una partizione non
    montata, ad esempio la prima partizione della seconda unità SCSI
    "/dev/sdb1" di dimensione corrispondente nel modo seguente.

    # dd if=partizione.img of=/dev/sdb1

%

9.6.3. Montare un file con un'immagine di disco

    Un'immagine di disco "partizione.img" contenente l'immagine di
    un'unica partizione, può essere montata e smontata usando il
    device loop nel modo seguente.

    # losetup -v -f partizione.img
    Loop device is /dev/loop0
    # mkdir -p /mnt/loop0
    # mount -t auto /dev/loop0 /mnt/loop0
    ...bla...bla...bla
    # umount /dev/loop0
    # losetup -d /dev/loop0

    Questo può essere semplificato nel modo seguente.

    # mkdir -p /mnt/loop0
    # mount -t auto -o loop partizione.img /mnt/loop0
    ...bla...bla...bla
    # umount partizione.img

    Ogni partizione di un'immagine di disco "disco.img" contentente
    più partizioni, può essere montata usando il device loop. Dato
    che quest'ultimo non gestisce in modo predefinito le partizioni,
    è necessario riconfigurarlo nel modo seguente.

    # modinfo -p loop # verifica la capacita del kernel
    max_part:Maximum number of partitions per loop device
    max_loop:Maximum number of loop devices
    # losetup -a # verifica che nulla stia usando il device loop
    # rmmod loop
    # modprobe loop max_part=16

    Ora il device loop può gestire fino a 16 partizioni.

    # losetup -v -f disco.img
    Loop device is /dev/loop0
    # fdisk -l /dev/loop0

    Disk /dev/loop0: 5368 MB, 5368709120 bytes
    255 heads, 63 sectors/track, 652 cylinders
    Units = cylinders of 16065 * 512 = 8225280 bytes
    Disk identifier: 0x452b6464

          Device Boot      Start         End      Blocks   Id  System
    /dev/loop0p1               1         600     4819468+  83  Linux
    /dev/loop0p2             601         652      417690   83  Linux
    # mkdir -p /mnt/loop0p1
    # mount -t ext4 /dev/loop0p1 /mnt/loop0p1
    # mkdir -p /mnt/loop0p2
    # mount -t ext4 /dev/loop0p2 /mnt/loop0p2
    ...bla...bla...bla
    # umount /dev/loop0p1
    # umount /dev/loop0p2
    # losetup -d /dev/loop0

    In alternativa, un risultato simile può essere ottenuto
    utilizzando i device mapper creati da kpartx(8), contenuto nel
    pacchetto kpartx, nel modo seguente.

    # kpartx -a -v disco.img
    ...
    # mkdir -p /mnt/loop0p2
    # mount -t ext4 /dev/mapper/loop0p2 /mnt/loop0p2
    ...
    ...bla...bla...bla
    # umount /dev/mapper/loop0p2
    ...
    # kpartx -d /mnt/loop0

    Nota

    È anche possibile montare una singola partizione di una tale
    immagine di disco con un device loop indicando un offset per
    saltare l'MBR, ecc., ma questo metodo è più esposto agli errori.

%

9.6.4. Pulire un file con un'immagine di disco

    Si può pulire un file con immagine di disco "disco.img" da tutti
    i file cancellati creando un'immagine pulita "nuova.img" nel modo
    seguente.

    # mkdir vecchia; mkdir nuova
    # mount -t auto -o loop disco.img vecchia
    # dd bs=1 count=0 if=/dev/zero of=nuova.img seek=5G
    # mount -t auto -o loop nuova.img nuova
    # cd vecchia
    # cp -a --sparse=always ./ ../nuova/
    # cd ..
    # umount nuova.img
    # umount disco.img

    Se "disco.img" è in ext2, ext3 o ext4, si può anche usare 
    zerofree(8), contenuto nel pacchetto zerofree, nel modo seguente.

    # losetup -f -v disco.img
    Loop device is /dev/loop3
    # zerofree /dev/loop3
    # cp --sparse=always disco.img nuovo.img

%

9.6.5. Creare un file con immagine di disco vuoto

    Si può creare un'immagine di disco vuota "disco.img", che può
    crescere fino a 5GiB, usando dd(1) nel modo seguente.

    $ dd bs=1 count=0 if=/dev/zero of=disco.img seek=5G

    È possibile creare un file system ext4 in questa immagine di
    disco, "disco.img" usando il device loop nel modo seguente.

    # losetup -f -v disco.img
    Loop device is /dev/loop1
    # mkfs.ext4 /dev/loop1
    ...bla...bla...bla
    # losetup -d /dev/loop1
    $ du  --apparent-size -h disco.img
    5.0G  disco.img
    $ du -h disco.img
    83M disco.img

    La dimensione del file "disco.img" è di 5.0GiB e il suo effettivo
    uso del disco è di soli 83MiB. Questa discrepanza è resa
    possibile dal fatto che il file system ext4 può contentere file
    sparsi.

    Suggerimento
   
    L'uso effettivo del disco dei file sparsi cresce insieme ai dati
    che in essi sono scritti.

    Usando operazioni simili su device creati dal device loop o dal
    device mapper, come in Sezione 9.6.3, «Montare un file con
    un'immagine di disco», si può partizionare tale immagine di disco
    "disco.img" usando parted(8) o fdisk(8) e si può creare in essa
    file system usando mkfs.ext4(8), mkswap(8), ecc.

%

9.6.6. Creare un file con un'immagine ISO9660

    Si può creare un file immagine ISO9660 "cd.iso" dell'albero di
    directory originale in "directory_sorgente" usando genisoimage(1)
    fornito da cdrkit nel modo seguente.

    #  genisoimage -r -J -T -V ID_volume -o cd.iso directory_sorgente

    Analogamente, si può creare un file immagine ISO9660 avviabile,
    "cdboot.iso", da un albero di directory simile a quello del
    debian-installer in "directory_sorgente" nel modo seguente.

    #  genisoimage -r -o cdboot.iso -V ID_volume \
       -b isolinux/isolinux.bin -c isolinux/boot.cat \
       -no-emul-boot -boot-load-size 4 -boot-info-table directory_sorgente

    In questo esempio viene usato per l'avvio il bootloader Isolinux
    (vedere Sezione 3.1.2, «Stadio 2: il bootloader»).

    Si può calcolare il valore md5sum e creare l'immagine ISO9660
    direttamente dal device CD-ROM nel modo seguente.

    $ isoinfo -d -i /dev/cdrom
    CD-ROM is in ISO 9660 format
    ...
    Logical block size is: 2048
    Volume size is: 23150592
    ...
    # dd if=/dev/cdrom bs=2048 count=23150592 conv=notrunc,noerror | md5sum
    # dd if=/dev/cdrom bs=2048 count=23150592 conv=notrunc,noerror > cd.iso

    Avvertimento

    Per ottenere un risultato corretto, si deve accuratamente evitare
    il bug di Linux riguardante il read ahead del file system
    ISO9660, come nell'esempio precedente.

%

9.6.7. Scrivere direttamente sul CD/DVD-R/RW

    Suggerimento
   
    Per wodim(1), fornito da cdrkit, un DVD è semplicemente un grande
    CD.

    Si può trovare un device utilizzabile usando il comando seguente.

    # wodim --devices

    Poi si inserisce un CD-R vergine nell'unità CD e si scrive il
    file immagine ISO9660 "cd.iso" su questo device, ad esempio "/dev
    /hda", usando wodim(1) nel modo seguente.

    # wodim -v -eject dev=/dev/hda cd.iso

    Se viene usato un CD-RW invece di un CD-R, usare quest'altro
    comando.

    # wodim -v -eject blank=fast dev=/dev/hda cd.iso

    Suggerimento

    Se il sistema desktop usato monta automaticamente i CD, prima di
    usare wodim(1) smontarlo usando dalla console "sudo umount /dev/
    hda".

%

9.6.8. Montare un file con un'immagine ISO9660

    Se "cd.iso" contiene un'immagine ISO9660, lo si può montare
    manualmente in "/cdrom" usando il comando seguente.

    # mount -t iso9660 -o ro,loop cd.iso /cdrom

    Suggerimento

    I sistemi desktop moderni possono montare automaticamente i
    supporti removibili come i CD in formato ISO9660 (vedere
    Sezione 10.1.7, «Supporti di archiviazione removibili»).

%

9.7. I dati binari

    Questa sezione tratta della manipolazione diretta dei dati binari
    su supporti di archiviazione.

%

9.7.1. Visualizzare e modificare dati binari

    Il metodo di visualizzazione dei dati binai più basilare è l'uso
    del comando "od -t x1".

    Tabella 9.20. Elenco di pacchetti che visualizzano e modificano
    dati binari

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|         descrizione         |
    |---------------+------+----------+-----------------------------|
    |               |V:891,|          |pacchetto base che contiene  |
    |coreutils      |I:999 |17478     |od(1) per fare il dump di    |
    |               |      |          |file (HEX, ASCII, OCTAL, …)  |
    |---------------+------+----------+-----------------------------|
    |               |      |          |pacchetto di utilità che     |
    |bsdmainutils   |V:60, |26        |contiene hd(1) per fare il   |
    |               |I:996 |          |dump di file (HEX, ASCII,    |
    |               |      |          |OCTAL, …)                    |
    |---------------+------+----------+-----------------------------|
    |hexedit        |V:1,  |72        |visualizzatore ed editor     |
    |               |I:12  |          |binario (HEX, ASCII)         |
    |---------------+------+----------+-----------------------------|
    |bless          |V:0,  |1028      |editor esadecimale completo  |
    |               |I:4   |          |(GNOME)                      |
    |---------------+------+----------+-----------------------------|
    |okteta         |V:1,  |1508      |editor esadecimale completo  |
    |               |I:15  |          |(KDE4)                       |
    |---------------+------+----------+-----------------------------|
    |ncurses-hexedit|V:0,  |132       |visualizzatore ed editor     |
    |               |I:2   |          |binario (HEX, ASCII, EBCDIC) |
    |---------------+------+----------+-----------------------------|
    |               |V:0,  |          |visualizzatore ed editor     |
    |beav           |I:0   |133       |binario (HEX, ASCII, EBCDIC, |
    |               |      |          |OCTAL, …)                    |
    +---------------------------------------------------------------+


    Suggerimento

    HEX è usato come acronimo per il formato esadecimale con base 16.
    OCTAL è usato per il formato ottale con base 8. ASCII è usato per
    American Standard Code for Information Interchange, cioè la
    normale codifica per testi in inglese. EBCDIC è usato per
    Extended Binary Coded Decimal Interchange Code usato nei sistemi
    operativi deimainframe IBM.

%

9.7.2. Manipolare file senza montare i dischi

    Esistono strumenti per leggere e scrivere file senza montare i
    dischi.

    Tabella 9.21. Elenco di pacchetti per manipolare file senza
    montare i dischi

    +---------------------------------------------------------------+
    |pacchetto| popcon |dimensione|           descrizione           |
    |---------+--------+----------+---------------------------------|
    |mtools   |V:10,   |389       |utilità per file MSDOS senza     |
    |         |I:83    |          |montarli                         |
    |---------+--------+----------+---------------------------------|
    |hfsutils |V:0, I:7|1884      |utilità per file HFS e HFS+ senza|
    |         |        |          |montarli                         |
    +---------------------------------------------------------------+


%

9.7.3. Dati ridondanti

    I sistemi software RAID offerti dal kernel Linux forniscono un
    livello di ridondanza dei dati nel file system a livello del
    kernel, allo scopo di ottenere una più alta affidabilità
    dell'archiviazione.

    Esistono strumenti per aggiungere dati ridondanti a file a
    livello di programmi applicativi per ottenere anche in questo
    modo una più alta affidabilità dell'archiviazione.

    Tabella 9.22. Elenco di strumenti per aggiungere dati ridondanti
    a file

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|           descrizione            |
    |----------+------+----------+----------------------------------|
    |          |V:4,  |          |insiemi di volumi di archivi di   |
    |par2      |I:15  |271       |parità, per controllare e riparare|
    |          |      |          |file                              |
    |----------+------+----------+----------------------------------|
    |          |V:0,  |          |protezione contro perdita di dati/|
    |dvdisaster|I:2   |1741      |graffi/invecchiamento di supporti |
    |          |      |          |CD/DVD                            |
    |----------+------+----------+----------------------------------|
    |          |V:0,  |          |strumento di backup che usa       |
    |dvbackup  |I:0   |413       |camcorder MiniDV (fornisce rsbep  |
    |          |      |          |(1))                              |
    |----------+------+----------+----------------------------------|
    |vdmfec    |V:0,  |97        |recupera blocchi perduti usando   |
    |          |I:0   |          |Forward Error Correction          |
    +---------------------------------------------------------------+


%

9.7.4. recupero di file dati ed analisi forensi

    Esistono strumenti per recuperare file dati e fare analisi
    forensi.

    Tabella 9.23. Elenco di pacchetti per recupero di file dati ed
    analisi forensi.

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|          descrizione          |
    |-------------+------+----------+-------------------------------|
    |             |V:3,  |          |utilità per scansione delle    |
    |testdisk     |I:38  |1426      |partizione e ripristino di     |
    |             |      |          |dischi                         |
    |-------------+------+----------+-------------------------------|
    |magicrescue  |V:0,  |259       |utilità per ripristinare file  |
    |             |I:3   |          |cercando byte magici           |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |strumento di escavazione di    |
    |scalpel      |I:4   |87        |file frugale e ad alte         |
    |             |      |          |prestazioni                    |
    |-------------+------+----------+-------------------------------|
    |myrescue     |V:0,  |83        |recupera dati da dischi fissi  |
    |             |I:3   |          |danneggiati                    |
    |-------------+------+----------+-------------------------------|
    |extundelete  |V:1,  |148       |utilità per decancellare file  |
    |             |I:11  |          |da file system ext3/4          |
    |-------------+------+----------+-------------------------------|
    |ext4magic    |V:0,  |233       |utilità per decancellare file  |
    |             |I:4   |          |da file system ext3/4          |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |strumento per aiutare a        |
    |ext3grep     |I:3   |281       |recuperare file cancellati da  |
    |             |      |          |file system ext3               |
    |-------------+------+----------+-------------------------------|
    |scrounge-ntfs|V:0,  |50        |programma di recupero di dati  |
    |             |I:3   |          |da file system NTFS            |
    |-------------+------+----------+-------------------------------|
    |gzrt         |V:0,  |33        |insieme di strumenti di        |
    |             |I:0   |          |recupero di gzip               |
    |-------------+------+----------+-------------------------------|
    |sleuthkit    |V:2,  |1511      |strumenti per analisi forensi  |
    |             |I:24  |          |(Sleuthkit)                    |
    |-------------+------+----------+-------------------------------|
    |autopsy      |V:0,  |1027      |interfaccia grafica per        |
    |             |I:2   |          |SleuthKit                      |
    |-------------+------+----------+-------------------------------|
    |foremost     |V:0,  |104       |applicazione forense per il    |
    |             |I:7   |          |recupero dei dati              |
    |-------------+------+----------+-------------------------------|
    |guymager     |V:0,  |1030      |strumento forense per immagini |
    |             |I:1   |          |basato su Qt                   |
    |-------------+------+----------+-------------------------------|
    |dcfldd       |V:0,  |106       |versione migliorata di dd per  |
    |             |I:5   |          |analisi forensi e sicurezza    |
    +---------------------------------------------------------------+


    Suggerimento

    Si possono ripristinare i file sui file system ext2 usando i
    comandi list_deleted_inodes e undel di debugfs(8) nel pacchetto
    e2fsprogs.

%

9.7.5. Suddividere un file grande in file più piccoli

    Quando dei dati sono troppo grandi affinché ne venga fatto il
    backup in un file singolo, si può fare il backup dei suoi
    contenuti dopo averlo suddiviso in pezzi di, ad esempio 2000MiB,
    che saranno successivamente riuniti a formare il file originale.

    $ split -b 2000m file_grande
    $ cat x* >file_grande

    Attenzione
   
    Assicurarsi di non avere altri file che iniziano con "x" per
    evitare conflitti nei nomi.

%

9.7.6. Pulire il contenuto di file

    Per ripulire i contenuti di un file, come un file di registro,
    non usare rm(1) per cancellarlo e poi crearne un altro, perché
    nell'intervallo tra i due comandi potrebbe essere ancora
    possibile accedere al file. Quello che segue è il metodo sicuro
    per pulire il contenuto di un file.

    $ :>file_da_pulire

%

9.7.7. File fittizi

    I comandi seguenti creano file fittizi o vuoti.

    $ dd if=/dev/zero    of=5kb.file bs=1k count=5
    $ dd if=/dev/urandom of=7mb.file bs=1M count=7
    $ touch zero.file
    $ : > semprezero.file

    Dovrebbero essere ora presenti i seguenti file.

      * "5kb.file" è costituito da 5KB di zero.

      * "7mb.file" è costituito da 7MB di dati casuali.

      * "zero.file" potrebbe essere un file di 0 byte. Se fosse stato
        preesistente, il suo orario mtime sarebbe stato aggiornato
        mentre sarebbero stati mantenuti i suoi contenuti e la sua
        grandezza.

      * "semprezero.file" è sempre un file di 0 byte. Se fosse stato
        preesistente, il suo orario mtime sarebbe stato aggiornato e
        il suo contenuto azzerato.

%

9.7.8. Cancellare un intero disco fisso

    Esistono diversi modi di cancellare completamente i dati da un
    intero device simile ad un disco fisso, ad esempio una chiavetta
    USB in "/dev/sda".

    Attenzione

    Prima di eseguire i comandi indicati in seguito controllare la
    posizione della chiavetta USB con mount(8). Il device a cui punta
    "/dev/sda" potrebbe essere il disco fisso SCSI o Serial-ATA che
    contiene l'intero sistema.

    Cancellare tutti i contenuti del disco reimpostando tutti i dati
    a 0 con il comando seguente.

    # dd if=/dev/zero of=/dev/sda

    Cancellare tutto sovrascrivendo dati casuali con il comando
    seguente.

    # dd if=/dev/urandom of=/dev/sda

    Cancellare tutto sovrascrivendo dati casuali in modo molto
    efficiente con il comando seguente.

    # shred -v -n 1 /dev/sda

    Dato che dd(1) è disponibile dalla shell di molti CD Linux
    avviabili, come il CD dell'installatore Debian, si può cancellare
    completamente il sistema installato su un disco fisso, ad esemio
    "/dev/hda", "/dev/sda", ecc., eseguendo un comando di
    cancellazione da un supporto CD simile.

%

9.7.9. Cancellare area inutilizzate di un disco fisso

    Area inutilizzate di un disco fisso (o di una chiavetta USB), ad
    esempio "/dev/sdb1", potrebbero contenere ancora i dati
    cancellati stessi, dato che questi sono semplicemente scollegati
    dal file system. È possibile pulire queste aree sovrascrivendole.

    # mount -t auto /dev/sdb1 /mnt/pippo
    # cd /mnt/pippo
    # dd if=/dev/zero of=spazzatura
    dd: writing to `spazzatura': No space left on device
    ...
    # sync
    # umount /dev/sdb1

    Avvertimento

    Solitamente questo procedimento è sufficientemente buono per le
    chiavette USB. Ma non è perfetto. La maggior parte dei nomi di
    file cancellati e dei loro attributi potrebbe ancora essere
    nascosta e rimanere nel file system.

%

9.7.10. De-cancellare file cancellati ma ancora aperti

    Anche se un file è stato cancellato per errore, fintanto che è
    usato da un'applicazione (in lettura o scrittura), è possibile
    recuperarlo.

    Per esempio, provare a fare quanto segue.

    $ echo pippo > pluto
    $ less pluto
    $ ps aux | grep ' less[ ]'
    bozo    4775  0.0  0.0  92200   884 pts/8    S+   00:18   0:00 less pluto
    $ rm pluto
    $ ls -l /proc/4775/fd | grep bar
    lr-x------ 1 bozo bozo 64 2008-05-09 00:19 4 -> /home/bozo/pluto (deleted)
    $ cat /proc/4775/fd/4 >pluto
    $ ls -l
    -rw-r--r-- 1 bozo bozo 4 2008-05-09 00:25 pluto
    $ cat pluto
    pippo

    Quando si ha il pacchetto lsof installato, eseguire in un altro
    terminale quanto segue.

    $ ls -li pluto
    2228329 -rw-r--r-- 1 bozo bozo 4 2008-05-11 11:02 pluto
    $ lsof |grep pluto|grep less
    less 4775 bozo 4r REG 8,3 4 2228329 /home/bozo/pluto
    $ rm pluto
    $ lsof |grep pluto|grep less
    less 4775 bozo 4r REG 8,3 4 2228329 /home/bozo/pluto (deleted)
    $ cat /proc/4775/fd/4 >pluto
    $ ls -li pluto
    2228302 -rw-r--r-- 1 bozo bozo 4 2008-05-11 11:05 pluto
    $ cat pluto
    pippo

%

9.7.11. Cercare tutti i collegamenti fisici

    I file con collegamenti fisici possono essere identificati usando
    "ls -li".

    $ ls -li
    total 0
    2738405 -rw-r--r-- 1 root root 0 2008-09-15 20:21 paperino
    2738404 -rw-r--r-- 2 root root 0 2008-09-15 20:21 pippo
    2738404 -rw-r--r-- 2 root root 0 2008-09-15 20:21 pluto

    Entrambi "pippo" e "pluto" hanno il numero di collegamenti uguale
    a "2" (>1), il che mostra che hanno collegamenti fisici. Hanno il
    numero di inode, "2738404", in comune. Ciò significa che sono lo
    stesso file con un collegamento fisico. Nell'eventualità che non
    si trovino tutti i file con collegamento fisico, li si possono
    cercare in base all'inode, ad esempio "2738404", nel modo
    seguente.

    # find /percorso/del/punto/di/mount -xdev -inum 2738404

%

9.7.12. Consumo invisibile dello spazio su disco

    Tutti i file cancellati ma aperti consumano spazio su disco,
    anche se non sono visibili con il normale comando du(1). Possono
    essere elencati, insieme alla loro dimensione, nel modo seguente.

    # lsof -s -X / |grep deleted

%

9.8. Suggerimenti per la cifratura dei dati

    Avendo l'accesso fisico alla macchina, chiunque può facilmente
    ottenere privilegi di root e accedere a tutti i file nel PC
    (vedere Sezione 4.7.4, «Rendere sicura la password di root»). Ciò
    significa che il sistema delle password di login non può mettere
    al sicuro i dati privati e sensibili contro un possibile furto
    del PC. Per farlo deve essere usata una tecnologia di cifratura
    dei dati. Sebbene GNU Privacy Guard (vedere Sezione 10.3,
    «Infrastruttura di sicurezza dei dati») possa cifrare file,
    richiede un po' di lavoro da parte dell'utente.

    dm-crypt e eCryptfs facilitano la cifratura automatica dei dati
    in modo nativo attraverso moduli del kernel Linux con un minimo
    lavoro da parte dell'utente.

    Tabella 9.24. Elenco di utilità per la cifratura dei dati

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|         descrizione          |
    |--------------+------+----------+------------------------------|
    |cryptsetup    |V:29, |402       |utilità per device a blocchi  |
    |              |I:78  |          |cifrati (dm-crypt / LUKS)     |
    |--------------+------+----------+------------------------------|
    |              |      |          |utilità per device a blocchi  |
    |              |V:4,  |          |cifrati (dm-crypt / LUKS) con |
    |cryptmount    |I:5   |228       |particolare attenzione al     |
    |              |      |          |montaggio/smontaggio da parte |
    |              |      |          |di utenti normali             |
    |--------------+------+----------+------------------------------|
    |ecryptfs-utils|V:3,  |460       |utilità per file system stack |
    |              |I:5   |          |cifrati (eCryptfs)            |
    +---------------------------------------------------------------+


    Dm-crypt è un file system crittografico che usa device-mapper.
    Device mapper mappa un blocco di un device ad un altro.

    eCryptfs è un altro file system crittografico che usa un file
    system stack; quest'ultimo si sovrappone ad una directory
    esistente in un file system montato.

    Attenzione
   
    La cifratura dei dati consuma tempo CPU, ecc. Valutare bene i
    suoi costi e i benefici.

    Nota

    È possibile installare un intero file system Debian in un disco
    cifrato con l'Installatore Debian (lenny o successivo) usando
    dm-crypt/LUKS e initramfs.

    Suggerimento
   
    Per lo strumento di cifratura in spazio utente GNU Privacy Guard
    vedere Sezione 10.3, «Infrastruttura di sicurezza dei dati».

%

9.8.1. Cifratura di dischi removibili con dm-crypt/LUKS

    Si può cifrare il contenuto di dispositivi di memorizzazione di
    massa removibili, ad esempio una chiavetta USB in "/dev/sdx",
    usando dm-crypt/LUKS. Formattarla semplicemente nel modo
    seguente.

    # badblocks -c 1024 -s -w -t random -v /dev/sdx
    # fdisk /dev/sdx
    ... "n" "p" "1" "return" "return" "w"
    # cryptsetup luksFormat /dev/sdx1
    ...
    # cryptsetup open --type luks /dev/sdx1 sdx1
    ...
    # ls -l /dev/mapper/
    total 0
    crw-rw---- 1 root root  10, 60 2008-10-04 18:44 control
    brw-rw---- 1 root disk 254,  0 2008-10-04 23:55 sdx1
    # mkfs.vfat /dev/mapper/sdx1
    ...
    # cryptsetup luksClose sdx1

    Si può poi montarla come una chiavetta qualunque in "/media/
    <etichetta_disco>", tranne per il fatto che verrà chiesta la
    password (vedere Sezione 10.1.7, «Supporti di archiviazione
    removibili») nei moderni ambienti desktop, come GNOME che usa 
    gnome-mount(1). La differenza è che ogni dato scritto in essa è
    cifrato. In alternativa è possibile formattare il supporto con un
    file system diverso, ad esempio ext4 usando "mkfs.ext4 /dev/
    sdx1".

    Nota

    Se si è veramente paranoici per ciò che riguarda la sicurezza dei
    propri dati, potrebbe essere necessario sovrascrivere diverse
    volte (il comando "badblocks" nell'esempio precedente). Questa
    operazione richiede però parecchio tempo.

%

9.8.2. Cifratura della partizione di swap con dm-crypt

    In questo esempio si suppone che il file "/etc/fstab" originale
    contenga quanto segue.

    /dev/sda7 swap sw 0 0

    Si può abilitare la cifratura della partizione di swap usando
    dm-crypt nel modo seguente.

    # aptitude install cryptsetup
    # swapoff -a
    # echo "cswap /dev/sda7 /dev/urandom swap" >> /etc/crypttab
    # perl -i -p -e "s/\/dev\/sda7/\/dev\/mapper\/cswap/" /etc/fstab
    # /etc/init.d/cryptdisks restart
     ...
    # swapon -a

%

9.8.3. Montare dischi removibili con dm-crypt/LUKS

    Una partizione di disco cifrata creata con dm-crypt/LUKS su "/dev
    /sdc5" può essere montata in "/mnt" nel modo seguente:

    $ sudo cryptsetup open /dev/sdc5 ninja --type luks
    Enter passphrase for /dev/sdc5: ****
    $ sudo lvm
    lvm> lvscan
      inactive          '/dev/ninja-vg/root' [13.52 GiB] inherit
      inactive          '/dev/ninja-vg/swap_1' [640.00 MiB] inherit
      ACTIVE            '/dev/goofy/root' [180.00 GiB] inherit
      ACTIVE            '/dev/goofy/swap' [9.70 GiB] inherit
    lvm> lvchange -a y /dev/ninja-vg/root
    lvm> exit
      Exiting.
    $ sudo mount /dev/ninja-vg/root /mnt

%

9.8.4. Cifratura automatica di file con eCryptfs

    È possibile cifrare automaticamente i file scritti in "~/Private/
    " usando eCryptfs e il pacchetto ecryptfs-utils.

      * Eseguire ecryptfs-setup-private(1) e impostare "~/Private/"
        nei prompt mostrati.

      * Attivare "~/Private/" eseguendo ecryptfs-mount-private(1).

      * Spostare i file con dati sensibili in "~/Private/" e creare i
        collegamenti simbolici necessari.

          + File candidati sono:"~/.fetchmailrc", "~/.ssh/identity",
            "~/.ssh/id_rsa", "~/.ssh/id_dsa" e altri file con
            permessi "go-rwx"

      * Spostare le directory con dati sensibili in una
        sottodirectory in "~/Private/" e creare i collegamenti
        simbolici necessari.

          + Directory candidate sono: "~/.gnupg" e altre directory
            con permessi "go-rwx"

      * Creare un collegamento simbolico da "~/Desktop/Private/" a "~
        /Private/" per facilitare le operazioni dal desktop.

      * Disattivare "~/Private/" eseguendo ecryptfs-umount-private(1)
        .

      * Attivare "~/Private/" eseguendo ecryptfs-mount-private(1)
        quando sono necessari dati cifrati..

    Suggerimento

    Dato che eCryptfs cifra selettivamente solo i file sensibili, il
    suo costo in termini di risorse di sistema è molto minore
    dell'uso di dm-crypt sull'intero device root o "/home". Non
    richiede nessun lavoro speciale di archiviazione su disco, ma non
    può mantenere confidenziali tutti i metadati del file system.

%

9.8.5. Montare automaticamente eCryptfs

    Se si usa la propria password di login come wrapper per le chiavi
    di cifratura, si può automatizzare il montaggio di eCryptfs
    tramite PAM (Pluggable Authentication Modules).

    Inserire la riga seguente immediatamente prima di "pam_permit.so"
    in "/etc/pam.d/common-auth".

    auth required pam_ecryptfs.so unwrap

    Inserire la riga seguente come ultima riga in "/etc/pam.d/
    common-session".

    session optional pam_ecryptfs.so unwrap

    Insrire la riga seguente come prima riga attiva in "/etc/pam.d/
    common-password".

    password required pam_ecryptfs.so

    Ciò risulta molto comodo.

    Avvertimento
   
    Errori di configurazione di PAM possono lasciare l'utente chiuso
    fuori dal proprio sistema. Vedere Capitolo 4, Autenticazione.

    Attenzione

    Se si usa la propria password di login per fare da wrapper alle
    chiavi di cifratura, i dati cifrati sono sicuri tanto quanto la
    password di login dell'utente (vedere Sezione 4.3, «Password
    buone»). A meno che non si scelga prudentemente una password
    forte, i propri dati saranno a rischio se qualcuno esegue
    software di forzatura della password dopo aver rubato il
    portatile (vedere Sezione 4.7.4, «Rendere sicura la password di
    root»).

%

9.9. Il kernel

    Debian distribuisce, per le architetture supportate, kernel Linux
    modulari contenuti in pacchetti.

%

9.9.1. Kernel Linux 2.6/3.x

    Nel kernel Linux 2.6/3.x ci sono alcune funzionalità degne di
    nota rispetto alla versione 2.4.

      * I device vengono creati dal sistema udev (vedere Sezione 3.3,
        «Il sistema udev»).

      * L'accesso in lettura/scrittura ai dispositivi CD/DVD IDE non
        usa il modulo ide-scsi.

      * Le funzioni di filtraggio dei pacchetti di rete usando i
        moduli iptables del kernel.

    Il salto di versione da Linux 2.6.39 a Linux 3.0 non è dovuto a
    cambiamenti tecnologici fondamentali, ma al ventesimo
    anniversario.

%

9.9.2. Parametri del kernel

    Molte caratteristiche di Linux possono essere configurate tramite
    parametri del kernel, nei modi seguenti.

      * Parametri del kernel inizializzati dal bootloader (vedere
        Sezione 3.1.2, «Stadio 2: il bootloader»)

      * Se accessibili attraverso sysfs (vedere Sezione 1.2.12,
        «procfs e sysfs»), parametri del kernel modificati da sysctl
        (8) durante l'esecuzione del sistema.

      * Parametri di moduli impostati dagli argomenti di modprobe(8)
        al momento dell'attivazione di un modulo (vedere
        Sezione 9.6.3, «Montare un file con un'immagine di disco»)

    Vedere "kernel-parameters.txt(.gz)" e altri documenti correlati
    nella documentazione del kernel Linux ("/usr/share/doc/
    linux-doc-3.*/Documentation/filesystems/*") fornita dai pacchetti
    linux-doc-3.*.

%

9.9.3. Header del kernel

    La maggior parte dei normali programmi non ha bisogno degli
    header del kernel per essere compilata, anzi di fatto può
    corrompersi se si usano direttamente gli header. Questi programmi
    dovrebbero essere compilati nel sistema Debian usando gli header
    in "/usr/include/linux" e "/usr/include/asm" forniti dal
    pacchetto libc6-dev (creato dal pacchetto sorgente glibc).

    Nota

    Per compilare alcuni programmi specifici per il kernel, come
    moduli per il kernel da fonti esterne e il demone automounter
    (amd), è necessario includere nella propria riga di comando il
    percorso ai corrispondenti header del kernel, ad esempio "-I/usr/
    src/linux-particular-version/include/". module-assistant(8) (o la
    suo forma abbbreviata m-a) aiuta l'utente a compilare ed
    installare pacchetti di moduli in modo semplice per uno o più
    kernel personalizzati.

%

9.9.4. Compilare il kernel ed i moduli relativi

    Debian ha un proprio metodo di compilazione del kernel e dei
    moduli relativi.

    Tabella 9.25. Elenco di pacchetti chiave da installare per la
    ricompilazione del kernel in un sistema Debian

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|         descrizione         |
    |---------------+------+----------+-----------------------------|
    |               |      |          |pacchetti essenziali per     |
    |build-essential|I:499 |20        |compilare pacchetti Debian:  |
    |               |      |          |make, gcc, …                 |
    |---------------+------+----------+-----------------------------|
    |bzip2          |V:157,|122       |utilità di compressione e    |
    |               |I:970 |          |decompressione per file bz2  |
    |---------------+------+----------+-----------------------------|
    |libncurses5-dev|I:116 |6         |librerie di sviluppo e       |
    |               |      |          |documentazione per ncurses   |
    |---------------+------+----------+-----------------------------|
    |               |V:305,|          |git: sistema distribuito di  |
    |git            |I:478 |35040     |controllo delle revisioni    |
    |               |      |          |usato dal kernel Linux       |
    |---------------+------+----------+-----------------------------|
    |               |V:35, |          |fornisce un ambiente fakeroot|
    |fakeroot       |I:521 |228       |per compilare pacchetti da   |
    |               |      |          |utente non root              |
    |---------------+------+----------+-----------------------------|
    |               |V:371,|          |strumento per compilare un   |
    |initramfs-tools|I:989 |112       |initramfs (specifico di      |
    |               |      |          |Debian)                      |
    |---------------+------+----------+-----------------------------|
    |               |      |          |DKMS (Dynamic Kernel Module  |
    |dkms           |V:70, |294       |Support, supporto dinamico   |
    |               |I:219 |          |per i noduli del kernel)     |
    |               |      |          |(generico)                   |
    |---------------+------+----------+-----------------------------|
    |               |V:9,  |          |script di aiuto per i        |
    |devscripts     |I:57  |2623      |manutentori di pacchetti     |
    |               |      |          |Debian (specifico di Debian) |
    +---------------------------------------------------------------+


    Se si usa initrd nello Sezione 3.1.2, «Stadio 2: il bootloader»,
    ci si assicuri di leggere le informazioni relative in 
    initramfs-tools(8), update-initramfs(8), mkinitramfs(8) e 
    initramfs.conf(5).

    Avvertimento

    Quando si compilano i sorgenti del kernel Linux, non mettere
    collegamenti simbolici alle directory nell'albero dei sorgenti
    (ad esempio, "/usr/src/linux*") in "/usr/include/linux" e "/usr/
    include/asm". (Alcuni documenti ormai datati suggeriscono di
    farlo.)

    Nota

    Quando si compila il kernel Linux più recente nel sistema Debian
    stable, potrebbe essere necessario l'uso delle versioni backport
    degli strumenti piu recenti da Debian unstable.

    Nota

    Il DKMS (Dynamic Kernel Module Support, supporto dinamico per i
    moduli del kernel) è un nuova infrastruttura indipendente dalla
    distribuzione progettata per permettere l'aggiornamento di
    singoli moduli del kernel senza cambiare tutto il kernel. È
    utilizzata per il mantenimento dei moduli esterni all'albero dei
    sorgenti. Rende anche molto facile la ricompilazione dei moduli
    quando si aggiornano i kernel.

9.9.5. Compilare i sorgenti del kernel: il metodo raccomandato dal
Team del Kernel di Debian

    Per compilare pacchetti binari del kernel personalizzati a
    partire dai sorgenti originali del kernel, si deve usare il
    target "deb-pkg fornito.

    $ sudo apt-get build-dep linux
    $ cd /usr/src
    $ wget http://www.kernel.org/pub/linux/kernel/v3.11/linux-<version>.tar.bz2
    $ tar -xjvf linux-<version>.tar.bz2
    $ cd linux-<version>
    $ cp /boot/config-<version> .config
    $ make menuconfig
     ...
    $ make deb-pkg

    Suggerimento

    Il pacchetto linux-source-<versione> fornisce i sorgenti del
    kernel Linux con le patch Debian come "/usr/src/linux-
    <versione>.tar.bz2".

    Per compilare pacchetti binari specifici a partire dal pacchetto
    Debian dei sorgenti del kernel, si devono usare i target
    "binary-arch_<architettura>_<featureset>_<flavour>" in "debian/
    rules.gen".

    $ sudo apt-get build-dep linux
    $ apt-get source linux
    $ cd linux-3.*
    $ fakeroot make -f debian/rules.gen binary-arch_i386_none_686

    Ulteriori informazioni:

      * Wiki Debian: FAQ del Kernel

      * Wiki Debian: Kernel Debian

      * Debian Linux Kernel Handbook: https://
        kernel-handbook.debian.net

%

9.9.6. Driver per hardware e firmware

    Un driver hardware è il codice eseguito nel sistema target. La
    maggior parte dei driver hardware sono ora disponibili come
    software libero e sono inclusi nei normali pacchetti Debian dei
    kernel nell'area main.

      * driver GPU

          + driver GPU Intel (main)

          + driver GPU AMD/ATI (main)
   
          + driver GPU NVIDIA (main per il driver nouveau e non-free
            per i driver solo binari supportati dal produttore.

      * driver Softmodem

          + pacchetti martian-modem e sl-modem-dkms (non-free)

    Il firmware è il codice o i dati caricati sul dispositivo (ad
    esempio microcodice della CPU, codice di rendering eseguito nella
    GPU oppure dati FPGA/CPLD, …). Alcuni pacchetti firmware sono
    disponibili come software libero, ma molti pacchetti firmware non
    lo sono dato che contengono dati binari senza sorgenti.

      * firmware-linux-free (main)

      * firmware-linux-nonfree (non-free)

      * firmware-linux-* (non-free)
   
      * *-firmware (non-free)

      * intel-microcode (non-free)

      * amd64-microcode (non-free)

    Notare che i pacchetti non-free e contrib non fanno parte del
    sistema Debian. La configurazione per abilitare e disabilitare le
    aree non-free e contrib è descritta in Sezione 2.1.4, «Nozioni di
    base sugli archivi Debian». Si dovrebbe essere consapevoli degli
    aspetti negativi legati all'uso dei pacchetti non-free e contrib
    come descritto in Sezione 2.1.5, «Debian è al 100% software
    libero».

%

9.10. Sistema virtualizzato

    L'uso di sistemi virtualizzati permette di eseguire più istanze
    di un sistema simultaneamente su un singolo hardware.

    Suggerimento
   
    Vedere http://wiki.debian.org/SystemVirtualization.

%

9.10.1. Strumenti per la virtualizzazione

    Ci sono diversi pacchetti in Debian relativi alla
    virtualizzazione ed emulazione di sistema che vanno oltre il
    semplice chroot. Alcuni pacchetti aiutano anche nell'impostazione
    di tali sistemi.

    Tabella 9.26. Elenco di strumenti di virtualizzazione

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|         descrizione         |
    |---------------+------+----------+-----------------------------|
    |               |V:7,  |          |strumento specializzato per  |
    |schroot        |I:10  |2708      |eseguire pacchetti Debian    |
    |               |      |          |binari in chroot             |
    |---------------+------+----------+-----------------------------|
    |               |V:1,  |          |strumento per compilare      |
    |sbuild         |I:4   |286       |pacchetti Debian binari da   |
    |               |      |          |sorgenti Debian              |
    |---------------+------+----------+-----------------------------|
    |               |V:2,  |          |creatore di pacchetti        |
    |pbuilder       |I:16  |966       |personali per pacchetti      |
    |               |      |          |Debian                       |
    |---------------+------+----------+-----------------------------|
    |debootstrap    |V:6,  |298       |avviare un sistema Debian    |
    |               |I:63  |          |base (scritto in sh)         |
    |---------------+------+----------+-----------------------------|
    |cdebootstrap   |V:0,  |116       |avviare un sistema Debian    |
    |               |I:3   |          |(scritto in C)               |
    |---------------+------+----------+-----------------------------|
    |               |V:10, |          |Virtual Machine Manager:     |
    |virt-manager   |I:42  |2298      |applicazione desktop per     |
    |               |      |          |gestire macchine virtuali    |
    |---------------+------+----------+-----------------------------|
    |libvirt-clients|V:43, |1167      |programmi per la libreria    |
    |               |I:62  |          |libvirt                      |
    |---------------+------+----------+-----------------------------|
    |bochs          |V:0,  |7194      |Bochs: emulatore PC IA-32    |
    |               |I:1   |          |                             |
    |---------------+------+----------+-----------------------------|
    |qemu           |I:34  |94        |QEMU: veloce emulatore       |
    |               |      |          |generico di processore       |
    |---------------+------+----------+-----------------------------|
    |qemu-system    |I:21  |95        |QEMU: binari per emulazione  |
    |               |      |          |completa del sistema         |
    |---------------+------+----------+-----------------------------|
    |qemu-user      |V:0,  |89671     |QEMU: binari per emulazione  |
    |               |I:13  |          |in spazio utente             |
    |---------------+------+----------+-----------------------------|
    |qemu-utils     |V:11, |6083      |QEMU: utilità                |
    |               |I:107 |          |                             |
    |---------------+------+----------+-----------------------------|
    |               |      |          |KVM: virtualizzazione        |
    |qemu-kvm       |V:10, |107       |completa su hardware x86     |
    |               |I:61  |          |convirtualizzazione assistita|
    |               |      |          |da hardware                  |
    |---------------+------+----------+-----------------------------|
    |               |V:12, |          |VirtualBox: soluzione per    |
    |virtualbox     |I:16  |106495    |virtualizzazione i dx86 su   |
    |               |      |          |i386 e amd64                 |
    |---------------+------+----------+-----------------------------|
    |xen-tools      |V:0,  |727       |strumenti per gestire server |
    |               |I:4   |          |virtuali XEN Debian          |
    |---------------+------+----------+-----------------------------|
    |wine           |V:19, |192       |Wine: implementazione della  |
    |               |I:82  |          |API Windows (suite standard) |
    |---------------+------+----------+-----------------------------|
    |               |V:2,  |          |DOSBox: emulatore x86 con    |
    |dosbox         |I:18  |2742      |grafica Tandy/Herc/CGA/EGA/  |
    |               |      |          |VGA/SVGA, suono e DOS        |
    |---------------+------+----------+-----------------------------|
    |dosemu         |V:0,  |4891      |DOSEMU: emulatore DOS di     |
    |               |I:2   |          |Linux                        |
    |---------------+------+----------+-----------------------------|
    |               |V:0,  |          |OpenVZ, soluzione per        |
    |vzctl          |I:1   |1112      |virtualizzazione server -    |
    |               |      |          |strumenti di controllo       |
    |---------------+------+----------+-----------------------------|
    |               |V:0,  |          |OpenVZ, soluzione per        |
    |vzquota        |I:1   |236       |virtualizzazione server -    |
    |               |      |          |strumenti per quote          |
    |---------------+------+----------+-----------------------------|
    |               |V:10, |          |strumenti in spazio utente   |
    |lxc            |I:15  |18761     |per contenitori Linux        |
    |               |      |          |containers                   |
    +---------------------------------------------------------------+


    Vedere l'articolo di Wikipedia Comparison of platform virtual
    machines per una comparazione dettagliata di diverse soluzioni
    per la virtualizzazione di piattaforme.

%

9.10.2. Fasi del processo di virtualizzazione

    Nota
   
    Alcune funzionalità descritte in seguito sono disponibili
    solamente in squeeze o rilasci successivi.

    Nota
   
    I kernel Debian predefiniti hanno il supporto per KVM a partire
    da lenny.

    Il tipico processo di virtualizzazione comporta diverse fasi.

      * Creare un file system vuoto (un albero di file o un'immagine
        di disco).

          + L'albero di file può essere creato con "mkdir -p /
            percorso/di/chroot".

          + Il file immagine raw del disco può essere creato con dd
            (1) (vedere Sezione 9.6.1, «Creare un file con
            un'immagine di disco» e Sezione 9.6.5, «Creare un file
            con immagine di disco vuoto»).

          + Si può usare qemu-img(1) per creare e convertire file
            immagine di dischi supportati da QEMU.

          + I formati di file raw e VMDK possono essere usati come
            formati comuni tra i vari strumenti di virtualizzazione.

      * Montare l'immagine del disco con mount(8) nel file system
        (opzionale).

          + Per il file immagine raw sel disco, montarlo come device
            loop o device mapper (vedere Sezione 9.6.3, «Montare un
            file con un'immagine di disco»).

          + Per le immagini disco supportate da QEMU, montarle come
            device a blocchi di rete (vedere Sezione 9.10.3, «Montare
            il file immagine di disco virtuale»).

      * Popolare il file system obiettivo con i dati di sistema
        necessari.

          + L'uso di programmi come debootstrap e cdebootstrap aiuta
            questo processo (vedere Sezione 9.10.4, «Sistema chroot»
            ).

          + Usare gli installatori di sistemi operativi
            nell'emulazione di sistemi completi.

      * Eseguire un programma in un ambiente virtualizzato.

          + chroot fornisce un ambiente di virtualizzazione base
            sufficiente a compilare programmi, eseguire applicazioni
            in console ed eseguire demoni al suo interno.

          + QEMU fornisce emulazione di CPU inter-piattaforma.

          + QEMU con KVM fornisce una completa emulazione di sistema
            con virtualizzazione assistita da hardware.

          + VirtualBox fornisce una completa emulazione del sistema
            in i386 e amd64 con o senza virtualizzazione assistita da
            hardware.

%

9.10.3. Montare il file immagine di disco virtuale

    Per i file immagine raw di disco, vedere Sezione 9.6, «Immagine
    del disco».

    Per altri file immagine di dischi virtuali, si può usare qemu-nbd
    (8) per esportarli usando il protocollo per device a blocchi di
    rete e montarli usando il modulo nbd del kernel.

    qemu-nbd(8) supporta i formati di disco supportati da QEMU; QEMU
    supporta i seguenti formati di dischi: raw, qcow2, qcow, vmdk,
    vdi, bochs, cow (copy-on-write di user-mode Linux), parallels,
    dmg, cloop, vpc, vvfat (VFAT virtuale) e host_device.

    I device a blocchi di rete possono supportare partizioni nello
    stesso modo dei device loop (vedere Sezione 9.6.3, «Montare un
    file con un'immagine di disco»). Si può montare la prima
    partizione di "disk.img" nel modo seguente.

    # modprobe nbd max_part=16
    # qemu-nbd -v -c /dev/nbd0 disk.img
    ...
    # mkdir /mnt/part1
    # mount /dev/nbd0p1 /mnt/part1

    Suggerimento
   
    È possibile esportare solamente la prima partizione di "disk.img"
    usando l'opzione "-P 1"per qemu-nbd(8).

%

9.10.4. Sistema chroot

    chroot(8) offre il metodo più basilare per eseguire diverse
    istanze dell'ambiente GNU/Linux simultaneamente in un singolo
    sistema senza riavviare.

    Attenzione
   
    Gli esempi seguenti presuppongono che entrambi i sistemi, quello
    genitore e quello chroot, condividano la stessa architettura.

    Si può imparare a impostare ed usare chroot(8) eseguendo il
    programma pbuilder(8) in script(1) nel modo seguente.

    $ sudo mkdir /sid-root
    $ sudo pbuilder --create --no-targz --debug --buildplace /sid-root

    Si può vedere come debootstrap(8) o cdebootstrap(1) popoli i dati
    di sistema per l'ambiente sid in "/sid-root".

    Suggerimento

    L'installatore Debian usa debootstrap(8) o cdebootstrap(1) per
    l'installazione Debian. Possono anche essere usati per installare
    Debian in un sistema senza usare un disco di installazione
    Debian, ma invece uno di un'altra distribuzione GNU/Linux.

    $ sudo pbuilder --login --no-targz  --debug --buildplace /sid-root

    Si può vedere come venga creata una shell di sistema in
    esecuzione nell'ambiente sid, nel modo seguente.

     1. Copiare la configurazione locale ("/etc/hosts", "/etc/
        hostname", "/etc/resolv.conf")

     2. Montare il file system "/proc"

     3. Montare il file system "/dev/pts"

     4. Creare "/usr/sbin/policy-rc.d" che restituisca sempre il
        codice 101

     5. Esegiore "chroot /sid-root bin/bash -c 'exec -a -bash bin/
        bash'"

    Nota

    Alcuni programmi in chroot per funzionare possono aver bisogno
    dell'accesso ad più file nel sistema genitore di quanti ne
    fornisca pbuilder. Per esempio, per essere montati con bind o
    copiati, possono essere necessari "/sys", "/etc/passwd", "/etc/
    group", "/var/run/utmp", "/var/log/wtmp", ecc.

    Nota

    Il file "/usr/sbin/policy-rc.d" evita che, in un sistema Debian,
    i programmi demone vengano avviati automaticamente. Vedere "/usr/
    share/doc/sysv-rc/README.policy-rc.d.gz".

    Suggerimento

    Lo scopo originale del pacchetto specializzato chroot, pbuilder è
    di costruire un sistema chroot e di compilare un pacchetto
    all'interno del chroot. È un sistema ideale per controllare che
    le dipendenze di compilazione di un pacchetto siano corrette e
    per assicurare che, nel pacchetto risultante, non ci siano
    dipendenze sbagliate o superflue.

    Suggerimento
   
    Il pacchetto simile schroot può dare un'idea di come eseguire un
    sistema chroot i386 in un sistema genitore amd64.

%

9.10.5. Sistemi desktop multipli

    Io raccomando l'uso di QEMU o VirtualBox per eseguire, in un
    sistema Debian stable, sistemi desktop multipli in maniera sicura
    usando la virtualizzazione. Permettono di eseguire applicazioni
    desktop di Debian unstable e testing senza i comuni rischi ad
    essi associati.

    Dato che QEMU puro è molto lento, è raccomandata la sua
    velocizzazione con KVM quando il sistema host lo permette.

    L'immagine disco virtuale "virtdisk.qcow2" contenente un sistema
    Debian per QEMU si può creare con i piccoli CD dell'installatore
    Debian nel modo seguente.

    $ wget http://cdimage.debian.org/debian-cd/5.0.3/amd64/iso-cd/debian-503-amd64-netinst.iso
    $ qemu-img create -f qcow2 virtdisk.qcow2 5G
    $ qemu -hda virtdisk.qcow2 -cdrom debian-503-amd64-netinst.iso -boot d -m 256
    ...

    Vedere altri suggerimenti su Debian Wiki: QEMU.

    VirtualBox è fornito con strumenti con interfaccia utente grafica
    Qt piuttosto intuitivi. I suoi strumenti grafici e a riga di
    comando sono spiegati nel Manuale utente di VirtualBox e Manuale
    utente di VirtualBox (PDF).

    Suggerimento

    Eseguire altre distribuzioni GNU/Linux come Ubuntu e Fedora in
    una virtualizzazione è un ottimo metodo per imparare trucchetti
    di configurazione. Anche altri sistemi operativi proprietari
    possono essere eseguiti tranquillamente in queste
    virtualizzazioni GNU/Linux.

Capitolo 10. Gestione dei dati

    In questo capitolo sono descritti strumenti e trucchi per gestire
    dati binari e di testo in un sistema Debian.

%

10.1. Condividere, copiare ed archiviare

    Avvertimento

    L'accesso in scrittura non coordinato a device a cui si sta
    attivamente accedendo e a file da parte di processi diversi deve
    essere evitato per prevenire le race condition. Per evitare ciò
    devono essere usati i meccanismi di lock dei file utilizzando 
    flock(1).

    La sicurezza dei dati e la loro condivisione controllata hanno
    diversi aspetti.

      * La creazione di archivi di dati

      * L'accesso ad archivi remoti

      * La duplicazione

      * Il tenere traccia della cronologia delle modifiche

      * La facilitazione della condivisione dei dati

      * Il prevenire l'accesso non autorizzato ai file

      * La rilevazione di modifiche non autorizzate ai file

    Queste azioni possono essere realizzate usando una combinazione
    di strumenti.

      * Strumenti di archiviazione e compressione

      * Strumenti di copia e sincronizzazione

      * file system di rete

      * Supporti di archiviazione removibili
   
      * Secure Shell

      * Il sistema di autenticazione

      * Strumenti per sistemi di controllo delle versioni

      * Strumenti crittografici per hash e cifratura

%

10.1.1. Strumenti di archiviazione e compressione

    Ecco una tabella riassuntiva degli strumenti di archiviazione e
    compressione disponibili per il sistema Debian.

    Tabella 10.1. Elenco di strumenti di archiviazione e compressione

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|estensione|comando|   commento    |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |          |V:905,|          |          |       |archiviazione  |
    |tar       |I:999 |3098      |.tar      |tar(1) |standard       |
    |          |      |          |          |       |(standard de   |
    |          |      |          |          |       |facto)         |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |          |      |          |          |       |archiviazione  |
    |cpio      |V:412,|1136      |.cpio     |cpio(1)|Unix in stile  |
    |          |I:998 |          |          |       |System V, da   |
    |          |      |          |          |       |usare con find |
    |          |      |          |          |       |(1)            |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |          |      |          |          |       |archiviazione  |
    |binutils  |V:164,|97        |.ar       |ar(1)  |per la         |
    |          |I:678 |          |          |       |creazione di   |
    |          |      |          |          |       |librerie       |
    |          |      |          |          |       |statiche       |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |fastjar   |V:2,  |183       |.jar      |fastjar|archiviazione  |
    |          |I:29  |          |          |(1)    |per Java       |
    |          |      |          |          |       |(simile a zip) |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |nuovo strumento|
    |          |V:13, |          |          |       |POSIX di       |
    |pax       |I:26  |170       |.pax      |pax(1) |archiviazione, |
    |          |      |          |          |       |compromesso tra|
    |          |      |          |          |       |tar e cpio     |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |gzip(1)|utilità GNU di |
    |gzip      |V:883,|245       |.gz       |, zcat |compressione   |
    |          |I:999 |          |          |(1), … |LZ77 (standard |
    |          |      |          |          |       |de facto)      |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |utilità per    |
    |          |      |          |          |       |compressione   |
    |          |      |          |          |       |con ordinamento|
    |          |      |          |          |       |dei blocchi    |
    |          |      |          |          |bzip2  |Burrows-Wheeler|
    |bzip2     |V:157,|122       |.bz2      |(1),   |con maggiore   |
    |          |I:970 |          |          |bzcat  |rapporto di    |
    |          |      |          |          |(1), … |compressione di|
    |          |      |          |          |       |gzip(1) (più   |
    |          |      |          |          |       |lenta di gzip  |
    |          |      |          |          |       |con sintassi   |
    |          |      |          |          |       |simile)        |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |utilità di     |
    |          |      |          |          |       |compressione   |
    |          |      |          |          |       |LZMA con       |
    |lzma      |V:2,  |149       |.lzma     |lzma(1)|maggiore       |
    |          |I:29  |          |          |       |rapporto di    |
    |          |      |          |          |       |compressione di|
    |          |      |          |          |       |gzip(1)        |
    |          |      |          |          |       |(deprecata)    |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |utilità di     |
    |          |      |          |          |       |compressione XZ|
    |          |      |          |          |       |con maggiore   |
    |          |      |          |          |       |rapporto di    |
    |          |      |          |          |       |compressione di|
    |          |V:454,|          |          |xz(1), |bzip2(1) (più  |
    |xz-utils  |I:977 |612       |.xz       |xzdec  |lenta di gzip, |
    |          |      |          |          |(1), … |ma più veloce  |
    |          |      |          |          |       |di bzip2;      |
    |          |      |          |          |       |sostituto      |
    |          |      |          |          |       |dell'utilità di|
    |          |      |          |          |       |compressione   |
    |          |      |          |          |       |LZMA)          |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |          |      |          |          |       |archiviazione  |
    |          |V:89, |          |          |7zr(1),|file 7-Zip con |
    |p7zip     |I:464 |987       |.7z       |p7zip  |alto rapporto  |
    |          |      |          |          |(1)    |di compressione|
    |          |      |          |          |       |(compressione  |
    |          |      |          |          |       |LZMA)          |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |strumento di   |
    |          |      |          |          |       |archiviazione  |
    |          |V:113,|          |          |7z(1), |file 7-Zip con |
    |p7zip-full|I:486 |4664      |.7z       |7za(1) |alto rapporto  |
    |          |      |          |          |       |di compressione|
    |          |      |          |          |       |(compressione  |
    |          |      |          |          |       |LZMA e altre)  |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |utilità di     |
    |          |      |          |          |       |compressione   |
    |          |      |          |          |       |LZO con        |
    |          |      |          |          |       |velocità di    |
    |          |      |          |          |       |compressione e |
    |          |      |          |          |       |decompressione |
    |lzop      |V:9,  |164       |.lzo      |lzop(1)|più alta di    |
    |          |I:76  |          |          |       |quella di gzip |
    |          |      |          |          |       |(1) (più basso |
    |          |      |          |          |       |rapporto di    |
    |          |      |          |          |       |compressione di|
    |          |      |          |          |       |gzip con       |
    |          |      |          |          |       |sintassi       |
    |          |      |          |          |       |simile)        |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |InfoZIP:       |
    |          |V:51, |          |          |       |strumento di   |
    |zip       |I:432 |608       |.zip      |zip(1) |archiviazione e|
    |          |      |          |          |       |compressione   |
    |          |      |          |          |       |per DOS        |
    |----------+------+----------+----------+-------+---------------|
    |          |      |          |          |       |InfoZIP:       |
    |          |      |          |          |       |strumento di   |
    |unzip     |V:154,|566       |.zip      |unzip  |estrazione di  |
    |          |I:798 |          |          |(1)    |archivi e      |
    |          |      |          |          |       |decompressione |
    |          |      |          |          |       |per DOS        |
    +---------------------------------------------------------------+


    Avvertimento
   
    Non impostare la variabile "$TAPE" a meno che non si sappia
    esattamente cosa aspettarsi. Cambia il comportamento di tar(1).

    Nota
   
    Gli archivi tar(1) compressi con gzip usano l'estensione di file
    ".tgz" o ".tar.gz".

    Nota
   
    Gli archivi tar(1) compressi con xz usano l'estensione di file
    ".txz" o ".tar.xz".

    Nota

    La popolarità dei metodi di compressione negli strumenti FOSS
    come tar(1) è cambiata nel tempo nel modo seguente gzip → bzip2 →
    xz

    Nota
   
    cp(1), scp(1) e tar(1) possono avere alcune limitazioni per file
    speciali. cpio(1) è più versatile.

    Nota

    cpio(1) è progettato per essere usato con find(1) ed altri
    comandi adatti per creare script di backup, dato che la porzione
    di selezione dei file dello script può essere testata in modo
    autonomo.

    Nota
   
    La struttura interna dei file di dati di LibreOffice è quella dei
    file «.jar» che può essere aperta anche da unzip.

    Nota

    Lo strumento multipiattaforma di fatto usato per gli archivi è
    zip. Usarlo come «zip -rX» per ottenere la massima compatibilità.
    Usare anche l'opzione «-s» se è importante la dimensione massima
    dei file.

%

10.1.2. Strumenti di copia e sincronizzazione

    Ecco una tabella riassuntiva dei semplici strumenti di copia e
    backup disponibili in un sistema Debian.

    Tabella 10.2. Elenco di strumenti di copia e sincronizzazione

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|strumento|      funzione      |
    |--------------+------+----------+---------+--------------------|
    |              |      |          |         |copia file e        |
    |coreutils     |V:891,|17478     |GNU cp   |directory localmente|
    |              |I:999 |          |         |("-a" per modalità  |
    |              |      |          |         |ricorsiva)          |
    |--------------+------+----------+---------+--------------------|
    |              |      |          |         |copia file e        |
    |openssh-client|V:803,|4298      |scp      |directory da remoto |
    |              |I:996 |          |         |(client, "-r" per   |
    |              |      |          |         |modalità ricorsiva) |
    |--------------+------+----------+---------+--------------------|
    |              |V:690,|          |         |copia file e        |
    |openssh-server|I:834 |1567      |sshd     |directory da remoto |
    |              |      |          |         |(server remoto)     |
    |--------------+------+----------+---------+--------------------|
    |              |V:281,|          |         |sincronizzazione e  |
    |rsync         |I:560 |677       |-        |backup in remoto    |
    |              |      |          |         |unidirezionale      |
    |--------------+------+----------+---------+--------------------|
    |              |V:4,  |          |         |sincronizzazione e  |
    |unison        |I:17  |14        |-        |backup in remoto    |
    |              |      |          |         |bidirezionale       |
    +---------------------------------------------------------------+


    La copia dei file con rsync(8) offre un insieme di funzionalità
    più ricco di altri strumenti.

      * l'algoritmo delta-transfer, che invia solamente le differenze
        tra il file sorgente ed il file esistente nella destinazione

      * algoritmo veloce di verifica (predefinito) che cerca i file
        la cui dimensione o il cui orario di ultima modifica sono
        cambiati
   
      * opzioni "--exclude" e "--exclude-from" simili a quelle di tar
        (1)

      * sintassi con "una barra / alla fine della directory sorgente"
        che evita di dover creare un livello aggiuntivo di directory
        nella destinazione

    Suggerimento

    L'esecuzione, tramite cron(8), dello script bkup citato in
    Sezione 10.2.3, «Uno script di copia per backup di dati» con
    l'opzione "-gl", dovrebbe fornire funzionalità moltio simili a
    dumpfs di Plan9 per un archivio di dati statici.

    Suggerimento

    Gli strumenti di controllo delle versioni VCS (Version control
    system) in Tabella 10.11, «Elenco di strumenti per sistemi di
    controllo delle versioni» possono essere usati come strumenti di
    copia e sincronizzazione multidirezionali.

%

10.1.3. Esempi di invocazione per archivi

    Ecco diversi modi di archiviare ed estrarre archivi con l'intero
    contenuto della directory "./sorgente", usando diversi strumenti.

    GNU tar(1):

    $ tar -cvJf archivo.tar.xz ./sorgente
    $ tar -xvJf archivo.tar.xz

    In alternativa usare i comandi seguenti.

    $ find ./sorgente -xdev -print0 | tar -cvJf archivo.tar.xz --null -F -

    cpio(1):

    $ find ./sorgente -xdev -print0 | cpio -ov --null > archivo.cpio; xz archivo.cpio
    $ zcat archivo.cpio.xz | cpio -i

%

10.1.4. Esempi di invocazione per la copia

    Ecco diversi modi di copiare l'intero contenuto della directory
    "./sorgente", usando diversi strumenti.

      * Copia locale: directory "./sorgente" → directory "/dest"
   
      * Copia remota: directory "./sourgente" sull'host locale →
        directory "/dest" sull'host "utente@host.dom"

    rsync(8):

    # cd ./sorgente; rsync -aHAXSv . /dest
    # cd ./sorgente; rsync -aHAXSv . utente@host.dom:/dest

    In alternativa si può usare la sintassi con "una barra / alla
    fine della directory sorgente".

    # rsync -aHAXSv ./sorgente/ /dest
    # rsync -aHAXSv ./sorgente/ utente@host.dom:/dest

    In alternativa usare i comandi seguenti.

    # cd ./sorgente; find . -print0 | rsync -aHAXSv0 --files-from=- . /dest
    # cd ./sorgente; find . -print0 | rsync -aHAXSv0 --files-from=- . utente@host.dom:/dest

    GNU cp(1) e openSSH scp(1):

    # cd ./sorgente; cp -a . /dest
    # cd ./sorgente; scp -pr . utente@host.dom:/dest

    GNU tar(1):

    # (cd ./sorgente && tar cf - . ) | (cd /dest && tar xvfp - )
    # (cd ./sorgente && tar cf - . ) | ssh utente@host.dom '(cd /dest && tar xvfp - )'

    cpio(1):

    # cd ./sorgente; find . -print0 | cpio -pvdm --null --sparse /dest

    In tutti gli esempi contenenti ".", si può sostituire "." con
    "pippo" per copiare i file dalla directory "./sorgente/pippo"
    alla directory "/dest/pippo".

    In tutti gli esempi contenenti ".", si può sostituire "." con il
    percorso assoluto "/percorso/di/sorgente/pippo" per evitare di
    fare "cd ./sorgente;". I file verranno copiati in posizioni
    diverse a seconda dello strumento utilizzato, come descritto qui
    di seguito.

      * in "/dest/pippo": rsync(8), GNU cp(1) e scp(1)
   
      * "/dest/percorso/di/sorgente/pippo": GNU tar(1) e cpio(1)

    Suggerimento
   
    rsync(8) e GNU cp(1) hanno l'opzione "-u" per saltare i file che
    sono più recenti nella destinazione.

%

10.1.5. Esempi di invocazione per la selezione di file

    find(1) viene usato per selezionare i file per i comandi di
    archiviazione e copia (vedere Sezione 10.1.3, «Esempi di
    invocazione per archivi» e Sezione 10.1.4, «Esempi di invocazione
    per la copia») o per xargs(1) (vedere Sezione 9.3.9, «Ripetere un
    comando su diversi file»). Questo funzionamento può essere
    migliorato usando le sue opzioni di comando.

    La sintassi base di find(1) può essere riassunta nel modo
    seguente.

      * Gli argomenti condizionali sono valutati da sinistra a
        destra.

      * Questa valutazione si ferma una volta che il risultato è
        determinato.

      * L'operatore "OR logico" (specificato con "-o" tra condizioni)
        ha una precedenza più bassa dell'operatore "AND logico"
        (specificato da "-a" o dall'assenza di un operatore tra
        condizioni).

      * L'operatore "NOT logico" (specificato da "!" prima di una
        condizione) ha una precedenza più alta di un operatore "AND
        logico".

      * L'opzione "-prune" restituisce sempre una condizione di VERO
        logico e, se si tratta di una directory, la ricerca si ferma
        a questo punto.

      * L'opzione "-name trova corrispondenze con il nome base del
        file tramite espressioni glob di shell (vedere Sezione 1.5.6,
        «Glob della shell»), ma fa corrispondenza anche con il
        carattere iniziale "." con l'uso di metacaratteri come "*" e
        "?". (Nuova funzionalità POSIX.)

      * L'opzione "-regex" trova corrispondenze con il percorso
        completo usando, in modo predefinito, BRE in stile emacs
        (vedere Sezione 1.6.2, «Espressioni regolari»).

      * L'opzione "-size" trova corrispondenze con file in base alla
        loro dimensione (valori preceduti da "+" o "-" per cercare
        dimensioni, rispettivamente, più grandi o piccole del
        valore).

      * L'opzione "-newer" trova corrispondenze con file più recenti
        di quello specificato come argomento dell'opzione.

      * L'opzione "-print0" restituisce sempre il valore logico VERO
        e stampa il nome file completo (terminato dal carattere null)
        sullo standard output.

    find(1) è spesso usato con uno stile di invocazione come il
    seguente.

    # find /path/to \
        -xdev -regextype posix-extended \
        -type f -regex ".*\.cpio|.*~" -prune -o \
        -type d -regex ".*/\.git" -prune -o \
        -type f -size +99M -prune -o \
        -type f -newer /path/to/timestamp -print0

    Il comando precedente si traduce nelle azioni seguenti.

     1. Cercare tutti i file a partire da "/percorso/di"

     2. Limitare globalmente la ricerca al file system da cui è
        richiamato e usare espressioni regolari ERE (vedere
        Sezione 1.6.2, «Espressioni regolari»)

     3. Escludere i file che corrispondono all'espressione regolare
        ".*\.cpio" o ".*~" dalla ricerca fermando la loro
        elaborazione
   
     4. Escludere le directory che corrispondono all'espressione
        regolare ".*/\.git" dalla ricerca fermando la loro
        elaborazione

     5. Escludere i file più grandi di 99 Megabyte (unità di 1048576
        byte) dalla ricerca fermando la loro elaborazione

     6. Stampare i nomi di file che soddisfano le condizioni di
        ricerca precedenti e che siano più recenti di "/percorso/di/
        marcaturaorario"

    Notare nell'esempio precedente l'uso della parte di comando
    "-prune -o per escludere file.

    Nota

    Alcune opzioni per find(1) potrebbero non essere supportate per i
    sistemi *nix non Debian. In questi casi, cambiare le invocazioni
    in quelle adatte corrispondenti e sostituire "-print0" con
    "-print". Potrebbe essere necessario modificare anche comandi
    correlati.

%

10.1.6. Supporti di archiviazione

    Quando si deve scegliere il supporto di archiviazione di dati
    informatici per un importante archivio di dati, si dovrebbe porre
    attenzione alle limitazioni dei supporti. Per piccoli backup di
    dati personali, io uso CD-R e DVD-R scegliendoli in base alla
    marca del produtttore e conservandoli in un ambiente fresco,
    all'ombra, asciutto e pulito. (I supporti di archiviazione a
    nastro sembrano molto popolari per gli usi professionali.)

    Nota

    Le casseforti a prova di fuoco sono pensate per i documenti
    cartacei. La maggior parte dei supporti di archiviazione di dati
    informatici ha una tolleranza più bassa alle alte temperature
    rispetto alla carta. Di solito mi affido a copie multiple cifrate
    sicure conservate in diverse posizioni sicure.

    Durata di vita ottimistica di diversi supporti di archiviazione
    da dati raccolti in rete (per lo più dalle informazioni dei
    produttori).

      * 100+ anni: carta senza acidi con inchiostro

      * 100 anni: supporti ottici (CD/DVD, CD/DVD-R)
   
      * 30 anni: supporti magnetici (nastri, dischetti floppy)

      * 20 anni: supporti ottici a cambio di fase (CD-RW)

    Questi tempi non tengono conto dei danni meccanici causati dal
    maneggiamento, ecc.

    Cicli di scrittura ottimistici di diversi supporti di
    archiviazione da dati raccolti in rete (per lo più dalle
    informazioni dei produttori).

      * 250,000+ cicli: unità a disco fisso

      * 10,000+ cicli: memoria flash
   
      * 1,000 cicli: CD/DVD-RW

      * 1 ciclo: CD/DVD-R, carta

    Attenzione

    I valori di durata di vita e dei cicli di scrittura riportati non
    dovrebbero essere usati per prendere decisioni riguardo
    all'archiviazione di dati critici. Consultare le informazioni
    specifiche per ciascun prodotto forniti dal produttore.

    Suggerimento

    Dato che i CD/DVD-R e la carta hanno un solo ciclo di scrittura,
    prevengono per loro stessa natura le perdite accidentali di dati
    per sovrascrittura. Questo è un vantaggio!

    Suggerimento

    Se è necessario fare backup frequenti e veloci di una grande
    quantità di dati, un disco fisso su un host remoto connesso con
    una connessione veloce, potrebbe essere l'unica soluzione
    realistica.

%

10.1.7. Supporti di archiviazione removibili

    Un support di archiviazione removibile può essere uno dei
    seguenti.

      * Unità flash USB

      * Unità a disco fisso

      * Unità a dischi ottici

      * Fotocamera digitale

      * Lettore audio digitale

    Possono essere connessi in uno dei modi seguenti.

      * USB

      * IEEE 1394 / FireWire

      * Scheda PC

    Gli ambienti desktop moderni, come GNOME e KDE, possono montare
    questi dispositivi removibili automaticamente senza una voce
    corrispondente in "/etc/fstab".

      * Il pacchetto udisks fornisce un demone e le utilità associate
        per montare e smontare questi dispositivi.
   
      * D-bus crea eventi per dare inizio ai processi automatici.

      * PolicyKit fornisce i privilegi necessari.

    Suggerimento
   
    I dispositivi montati automaticamente hanno l'opzione di mount
    "uhelper=" che viene usata da umount(8).

    Suggerimento

    Nei moderni ambienti desktop il montaggio automatico avviene solo
    quando i device dei supporti removibili non sono elencati in "/
    etc/fstab".

    Il punto di mount negli ambienti desktop moderni viene scelto
    come "/media/<etichetta_disco>" che può essere personalizzata nel
    modo seguente.

      * mlabel(1) per file system FAT

      * genisoimage(1) con l'opzione "-V" per file system ISO9660

      * tune2fs(1) con l'opzione "-L" per file system ext2/ext3/ext4

    Suggerimento

    Può essere necessario fornire come opzione di montaggio la scelta
    della codifica (vedere Sezione 8.4.6, «Codifica per i nomi di
    file»).

    Suggerimento

    L'uso del menu GUI per smontare un file system può rimuovere il
    suo nodo di device generato dinamicamente come "/dev/sdc". Se si
    desidera mantenere il suo nodo di device, smontarlo con il
    comando umount(8) dal prompt di shell.

%

10.1.8. Scelta del file system per la condivisione di dati

    Quando si condividono dati con un altro sistema attraverso
    dispositivi di archiviazione removibili, quest'ultimi andrebbero
    formattati con un filesystem comune supportato da entrambi i
    sistemi. Quello che segue è un elenco delle scelte possibili per
    il file system.

    Tabella 10.3. Elenco di possibili scelte per il file system di
    dispositivi di archiviazione removibili con scenari di uso tipici

    +---------------------------------------------------------------+
    | file  |       descrizione dello scenario di uso tipico        |
    |system |                                                       |
    |-------+-------------------------------------------------------|
    |FAT12  |condivisione interpiattaforma di dati su dischetti     |
    |       |floppy (<32MiB)                                        |
    |-------+-------------------------------------------------------|
    |FAT16  |condivisione interpiattaforma di dati su dispositivi   |
    |       |come piccoli dischi fissi (<2GiB)                      |
    |-------+-------------------------------------------------------|
    |       |condivisione interpiattaforma di dati su dispositivi   |
    |FAT32  |come grandi dischi fissi (<8TiB, supportato da sistemi |
    |       |più recenti di MS Windows95 OSR2)                      |
    |-------+-------------------------------------------------------|
    |       |condivisione interpiattaforma di dati su dispositivi   |
    |NTFS   |come grandi dischi fissi (supportato nativamente su MS |
    |       |Windows NT e versioni successive e supportato da       |
    |       |NTFS-3G attraverso FUSE in Linux)                      |
    |-------+-------------------------------------------------------|
    |ISO9660|condivisione interpiattaforma di dati statici su CD-R e|
    |       |DVD+/-R                                                |
    |-------+-------------------------------------------------------|
    |UDF    |scrittura incrementale di dati su CD-R e DVD+/-R       |
    |       |(nuovo)                                                |
    |-------+-------------------------------------------------------|
    |file   |archiviazione, efficiente in termini di spazio, di file|
    |system |dati unix su dischetti floppy                          |
    |MINIX  |                                                       |
    |-------+-------------------------------------------------------|
    |file   |condivisione di dati su dispositivi come dischi fissi  |
    |system |con sistemi Linux più vecchi                           |
    |ext2   |                                                       |
    |-------+-------------------------------------------------------|
    |file   |condivisione di dati su dispositivi come dischi fissi  |
    |system |con sistemi Linux più vecchi                           |
    |ext3   |                                                       |
    |-------+-------------------------------------------------------|
    |file   |condivisione di dati su dispositivi come dischi fissi  |
    |system |con sistemi Linux recenti                              |
    |ext4   |                                                       |
    +---------------------------------------------------------------+


    Suggerimento

    Vedere Sezione 9.8.1, «Cifratura di dischi removibili con
    dm-crypt/LUKS» per la condivisione interpiattaforma di dati
    usando cifratura a livello di dispositivo.

    Il file system FAT è supportato da quasi tutti i sistemi
    operativi moderni ed è piuttosto utile per scopi di scambio di
    dati attraverso supporti come dischi fissi removibili.

    Quando si formatta un dispositivo come un disco fisso removibile
    con il file system FAT per la condivisione interpiattaforma di
    dati, le scelte seguenti dovrebbero essere quelle più sicure.

      * Partizionare con fdisk(8), cfdisk(8) o parted(8) (vedere
        Sezione 9.5.2, «Configurazione del partizionamento dei
        dischi») creando un'unica partizione primaria e marcarla nel
        modo seguente.

          + Tipo "6", cioè FAT16, per supporti più piccoli di 2GB.

          + Tipo "c", cioè FAT32 (LBA), per supporti più grandi.
   
      * Formattare la partizione primaria con mkfs.vfat(8) nel modo
        seguente.

          + Per FAT16, semplicemente con il suo nome di device, ad
            esempio "/dev/sda1".

          + Per FAT32, con il suo nome di device e l'opzione
            esplicita, ad esempio "-F 32 /dev/sda1"

    Quando si usano i file system FAT o ISO9660 per la condivisione
    dei dati, per essere sicuri dei risultati, si dovrebbero
    considerare i seguenti aspetti.

      * Archiviare prima i file in un file di archivio usando tar(1)
        o cpio(1) per mantenere i nomi di file lunghi, i collegamenti
        simbolici, i permessi Unix sui file originali e le
        informazioni sui proprietari.

      * Suddividere il file di archivio in pezzi più piccoli di 2 GiB
        con il comando split(1) per proteggerli da limitazioni sulla
        dimensione dei file.

      * Cifrare il file archivio per proteggere i suoi contenuti da
        accesso non autorizzato.

    Nota

    Il file system FAT, per sua stessa natura, permette una
    dimensione massima per i file di (2^32 - 1) byte = (4GiB - 1
    byte). Per alcune applicazioni su sistemi operativi a 32 bit più
    vecchi, la dimensione massima per i file era ancora più piccola:
    (2^31 - 1) byte = (2GiB - 1 byte). Debian non soffre di
    quest'ultima limitazione.

    Nota

    La stessa Microsoft non raccomanda l'uso di FAT per le unità o le
    partizioni più grandi di 200 MB. Microsoft evidenzia le sue
    limitazioni, quali un uso inefficiente dello spazio su disco, nel
    documento "Overview of FAT, HPFS, and NTFS File Systems".
    Naturalmente per Linux si dovrebbe normalmente usare il file
    system ext4.

    Suggerimento
   
    Per maggiori informazioni sui file system e sull'accesso ad essi,
    leggere il "Filesystems HOWTO".

%

10.1.9. Condividere dati attraverso una rete

    Quando si condividono dati con un altro sistema attraverso una
    rete, si dovrebbero tenere a mente i servizi comuni. Ecco alcuni
    suggerimenti.

    Tabella 10.4. Elenco dei servizi di rete da scegliere in base
    allo scenario di uso tipico

    +---------------------------------------------------------------+
    | servizio di rete |  descrizione dello scenario di uso tipico  |
    |------------------+--------------------------------------------|
    |file system       |condivisione di file attraverso "rete       |
    |montato di rete   |Microsoft Windows", vedere smb.conf(5) e The|
    |SMB/CIFS con Samba|Official Samba 3.x.x HOWTO and Reference    |
    |                  |Guide o il pacchetto samba-doc              |
    |------------------+--------------------------------------------|
    |file system       |                                            |
    |montato di rete   |condivisione di file attraverso "rete Unix/ |
    |NFS con il kernel |Linux", vedere exports(5) e Linux NFS-HOWTO |
    |Linux             |                                            |
    |------------------+--------------------------------------------|
    |servizio HTTP     |condivisione di file tra client/server web  |
    |------------------+--------------------------------------------|
    |                  |condivisione di file tra client/server web  |
    |servizio HTTPS    |con SSL (Secure Sockets Layer) cifrato o TLS|
    |                  |(Transport Layer Security)                  |
    |------------------+--------------------------------------------|
    |servizio FTP      |condivisione di file tra client/server FTP  |
    +---------------------------------------------------------------+


    Sebbene questi file system montati in rete e metodi di
    trasferimento di file attraverso la rete siano piuttosto comodi
    per la condivisione dei dati, possono essere non sicuri. La loro
    connessione di rete deve essere resa sicura nel modo seguente.

      * Cifrarli con SSL/TLS

      * Usarli in tunnel SSH
   
      * Usarli in tunnel VPN

      * Limitarli dietro ad un firewall sicuro

    Vedere anche Sezione 6.10, «Altri server di rete» e Sezione 6.11,
    «Altri client di rete».

%

10.2. Backup e ripristino

    Tutti sanno che i computer a volte si danneggiano oppure errori
    umani causano danni al sistema e ai dati. Le operazioni di backup
    e ripristino sono una parte essenziale di un'amministrazione di
    sistema di successo. Tutte i possibili modi in cui si possono
    creare danni si verificano prima o poi.

    Suggerimento

    Mantenere il proprio sistema di backup semplice e fare il backup
    di sistema spesso. Avere dati di backup è più importante della
    qualità tecnica del metodo di backup.

    Ci sono 3 fattori chiave che determinano la reale politica di
    backup e ripristino.

     1. Sapere di cosa fare il backup ed il ripristino

          + I file dati direttamente creati dall'utente: in "~/"

          + I file dati creati da applicazioni usate dall'utente:
            dati in "/var/" (tranne "/var/cache/", "/var/run/" e "/
            var/tmp/")

          + File di configurazione del sistema: dati in "/etc/"

          + Software locali: dati in "/usr/local/" o "/opt/"

          + Informazioni di installazione del sistema: un memorandum
            in puro testo sui passi chiave (partizioni, …)

          + Insiemi di dati comprovati: confermati da operazioni
            preventive sperimentali di ripristino

     2. Sapere come fare il backup ed il ripristino
   
          + Rendere sicura l'archiviazione dei dati: protezione da
            sovrascritture e fallimenti del sistema

          + Backup frequenti: backup pianificati

          + Backup ridondanti: mirror di dati

          + Procedura a prova di idioti: singolo facile comando di
            backup

     3. Valutazione dei rischi e dei costi

          + Valore dei dati se persi

          + Risorse necessarie per il backup: umane, hardware,
            software, …

          + Modi in cui le cose possono andare storte e loro
            probabilità

    Nota

    Non fare il backup dei contenuti dei pseudo file system che si
    trovano in /proc, /sys, /tmp e /run (vedere Sezione 1.2.12,
    «procfs e sysfs» e Sezione 1.2.13, «tmpfs»). A meno di non sapere
    esattamente ciò che si sta facendo, sono un'enorme mole di dati
    senza utilità.

    Per quanto riguarda il rendere sicura l'archiviazione dei dati,
    questi dovrebbero essere come minimo in una partizione diversa
    del disco e preferibilmente su dischi e macchine diversi per
    sopravvivere alla corruzione del file system. È preferibile
    archiviare i dati importanti su supporti scrivibili una sola
    volta, come CD/DVD-R per prevenire incidenti di sovrascrittura.
    (Vedere Sezione 9.7, «I dati binari» per come scrivere sul
    supporto di archiviazione dalla riga di comando. L'ambiente
    desktop GNOME con interfaccia grafica fornisce un facile accesso
    tramite menu: "Risorse→Creazione CD/DVD".)

    Nota

    Durante il backup dei dati può essere preferibile fermare alcuni
    demoni applicativi come l'MTA (vedere Sezione 6.3, «Agente di
    trasporto della posta (MTA)»).

    Nota

    Si dovrebbe dare un'attenzione particolare al backup ed al
    ripristino di file con dati relativi all'identità dell'utente,
    come "/etc/ssh/ssh_host_dsa_key", "/etc/ssh/ssh_host_rsa_key", "~
    /.gnupg/*", "~/.ssh/*", "/etc/passwd", "/etc/shadow", "/etc/
    fetchmailrc", "popularity-contest.conf", "/etc/ppp/pap-secrets" e
    "/etc/exim4/passwd.client". Alcuni di questi dati non possono
    essere ricreati inserendo la stessa stringa di input nel sistema.

    Nota

    Se si esegue un compito di cron come processo di un utente, si
    deve ripristinare i file nella directory "/var/spool/cron/
    crontabs" e riavviare cron(8). Vedere Sezione 9.3.14,
    «Pianificare compiti in modo regolare» per informazioni su cron
    (8) e crontab(1).

%

10.2.1. Suite con utilità di backup

    Quello che segue è un elenco di importanti suite di utilità di
    backup disponibili in un sistema Debian

    Tabella 10.5. Elenco di suite con utilità di backup

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione|         descrizione          |
    |--------------+------+----------+------------------------------|
    |              |V:1,  |          |dump(8) e restore(8) di BSD   |
    |dump          |I:6   |352       |4.4 per file system ext2/ext3/|
    |              |      |          |ext4                          |
    |--------------+------+----------+------------------------------|
    |              |V:0,  |          |dump e ripristino con xfsdump |
    |xfsdump       |I:9   |854       |(8) e xfsrestore(8) per file  |
    |              |      |          |system XFS in GNU/Linux e IRIX|
    |--------------+------+----------+------------------------------|
    |backupninja   |V:4,  |355       |sistema di meta-backup leggero|
    |              |I:5   |          |ed estensibile                |
    |--------------+------+----------+------------------------------|
    |              |V:10, |          |Bacula: backup, ripristino e  |
    |bacula-common |I:15  |2158      |controllo in rete - file      |
    |              |      |          |comuni di supporto            |
    |--------------+------+----------+------------------------------|
    |              |      |          |Bacula: backup, ripristino e  |
    |bacula-client |I:3   |183       |controllo in rete -           |
    |              |      |          |metapacchetto client          |
    |--------------+------+----------+------------------------------|
    |              |V:1,  |          |Bacula: backup, ripristino e  |
    |bacula-console|I:5   |107       |controllo in rete - console   |
    |              |      |          |testuale                      |
    |--------------+------+----------+------------------------------|
    |              |      |          |Bacula: backup, ripristino e  |
    |bacula-server |I:1   |183       |controllo in rete -           |
    |              |      |          |metapacchetto server          |
    |--------------+------+----------+------------------------------|
    |              |V:0,  |          |Amanda: Advanced Maryland     |
    |amanda-common |I:2   |10031     |Automatic Network Disk        |
    |              |      |          |Archiver (Librerie)           |
    |--------------+------+----------+------------------------------|
    |              |V:0,  |          |Amanda: Advanced Maryland     |
    |amanda-client |I:2   |1089      |Automatic Network Disk        |
    |              |      |          |Archiver (Client)             |
    |--------------+------+----------+------------------------------|
    |              |V:0,  |          |Amanda: Advanced Maryland     |
    |amanda-server |I:0   |1076      |Automatic Network Disk        |
    |              |      |          |Archiver (Server)             |
    |--------------+------+----------+------------------------------|
    |backup-manager|V:1,  |572       |strumento di backup a riga di |
    |              |I:2   |          |comando                       |
    |--------------+------+----------+------------------------------|
    |              |      |          |strumento di backup/ripristino|
    |backup2l      |V:0,  |114       |per supporti montabile (basato|
    |              |I:1   |          |su dischi) che richiede bassa |
    |              |      |          |manutenzione                  |
    |--------------+------+----------+------------------------------|
    |              |      |          |BackupPC è un sistema ad altre|
    |backuppc      |V:3,  |3182      |prestazioni di qualità        |
    |              |I:3   |          |professionale per il backup di|
    |              |      |          |PC (basato su dischi)         |
    |--------------+------+----------+------------------------------|
    |duplicity     |V:7,  |1761      |backup incrementali (remoti)  |
    |              |I:15  |          |                              |
    |--------------+------+----------+------------------------------|
    |flexbackup    |V:0,  |243       |backup incrementali (remoti)  |
    |              |I:0   |          |                              |
    |--------------+------+----------+------------------------------|
    |rdiff-backup  |V:7,  |733       |backup incrementali (remoti)  |
    |              |I:15  |          |                              |
    |--------------+------+----------+------------------------------|
    |restic        |V:1,  |20595     |backup incrementali (remoti)  |
    |              |I:3   |          |                              |
    |--------------+------+----------+------------------------------|
    |rsnapshot     |V:5,  |462       |backup incrementali (remoti)  |
    |              |I:11  |          |                              |
    |--------------+------+----------+------------------------------|
    |slbackup      |V:0,  |151       |backup incrementali (remoti)  |
    |              |I:0   |          |                              |
    +---------------------------------------------------------------+


    Gli strumenti di backup hanno una propria specializzazione.

      * Mondo Rescue è un sistema di backup per facilitare il
        ripristino veloce di un sistema completo a partire da backup
        su CD/DVD ecc., senza dover affrontare il normale processo di
        installazione del sistema.

      * Backup regolari dei dati degli utenti possono essere
        realizzati da un semplice script (Sezione 10.2.2, «Uno script
        di esempio per il backup di sistema») e cron(8).

      * Bacula, Amanda e BackupPC sono suite di utilità di backup
        complete che sono pensate per backup regolari in rete.

    Gli strumenti base descritti in Sezione 10.1.1, «Strumenti di
    archiviazione e compressione» e Sezione 10.1.2, «Strumenti di
    copia e sincronizzazione» possono essere usati per facilitare il
    backup di sistema attraverso script personalizzati. Tali script
    possono essere migliorati con gli strumenti seguenti.

      * Il pacchetto restic permette backup incrementali (remoti).

      * Il pacchetto rdiff-backup permette backup incrementali
        (remoti).

      * Il pacchetto dump aiuta ad archiviare e ripristinare tutto il
        file system in maniera incrementale ed efficiente.

    Suggerimento

    Per imparare ulteriori informazioni sul pacchetto dump, vedere i
    file in "/usr/share/doc/dump/" e "Is dump really deprecated?
    (dump è davvero deprecato?).

%

10.2.2. Uno script di esempio per il backup di sistema

    Per un sistema desktop Debian personale con la suite unstable,
    devo proteggere solo i dati personali e quelli critici; tanto
    reinstallo comunque il sistema una volta all'anno. Perciò non ho
    ragione di fare il backup dell'intero sistema o di installare
    un'utilità completa di backup.

    Uso un semplice script per fare un archivio di backup e
    masterizzarlo su CD/DVD usando una GUI. Ecco uno script di
    esempio che fa proprio questo.

    #!/bin/sh -e
    # Copyright (C) 2007-2008 Osamu Aoki <osamu@debian.org>, Public Domain
    BUUID=1000; USER=osamu # UID and name of a user who accesses backup files
    BUDIR="/var/backups"
    XDIR0=".+/Mail|.+/Desktop"
    XDIR1=".+/\.thumbnails|.+/\.?Trash|.+/\.?[cC]ache|.+/\.gvfs|.+/sessions"
    XDIR2=".+/CVS|.+/\.git|.+/\.svn|.+/Downloads|.+/Archive|.+/Checkout|.+/tmp"
    XSFX=".+\.iso|.+\.tgz|.+\.tar\.gz|.+\.tar\.bz2|.+\.cpio|.+\.tmp|.+\.swp|.+~"
    SIZE="+99M"
    DATE=$(date --utc +"%Y%m%d-%H%M")
    [ -d "$BUDIR" ] || mkdir -p "BUDIR"
    umask 077
    dpkg --get-selections \* > /var/lib/dpkg/dpkg-selections.list
    debconf-get-selections > /var/cache/debconf/debconf-selections

    {
    find /etc /usr/local /opt /var/lib/dpkg/dpkg-selections.list \
         /var/cache/debconf/debconf-selections -xdev -print0
    find /home/$USER /root -xdev -regextype posix-extended \
      -type d -regex "$XDIR0|$XDIR1" -prune -o -type f -regex "$XSFX" -prune -o \
      -type f -size  "$SIZE" -prune -o -print0
    find /home/$USER/Mail/Inbox /home/$USER/Mail/Outbox -print0
    find /home/$USER/Desktop  -xdev -regextype posix-extended \
      -type d -regex "$XDIR2" -prune -o -type f -regex "$XSFX" -prune -o \
      -type f -size  "$SIZE" -prune -o -print0
    } | cpio -ov --null -O $BUDIR/BU$DATE.cpio
    chown $BUUID $BUDIR/BU$DATE.cpio
    touch $BUDIR/backup.stamp

    Questo è pensato come esempio di script che deve essere eseguito
    da root.

    Modificarlo ed eseguirlo nel modo seguente.

      * Modificare lo script per includere tutti i propri dati
        importanti (vedere Sezione 10.1.5, «Esempi di invocazione per
        la selezione di file» e Sezione 10.2, «Backup e ripristino»).

      * Sostituire "find … -print0" con "find … -newer $BUDIR/
        backup.stamp -print0" per fare backup incrementali.

      * Trasferire i file di backup su un host remoto usando scp(1) o
        rsync(1) o masterizzarli su CD/DVD per una maggiore sicurezza
        dei dati. (Io uso la GUI del desktop GNOME per masterizzare i
        CD/DVD.. Vedere Sezione 12.1.8, «Esempio di script di shell
        con zenity» per l'inserimento di dati di ridondanza.)

    Mantenere le cose semplici!

    Suggerimento

    Si possono ripristinare i dati di configurazione di debconf con
    "debconf-set-selections debconf-selections" ed i dati delle
    selezioni di dpkg con "dpkg --set-selection
    <dpkg-selections.list".

%

10.2.3. Uno script di copia per backup di dati

    Per l'insieme dei dati in un albero di directory, la copia con
    "cp -a" fornisce normali backup.

    Per un grande insieme di dati statici non sovrascritti in un
    albero di directory, come quello nella directory "/var/cache/apt/
    packages/", i collegamenti fisici creati con "cp -al" forniscono
    un'alternativa ai normali backup con un uso efficiente dello
    spazio su disco.

    Ecco uno script di copia, che ho chiamato bkup, per il backup di
    dati. Questo script copia tutti i file (non-VCS) contenuti nella
    directory attuale in una directory datata nella directory
    genitore o in un host remoto.

    #!/bin/sh -e
    # Copyright (C) 2007-2008 Osamu Aoki <osamu@debian.org>, Public Domain
    fdot(){ find . -type d \( -iname ".?*" -o -iname "CVS" \) -prune -o -print0;}
    fall(){ find . -print0;}
    mkdircd(){ mkdir -p "$1";chmod 700 "$1";cd "$1">/dev/null;}
    FIND="fdot";OPT="-a";MODE="CPIOP";HOST="localhost";EXTP="$(hostname -f)"
    BKUP="$(basename $(pwd)).bkup";TIME="$(date  +%Y%m%d-%H%M%S)";BU="$BKUP/$TIME"
    while getopts gcCsStrlLaAxe:h:T f; do case $f in
    g)  MODE="GNUCP";; # cp (GNU)
    c)  MODE="CPIOP";; # cpio -p
    C)  MODE="CPIOI";; # cpio -i
    s)  MODE="CPIOSSH";; # cpio/ssh
    t)  MODE="TARSSH";; # tar/ssh
    r)  MODE="RSYNCSSH";; # rsync/ssh
    l)  OPT="-alv";; # hardlink (GNU cp)
    L)  OPT="-av";;  # copy (GNU cp)
    a)  FIND="fall";; # find all
    A)  FIND="fdot";; # find non CVS/ .???/
    x)  set -x;; # trace
    e)  EXTP="${OPTARG}";; # hostname -f
    h)  HOST="${OPTARG}";; # user@remotehost.example.com
    T)  MODE="TEST";; # test find mode
    \?) echo "use -x for trace."
    esac; done
    shift $(expr $OPTIND - 1)
    if [ $# -gt 0 ]; then
      for x in $@; do cp $OPT $x $x.$TIME; done
    elif [ $MODE = GNUCP ]; then
      mkdir -p "../$BU";chmod 700 "../$BU";cp $OPT . "../$BU/"
    elif [ $MODE = CPIOP ]; then
      mkdir -p "../$BU";chmod 700 "../$BU"
      $FIND|cpio --null --sparse -pvd ../$BU
    elif [ $MODE = CPIOI ]; then
      $FIND|cpio -ov --null | ( mkdircd "../$BU"&&cpio -i )
    elif [ $MODE = CPIOSSH ]; then
      $FIND|cpio -ov --null|ssh -C $HOST "( mkdircd \"$EXTP/$BU\"&&cpio -i )"
    elif [ $MODE = TARSSH ]; then
      (tar cvf - . )|ssh -C $HOST "( mkdircd \"$EXTP/$BU\"&& tar xvfp - )"
    elif [ $MODE = RSYNCSSH ]; then
      rsync -aHAXSv ./ "${HOST}:${EXTP}-${BKUP}-${TIME}"
    else
      echo "Any other idea to backup?"
      $FIND |xargs -0 -n 1 echo
    fi

    Questo script è pensato per essere un esempio per i comandi;
    leggerlo e modificarlo prima di usarlo.

    Suggerimento

    Io tengo questo script bkup nella mia directory "/usr/local/bin/"
    ed eseguo il comando bkup senza opzioni nella directory di lavoro
    ogni volta che ho bisogno di un backup istantaneo temporaneo.

    Suggerimento

    Per creare uno storico delle istantanee di un albero di file
    sorgenti o di un albero di file di configurazione, l'uso di git
    (7) è più semplice e più efficiente in termini di spazio (vedere
    Sezione 10.6.5, «Git per registrare la cronologia della
    configurazione»).

%

10.3. Infrastruttura di sicurezza dei dati

    L'infrastruttura di sicurezza dei dati viene fornita dalla
    combinazione di strumenti di cifratura dei dati, strumenti
    message digest e strumenti di firma.

    Tabella 10.6. Elenco di strumenti per l'infrastruttura di
    sicurezza dei dati

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione| comando  |    descrizione    |
    |--------------+------+----------+----------+-------------------|
    |              |      |          |          |GNU Privacy Guard -|
    |gnupg         |V:531,|787       |gpg(1)    |strumento OpenPGP  |
    |              |I:950 |          |          |di cifratura e     |
    |              |      |          |          |firma              |
    |--------------+------+----------+----------+-------------------|
    |              |      |          |          |GNU Privacy Guard -|
    |gpgv          |V:880,|859       |gpgv(1)   |strumento di       |
    |              |I:999 |          |          |verifica delle     |
    |              |      |          |          |firme              |
    |--------------+------+----------+----------+-------------------|
    |              |      |          |          |estrae solamente le|
    |paperkey      |V:1,  |58        |paperkey  |informazioni       |
    |              |I:13  |          |(1)       |segrete da chiavi  |
    |              |      |          |          |OpenPGP segrete    |
    |--------------+------+----------+----------+-------------------|
    |              |      |          |          |utilità per la     |
    |              |V:29, |          |cryptsetup|cifratura dm-crypto|
    |cryptsetup    |I:78  |402       |(8), …    |per i device a     |
    |              |      |          |          |blocchi con        |
    |              |      |          |          |supporto LUKS      |
    |--------------+------+----------+----------+-------------------|
    |              |      |          |          |utilità per        |
    |ecryptfs-utils|V:3,  |460       |ecryptfs  |cifratura di file  |
    |              |I:5   |          |(7), …    |system stack       |
    |              |      |          |          |ecryptfs           |
    |--------------+------+----------+----------+-------------------|
    |coreutils     |V:891,|17478     |md5sum(1) |calcola e controlla|
    |              |I:999 |          |          |message digest MD5 |
    |--------------+------+----------+----------+-------------------|
    |coreutils     |V:891,|17478     |sha1sum(1)|calcola e controlla|
    |              |I:999 |          |          |message digest SHA1|
    |--------------+------+----------+----------+-------------------|
    |              |V:794,|          |openssl   |calcola message    |
    |openssl       |I:993 |1465      |(1ssl)    |digest con "openssl|
    |              |      |          |          |dgst" (OpenSSL)    |
    +---------------------------------------------------------------+


    Per dm-crypto e ecryptfs che implementano infrastrutture di
    cifratura automatica dei dati attraverso moduli del kernel Linux,
    vedere Sezione 9.8, «Suggerimenti per la cifratura dei dati».

%

10.3.1. Gestione delle chiavi per GnuPG

    Quelli che seguono sono alcuni comandi per GNU Privacy Guard per
    la gestione base delle chiavi.

    Tabella 10.7. Elenco di comandi per GNU Privacy Guard per la
    gestione delle chiavi

    +---------------------------------------------------------------+
    |       comando       |               descrizione               |
    |---------------------+-----------------------------------------|
    |gpg --gen-key        |Genera una nuova chiave                  |
    |---------------------+-----------------------------------------|
    |gpg --gen-revoke     |genera una chiave di revoca per          |
    |mio_ID_utente        |mio_ID_utente                            |
    |---------------------+-----------------------------------------|
    |gpg --edit-key       |modifica la chiave in modo interattivo,  |
    |user_ID              |"help" per l'aiuto                       |
    |---------------------+-----------------------------------------|
    |gpg -o file --export |esporta tutte le chiavi in un file       |
    |---------------------+-----------------------------------------|
    |gpg --import file    |importa tutte le chiavi da un file       |
    |---------------------+-----------------------------------------|
    |gpg --send-keys      |invia la chiave di ID_utente al server di|
    |ID_utente            |chiavi                                   |
    |---------------------+-----------------------------------------|
    |gpg --recv-keys      |riceve la chiave di ID_utente dal server |
    |ID_utente            |di chiavi                                |
    |---------------------+-----------------------------------------|
    |gpg --list-keys      |elenca le chiavi di ID_utente            |
    |ID_utente            |                                         |
    |---------------------+-----------------------------------------|
    |gpg --list-sigs      |elenca le firme di ID_utente             |
    |ID_utente            |                                         |
    |---------------------+-----------------------------------------|
    |gpg --check-sigs     |controlla le firme di ID_utente          |
    |ID_utente            |                                         |
    |---------------------+-----------------------------------------|
    |gpg --fingerprint    |controlla le impronte digitali di        |
    |ID_utente            |ID_utente                                |
    |---------------------+-----------------------------------------|
    |gpg --refresh-keys   |aggiorna il portachiavi locale           |
    +---------------------------------------------------------------+


    Quelli seguenti sono i significati dei codici di fiducia.

    Tabella 10.8. Elenco dei significati dei codici di fiducia

    +---------------------------------------------------------------+
    |codice|               descrizione della fiducia                |
    |------+--------------------------------------------------------|
    |-     |nessuna fiducia assegnata dal proprietario / ancora non |
    |      |calcolata                                               |
    |------+--------------------------------------------------------|
    |e     |calcolo della fiducia fallito                           |
    |------+--------------------------------------------------------|
    |q     |informazioni insufficienti per il calcolo               |
    |------+--------------------------------------------------------|
    |n     |non fidarsi mai di questa chiave                        |
    |------+--------------------------------------------------------|
    |m     |marginalmente affidabile                                |
    |------+--------------------------------------------------------|
    |f     |completamente fidata                                    |
    |------+--------------------------------------------------------|
    |u     |definitivamente fidata                                  |
    +---------------------------------------------------------------+


    Il comando seguente carica la mia chiave "1DD8D791" sul popolare
    server di chiavi "hkp://keys.gnupg.net".

    $ gpg --keyserver hkp://keys.gnupg.net --send-keys 1DD8D791

    Un buon server di chiavi predefinito impostato in "~/.gnupg/
    gpg.conf" (o nella vecchia posizione "~/.gnupg/options") si
    ottiene la voce seguente.

    keyserver hkp://keys.gnupg.net

    Il comando seguente recupera le chiavi sconosciute dal server di
    chiavi.

    $ gpg --list-sigs --with-colons | grep '^sig.*\[User ID not found\]' |\
      cut -d ':' -f 5| sort | uniq | xargs gpg --recv-keys

    In OpenPGP Public Key Server (versioni pre-0.9.6) esisteva un bug
    che corrompeva le chiavi con più di 2 sottochiavi. I pacchetti
    GnuPG più recenti (>1.2.1-2) possono gestire queste sottochiavi
    corrotte. Vedere l'opzione "--repair-pks-subkey-bug in gpg(1).

%

10.3.2. Usare GnuPG su file

    Quelli seguenti sono esempi di comandi per usare GNU Privacy
    Guard su file.

    Tabella 10.9. Elenco di comandi GNU Privacy Guard per file

    +---------------------------------------------------------------+
    |       comando       |               descrizione               |
    |---------------------+-----------------------------------------|
    |gpg -a -s file       |firma un file in file.asc con corazza    |
    |                     |ASCII                                    |
    |---------------------+-----------------------------------------|
    |gpg --armor --sign   |" "                                      |
    |file                 |                                         |
    |---------------------+-----------------------------------------|
    |gpg --clearsign file |inserisce una firma leggibile nel        |
    |                     |messaggio                                |
    |---------------------+-----------------------------------------|
    |gpg --clearsign file||invia un messaggio di posta firmato      |
    |mail                 |leggibile a pippo@example.org            |
    |pippo@example.org    |                                         |
    |---------------------+-----------------------------------------|
    |gpg --clearsign      |inserisce una firma leggibile in         |
    |--not-dash-escaped   |patchfile                                |
    |patchfile            |                                         |
    |---------------------+-----------------------------------------|
    |gpg --verify file    |verifica un file con firma leggibile     |
    |---------------------+-----------------------------------------|
    |gpg -o file.sig -b   |crea una firma staccata                  |
    |file                 |                                         |
    |---------------------+-----------------------------------------|
    |gpg -o file.sig      |" "                                      |
    |--detach-sig file    |                                         |
    |---------------------+-----------------------------------------|
    |gpg --verify file.sig|verifica file con file.sig               |
    |file                 |                                         |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.gpg |cifratura di file nel file binario       |
    |-r nome -e file      |cifr_file.gpg usando la chiave pubblica  |
    |                     |indirizzata a nome                       |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.gpg |                                         |
    |--recipient nome     |" "                                      |
    |--encrypt file       |                                         |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.asc |cifratura di file nel file con cifratura |
    |-a -r nome -e file   |corazzata ASCII cifr_file.asc usando la  |
    |                     |chiave pubblica indirizzata a nome       |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.gpg |cifratura simmetrica da file a           |
    |-c file              |cifr_file.gpg                            |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.gpg |" "                                      |
    |--symmetric file     |                                         |
    |---------------------+-----------------------------------------|
    |gpg -o cifr_file.asc |cifratura simmetrica pensata per nome di |
    |-a -c file           |file nel file con cifratura corazzata    |
    |                     |ASCII cifr_file.asc                      |
    |---------------------+-----------------------------------------|
    |gpg -o file -d       |decifratura                              |
    |cifr_file.gpg -r nome|                                         |
    |---------------------+-----------------------------------------|
    |gpg -o file --decrypt|" "                                      |
    |cifr_file.gpg        |                                         |
    +---------------------------------------------------------------+


%

10.3.3. Usare GnuPG con Mutt

    Aggiungere quanto seguie al file "~/.muttrc" per evitare che il
    lento GnuPG venga avviato automaticamente, permettendo allo
    stesso tempo di richiamarlo digitando "S" nel menu della vista
    indice.

    macro index S ":toggle pgp_verify_sig\n"
    set pgp_verify_sig=no

%

10.3.4. Usare GnuPG con Vim

    Il plugin gnupg permette di eseguire GnuPG in modo trasparente
    per i file con estensione ".gpg", ".asc" e ".pgp".

    # aptitude install vim-scripts vim-addon-manager
    $ vim-addons install gnupg

%

10.3.5. Somme di controllo MD5

    md5sum(1) fornisce un'utilità per creare un file digest usando il
    metodo descritto nella rfc1321 e per verificare i file con esso.

    $ md5sum pippo pluto >paperino.md5
    $ cat paperino.md5
    d3b07384d113edec49eaa6238ad5ff00  pippo
    c157a79031e1c40f85931829bc5fc552  pluto
    $ md5sum -c paperino.md5
    pippo: OK
    pluto: OK

    Nota

    Il calcolo delle somme di controllo MD5 è meno dispendioso in
    termini di CPU di quello delle firme crittografiche di GNU
    Privacy Guard (GnuPG). Di solito solamente il file digest di più
    alto livello è firmato crittograficamente per assicurare
    l'integrità dei dati.

%

10.4. Strumenti per la fusione di codice sorgente

    Esistono molti strumenti per la fusione di codice sorgente.
    Quello che segue è un elenco di strumenti che hanno catturato la
    mia attenzione.

    Tabella 10.10. Elenco di strumenti per la fusione di codice
    sorgente

    +---------------------------------------------------------------+
    |pacchetto |popcon|dimensione|  comando  |     descrizione      |
    |----------+------+----------+-----------+----------------------|
    |diffutils |V:871,|1598      |diff(1)    |confronta i file riga |
    |          |I:991 |          |           |per riga              |
    |----------+------+----------+-----------+----------------------|
    |diffutils |V:871,|1598      |diff3(1)   |confronta e fonde tre |
    |          |I:991 |          |           |file riga per riga    |
    |----------+------+----------+-----------+----------------------|
    |          |V:106,|          |           |confronta 2 file uno  |
    |vim       |I:398 |3231      |vimdiff(1) |di fianco all'altro in|
    |          |      |          |           |vim                   |
    |----------+------+----------+-----------+----------------------|
    |patch     |V:99, |248       |patch(1)   |applica un file diff  |
    |          |I:725 |          |           |ad un originale       |
    |----------+------+----------+-----------+----------------------|
    |          |V:0,  |          |           |gestisce serie di     |
    |dpatch    |I:11  |191       |dpatch(1)  |patch per pacchetti   |
    |          |      |          |           |Debian                |
    |----------+------+----------+-----------+----------------------|
    |          |V:16, |          |           |produce un istogramma |
    |diffstat  |I:154 |73        |diffstat(1)|delle modifiche       |
    |          |      |          |           |apportate da un diff  |
    |----------+------+----------+-----------+----------------------|
    |          |V:18, |          |combinediff|crea una patch        |
    |patchutils|I:150 |232       |(1)        |cumulativa da due     |
    |          |      |          |           |patch incrementali    |
    |----------+------+----------+-----------+----------------------|
    |patchutils|V:18, |232       |dehtmldiff |estrae un diff da una |
    |          |I:150 |          |(1)        |pagina HTML           |
    |----------+------+----------+-----------+----------------------|
    |patchutils|V:18, |232       |filterdiff |estrae o esclude diff |
    |          |I:150 |          |(1)        |da un file diff       |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |aggiusta file diff    |
    |patchutils|V:18, |232       |fixcvsdiff |creati da CVS che sono|
    |          |I:150 |          |(1)        |male interpretati da  |
    |          |      |          |           |patch(1)              |
    |----------+------+----------+-----------+----------------------|
    |patchutils|V:18, |232       |flipdiff(1)|scambia l'ordine di   |
    |          |I:150 |          |           |due patch             |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |mostra quali file     |
    |          |      |          |           |siano modificati da   |
    |patchutils|V:18, |232       |grepdiff(1)|una patch che fa      |
    |          |I:150 |          |           |corrispondenza con    |
    |          |      |          |           |un'espressione        |
    |          |      |          |           |regolare              |
    |----------+------+----------+-----------+----------------------|
    |          |V:18, |          |interdiff  |mostra le differenze  |
    |patchutils|I:150 |232       |(1)        |tra due file diff     |
    |          |      |          |           |unificati             |
    |----------+------+----------+-----------+----------------------|
    |          |V:18, |          |           |mostra quali file     |
    |patchutils|I:150 |232       |lsdiff(1)  |vengano modificati da |
    |          |      |          |           |una patch             |
    |----------+------+----------+-----------+----------------------|
    |          |V:18, |          |recountdiff|ricalcola conteggi e  |
    |patchutils|I:150 |232       |(1)        |offset in diff        |
    |          |      |          |           |unificati             |
    |----------+------+----------+-----------+----------------------|
    |          |V:18, |          |           |aggiusta conteggi ed  |
    |patchutils|I:150 |232       |rediff(1)  |offset di un diff     |
    |          |      |          |           |modificato a mano     |
    |----------+------+----------+-----------+----------------------|
    |patchutils|V:18, |232       |splitdiff  |separa due patch      |
    |          |I:150 |          |(1)        |incrementali          |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |ripristina patch il   |
    |patchutils|V:18, |232       |unwrapdiff |cui contenuto è stato |
    |          |I:150 |          |(1)        |mandato a capo        |
    |          |      |          |           |automaticamente       |
    |----------+------+----------+-----------+----------------------|
    |wiggle    |V:0,  |174       |wiggle(1)  |applica le patch      |
    |          |I:0   |          |           |respinte              |
    |----------+------+----------+-----------+----------------------|
    |quilt     |V:3,  |788       |quilt(1)   |gestisce serie di     |
    |          |I:33  |          |           |patch                 |
    |----------+------+----------+-----------+----------------------|
    |meld      |V:14, |2972      |meld(1)    |confronta e fonde file|
    |          |I:39  |          |           |(GTK)                 |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |mostra le differenze  |
    |dirdiff   |V:0,  |166       |dirdiff(1) |ed apporta i          |
    |          |I:2   |          |           |cambiamenti tra alberi|
    |          |      |          |           |di directory          |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |confronta due file    |
    |docdiff   |V:0,  |555       |docdiff(1) |parola per parola /   |
    |          |I:0   |          |           |carattere per         |
    |          |      |          |           |carattere             |
    |----------+------+----------+-----------+----------------------|
    |          |      |          |           |strumento interattivo |
    |imediff   |V:0,  |157       |imediff(1) |a tutto schermo per   |
    |          |I:0   |          |           |unione di modifiche a |
    |          |      |          |           |2/3 vie               |
    |----------+------+----------+-----------+----------------------|
    |makepatch |V:0,  |102       |makepatch  |genera file patch     |
    |          |I:0   |          |(1)        |estesi                |
    |----------+------+----------+-----------+----------------------|
    |makepatch |V:0,  |102       |applypatch |applica file patch    |
    |          |I:0   |          |(1)        |estesi                |
    |----------+------+----------+-----------+----------------------|
    |          |V:9,  |          |           |mostra le differenze  |
    |wdiff     |I:72  |644       |wdiff(1)   |di parole tra file di |
    |          |      |          |           |testo                 |
    +---------------------------------------------------------------+


%

10.4.1. Estrarre differenze da file sorgenti

    Si possono estrarre le differenze tra due file sorgenti e creare
    file diff unificati "file.patch0" o "file.patch1", a seconda
    della posizione del file, con le procedure seguenti.

    $ diff -u file.vecchio file.nuovo > file.patch0
    $ diff -u vecchio/file nuovo/file > file.patch1

%

10.4.2. Fondere aggiornamenti per file sorgenti

    I file diff (chiamati anche file patch) sono usati per inviare
    aggiornamenti per un programma. Chi li riceve applica questo
    aggiornamento ad un altro file nel modo seguente.

    $ patch -p0 file < file.patch0
    $ patch -p1 file < file.patch1

%

10.4.3. Aggiornare con fusioni a 3 vie

    Se si hanno tre versioni di un codice sorgente, è possibile
    effettuare una fusione a 3 vie in maniera efficace usando diff3
    (1) nel modo seguente.

    $ diff3 -m file.mio file.vecchio file.tuo > file

%

10.5. Sistemi di controllo delle versioni

    Ecco un riassunto dei sistemi di controllo delle versioni (VCS)
    nel sistema Debian.

    Nota
   
    Se non si ha esperienza di sistemi VCS, si dovrebbe iniziare ad
    imparare con Git che sta acquistando sempre più popolarità.

    Tabella 10.11. Elenco di strumenti per sistemi di controllo delle
    versioni

    +-------------------------------------------------------------------+
    |pacchetto |popcon|dimensione|strumento |tipo di VCS|   commento    |
    |----------+------+----------+----------+-----------+---------------|
    |          |V:0,  |          |          |           |clone di SCCS  |
    |cssc      |I:2   |2044      |CSSC      |locale     |Unix           |
    |          |      |          |          |           |(deprecato)    |
    |----------+------+----------+----------+-----------+---------------|
    |rcs       |V:3,  |562       |RCS       |locale     |"SCCS Unix     |
    |          |I:19  |          |          |           |fatto bene"    |
    |----------+------+----------+----------+-----------+---------------|
    |          |V:5,  |          |          |           |precedente     |
    |cvs       |I:41  |4609      |CVS       |remoto     |standard per   |
    |          |      |          |          |           |VCS remoto     |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |"CVS fatto     |
    |          |V:20, |          |          |           |bene", il nuovo|
    |subversion|I:109 |4858      |Subversion|remoto     |standard di    |
    |          |      |          |          |           |fatto per VCS  |
    |          |      |          |          |           |remoto         |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |veloce DVCS in |
    |git       |V:305,|35040     |Git       |distribuito|C (usato dal   |
    |          |I:478 |          |          |           |kernel Linux ed|
    |          |      |          |          |           |altri)         |
    |----------+------+----------+----------+-----------+---------------|
    |mercurial |V:8,  |1053      |Mercurial |distribuito|DVCS in Python |
    |          |I:48  |          |          |           |e un po' di C  |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |DVCS           |
    |          |V:2,  |          |          |           |influenzato da |
    |bzr       |I:16  |28        |Bazaar    |distribuito|tla, scritto in|
    |          |      |          |          |           |Python (usato  |
    |          |      |          |          |           |da Ubuntu)     |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |DVCS con       |
    |          |V:0,  |          |          |           |algebra        |
    |darcs     |I:7   |23159     |Darcs     |distribuito|intelligente   |
    |          |      |          |          |           |per le patch   |
    |          |      |          |          |           |(lento)        |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |DVCS           |
    |tla       |V:0,  |1011      |GNU arch  |distribuito|principalmente |
    |          |I:2   |          |          |           |di Tom Lord    |
    |          |      |          |          |           |(storico)      |
    |----------+------+----------+----------+-----------+---------------|
    |monotone  |V:0,  |5815      |Monotone  |distribuito|DVCS in C++    |
    |          |I:0   |          |          |           |               |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |visualizzazione|
    |          |      |          |          |           |GUI di alberi  |
    |tkcvs     |V:0,  |1498      |CVS, …    |remoto     |di archivi VCS |
    |          |I:1   |          |          |           |(CVS,          |
    |          |      |          |          |           |Subversion,    |
    |          |      |          |          |           |RCS)           |
    |----------+------+----------+----------+-----------+---------------|
    |          |      |          |          |           |visualizzazione|
    |gitk      |V:6,  |1723      |Git       |distribuito|GUI di alberi  |
    |          |I:42  |          |          |           |di repository  |
    |          |      |          |          |           |VCS (Git)      |
    +-------------------------------------------------------------------+


    Un VCS viene a volte chiamato sistema di controllo delle
    revisioni (RCS) o gestione della configurazione software (SCM).

    Al giorno d'oggi i VCS distribuiti come Git sono gli strumenti
    preferiti. CVS e Subversion possono essere ancora utili per
    aggregarsi ad alcune realtà di programmi open source esistenti.

    Debian fornisce servizi Git liberi attraverso il servizio Debian
    Salsa. La sua documentazione è reperibile su https://
    wiki.debian.org/Salsa.

    Attenzione

    Debian ha chiuso i suoi vecchi servizi Alioth e i dati del
    vecchio servizio Alioth sono disponibili in alioth-archive come
    archivi tar.

    Ci sono alcune nozioni base da ricordare per creare un accesso
    condiviso ad un archivio VCS.

      * Usare "umask 002" (vedere Sezione 1.2.4, «Controllo dei
        permessi per i file appena creati: umask»)

      * Far sì che tutti i file dell'archivio VCS appartengano ad un
        gruppo pertinente
   
      * Abilitare l'impostazione dell'ID di gruppo per tutte le
        directory dell'archivio VCS (schema di creazione di file in
        stile BSD, vedere Sezione 1.2.3, «Permessi del file system»)

      * Far sì che gli utenti che condividano l'archivio VCS
        appartengano al gruppo

%

10.5.1. Comparazione di comandi VCS

    Quella che segue è una comparazione ipersemplificata, per dare
    un'idea generale dei comandi VCS nativi. La sequenza di comandi
    usata tipicamente può richiedere opzioni ed argomenti.

    Tabella 10.12. Comparazione di comandi VCS nativi

    +---------------------------------------------------------------+
    |    Git     | CVS  |Subversion|            funzione            |
    |------------+------+----------+--------------------------------|
    |git init    |cvs   |svn create|creazione dell'archivio (locale)|
    |            |init  |          |                                |
    |------------+------+----------+--------------------------------|
    |-           |cvs   |-         |login all'archivio remoto       |
    |            |login |          |                                |
    |------------+------+----------+--------------------------------|
    |            |      |          |fare il check out dell'archivio |
    |git clone   |cvs co|svn co    |remoto come albero di directory |
    |            |      |          |di lavoro                       |
    |------------+------+----------+--------------------------------|
    |git pull    |cvs up|svn up    |aggiornare l'albero di lavoro   |
    |            |      |          |fondendovi l'archivio remoto    |
    |------------+------+----------+--------------------------------|
    |git add .   |cvs   |svn add   |aggiungere il/i file nell'albero|
    |            |add   |          |di lavoro al VCS                |
    |------------+------+----------+--------------------------------|
    |git rm      |cvs rm|svn rm    |rimuovere il/i file nell'albero |
    |            |      |          |di lavoro dal VCS               |
    |------------+------+----------+--------------------------------|
    |-           |cvs ci|svn ci    |fare il commit dei cambiamenti  |
    |            |      |          |all'archivio remoto             |
    |------------+------+----------+--------------------------------|
    |git commit  |-     |-         |fare il commit dei cambiamenti  |
    |-a          |      |          |all'archivio locale             |
    |------------+------+----------+--------------------------------|
    |git push    |-     |-         |aggiornare l'archivio remoto con|
    |            |      |          |l'archivio locale               |
    |------------+------+----------+--------------------------------|
    |git status  |cvs   |svn status|visualizza lo stato dell'albero |
    |            |status|          |di lavoro dal VCS               |
    |------------+------+----------+--------------------------------|
    |git diff    |cvs   |svn diff  |diff <archivio_diriferimento>   |
    |            |diff  |          |<albero_di_lavoro>              |
    |------------+------+----------+--------------------------------|
    |git repack  |      |          |reimpacchetta l'archivio locale |
    |-a -d; git  |-     |-         |in un singolo pacchetto         |
    |prune       |      |          |                                |
    |------------+------+----------+--------------------------------|
    |gitk        |tkcvs |tkcvs     |visualizzazione GUI dell'albero |
    |            |      |          |dell'archivio VCS               |
    +---------------------------------------------------------------+


    Attenzione

    A partire dall'inizio del 2006, l'invocazione diretta, dalla riga
    di comando, di un sottocomando di git come "git-xyz" è diventata
    deprecata.

    Suggerimento

    Se c'è un file eseguibile git-pippo nel percorso specificato da
    $PATH, l'inserimento nella riga di comando di "git pippo" senza
    trattino invoca tale git-pippo. Questa è una funzionalità del
    comando git.

    Suggerimento

    Gli strumenti con interfaccia utente grafica, come tkcvs(1) e 
    gitk(1), aiutano realmente a tenere traccia della cronologia
    delle revisioni dei file. L'interfaccia web fornita da molti
    archivi pubblici per la navigazione dei loro repository è
    anch'essa piuttosto utile.

    Suggerimento

    Git può lavorare direttamente con diversi archivi VCS, come
    quelli forniti da CVS e Subversion, e fornisce archivi locali per
    modifiche locali tramite i pacchetti git-cvs e git-svn. Vedere
    Git per utenti CVS e la Sezione 10.6.4, «Git per repository
    Subversion».

    Suggerimento
   
    Git ha comandi che non hanno equivalenti in CVS e Subversion:
    "fetch", "rebase", "cherry-pick", …

%

10.6. Git

    Git può fare tutto ciò che riguarda la gestione di codice
    sorgente, sia in locale sia in remoto. Ciò significa che è
    possibile registrare i cambiamenti al codice sorgente senza
    bisogno di connessione di rete all'archivio remoto.

%

10.6.1. Configurazione del client Git

    È possibile che si desideri impostare diverse configurazioni
    globali, come il nome e l'indirizzo di posta elettronica usati da
    Git, in "~/.gitconfig" nel modo seguente.

    $ git config --global user.name "Nome Cognome"
    $ git config --global user.email proprionome@esempio.com

    Se si è abituati ai comandi di CVS o Subversion, si potrebbe
    volere impostare alcuni alias per i comandi nel modo seguente.

    $ git config --global alias.ci "commit -a"
    $ git config --global alias.co checkout

    La configurazione globale può essere controllata con il comando
    seguente.

    $ git config --global --list

%

10.6.2. Documenti di consultazione per Git

    Vedere la documentazione seguente.

      * pagina man: git(1) (/usr/share/doc/git-doc/git.html)

      * Manuale utente di Git (/usr/share/doc/git-doc/
        user-manual.html)

      * Un tutorial introduttivo su git (/usr/share/doc/git-doc/
        gittutorial.html)

      * Un tutorial introduttivo su git: parte seconda (/usr/share/
        doc/git-doc/gittutorial-2.html)

      * Uso quotidiano di GIT con 20 comandi o poco più (/usr/share/
        doc/git-doc/everyday.html)

      * git per gli utenti CVS (/usr/share/doc/git-doc/
        gitcvs-migration.html)

          + Questo descrive anche come impostare server come CVS ed
            estrarre vecchi dati da CVS portandoli in Git.

      * Altre risorse git disponibili in rete

          + Corso veloce per Git - SVN

          + Git Magic (/usr/share/doc/gitmagic/html/index.html)

    I comandi git-gui(1) e gitk(1) rendono l'uso di Git molto
    semplice.

    Avvertimento

    Non usare stringhe per etichette contenenti spazi, anche se
    alcuni strumenti come gitk(1) lo permettono. Altri comandi git
    potrebbero avere problemi con esse.

%

10.6.3. Comandi Git

    Anche se l'archivio a monte usa un diverso VCS, potrebbe essere
    una buona idea usare git(1) per l'attività locale, dato che si
    può gestire la propria copia locale dell'albero dei sorgenti
    senza una connessione di rete con l'archivio a monte. Ecco alcuni
    pacchetti e comandi usati con git(1).

    Tabella 10.13. Elenco di pacchetti e comandi relativi a Git

    +---------------------------------------------------------------------+
    |   pacchetto    |popcon|dimensione|      comando      | descrizione  |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |documentazione|
    |git-doc         |I:15  |11762     |N/D                |ufficiale per |
    |                |      |          |                   |Git           |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |"Git Magic",  |
    |                |      |          |                   |una guida per |
    |gitmagic        |I:1   |721       |N/D                |Git più       |
    |                |      |          |                   |semplice da   |
    |                |      |          |                   |capire        |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |Git, il       |
    |                |      |          |                   |sistema di    |
    |                |      |          |                   |controllo     |
    |git             |V:305,|35040     |git(7)             |delle         |
    |                |I:478 |          |                   |revisioni     |
    |                |      |          |                   |veloce,       |
    |                |      |          |                   |scalabile e   |
    |                |      |          |                   |distribuito   |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |browser degli |
    |                |      |          |                   |archivi Git   |
    |gitk            |V:6,  |1723      |gitk(1)            |con           |
    |                |I:42  |          |                   |interfaccia   |
    |                |      |          |                   |utente grafica|
    |                |      |          |                   |e cronologia  |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |interfaccia   |
    |git-gui         |V:2,  |2317      |git-gui(1)         |utente grafica|
    |                |I:24  |          |                   |per Git (senza|
    |                |      |          |                   |cronologia)   |
    |----------------+------+----------+-------------------+--------------|
    |                |V:1,  |          |                   |importa i dati|
    |git-svn         |I:22  |1144      |git-svnimport(1)   |da Subversion |
    |                |      |          |                   |in Git        |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |fornisce      |
    |                |V:1,  |          |                   |operazioni    |
    |git-svn         |I:22  |1144      |git-svn(1)         |bidirezionali |
    |                |      |          |                   |tra Subversion|
    |                |      |          |                   |e Git         |
    |----------------+------+----------+-------------------+--------------|
    |git-cvs         |V:0,  |1279      |git-cvsimport(1)   |importa i dati|
    |                |I:10  |          |                   |da CVS in Git |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |esporta un    |
    |git-cvs         |V:0,  |1279      |git-cvsexportcommit|commit a un   |
    |                |I:10  |          |(1)                |checkout CVS  |
    |                |      |          |                   |da Git        |
    |----------------+------+----------+-------------------+--------------|
    |                |V:0,  |          |                   |emulatore di  |
    |git-cvs         |I:10  |1279      |git-cvsserver(1)   |server CVS per|
    |                |      |          |                   |Git           |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |invia una     |
    |                |V:0,  |          |                   |raccolta di   |
    |git-email       |I:11  |966       |git-send-email(1)  |patch come    |
    |                |      |          |                   |messaggio di  |
    |                |      |          |                   |posta da Git  |
    |----------------+------+----------+-------------------+--------------|
    |stgit           |V:0,  |603       |stg(1)             |quilt sopra a |
    |                |I:0   |          |                   |git (Python)  |
    |----------------+------+----------+-------------------+--------------|
    |                |      |          |                   |automatizza la|
    |git-buildpackage|V:2,  |4193      |git-buildpackage(1)|creazione di  |
    |                |I:12  |          |                   |pacchetti     |
    |                |      |          |                   |Debian con Git|
    |----------------+------+----------+-------------------+--------------|
    |                |V:0,  |          |                   |quilt sopra a |
    |guilt           |I:0   |146       |guilt(7)           |git (SH/AWK/  |
    |                |      |          |                   |SED/…)        |
    +---------------------------------------------------------------------+


    Suggerimento

    Con git(1) si lavora su un ramo locale con molti commit e si usa
    successivamente un comando simile a "git rebase -i master" per
    riorganizzare la cronologia dei cambiamenti. Ciò permette di
    avere cronologie dei cambiamenti pulite. Vedere git-rebase(1) e 
    git-cherry-pick(1).

    Suggerimento

    Quando si vuole tornare ad una directory di lavoro pulita senza
    perdere lo stato attuale della directory di lavoro, si può usare
    "git stash". Vedere git-stash(1).

%

10.6.4. Git per repository Subversion

    Si può fare il check out di un repository Subversion su "svn+ssh:
    //svn.example.org/project/module/trunk" in un repository Git
    locale in "./dest" fare poi nuovamente il commit sul repository
    Subversion. Ad esempio:

    $ git svn clone -s -rHEAD svn+ssh://svn.esempio.org/progetto dest
    $ cd dest
    ... fare i cambiamenti
    $ git commit -a
    ... continuare a lavorare localmente con git
    $ git svn dcommit

    Suggerimento
   
    L'uso di "-rHEAD" permette di evitare di dover clonare tutti i
    contenuti della cronologia del repository Subversion.

%

10.6.5. Git per registrare la cronologia della configurazione

    Si può registrare manualmente la cronologia della configurazione
    usando strumenti Git. Quello che segue è un semplice esempio che
    insegna a registrare il contenuto di "/etc/apt/".

    $ cd /etc/apt/
    $ sudo git init
    $ sudo chmod 700 .git
    $ sudo git add .
    $ sudo git commit -a

    Fare il commit della configurazione con una descrizione.

    Modificare i file di configurazione

    $ cd /etc/apt/
    $ sudo git commit -a

    Fare il commit della configurazione con una descrizione e andare
    avanti con la propria vita.

    $ cd /etc/apt/
    $ sudo gitk --all

    Si avrà una completa cronologia della configurazione.

    Nota

    Per lavorare con tutti i tipi di permessi dei dati di
    configurazione è necessario sudo(8). Per i dati di configurazione
    dell'utente, si può saltare l'uso di sudo.

    Nota
   
    Il comando "chmod 700 .git" nell'esempio precedente è necessario
    per proteggere i dati dell'archivio da accessi non autorizzati.

    Suggerimento

    Per l'impostazione di un sistema di registrazione della
    configurazione più completo, guardare il pacchetto etckeeper:
    Sezione 9.2.10, «Registrare i cambiamenti a file di
    configurazione».

%

10.7. CVS

    CVS è un sistema di controllo di versione più vecchio antecedente
    a Subversion e Git.

    Attenzione
   
    Molti URL negli esempi sottostanti per CVS non esistono più.

    Vedere la documentazione seguente.

      * cvs(1)

      * "/usr/share/doc/cvs/html-cvsclient"

      * "/usr/share/doc/cvs/html-info"

      * "/usr/share/doc/cvsbook"

      * "info cvs"

%

10.7.1. Configurazione di archivi CVS

    La configurazione seguente permette solo ai membri del gruppo
    "src" di fare commit nell'archivio CVS e solo ai membri del
    gruppo "staff" di amministrare il CVS, riducendo perciò le
    possibilità di autodanneggiarsi.

    # cd /var/lib; umask 002; mkdir cvs
    # export CVSROOT=/srv/cvs/progetto
    # cd $CVSROOT
    # chown root:src .
    # chmod 2775 .
    # cvs -d $CVSROOT init
    # cd CVSROOT
    # chown -R root:staff .
    # chmod 2775 .
    # touch val-tags
    # chmod 664 history val-tags
    # chown root:src history val-tags

    Suggerimento

    Si può limitare la creazione di nuovi progetti modificando il
    proprietario della directory "$CVSROOT" in "root:staff" e i suoi
    permessi in "3775".

%

10.7.2. Accesso locale al CVS

    L'archivio CVS predefinito è indicato da "$CVSROOT". Il comando
    seguente imposta "$CVSROOT" per l'accesso locale.

    $ export CVSROOT=/srv/cvs/progetto

%

10.7.3. Accesso remoto a CVS con pserver

    Molti server CVS pubblici forniscono accesso remoto solo in
    lettura all'account "anonymous" tramite il servizio pserver. I
    contenuti del sito Debian, per esempio, erano mantenuti dal
    progetto webwml attraverso CVS sul servizio Debian Alioth. Il
    comando seguente veniva usato per impostare "$CVSROOT" per
    l'accesso remoto al questo vecchio repository CVS.

    $ export CVSROOT=:pserver:anonymous@anonscm.debian.org:/cvs/webwml
    $ cvs login

    Nota

    Dato che pserver è esposto ad attacchi di spionaggio ed è
    insicuro, l'accesso in scrittura è solitamente disabilitato dagli
    amministratori del server.

%

10.7.4. Accesso remoto a CVS con ssh

    Il comando seguente veniva usato per impostare "$CVS_RSH" e
    "$CVSROOT" per l'accesso remoto con SSH al vecchio archivio CVS
    del progetto webwml.

    $ export CVS_RSH=ssh
    $ export CVSROOT=:ext:account@cvs.alioth.debian.org:/cvs/webwml

    Si può anche usare l'autenticazione con chiave pubblica per SSH
    che elimina la richiesta di inserimento della password remota.

%

10.7.5. Importare un nuovo sorgente in CVS

    Creare un nuovo albero di sorgenti locale in "~/percorso/di/
    modulo1" con il comando seguente.

    $ mkdir -p ~/percorso/di/modulo1; cd ~/percorso/di/modulo1

    Popolare il nuovo albero di sorgenti locale in "~/percorso/di/
    modulo1" con i file.

    Importarlo nel CVS con i parametri seguenti.

      * Nome modulo: "modulo1"

      * Etichetta fornitore: "Ramo-principale" (etichetta per
        l'intero ramo)

      * Etichetta rilascio: "Rilascio-iniziale" (etichetta per un
        rilascio specifico)

    $ cd ~/percorso/di/modulo1
    $ cvs import -m "Inizio di modulo1" Ramo-principale Rilascio-iniziale
    $ rm -Rf . # opzionale

%

10.7.6. Permessi dei file negli archivi CVS

    CVS non sovrascrive i file attuali nell'archivio, ma li
    sostituisce con altri. Perciò i permessi di scrittura della
    directory dell'archivio sono fondamentali. Per ogni nuovo modulo
    di modulo1" nell'archivio in "/srv/cvs/progetto", eseguire i
    comandi seguenti per assicurare che i permessi siano corretti, se
    necessario.

    # cd /srv/cvs/progetto
    # chown -R root:src modulo1
    # chmod -R ug+rwX   modulo1
    # chmod    2775     modulo1

%

10.7.7. Sequenza di azioni tipiche nell'uso di CVS

    Ecco un esempio di una sequenza tipica di azioni svolte nell'uso
    di CVS.

    Controllare tutti i moduli disponibili dal progetto CVS a cui
    punta "$CVSROOT" con il comando seguente.

    $ cvs rls
    CVSROOT
    modulo1
    modulo2
    ...

    Fare il checkout di "modulo1" nella sua directory predefinita "./
    modulo1" con il comando seguente.

    $ cd ~/percorso/di
    $ cvs co modulo1
    $ cd modulo1

    Fare i cambiamenti desiderati necessari ai contenuti.

    Controllare i cambiamenti facendo l'equivalente di "diff -u
    [archivio] [locale]" con il comando seguente.

    $ cvs diff -u

    Si scopre, ad esempio, di aver corrotto gravemente un file
    "file_da_ripristinare", ma gli altri file sono a posto.

    Sovrascrivere "file_da_ripristinare" con una copia pulita dal CVS
    con il comando seguente.

    $ cvs up -C file_da_ripristinare

    Salvare l'albero dei sorgenti locale aggiornato sul CVS con il
    comando seguente.

    $ cvs ci -m "Descrivere qui i cambiamenti"

    Creare ed aggiungere il file "file_da_aggiungere" al CVS con il
    comando seguente.

    $ vi file_da_aggiungere
    $ cvs add file_da_aggiungere
    $ cvs ci -m "Aggiunto file_da_aggiungere"

    Fondere la versione più recente dal CVS con il comando seguente.

    $ cvs up -d

    Prestare attenzione alle righe che iniziano con "C nomefile" che
    indicano le modifiche che creano conflitti.

    Cercare il codice non modificato in ".#nomefile.versione".

    Per trovare le modifiche che creano conflitti cercare "<<<<<<<" e
    ">>>>>>>" nei file.

    Modificare i file in modo da risolvere i conflitti.

    Aggiungere un'etichetta di rilascio "Rilascio-1" nel modo
    seguente.

    $ cvs ci -m "ultimo commit per Rilascio-1"
    $ cvs tag Rilascio-1

    Modificare ulteriormente.

    Rimuovere l'etichetta di rilascio "Rilascio-1" con il comando
    seguente.

    $ cvs tag -d Rilascio-1

    Fare il commit delle modifiche sul CVS con il comando seguente.

    $ cvs ci -m "ultimissimo commit per Rilascio-1"

    Riaggiungere l'etichetta di rilascio "Rilascio-1" all'HEAD CVS
    aggiornato principale con il comando seguente.

    $ cvs tag Rilascio-1

    Creare un ramo con un'etichetta permanente
    "Rilascio-iniziale-risoluzionebug" dalla versione originale a cui
    punta l'etichetta "Rilascio-iniziale" e farne il checkout nella
    directory "~/percorso/di/vecchio" nel modo seguente.

    $ cvs rtag -b -r Rilascio-iniziale Rilascio-iniziale-risoluzionebug modulo1
    $ cd ~/percorso/di
    $ cvs co -r Rilascio-iniziale-risoluzionebug -d vecchio modulo1
    $ cd vecchio

    Suggerimento

    Per specificare una particolare data come punto di ramificazione,
    usare "-D 2005-12-20" (formato ISO 8601 per le date) invece di
    "-r Rilascio-iniziale".

    Lavorare in questo albero locale di sorgenti che ha l'etichetta
    permanente "Rilascio-iniziale-risoluzionebug" e che è basato
    sulla versione originale.

    Lavorare in questo ramo da soli … fino a che qualcun altro non si
    aggiunge al ramo "Rilascio-iniziale-risoluzionebug".

    Fare la sincronizzazione dei file modificati da altri in questo
    ramo, creando contemporaneamente nuove directory se necessario,
    con il comando seguente.

    $ cvs up -d

    Modificare i file in modo da risolvere i conflitti.

    Fare il commit delle modifiche sul CVS con il comando seguente.

    $ cvs ci -m "fatto il commit in questo ramo"

    Aggiornare l'albero locale con l'HEAD del principale, rimuovendo
    allo stesso tempo l'etichetta permanente ("-A") e senza
    espansione delle parole chiave ("-kk"), con il comando seguente.

    $ cvs up -d -kk -A

    Aggiornare l'albero locale (contenuto = HEAD del principale)
    fondendo dal ramo "Rilascio-iniziale-risoluzionebug" e senza
    espansione delle parole chiave con il comando seguente.

    $ cvs up -d -kk -j Rilascio-iniziale-risoluzionebug

    Correggere i conflitti con l'editor.

    Fare il commit delle modifiche sul CVS con il comando seguente.

    $ cvs ci -m "fusione con Rilascio-iniziale-risoluzionebug"

    Creare un file archivio nel modo seguente.

    $ cd ..
    $ mv vecchio vecchio-modulo1-risoluzionebug
    $ tar -cvzf vecchio-modulo1-risoluzionebug.tar.gz vecchio-modulo1-risoluzionebug
    $ rm -rf vecchio-modulo1-risoluzionebug

    Suggerimento
   
    Il comando "cvs up" accetta l'opzione "-d" per creare nuove
    directory e l'opzione "-P" per eliminare le directory vuote.

    Suggerimento
   
    Si può fare il checkout solamente di una sottodirectory di
    "modulo1" fornendo il suo nome come in "cvs co modulo1/sottodir".

    Tabella 10.14. Opzioni importanti per comandi CVS (da usare come
    primi argomenti di cvs(1))

    +---------------------------------------------------------------+
    |opzione|                      significato                      |
    |-------+-------------------------------------------------------|
    |-n     |esecuzione di prova, nessun effetto                    |
    |-------+-------------------------------------------------------|
    |-t     |visualizza i messaggi che mostrano i passi             |
    |       |dell'attività di cvs                                   |
    +---------------------------------------------------------------+


%

10.7.8. File più recenti dal CVS

    Per ottenere i file più recenti dal CVS usare "tomorrow" nel modo
    seguente.

    $ cvs ex -D tomorrow nome_modulo

%

10.7.9. Amministrazione del CVS

    Aggiungere l'alias "mx" per un modulo ad un progetto CVS (server
    locale) usando il comando seguente.

    $ export CVSROOT=/srv/cvs/progetto
    $ cvs co CVSROOT/moduli
    $ cd CVSROOT
    $ echo "mx -a modulo1" >>moduli
    $ cvs ci -m "Ora mx e' un alias per modulo1"
    $ cvs release -d .

    Ora si può fare il checkout di "modulo1" (alias: "mx") dal CVS
    alla directory "nuova" nel modo seguente.

    $ cvs co -d nuova mx
    $ cd nuova

    Nota
   
    Per seguire la procedura precedente sono necessari gli adeguati
    permessi sui file.

%

10.7.10. Bit di esecuzione per il checkout CVS

    Quando si fa il checkout di file dal CVS viene mantenuto il loro
    bit del permesso di esecuzione.

    Ogni volta si incontrano problemi con i permessi di esecuzione di
    un file di cui si è fatto il checkout, ad esempio "nomefile", per
    risolverli cambiare i suoi permessi nell'archivio CVS
    corrispondente nel modo seguente.

    # chmod ugo-x nomefile

%

10.8. Subversion

    Subversion è un sistema di controllo delle versioni di vecchio
    antecedente a Git, ma successivo a CVS. Manca delle funzionalità
    per etichette e rami che si trovano in CVS e Git.

    Per impostare un server Subversion è necessario installare i
    pacchetti subversion, libapache2-mod-svn e subversion-tools.

%

10.8.1. Configurazione di archivi Subversion

    Attualmente il pacchetto subversion non imposta un archivio,
    perciò è necessario farlo manualmente. Una possibile collocazione
    per un archivio è in "/srv/svn/progetto".

    Creare una directory con il comando seguente

    # mkdir -p        /srv/svn/progetto

    Creare il database dell'archivio con il comando seguente.

    # svnadmin create /srv/svn/progetto

%

10.8.2. Accedere a Subversion tramite il server Apache2

    Se si accede all'archivio Subversion solamente attraverso il
    server Apache2, è necessario soltanto rendere l'archivio
    scrivibile dal server WWW, nel modo seguente.

    # chown -R www-data:www-data /srv/svn/progetto

    Per permettere l'accesso all'archivio tramite autenticazione
    dell'utente aggiungere (o decommentare) quanto segue in "/etc/
    apache2/mods-available/dav_svn.conf".

    <Location /progetto>
      DAV svn
      SVNPath /srv/svn/progetto
      AuthType Basic
      AuthName "Subversion repository"
      AuthUserFile /etc/subversion/passwd
    <LimitExcept GET PROPFIND OPTIONS REPORT>
        Require valid-user
    </LimitExcept>
    </Location>

    Creare un file di autenticazione dell'utente con il comando
    seguente.

    # htpasswd2 -c /etc/subversion/passwd un-qualche-nomeutente

    Riavviare Apache2.

    Il nuovo archivio Subversion è accessibile da svn(1) agli URL
    "http://localhost/progetto" e "http://esempio.com/progetto"
    (assumendo che l'URL del proprio server web sia "http://
    esempio.com/").

%

10.8.3. Accesso locale a Subversion da parte di un gruppo

    I comandi seguenti impostano l'archivio Subversion per l'accesso
    locale da parte di un gruppo, ad esempio progetto.

    # chmod  2775     /srv/svn/progetto
    # chown -R root:src /srv/svn/progetto
    # chmod -R ug+rwX   /srv/svn/progetto

    Il nuovo archivio Subversion è accessibile con svn(1) per gli
    utenti locali che appartengono al gruppo progetto, all'URL "file:
    ///localhost/srv/svn/progetto" o "file:///srv/svn/progetto". Per
    assicurare l'accesso al gruppo è necessario usare i programmi
    come svn, svnserve, svnlook e svnadmin con "umask 002".

%

10.8.4. Accesso remoto a Subversion con SSH

    Se esiste un archivio Subversion accessibile da un gruppo all'URL
    "esempio.com:/srv/svn/progetto", si può accedere ad esso con svn
    (1) e SSH all'URL "svn+ssh://esempio.com:/srv/svn/progetto".

%

10.8.5. Struttura delle directory di Subversion

    Per compensare la mancanza di rami ed etichette in Subversion,
    molti progetti usano con esso un albero di directory simile al
    seguente.

      ----- modulo1
        |   |-- branches
        |   |-- tags
        |   |   |-- rilascio-1.0
        |   |   `-- rilascio-2.0
        |   |
        |   `-- trunk
        |       |-- file1
        |       |-- file2
        |       `-- file3
        |
        `-- modulo2

    Suggerimento

    Per marcare i rami e le etichette è necessario usare il comando
    "svn copy …". Ciò assicura che Subversion regisstri la cronologia
    dei cambiamenti dei file in maniera corretta e risparma spazio.

%

10.8.6. Importare un nuovo sorgente in Subversion

    Creare un nuovo albero di sorgenti locale in "~/percorso/di/
    modulo1" con il comando seguente.

    $ mkdir -p ~/percorso/di/modulo1; cd ~/percorso/di/modulo1

    Popolare il nuovo albero di sorgenti locale in "~/percorso/di/
    modulo1" con i file.

    Importarlo In Subversion con i parametri seguenti.

      * Nome modulo: "modulo1"

      * URL sito Subversion: "file:///srv/svn/progetto"
   
      * Directory Subversion: "modulo1/trunk"

      * Etichetta Subversion: "modulo1/tags/Rilascio-iniziale"

    $ cd ~/percorso/di/modulo1
    $ svn import file:///srv/svn/progetto/modulo1/trunk -m "Inizo di modulo1"
    $ svn cp file:///srv/svn/progetto/modulo1/trunk file:///srv/svn/progetto/modulo1/tags/Rilascio-iniziale

    In alternativa usare i comandi seguenti.

    $ svn import ~/percorso/di/modulo1 file:///srv/svn/progetto/modulo1/trunk -m "Inizo di modulo1"
    $ svn cp file:///srv/svn/progetto/modulo1/trunk file:///srv/svn/progetto/modulo1/tags/Rilascio-iniziale

    Suggerimento
   
    Si possono sostituire gli URL come "file:///…" con URL in
    qualsiasi altro formato, come "http://…" e "svn+ssh://…".

%

10.8.7. Sequenza di azioni tipiche nell'uso di Subversion

    Ecco un esempio di una sequenza tipica di azioni svolte nell'uso
    di Subversion con il suo client nativo.

    Suggerimento

    I comandi client forniti dal pacchetto git-svn possono offrire un
    metodo alternativo di lavoro con Subversion con l'uso del comando
    git. Vedere Sezione 10.6.4, «Git per repository Subversion».

    Controllare tutti i moduli disponibili dal progetto Subversion a
    cui punta l'URL "file:///srv/svn/progetto" con il comando
    seguente.

    $ svn list file:///srv/svn/progetto
    modulo1
    modulo2
    ...

    Fare il checkout di "modulo1/trunk" in una directory "./modulo1"
    con il comando seguente.

    $ cd ~/percorso/di
    $ svn co file:///srv/svn/progetto/modulo1/trunk modulo1
    $ cd modulo1

    Fare i cambiamenti desiderati necessari ai contenuti.

    Controllare i cambiamenti facendo l'equivalente di "diff -u
    [archivio] [locale]" con il comando seguente.

    $ svn diff

    Si scopre, ad esempio, di aver corrotto gravemente un file
    "file_da_ripristinare", ma gli altri file sono a posto.

    Sovrascrivere "file_da_ripristinare" con una copia pulita da
    Subversion con il comando seguente.

    $ svn revert file_da_ripristinare

    Salvare l'albero dei sorgenti locale aggiornato su Subversion con
    il comando seguente.

    $ svn ci -m "Descrivere qui i cambiamenti"

    Creare ed aggiungere il file "file_da_aggiungere" a Subversion
    con il comando seguente.

    $ vi file_da_aggiungere
    $ svn add file_da_aggiungere
    $ svn ci -m "Aggiunto file_da_aggiungere"

    Fondere la versione più recente da Subversion con il comando
    seguente.

    $ svn up

    Prestare attenzione alle righe che iniziano con "C nomefile" che
    indicano le modifiche che creano conflitti.

    Cercare codice non modificato in, ad esempio "nomefile.r6",
    "nomefile.r9" e "nomefile.mio".

    Per trovare le modifiche che creano conflitti cercare "<<<<<<<" e
    ">>>>>>>" nei file.

    Modificare i file in modo da risolvere i conflitti.

    Aggiungere un'etichetta di rilascio "Rilascio-1" nel modo
    seguente.

    $ svn ci -m "ultimo commit per Rilascio-1"
    $ svn cp file:///srv/svn/progetto/modulo1/trunk file:///srv/svn/progetto/modulo1/tags/Rilascio-1

    Modificare ulteriormente.

    Rimuovere l'etichetta di rilascio "Rilascio-1" con il comando
    seguente.

    $ svn rm file:///srv/svn/progetto/modulo1/tags/Rilascio-1

    Fare il commit delle modifiche su Subversion con il comando
    seguente.

    $ svn ci -m "ultimissimo commit per Rilascio-1"

    Riaggiungere l'etichetta di rilascio "Rilascio-1" all'HEAD CVS
    aggiornato di trunk con il comando seguente.

    $ svn cp file:///srv/svn/progetto/modulo1/trunk file:///srv/svn/progetto/modulo1/tags/Rilascio-1

    Creare un ramo con percorso "modulo1/branches/
    Rilascio-iniziale-risoluzionebug" dalla versione originale a cui
    punta il percorso "modulo1/tags/Rilascio-iniziale" e farne il
    checkout nella directory "~/percorso/di/vecchio" nel modo
    seguente.

    $ svn cp file:///srv/svn/progetto/modulo1/tags/Rilascio-initzale file:///srv/svn/progetto/modulo1/branches/Rilascio-iniziale-risoluzionebug
    $ cd ~/percorso/di
    $ svn co file:///srv/svn/progetto/modulo1/branches/Rilascio-iniziale-risoluzionebug vecchio
    $ cd vecchio

    Suggerimento

    Per specificare una particolare data come punto di ramificazione,
    usare "modulo1/trunk@{2005-12-20}" (formato ISO 8601 per le date)
    invece di "modulo1/tags/Rilascio-iniziale".

    Lavorare in questo albero locale di sorgenti che punta al ramo
    "Rilascio-iniziale-risoluzionebug" e che è basato sulla versione
    originale.

    Lavorare in questo ramo da soli … fino a che qualcun altro non si
    aggiunge al ramo "Rilascio-iniziale-risoluzionebug".

    Fare la sincronizzazione con i file in questo ramo modificati da
    altri, con il comando seguente.

    $ svn up

    Modificare i file in modo da risolvere i conflitti.

    Fare il commit delle modifiche su Subversion con il comando
    seguente.

    $ svn ci -m "fatto il commit in questo ramo"

    Aggiornare l'albero locae con HEAD di trunk nel modo seguente.

    $ svn switch file:///srv/svn/progetto/modulo1/trunk

    Aggiornare l'albero locale (contenuto = HEAD di trunk) fondendo
    dal ramo "Rilascio-iniziale-risoluzionebug" con il comando
    seguente.

    $ svn merge file:///srv/svn/progetto/modulo1/branches/Rilascio-iniziale-risoluzionebug

    Correggere i conflitti con l'editor.

    Fare il commit delle modifiche su Subversion con il comando
    seguente.

    $ svn ci -m "fusione con Rilascio-iniziale-risoluzionebug"

    Creare un file archivio nel modo seguente.

    $ cd ..
    $ mv vecchio vecchio-modulo1-risoluzionebug
    $ tar -cvzf vecchio-modulo1-risoluzionebug.tar.gz vecchio-modulo1-risoluzionebug
    $ rm -rf vecchio-modulo1-risoluzionebug

    Suggerimento
   
    Si possono sostituire gli URL come "file:///…" con URL in
    qualsiasi altro formato, come "http://…" e "svn+ssh://…".

    Suggerimento

    Si può fare il checkout solamente di una sottodirectory di
    "modulo1" fornendo il suo nome come in "svn co file:///srv/svn/
    progetto/modulo1/trunk/sottodir modulo1/sottodir", ecc.

    Tabella 10.15. Opzioni importanti per comandi Subversion (da
    usare come primi argomenti di svn(1))

    +--------------------------------------------------------------+
    | opzione |                    significato                     |
    |---------+----------------------------------------------------|
    |--dry-run|esecuzione di prova, nessun effetto                 |
    |---------+----------------------------------------------------|
    |-v       |visualizza messaggi dettagliati sull'attività di svn|
    +--------------------------------------------------------------+


Capitolo 11. Conversione di dati

    In questo capitolo sono descritti strumenti e trucchi per
    convertire tra diversi formati di dati in un sistema Debian.

    Gli strumenti standard sono eccellenti, ma il supporto per i
    formati proprietari per i dati è limitato.

%

11.1. Strumenti di conversione di dati testuali

    Quelli che seguono sono pacchetti per la conversione dei dati
    testuali che hanno attirato la mia attenzione.

    Tabella 11.1. Elenco di strumenti di conversione di dati testuali

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|   parola chiave   |  descrizione  |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |convertitore   |
    |         |      |          |                   |della codifica |
    |libc6    |V:935,|12771     |set di caratteri   |del testo tra  |
    |         |I:999 |          |                   |localizzazioni |
    |         |      |          |                   |usando iconv(1)|
    |         |      |          |                   |(fondamentale) |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |convertitore   |
    |         |      |          |                   |della codifica |
    |         |      |          |set                |del testo tra  |
    |recode   |V:3,  |603       |caratteri+carattere|localizzazioni |
    |         |I:25  |          |fine riga          |(versatile,    |
    |         |      |          |                   |maggior numero |
    |         |      |          |                   |di alias e     |
    |         |      |          |                   |funzionalità)  |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |convertitore   |
    |         |V:1,  |          |                   |della codifica |
    |konwert  |I:54  |134       |set di caratteri   |tra            |
    |         |      |          |                   |localizzazioni |
    |         |      |          |                   |(elegante)     |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |traduttore del |
    |nkf      |V:0,  |358       |set di caratteri   |set di         |
    |         |I:11  |          |                   |caratteri per  |
    |         |      |          |                   |il giapponese  |
    |---------+------+----------+-------------------+---------------|
    |         |V:0,  |          |                   |traduttore del |
    |tcs      |I:0   |518       |set di caratteri   |set di         |
    |         |      |          |                   |caratteri      |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |sostituisce le |
    |         |V:0,  |          |                   |lettere        |
    |unaccent |I:0   |29        |set di caratteri   |accentate con  |
    |         |      |          |                   |le equivalenti |
    |         |      |          |                   |senza accento  |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |convertitore   |
    |         |V:1,  |          |                   |del formato di |
    |tofrodos |I:25  |55        |carattere fine riga|testo tra DOS e|
    |         |      |          |                   |Unix: fromdos  |
    |         |      |          |                   |(1) e todos(1) |
    |---------+------+----------+-------------------+---------------|
    |         |      |          |                   |convertitore   |
    |         |      |          |                   |del formato di |
    |macutils |V:0,  |298       |carattere fine riga|testo tra      |
    |         |I:1   |          |                   |Macintosh e    |
    |         |      |          |                   |Unix: frommac  |
    |         |      |          |                   |(1) e tomac(1) |
    +---------------------------------------------------------------+


%

11.1.1. Convertire un file di testo con iconv

    Suggerimento

    iconv(1) viene fornito come parte del pacchetto libc6 ed è sempre
    disponibile praticamente su tutti i sistemi in stile Unix, per
    fare la conversione della codifica dei caratteri.

    Si può convertire la codifica di un file di testo con iconv(1)
    nel modo seguente.

    $ iconv -f codifica1 -t codifica2 input.txt >output.txt

    Nel trovare corrispondenze con i valori delle codifiche non viene
    tenuto conto delle lettere maiuscole o minuscole e vengono
    ignorati i caratteri "-" e "_". Si possono controllare le
    codifiche supportate con il comando "iconv -l".

    Tabella 11.2. Elenco dei valori delle codifiche e loro uso

    +---------------------------------------------------------------+
    |  valore   |                                                   |
    |   della   |                        uso                        |
    | codifica  |                                                   |
    |-----------+---------------------------------------------------|
    |           |American Standard Code for Information Interchange,|
    |ASCII      |codifica americana standard per lo scambio di      |
    |           |informazioni, codice a 7 bit senza caratteri       |
    |           |accentati                                          |
    |-----------+---------------------------------------------------|
    |UTF-8      |attuale standard multilingua per tutti i sistemi   |
    |           |operativi moderni                                  |
    |-----------+---------------------------------------------------|
    |ISO-8859-1 |vecchio standard per le lingue europee occidentali,|
    |           |ASCII + caratteri accentati                        |
    |-----------+---------------------------------------------------|
    |ISO-8859-2 |vecchio standard per le lingue europee orientali,  |
    |           |ASCII + caratteri accentati                        |
    |-----------+---------------------------------------------------|
    |ISO-8859-15|vecchio standard per le lingue europee occidentali,|
    |           |ISO-8859-1 con simbolo dell'euro                   |
    |-----------+---------------------------------------------------|
    |           |code page 850, caratteri Microsoft DOS con         |
    |CP850      |caratteri grafici per le lingue europee            |
    |           |occidentali, variante di ISO-8859-1                |
    |-----------+---------------------------------------------------|
    |CP932      |code page 932, variante in stile Microsoft Windows |
    |           |di Shift-JIS per il giapponese                     |
    |-----------+---------------------------------------------------|
    |CP936      |code page 936, variante in stile Microsoft Windows |
    |           |di GB2312, GBK o GB18030 per il cinese semplificato|
    |-----------+---------------------------------------------------|
    |CP949      |code page 949, variante in stile Microsoft Windows |
    |           |di EUC-KR o Unified Hangul Code per il coreano     |
    |-----------+---------------------------------------------------|
    |CP950      |code page 950, variante in stile Microsoft Windows |
    |           |di Big5 per il cinese tradizionale                 |
    |-----------+---------------------------------------------------|
    |CP1251     |code page 1251, codifica in stile Microsoft Windows|
    |           |per l'alfabeto cirillico                           |
    |-----------+---------------------------------------------------|
    |CP1252     |code page 1252, variante in stile Microsoft Windows|
    |           |di ISO-8859-15 per le lingue europee occidentali   |
    |-----------+---------------------------------------------------|
    |KOI8-R     |vecchio standard UNIX russo per l'alfabeto         |
    |           |cirillico                                          |
    |-----------+---------------------------------------------------|
    |ISO-2022-JP|codifica standard per la posta elettronica in      |
    |           |giapponese che usa solo codici a 7 bit             |
    |-----------+---------------------------------------------------|
    |eucJP      |vecchio standard UNIX giapponese con codici a 8 bit|
    |           |completamente diverso da Shift-JIS                 |
    |-----------+---------------------------------------------------|
    |Shift-JIS  |standard JIS X 0208 Appendix 1 per il giapponese   |
    |           |(vedere CP932)                                     |
    +---------------------------------------------------------------+


    Nota

    Alcune codifiche non sono gestite in fase di conversione dei dati
    e non sono utilizzate come valori di localizzazione (
    Sezione 8.4.1, «Nozioni base sulla codifica»).

    Per i set di caratteri contenuti in un singolo byte, come i set
    di caratteri ASCII e ISO-8859, la codifica di carattere è quasi
    la stessa cosa del set di caratteri.

    Per i set di caratteri con molti caratteri, come JIS X 0213 per
    il giapponese o Universal Character Set (UCS, Unicode,
    ISO-10646-1) per praticamente tutte le lingue, esistono molti
    schemi di codifica per inserirli nella sequenza dei byte dati.

      * EUC e ISO/IEC 2022 (chiamato anche JIS X 0202) per il
        giapponese

      * UTF-8, UTF-16/UCS-2 e UTF-32/UCS-4 per Unicode

    In questi casi c'è una netta differenza tra il set di caratteri e
    la codifica di caratteri.

    Il termine code page è usato come sinonimo di tabella di codifica
    dei caratteri per alcune tabelle specifiche di produttori.

    Nota

    Notare che la maggior parte dei sistemi di codifica condividono
    con ASCII gli stessi codici per i caratteri a 7 bit. Ci sono però
    alcune eccezioni. Se si stanno convertendo dati di vecchi
    programmi C o URL in giapponese dal formato di codifica
    volgarmente chiamato Shift-JIS in formato UTF-8, usare "CP932"
    come nome di codifica invece di "shift-JIS" per ottenere i
    risultati attesi: 0x5C → "\" e 0x7E → "~". Altrimenti questi
    vengono convertiti nei caratteri sbagliati.

    Suggerimento

    Si può anche usare recode(1) che offre più della semplice
    combinazione delle funzionalità di iconv(1), fromdos(1), todos(1)
    , frommac(1) e tomac(1). Per maggiori informazioni vedere "info
    recode".

%

11.1.2. Controllare se un file è in UTF-8 con iconv

    Si può controllare se un file di testo è nella codifica UTF-8
    usando iconv(1) nel modo seguente.

    $ iconv -f utf8 -t utf8 input.txt >/dev/null || echo "trovato non-UTF-8"

    Suggerimento
   
    Usare l'opzione "--verbose" nell'esempio precedente per trovare
    il primo carattere non UTF-8.

%

11.1.3. Convertire nomi di file con iconv

    Ecco uno script d'esempio per convertire in una directory la
    codifica dei nomi di file dai nomi creati in un vecchio sistema
    operativo a quelli UTF-8 moderni.

    #!/bin/sh
    ENCDN=iso-8859-1
    for x in *;
     do
     mv "$x" "$(echo "$x" | iconv -f $ENCDN -t utf-8)"
    done

    La variabile "$ENCDN" specifica la codifica originale usata per i
    nomi di file nei sistemi operativi più vecchi come in
    Tabella 11.2, «Elenco dei valori delle codifiche e loro uso».

    Per scenari più complessi, montare, usando come opzione di mount
    (8) la codifica appropriata (vedere Sezione 8.4.6, «Codifica per
    i nomi di file»), il file system (ad esempio una partizione in un
    disco fisso) contenente tali nomi di file e copiare usando il
    comando "cp-a" il suo intero contenuto in un altro file system
    montato come UTF-8.

%

11.1.4. Conversione del carattere di fine riga

    Il formato dei file di testo e specificatamente il codice EOL
    (End of line, fine riga) è dipendente dalla piattaforma.

    Tabella 11.3. Elenco di stili per EOL per differenti piattaforme

    +---------------------------------------------------------------+
    | piattaforma  | codice |   carattere di   |decimale|esadecimale|
    |              |  EOL   |    controllo     |        |           |
    |--------------+--------+------------------+--------+-----------|
    |Debian (unix) |LF      |^J                |10      |0A         |
    |--------------+--------+------------------+--------+-----------|
    |MSDOS e       |CR-LF   |^M^J              |13 10   |0D 0A      |
    |Windows       |        |                  |        |           |
    |--------------+--------+------------------+--------+-----------|
    |Macintosh di  |CR      |^M                |13      |0D         |
    |Apple         |        |                  |        |           |
    +---------------------------------------------------------------+


    I programmi di conversione del formato di EOL, fromdos(1), todos
    (1), frommac(1) e tomac(1), sono piuttosto comodi. Anche recode
    (1) è utile.

    Nota

    Alcuni dati nel sistema Debian, come i dati della pagina wiki per
    il pacchetto python-moinmoin, usano CR-LF in stile MSDOS come
    codice EOL. Perciò la regola sopra descritta è solamente una
    regola generale.

    Nota
   
    La maggior parte degli editor (es. vim, emacs, gedit, …) può
    gestire file con EOL in stile MSDOS in modo trasparente.

    Suggerimento

    È meglio usare "sed -e '/\r$/!s/$/\r/'" invece di todos(1) quando
    si desidere unificare lo stile EOL allo stile MSDOS da uno stile
    misto MSDOS e Unix (ad esempio dopo la fusione di 2 file in stile
    MSDOS con diff3(1)). Questo perché todos aggiunge CR a tutte le
    righe.

%

11.1.5. Conversione di tabulazioni

    Esistono alcuni programmi popolari specializzati nella
    conversione dei codici di tabulazione.

    Tabella 11.4. Elenco di comandi di conversione di TAB dai
    pacchetti bsdmainutils e coreutils

    +----------------------------------------------------------+
    |             funzione              |bsdmainutils|coreutils|
    |-----------------------------------+------------+---------|
    |espande le tabulazioni in spazi    |"col -x"    |expand   |
    |-----------------------------------+------------+---------|
    |de-espande gli spazi in tabulazioni|"col -h"    |unexpand |
    +----------------------------------------------------------+


    indent(1) nel pacchetto indent riformatta completamente gli spazi
    bianchi nei programmi C.

    Anche programmi editor come vim ed emacs possono essere usati per
    la conversione di TAB. Per esempio con vim, è possibile espandere
    i TAB con la sequenza di comandi ":set expandtab" e ":%retab". Si
    può annullare questa azione con la sequenza di comandi ":set
    noexpandtab" e ":%retab!".

%

11.1.6. Editor con auto-conversione

    Gli editor moderni intelligenti come il programmavim sono
    piuttosto bravi e gestiscono bene qualsiasi sistema di codifica e
    formato di file. Per una migliore compatibilità questi editor
    andrebbero usati con la localizzazione UTF-8 in console con
    capacità UTF-8.

    Un vecchio file di testo Unix in lingua europea occidentale,
    "u-file.txt" salvato nella codifica latin1 (iso-8859-1) può
    essere modificato con vim semplicemente con il comando seguente.

    $ vim u-file.txt

    Ciò è reso possibile dal fatto che il meccanismo di rivelazione
    automatica della codifica dei file di vim presuppone come prima
    cosa che la codifica sia UTF-8 e, se ciò fallisce, presuppone che
    sia latin1.

    Un vecchio file di testo Unix in lingua polacca, "pu-file.txt"
    salvato nella codifica latin1 (iso-8859-1) può essere modificato
    con vim con il comando seguente.

    $ vim '+e ++enc=latin2 pu-file.txt'

    Un vecchio file di testo Unix in giapponese, "ju-file.txt"
    salvato nella codifica eucJP può essere modificato con vim con il
    comando seguente.

    $ vim '+e ++enc=eucJP ju-file.txt'

    Un vecchio file di testo MS-Windows in giapponese, "jw-file.txt"
    salvato nella cosiddetta codifica shift-JIS (più precisamente
    CP932) può essere modificato con vim con il comando seguente.

    $ vim '+e ++enc=CP932 ++ff=dos jw-file.txt'

    Quando un file viene aperto con le opzioni "++enc" e "++ff",
    l'uso di ":w" nella riga di comando di Vim lo salva nel formato
    originale sovrascrivendo il file originale. Si può anche
    specificare nella riga di comando di Vim il formato e il nome con
    cui salvare il file, ad esempio ":w ++enc=utf8 nuovo.txt".

    Fare riferimento a mbyte.txt per il "supporto di testi
    multi-byte" nell'aiuto in linea di vim e a Tabella 11.2, «Elenco
    dei valori delle codifiche e loro uso» per i valori delle
    localizzazione usati con "++enc".

    La famiglia di programmi emacs può svolgere funzioni equivalenti.

%

11.1.7. Estrazione del testo puro

    Il comando seguente legge una pagina web mettendola in un file di
    testo. È molto utile quando si copiano configurazioni dal Web o
    per applicare strumenti di testo base Unix come grep(1) sulla
    pagina web.

    $ w3m -dump http://www.sito-remoto.com/help-info.html >filetesto

    In modo analogo, si possono estrarre dati in testo puro da altri
    formati con gli strumenti seguenti.

    Tabella 11.5. Elenco di strumenti per estrarre dati in testo puro

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|   parola   |       funzione       |
    |         |      |          |   chiave   |                      |
    |---------+------+----------+------------+----------------------|
    |         |V:31, |          |html→testo  |conversione da HTML a |
    |w3m      |I:284 |2289      |puro        |testo semplice con il |
    |         |      |          |            |comando "w3m -dump"   |
    |---------+------+----------+------------+----------------------|
    |         |V:3,  |          |html→testo  |convertitore avanzato |
    |html2text|I:33  |274       |puro        |da HTML a testo       |
    |         |      |          |            |semplice (ISO 8859-1) |
    |---------+------+----------+------------+----------------------|
    |         |V:13, |          |html→testo  |conversione da HTML a |
    |lynx     |I:98  |1948      |puro        |testo semplice con il |
    |         |      |          |            |comando "lynx -dump"  |
    |---------+------+----------+------------+----------------------|
    |         |V:6,  |          |html→testo  |conversione da HTML a |
    |elinks   |I:28  |1767      |puro        |testo semplice con il |
    |         |      |          |            |comando "elinks -dump"|
    |---------+------+----------+------------+----------------------|
    |         |V:6,  |          |html→testo  |conversione da HTML a |
    |links    |I:39  |2249      |puro        |testo semplice con il |
    |         |      |          |            |comando "links -dump" |
    |---------+------+----------+------------+----------------------|
    |         |V:1,  |          |html→testo  |conversione da HTML a |
    |links2   |I:15  |5417      |puro        |testo semplice con il |
    |         |      |          |            |comando "links2 -dump"|
    |---------+------+----------+------------+----------------------|
    |antiword |V:2,  |589       |MSWord→testo|converte file MSWord  |
    |         |I:10  |          |puro, ps    |in testo puro o ps    |
    |---------+------+----------+------------+----------------------|
    |catdoc   |V:27, |675       |MSWord→testo|converte file MSWord  |
    |         |I:127 |          |puro, TeX   |in testo puro o TeX   |
    |---------+------+----------+------------+----------------------|
    |pstotext |V:1,  |126       |ps/pdf→testo|estrae testo da file  |
    |         |I:3   |          |puro        |PostScript e PDF      |
    |---------+------+----------+------------+----------------------|
    |unhtml   |V:0,  |43        |html→testo  |rimuove i tag         |
    |         |I:0   |          |puro        |marcatori da file HTML|
    |---------+------+----------+------------+----------------------|
    |         |V:1,  |          |odt→testo   |converte da           |
    |odt2txt  |I:7   |60        |puro        |OpenDocument Text in  |
    |         |      |          |            |testo puro            |
    +---------------------------------------------------------------+


%

11.1.8. Evidenziare e formattare dati in puro testo

    È possibile evidenziare e formattare dati in testo puro usando
    gli strumenti seguenti.

    Tabella 11.6. Elenco di strumenti per evidenziare dati in testo
    puro

    +---------------------------------------------------------------+
    |   pacchetto    |popcon|dimensione|   parola   |  descrizione  |
    |                |      |          |   chiave   |               |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |MACRO Vim per  |
    |                |      |          |            |convertire     |
    |                |      |          |            |codice sorgente|
    |vim-runtime     |V:19, |31723     |evidenziare |in HTML con    |
    |                |I:435 |          |            |":source       |
    |                |      |          |            |$VIMRUNTIME/   |
    |                |      |          |            |syntax/        |
    |                |      |          |            |html.vim"      |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |convertitore   |
    |cxref           |V:0,  |1193      |c→html      |per programmi C|
    |                |I:0   |          |            |in latex e HTML|
    |                |      |          |            |(linguaggio C) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |converte molti |
    |src2tex         |V:0,  |622       |evidenziare |codici sorgenti|
    |                |I:0   |          |            |in TeX         |
    |                |      |          |            |(linguaggio C) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |converte molti |
    |                |      |          |            |codici sorgenti|
    |                |      |          |            |in file HTML,  |
    |                |      |          |            |XHTML, LaTeX,  |
    |                |V:0,  |          |            |Texinfo,       |
    |source-highlight|I:7   |1992      |evidenziare |sequenze di    |
    |                |      |          |            |escape per     |
    |                |      |          |            |colori ANSI e  |
    |                |      |          |            |DocBook con    |
    |                |      |          |            |evidenziazione |
    |                |      |          |            |(C++)          |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |converte molti |
    |                |      |          |            |codici sorgenti|
    |                |      |          |            |in file HTML,  |
    |highlight       |V:1,  |1083      |evidenziare |XHTML, RTF,    |
    |                |I:12  |          |            |LaTeX, TeX o   |
    |                |      |          |            |XSL-FO con     |
    |                |      |          |            |evidenziazione |
    |                |      |          |            |(C++)          |
    |----------------+------+----------+------------+---------------|
    |                |V:0,  |          |            |colorazione    |
    |grc             |I:3   |190       |testo→colori|generica per   |
    |                |      |          |            |tutto (Python) |
    |----------------+------+----------+------------+---------------|
    |                |V:0,  |          |            |convertitore da|
    |txt2html        |I:3   |259       |testo→html  |testo semplice |
    |                |      |          |            |in HTML (Perl) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |formattatore   |
    |                |V:0,  |          |            |markdown di    |
    |markdown        |I:8   |57        |testo→html  |documenti di   |
    |                |      |          |            |testo in (X)   |
    |                |      |          |            |HTML (Perl)    |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |formattatore   |
    |                |      |          |            |AsciiDoc di    |
    |asciidoc        |I:13  |81        |testo→tutto |documenti di   |
    |                |      |          |            |testo in XML/  |
    |                |      |          |            |HTML (Python)  |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |convertitore   |
    |pandoc          |V:8,  |151714    |testo→tutto |universale di  |
    |                |I:47  |          |            |marcatori      |
    |                |      |          |            |(Haskel)       |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |formattatore di|
    |                |V:12, |          |            |documenti      |
    |python-docutils |I:133 |1771      |testo→tutto |ReStructured   |
    |                |      |          |            |Text in XML    |
    |                |      |          |            |(Python)       |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |conversione di |
    |                |      |          |            |documenti da   |
    |                |      |          |            |testo semplice |
    |                |V:0,  |          |            |a HTML, SGML,  |
    |txt2tags        |I:1   |342       |testo→tutto |LaTeX, pagine  |
    |                |      |          |            |man, MoinMoin, |
    |                |      |          |            |Magic Point e  |
    |                |      |          |            |PageMaker      |
    |                |      |          |            |(Python)       |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |utilità        |
    |                |      |          |            |universale di  |
    |udo             |V:0,  |583       |testo→tutto |elaborazione di|
    |                |I:0   |          |            |documenti -    |
    |                |      |          |            |testo          |
    |                |      |          |            |(linguaggio C) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |convertitore di|
    |                |      |          |            |documenti da   |
    |stx2any         |V:0,  |264       |testo→tutto |testo semplice |
    |                |I:0   |          |            |strutturato in |
    |                |      |          |            |altri formati  |
    |                |      |          |            |(m4)           |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |convertitore di|
    |                |V:0,  |          |            |documenti da   |
    |rest2web        |I:0   |527       |testo→html  |ReStructured   |
    |                |      |          |            |Text in HTML   |
    |                |      |          |            |(Python)       |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |sistema di     |
    |                |V:0,  |          |            |preparazione di|
    |aft             |I:0   |235       |testo→tutto |documenti a    |
    |                |      |          |            |"modello       |
    |                |      |          |            |libero" (Perl) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |pre-linguaggio |
    |                |V:0,  |          |            |per documenti e|
    |yodl            |I:0   |610       |testo→tutto |strumenti per  |
    |                |      |          |            |elaborarlo     |
    |                |      |          |            |(linguaggio C) |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |semplice       |
    |sdf             |V:0,  |1445      |testo→tutto |analizzatore di|
    |                |I:0   |          |            |documenti      |
    |                |      |          |            |(Perl)         |
    |----------------+------+----------+------------+---------------|
    |                |      |          |            |infrastruttura |
    |                |      |          |            |per            |
    |                |V:0,  |          |            |strutturazione,|
    |sisu            |I:0   |5344      |testo→tutto |pubblicazione e|
    |                |      |          |            |ricerca di     |
    |                |      |          |            |documenti      |
    |                |      |          |            |(Ruby)         |
    +---------------------------------------------------------------+


%

11.2. Dati XML

    XML (Extensible Markup Language) è un linguaggio a marcatori per
    documenti contenenti informazioni strutturate.

    Vedere informazioni introduttive su XML.COM.

      * "Cosa è XML?"

      * "Cosa è XSLT?"
   
      * "Cosa è XSL-FO?"

      * "Cosa è XLink?"

%

11.2.1. Suggerimenti base per XML

    I testi XML hanno un aspetto simile all'HTML. Permettono di
    gestire formati di output multipli per un documento. Un facile
    sistema per XML è il pacchetto docbook-xsl che è stato usato per
    questo documento.

    Ogni file XML inizia con una dichiarazione XML standard come la
    seguente.

    <?xml version="1.0" encoding="UTF-8"?>

    La sintassi di base per un elemento XML usa un marcatore come il
    seguente.

    <nome attributo="valore">contenuto</nome>

    Gli elementi XML senza contenuto sono indicati nella seguente
    forma breve.

    <nome attributo="valore"/>

    La parte "attributo="valore"" negli esempi precedenti è
    opzionale.

    In XML una sezione di commento è marcata nel modo seguente.

    <!-- commento -->

    A parte l'aggiunta dei marcatori, XML richiede solo una minima
    conversione dei contenuti usando entità predefinite per i
    caratteri seguenti.

    Tabella 11.7. Elenco di entità predefinite per XML

    +----------------------------------------------+
    |entità predefinita|carattere in cui convertire|
    |------------------+---------------------------|
    |&quot;            |" : virgolette             |
    |------------------+---------------------------|
    |&apos;            |' : apostrofo              |
    |------------------+---------------------------|
    |&lt;              |< : minore-di              |
    |------------------+---------------------------|
    |&gt;              |> : maggiore-di            |
    |------------------+---------------------------|
    |&amp;             |& : e-commerciale          |
    +----------------------------------------------+


    Attenzione
   
    "<" e "&" non possono essere usati in attributi o elementi.

    Nota

    Quando vengono usate entità definite in stile SGML, ad esempio "&
    qualche-tag:", la prima definizione prevale su tutte le altre. La
    definizione di entità è espressa nella forma "<!ENTITY
    qualche-tag "valore entità">".

    Nota

    Fintanto che i marcatori XML sono usati in modo coerente con un
    certo set dei nomi di tag (qualche dato usato come contenuto o
    valore di attributo), la conversione in un altro XML è un compito
    banale usando XSLT (Extensible Stylesheet Language
    Trasformations.

%

11.2.2. Elaborazione XML

    Sono disponibili molti strumenti per elaborare file XML, come
    l'XSL (Extensible Stylesheet Language).

    Fondamentalmente, una volta creato un file XML ben formato, lo si
    può convertire in qualsiasi formato usando XSLT (Extensible
    Stylesheet Language Transformation).

    XSL-FO (Extensible Stylesheet Language for Formatting Object),
    linguaggio per fogli di stile estensibile per la formattazione di
    oggetti, è pensato per essere una soluzione per la formattazione.
    Il pacchetto fop è una novità nell'archivio Debian main a causa
    delle sue dipendenze dal linguaggio di programmazione Java.
    Perciò il codice LaTeX è solitamente generato dall'XML usando
    XSLT ed il sistema LaTeX viene usato per creare file adatti alla
    stampa come DVI, PostScript e PDF.

    Tabella 11.8. Elenco di strumenti XML

    +---------------------------------------------------------------+
    | pacchetto |popcon|dimensione|parola|       descrizione        |
    |           |      |          |chiave|                          |
    |-----------+------+----------+------+--------------------------|
    |           |V:15, |          |      |DTD (Document Type        |
    |docbook-xml|I:280 |2133      |xml   |Definition) XML per       |
    |           |      |          |      |DocBook                   |
    |-----------+------+----------+------+--------------------------|
    |           |      |          |      |elaboratore a riga di     |
    |xsltproc   |V:15, |160       |xslt  |comando XSLT (XML→ XML,   |
    |           |I:104 |          |      |HTML, testo semplice,     |
    |           |      |          |      |ecc.)                     |
    |-----------+------+----------+------+--------------------------|
    |           |      |          |      |fogli di stile XSL per    |
    |docbook-xsl|V:13, |14870     |xml/  |elaborare XML DocBook con |
    |           |I:165 |          |xslt  |XSLT in vari formati di   |
    |           |      |          |      |output                    |
    |-----------+------+----------+------+--------------------------|
    |xmlto      |V:1,  |130       |xml/  |convertitore              |
    |           |I:23  |          |xslt  |da-XML-a-tutto con XSLT   |
    |-----------+------+----------+------+--------------------------|
    |dbtoepub   |V:0,  |37        |xml/  |convertitore da XML       |
    |           |I:0   |          |xslt  |DocBook a .epub           |
    |-----------+------+----------+------+--------------------------|
    |           |V:3,  |          |xml/  |converte file DocBook con |
    |dblatex    |I:16  |4643      |xslt  |XSLT in documenti DVI,    |
    |           |      |          |      |PostScript, PDF           |
    |-----------+------+----------+------+--------------------------|
    |fop        |V:1,  |291       |xml/  |converte file XML DocBook |
    |           |I:24  |          |xsl-fo|in PDF                    |
    +---------------------------------------------------------------+


    Dato che XML è un sottoinsieme di SGML (Standard Generalized
    Markup Language), può essere elaborato dagli strumenti completi
    disponibili per SGML, come DSSSL (Document Style Semantics and
    Specification Language).

    Tabella 11.9. Elenco di strumenti DSSSL

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|parola|      descrizione       |
    |             |      |          |chiave|                        |
    |-------------+------+----------+------+------------------------|
    |             |V:2,  |          |      |elaboratore standard    |
    |openjade     |I:38  |1019      |dsssl |DSSSL ISO/IEC 10179:1996|
    |             |      |          |      |(più recente)           |
    |-------------+------+----------+------+------------------------|
    |             |      |          |      |fogli di stile DSSSL per|
    |docbook-dsssl|V:1,  |2604      |xml/  |elaborare XML DocBook   |
    |             |I:23  |          |dsssl |con DSSSL in vari       |
    |             |      |          |      |formati di output       |
    |-------------+------+----------+------+------------------------|
    |             |      |          |      |utilità per file        |
    |             |      |          |      |DocBook, inclusa la     |
    |docbook-utils|V:0,  |281       |xml/  |conversione in altri    |
    |             |I:16  |          |dsssl |formati (HTML, RTF, PS, |
    |             |      |          |      |man, PDF) con comandi   |
    |             |      |          |      |docbook2* con DSSSL     |
    |-------------+------+----------+------+------------------------|
    |             |V:0,  |          |SGML/ |convertitore da SGML e  |
    |sgml2x       |I:0   |90        |dsssl |XML che usa fogli di    |
    |             |      |          |      |stile DSSSL             |
    +---------------------------------------------------------------+


    Suggerimento
   
    A volte yelp di GNOME è utile per leggere file XML DocBook
    direttamente dato che li visualizza in modo decente in X.

%

11.2.3. Estrazione di dati XML

    Si possono esstrarre dati HTML o XML da altri formati usando gli
    strumenti seguenti.

    Tabella 11.10. Elenco di strumenti di estrazione di dati XML

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|  parola chiave  |   descrizione   |
    |---------+------+----------+-----------------+-----------------|
    |         |      |          |                 |convertitore di  |
    |wv       |V:0,  |717       |MSWord→tutto     |documenti da     |
    |         |I:7   |          |                 |Microsoft Word a |
    |         |      |          |                 |HTML, LaTeX, ecc.|
    |---------+------+----------+-----------------+-----------------|
    |texi2html|V:0,  |1833      |texi→html        |convertitore da  |
    |         |I:8   |          |                 |texinfo a HTML   |
    |---------+------+----------+-----------------+-----------------|
    |         |V:0,  |          |                 |convertitore da  |
    |man2html |I:2   |138       |pagine man→html  |pagine man a HTML|
    |         |      |          |                 |(supporto CGI)   |
    |---------+------+----------+-----------------+-----------------|
    |         |V:0,  |          |                 |convertitore di  |
    |unrtf    |I:4   |148       |rtf→html         |documenti da RTF |
    |         |      |          |                 |a HTML, ecc.     |
    |---------+------+----------+-----------------+-----------------|
    |         |V:1,  |          |                 |convertitore da  |
    |info2www |I:3   |76        |info→html        |GNU info a HTML  |
    |         |      |          |                 |(supporto CGI)   |
    |---------+------+----------+-----------------+-----------------|
    |         |      |          |                 |convertitore da  |
    |ooo2dbk  |V:0,  |217       |sxw→xml          |documenti SXW    |
    |         |I:0   |          |                 |OpenOffice.org in|
    |         |      |          |                 |XML DocBook      |
    |---------+------+----------+-----------------+-----------------|
    |         |      |          |                 |da file          |
    |wp2x     |V:0,  |202       |WordPerfect→tutto|WordPerfect 5.0 e|
    |         |I:0   |          |                 |5.1 a TeX, LaTeX,|
    |         |      |          |                 |troff, GML e HTML|
    |---------+------+----------+-----------------+-----------------|
    |         |V:0,  |          |                 |convertitore da  |
    |doclifter|I:0   |451       |troff→xml        |troff a XML      |
    |         |      |          |                 |DocBook          |
    +---------------------------------------------------------------+


    I file HTML non-XML possono essere convertiti in XHTML che è
    un'istanza di XML ben strutturato. XHTML può essere elaborato con
    strumenti XML.

    Tabella 11.11. Elenco di strumenti per belle stampe XML

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|parola chiave |  descrizione   |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |strumento XML a |
    |             |      |          |              |riga di comando |
    |             |      |          |              |con xmllint(1)  |
    |libxml2-utils|V:22, |182       |xml↔html↔xhtml|(controllo di   |
    |             |I:246 |          |              |sintassi,       |
    |             |      |          |              |riformattazione,|
    |             |      |          |              |eliminazione    |
    |             |      |          |              |sporcizia, …)   |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |controllore     |
    |tidy         |V:2,  |84        |xml↔html↔xhtml|della sintassi e|
    |             |I:14  |          |              |riformattatore  |
    |             |      |          |              |per HTML        |
    +---------------------------------------------------------------+


    Una volta che è stato generato codice XML corretto, si può usare
    la tecnologia XSLT per estrarre dati in base al contesto dei
    marcatori

%

11.3. Impaginazione

    Per semplici impaginazioni si può usare il programma Unix troff
    sviluppato da AT&T. Viene di solito usato per creare pagine man.

    TeX, creato da Donald Knuth è uno strumento di impaginazione
    molto potente ed è lo standard di fatto. LaTeX, scritto
    originariamente da Leslie Lamport, permette un accesso alla
    potenza di TeX a più alto livello.

    Tabella 11.12. Elenco di strumenti per impaginazione

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|parola |        descrizione        |
    |         |      |          |chiave |                           |
    |---------+------+----------+-------+---------------------------|
    |         |V:3,  |          |       |sistema TeX per            |
    |texlive  |I:50  |71        |(La)TeX|impaginazione, anteprima e |
    |         |      |          |       |stampa                     |
    |---------+------+----------+-------+---------------------------|
    |groff    |V:3,  |11838     |troff  |sistema di formattazione di|
    |         |I:64  |          |       |testi GNU troff            |
    +---------------------------------------------------------------+


%

11.3.1. Impaginazione roff

    Tradizionalmente il sistema di elaborazione di testi Unix
    principale è roff. Vedere roff(7), groff(7), groff(1), grotty(1),
    troff(1), groff_mdoc(7), groff_man(7), groff_ms(7), groff_me(7), 
    groff_mm(7) e "info groff".

    Si può leggere o stampare un buon tutorial e documento di
    consultazione sulla macro "-me" in "/usr/share/doc/groff/", dopo
    aver installato il pacchetto groff.

    Suggerimento

    "groff -Tascii -me -" produce output in puro testo con codici di
    escape ANSI. Se si desidera produrre un output in stile pagine
    man con molti "^H" e "_", usare invece "GROFF_NO_SGR=1 groff
    -Tascii -me -".

    Suggerimento
   
    Per rimuovere i "^H" e "_" da un file di testo generato con
    groff, filtrarlo con "col -b -x".

%

11.3.2. TeX/LaTeX

    La distribuzione software TeX Live offre un sistema TeX completo.
    Il metapacchetto texlive fornisce una buona selezione dei
    pacchetti TeX Live che dovrebbe essere sufficiente per la maggior
    parte dei compiti più comuni.

    Ci sono molti documenti consultabili disponibili per TeX e LaTeX.

      * teTeX HOWTO: The Linux-teTeX Local Guide

      * tex(1)

      * latex(1)

      * texdoc(1)

      * texdoctk(1)

      * "The TeXbook", di Donald E. Knuth, (Addison-Wesley)

      * "LaTeX - A Document Preparation System", di Leslie Lamport,
        (Addison-Wesley)

      * "The LaTeX Companion", di Goossens, Mittelbach, Samarin,
        (Addison-Wesley)

    Questo è l'ambiente di impaginazione più potente. Molti
    elaboratori SGML lo usano come backend per l'elaborazione del
    testo. Lyx, fornito dal pacchetto lyx, e GNUTeXmacs, fornito dal
    pacchetto texmacs, offrono un bell'ambiente WYSIWYG per LaTeX;
    inoltre molti usano Emacs e Vim come scelta di editor per i
    sorgenti.

    Sono disponibili molte risorse in rete.

      * The TEX Live Guide - TEX Live 2007 ("/usr/share/doc/
        texlive-doc-base/english/texlive-en/live.html") (pacchetto
        texlive-doc-base)

      * A Simple Guide to Latex/Lyx

      * Word Processing Using LaTeX

      * Local User Guide to teTeX/LaTeX

    Quando i documenti crescono di dimensioni, a volte TeX può
    generare errori. Per risolvere queto problema si deve aumentare
    la dimensione di pool in "/etc/texmf/texmf.cnf" (o in modo più
    corretto, modificare "/etc/texmf/texmf.d/95NonPath" ed eseguire 
    update-texmf(8)).

    Nota

    Il sorgente TeX di "The TeXbook" è disponibile all'indirizzo
    http://tug.ctan.org/tex-archive/systems/knuth/dist/tex/
    texbook.tex. Questo file contiene la maggior parte delle macro
    necessarie. Mi è stato detto che si può elaborare questo
    documento con tex(1) dopo aver commentato le righe da 7 a 10 ed
    aggiungendo "\input manmac \proofmodefalse". È caldamente
    raccomandabile comprare questo libro (e tutti gli altri libri di
    Donald E. Knuth) invece di usare le versioni in rete, ma il
    sorgente è un meraviglioso esempio di input TeX!

%

11.3.3. Fare una bella stampa di una pagina di manuale

    Si può stampare una pagina di manuale in PostScript in un bel
    modo usando uno dei comandi seguenti.

    $ man -Tps una_qualche_paginaman | lpr

%

11.3.4. Creare una pagina di manuale

    Benché sia possibile scrivere una pagina di manuale (pagina man)
    in formato troff semplice, ci sono alcuni pacchetti di aiuto per
    farlo.

    Tabella 11.13. Elenco di pacchetti che aiutano a creare una
    pagina man

    +---------------------------------------------------------------+
    |  pacchetto   |popcon|dimensione| parola chiave | descrizione  |
    |--------------+------+----------+---------------+--------------|
    |              |      |          |               |convertitore  |
    |docbook-to-man|V:0,  |191       |SGML→paginaman |da SGML       |
    |              |I:13  |          |               |DocDook in    |
    |              |      |          |               |macro roff man|
    |--------------+------+----------+---------------+--------------|
    |              |      |          |               |generatore    |
    |help2man      |V:0,  |498       |testo→paginaman|automatico di |
    |              |I:10  |          |               |pagine man da |
    |              |      |          |               |--help        |
    |--------------+------+----------+---------------+--------------|
    |              |      |          |               |convertitore  |
    |info2man      |V:0,  |134       |info→paginaman |da GNU info a |
    |              |I:0   |          |               |POD o pagine  |
    |              |      |          |               |man           |
    |--------------+------+----------+---------------+--------------|
    |              |      |          |               |converte testo|
    |              |V:0,  |          |               |in puro ASCII |
    |txt2man       |I:1   |114       |testo→paginaman|nel formato   |
    |              |      |          |               |delle pagine  |
    |              |      |          |               |man           |
    +---------------------------------------------------------------+


%

11.4. Dati stampabili

    In un sistema Debian i dati stampabili sono presentati in formato
    PostScript. CUPS (Common Unix Printing System) usa Ghostscript
    come suo programma backend per la rasterizzazione per le
    stampanti non-PostScript.

%

11.4.1. Ghostscript

    Il cuore centrale della manipolazione dei dati da stampare è
    l'interprete PostScript (PS) Ghostscript che genera immagini
    raster.

    La licenza dell'ultima versione a monte di Ghostscript di Artifex
    è passata da AFPL a GPL e sono state fuse in un rilascio
    unificato tutte le più recenti modifiche alle versioni ESP, come
    quelle relative a CUPS nel rilascio 8.60.

    Tabella 11.14. Elenco di interpreti PostScript Ghostscript

    +---------------------------------------------------------------+
    |   pacchetto    |popcon|dimensione|        descrizione         |
    |----------------+------+----------+----------------------------|
    |ghostscript     |V:252,|231       |interprete PostScript/PDF   |
    |                |I:598 |          |GPL Ghostscript             |
    |----------------+------+----------+----------------------------|
    |                |V:15, |          |interprete PostScript/PDF   |
    |ghostscript-x   |I:65  |223       |GPL Ghostscript - supporto  |
    |                |      |          |per display X               |
    |----------------+------+----------+----------------------------|
    |                |      |          |libreria di rendering per   |
    |libpoppler95    |I:3   |4172      |PDF risultato di un fork del|
    |                |      |          |visualizzatore di PDF xpdf  |
    |----------------+------+----------+----------------------------|
    |                |V:217,|          |libreria di rendering per   |
    |libpoppler-glib8|I:481 |449       |PDF (libreria condivisa     |
    |                |      |          |basata su GLib)             |
    |----------------+------+----------+----------------------------|
    |                |V:111,|          |CMaps per la libreria di    |
    |poppler-data    |I:637 |13090     |rendering per PDF (per      |
    |                |      |          |supporto CJK: Adobe-*)      |
    +---------------------------------------------------------------+


    Suggerimento
   
    La configurazione di Ghostscript può essere visualizzata con "gs
    -h".

%

11.4.2. Unire due file PS o PDF

    È possibile unire due file PostScript (PS) o PDF (Portable
    Document Format) usando gs(1) di Ghostscript.

    $ gs -q -dNOPAUSE -dBATCH -sDEVICE=pswrite -sOutputFile=bla.ps -f pippo1.ps pippo2.ps
    $ gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sOutputFile=bla.pdf -f pippo1.pdf pippo2.pdf

    Nota

    Il formato PDF che è un formato ampiamente usato per dati
    stampabili multipiattaforma, è essenzialmente il formato PS
    compresso con alcune funzionalità ed estensioni aggiuntive.

    Suggerimento

    Per manipolare dalla riga di comando documenti PostScript sono
    utili psmerge(1) e altri comandi nel pacchetto psutils. Anche 
    pdftk(1), nel pacchetto pdftk, è utile per manipolare documenti
    PDF.

%

11.4.3. Utilità per dati stampabili

    Quello che segue è un elenco di pacchetti con utilità per dati
    stampabili che hanno attirato la mia attenzione.

    Tabella 11.15. Elenco di utilità per dati stampabili

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|parola chiave |  descrizione   |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |utilità PDF:    |
    |             |      |          |              |pdftops,        |
    |poppler-utils|V:241,|689       |pdf→ps,testo,…|pdfinfo,        |
    |             |I:434 |          |              |pdfimages,      |
    |             |      |          |              |pdftotext,      |
    |             |      |          |              |pdffonts        |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |strumenti di    |
    |psutils      |V:6,  |219       |ps→ps         |conversione di  |
    |             |I:105 |          |              |documenti       |
    |             |      |          |              |PostScript      |
    |-------------+------+----------+--------------+----------------|
    |             |V:0,  |          |              |crea grandi     |
    |poster       |I:5   |58        |ps→ps         |poster da pagine|
    |             |      |          |              |PostScript      |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |converte testo  |
    |             |V:1,  |          |testo→ps,     |ASCII in        |
    |enscript     |I:20  |2132      |html, rtf     |PostScript,     |
    |             |      |          |              |HTML, RTF o     |
    |             |      |          |              |Pretty-Print    |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |convertitore e  |
    |             |V:1,  |          |              |creatore di     |
    |a2ps         |I:15  |3651      |testo→ps      |belle stampe "Da|
    |             |      |          |              |tutto a         |
    |             |      |          |              |PostScript"     |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |strumento di    |
    |pdftk        |I:51  |28        |pdf→pdf       |conversione di  |
    |             |      |          |              |documenti PDF:  |
    |             |      |          |              |pdftk           |
    |-------------+------+----------+--------------+----------------|
    |html2ps      |V:0,  |249       |html→ps       |converte da HTML|
    |             |I:3   |          |              |aPostScript     |
    |-------------+------+----------+--------------+----------------|
    |gnuhtml2latex|V:0,  |27        |html→latex    |convertitore da |
    |             |I:1   |          |              |HTML a latex    |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |converte        |
    |             |V:0,  |          |              |documenti da    |
    |latex2rtf    |I:6   |480       |latex→rtf     |LaTeX a RTF     |
    |             |      |          |              |leggibili da MS |
    |             |      |          |              |Word            |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |converte da     |
    |ps2eps       |V:3,  |98        |ps→eps        |PostScript a EPS|
    |             |I:68  |          |              |(Encapsulated   |
    |             |      |          |              |PostScript)     |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |convertitore da |
    |             |      |          |              |testo a         |
    |e2ps         |V:0,  |109       |testo→ps      |PostScript con  |
    |             |I:0   |          |              |supporto per la |
    |             |      |          |              |codifica        |
    |             |      |          |              |giapponese      |
    |-------------+------+----------+--------------+----------------|
    |impose+      |V:0,  |119       |ps→ps         |Utilità         |
    |             |I:0   |          |              |PostScript      |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |belle stampe di |
    |             |      |          |              |molti tipi di   |
    |             |      |          |              |codice sorgente |
    |             |V:0,  |          |              |(C, C++, Java,  |
    |trueprint    |I:0   |146       |testo→ps      |Pascal, Perl,   |
    |             |      |          |              |Pike, Sh e      |
    |             |      |          |              |Verilog) in     |
    |             |      |          |              |PostScript.     |
    |             |      |          |              |(linguaggio C)  |
    |-------------+------+----------+--------------+----------------|
    |             |      |          |              |convertitore da |
    |pdf2svg      |V:0,  |30        |ps→svg        |PDF al formato  |
    |             |I:4   |          |              |SVG (Scalable   |
    |             |      |          |              |Vector Graphics)|
    |-------------+------+----------+--------------+----------------|
    |             |V:0,  |          |              |convertitore da |
    |pdftoipe     |I:0   |71        |ps→ipe        |PDF al formato  |
    |             |      |          |              |XML di IPE      |
    +---------------------------------------------------------------+


%

11.4.4. Stampare con CUPS

    Entrambi i comandi lp(1) e lpr(1) forniti da CUPS (Common Unix
    Printing System) forniscono opzioni per stampe personalizzate dei
    dati stampabili.

    Si possono stampare 3 copie fascicolate di un file usando uno dei
    comandi seguenti.

    $ lp -n 3 -o Collate=True nomefile

    $ lpr -#3 -o Collate=True nomefile

    Si può personalizzare ulteriormente l'operazione di stampa usando
    opzioni come "-o number-up=2", "-o page-set=even", "-o page-set=
    odd", "-o scaling=200", "-o natural-scaling=200", ecc.,
    documentate in Stampa dalla riga di comando ed opzioni relative.

%

11.5. Conversione dei dati di posta

    Quelli che seguono sono pacchetti per la conversione dei dati di
    posta che hanno attirato la mia attenzione.

    Tabella 11.16. Elenco di pacchetto che aiutano a convertire dati
    di posta

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|parola |        descrizione        |
    |         |      |          |chiave |                           |
    |---------+------+----------+-------+---------------------------|
    |sharutils|V:4,  |1421      |posta  |shar(1), unshar(1),        |
    |         |I:55  |          |       |uuencode(1), uudecode(1)   |
    |---------+------+----------+-------+---------------------------|
    |         |V:1,  |          |       |codifica e decodifica di   |
    |mpack    |I:18  |106       |MIME   |messaggiMIME: mpack(1) e   |
    |         |      |          |       |munpack(1)                 |
    |---------+------+----------+-------+---------------------------|
    |         |      |          |       |spacchettamento di allegati|
    |tnef     |V:1,  |110       |ms-tnef|MIME di tipo "application/ |
    |         |I:10  |          |       |ms-tnef" che è un formato  |
    |         |      |          |       |esclusivo di Microsoft     |
    |---------+------+----------+-------+---------------------------|
    |         |      |          |       |codificatore e             |
    |         |V:0,  |          |       |decodificatore per i       |
    |uudeview |I:5   |109       |posta  |seguenti formati: uuencode,|
    |         |      |          |       |xxencode, BASE64, quoted   |
    |         |      |          |       |printable e BinHex         |
    +---------------------------------------------------------------+


    Suggerimento

    Se il software del programma di posta può essere configurato per
    usarlo, anche il server IMAP4 (Internet Message Access Protocol,
    versione 4) (vedere Sezione 6.7, «Server POP3/IMAP4») può essere
    usato per spostare la posta da sistemi proprietari.

%

11.5.1. Nozioni di base sui dati di posta

    I dati di posta (SMTP) dovrebbero essere limitati a serie di 7
    bit di dati. Perciò dati binari e testi a 8 bit sono codificati
    in un formato a 7 bit con MIME (Multipurpose Internet Mail
    Extensions) e la selezione del set di caratteri (vedere
    Sezione 8.4.1, «Nozioni base sulla codifica»).

    Il formato standard per l'archiviazione della posta è mbox
    strutturato seguendo la RFC2822 (che aggiorna RFC822). Vedere 
    mbox(5) (fornito dal pacchetto mutt).

    Per le lingue europee, per la posta viene di solito usato
    "Content-Transfer-Encoding: quoted-printable" con il set di
    caratteri ISO-8859-1 dato che non ci sono molti caratteri a 8
    bit. Se il testo europeo è codificato in UTF-8, è probabile venga
    usato "Content-Transfer-Encoding: quoted-printable" dato che sono
    per la maggior parte dati a 7 bit.

    Per il giapponese, per la posta viene tradizionalmente usato
    "Content-Type: text/plain; charset=ISO-2022-JP" per mantenere il
    testo a 7 bit. Ma sistemi Microsoft più vecchi possono inviare
    dati di posta in Shift-JIS senza una dichiarazione appropriata.
    Se il testo giapponese è codificato in UTF-8, è probabile venga
    usato Base64 dato che contiene molti dati a 8 bit. La situazione
    delle altre lingue asiatiche è simile.

    Nota

    Se i dati di posta non-Unix sono accessibili da un software di
    posta non-Debian che può comunicare con il server IMAP4, potrebbe
    essere possibile spostarli eseguendo un proprio server IMAP4
    (vedere Sezione 6.7, «Server POP3/IMAP4»).

    Nota

    Se si usano altri formati di archiviazione, spostarli nel formato
    mbox è un buon primo passo. Un versatile programma client come 
    mutt(1) può essere di aiuto in questo caso.

    Si può suddividere il contenuto di una casella di posta nei
    singoli messaggi usando procmail(1) e formail(1).

    Ciascun messaggio di posta può essere spachettato usando munpack
    (1), dal pacchetto mpack, (o con altri strumenti specializzati)
    per ottenere i contenuti codificati MIME.

%

11.6. Strumenti per dati grafici

    Quelli che seguono sono pacchetti per la conversione, la modifica
    e l'organizzazione di dati grafici che hanno attirato la mia
    attenzione.

    Tabella 11.17. Elenco di strumenti per dati grafici

    +---------------------------------------------------------------------------------+
    |       pacchetto        |popcon|dimensione|   parola chiave    |   descrizione   |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |GNU Image        |
    |                        |      |          |                    |Manipulation     |
    |gimp                    |V:68, |22313     |immagine(bitmap)    |Program,         |
    |                        |I:341 |          |                    |programma GNU di |
    |                        |      |          |                    |manipolazione di |
    |                        |      |          |                    |immagini         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |programmi di     |
    |imagemagick             |I:400 |218       |immagine(bitmap)    |manipolazione    |
    |                        |      |          |                    |immagini         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |programmi di     |
    |graphicsmagick          |V:3,  |5224      |immagine(bitmap)    |manipolazione di |
    |                        |I:17  |          |                    |immagini (fork di|
    |                        |      |          |                    |imagemagick)     |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |frontend X11     |
    |xsane                   |V:17, |2346      |immagine(bitmap)    |basato su GTK+   |
    |                        |I:173 |          |                    |per SANE (Scanner|
    |                        |      |          |                    |Access Now Easy) |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:32, |          |                    |strumenti di     |
    |netpbm                  |I:409 |4302      |immagine(bitmap)    |conversione di   |
    |                        |      |          |                    |dati grafici     |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |converte icone e |
    |                        |V:21, |          |                    |puntatori MS     |
    |icoutils                |I:127 |221       |png↔ico(bitmap)     |Windows da e     |
    |                        |      |          |                    |verso il formato |
    |                        |      |          |                    |PNG (favicon.ico)|
    |------------------------+------+----------+--------------------+-----------------|
    |scribus                 |V:2,  |30375     |ps/pdf/SVG/…        |editor DTP       |
    |                        |I:23  |          |                    |Scribus          |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:177,|          |                    |suite per ufficio|
    |libreoffice-draw        |I:434 |14600     |immagine(vettoriale)|LibreOffice -    |
    |                        |      |          |                    |disegno          |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:55, |          |                    |editor SVG       |
    |inkscape                |I:209 |84823     |immagine(vettoriale)|(Scalable Vector |
    |                        |      |          |                    |Graphics)        |
    |------------------------+------+----------+--------------------+-----------------|
    |dia                     |V:5,  |3727      |immagine(vettoriale)|editor di        |
    |                        |I:31  |          |                    |diagrammi (Gtk)  |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |strumento per la |
    |xfig                    |V:2,  |1793      |immagine(vettoriale)|generazione      |
    |                        |I:15  |          |                    |interattiva di   |
    |                        |      |          |                    |figure in X11    |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |convertitore di  |
    |                        |      |          |                    |file PostScript e|
    |pstoedit                |V:4,  |988       |ps/pdf→immagine     |PDF in grafica   |
    |                        |I:98  |          |(vettoriale)        |vettoriale       |
    |                        |      |          |                    |modificabile     |
    |                        |      |          |                    |(SVG)            |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |strumenti di     |
    |                        |V:10, |          |Windows/immagine    |conversione di   |
    |libwmf-bin              |I:211 |113       |(vettoriale)        |metafile windows |
    |                        |      |          |                    |(dati di grafica |
    |                        |      |          |                    |vettoriale)      |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |converte file    |
    |fig2sxd                 |V:0,  |149       |fig→sxd(vettoriale) |XFig nel formato |
    |                        |I:0   |          |                    |di Draw di       |
    |                        |      |          |                    |OpenOffice.org   |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |strumento di     |
    |                        |V:2,  |          |                    |post-elaborazione|
    |unpaper                 |I:19  |460       |immagine→immagine   |per pagine       |
    |                        |      |          |                    |scansionate per  |
    |                        |      |          |                    |OCR              |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |software OCR     |
    |tesseract-ocr           |V:8,  |1500      |immagine→testo      |libero basato sul|
    |                        |I:37  |          |                    |motore OCR       |
    |                        |      |          |                    |commerciale di HP|
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |dati per motore  |
    |                        |V:7,  |          |                    |OCR: file di     |
    |tesseract-ocr-eng       |I:37  |4032      |immagine→testo      |lingua           |
    |                        |      |          |                    |tesseract-ocr per|
    |                        |      |          |                    |testi in inglese |
    |------------------------+------+----------+--------------------+-----------------|
    |gocr                    |V:1,  |531       |immagine→testo      |software OCR     |
    |                        |I:13  |          |                    |libero           |
    |------------------------+------+----------+--------------------+-----------------|
    |ocrad                   |V:0,  |303       |immagine→testo      |software OCR     |
    |                        |I:5   |          |                    |libero           |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:71, |          |                    |visualizzatore di|
    |eog                     |I:264 |10189     |immagine(Exif)      |immagini grafiche|
    |                        |      |          |                    |Eye of GNOME     |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:5,  |          |                    |navigatore e     |
    |gthumb                  |I:22  |5475      |immagine(Exif)      |visualizzatore di|
    |                        |      |          |                    |immagini (GNOME) |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:6,  |          |                    |visualizzatore   |
    |geeqie                  |I:21  |14643     |immagine(Exif)      |d'immagini che   |
    |                        |      |          |                    |usa GTK+         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:19, |          |                    |organizzatore di |
    |shotwell                |I:223 |6451      |immagine(Exif)      |foto digitali    |
    |                        |      |          |                    |(GNOME)          |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |applicazione per |
    |                        |V:0,  |          |                    |recuperare dati  |
    |gtkam                   |I:6   |1154      |immagine(Exif)      |multimediali da  |
    |                        |      |          |                    |fotocamere       |
    |                        |      |          |                    |digitali (GTK+)  |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |client gphoto2 a |
    |gphoto2                 |V:1,  |955       |immagine(Exif)      |riga di comando  |
    |                        |I:12  |          |                    |per le fotocamere|
    |                        |      |          |                    |digitali         |
    |------------------------+------+----------+--------------------+-----------------|
    |gwenview                |V:28, |10570     |immagine(Exif)      |visualizzatore di|
    |                        |I:97  |          |                    |immagini (KDE)   |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |supporto per     |
    |kamera                  |I:97  |798       |immagine(Exif)      |fotocamere       |
    |                        |      |          |                    |digitali in      |
    |                        |      |          |                    |applicazioni KDE |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |applicazione per |
    |digikam                 |V:2,  |2646      |immagine(Exif)      |la gestione delle|
    |                        |I:13  |          |                    |foto digitali per|
    |                        |      |          |                    |KDE              |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |strumento di     |
    |exiv2                   |V:3,  |321       |immagine(Exif)      |manipolazione di |
    |                        |I:44  |          |                    |metadati EXIF/   |
    |                        |      |          |                    |IPTC             |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |trasforma        |
    |exiftran                |V:1,  |70        |immagine(Exif)      |immagini JPEG di |
    |                        |I:21  |          |                    |fotocamere       |
    |                        |      |          |                    |digitali         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |manipola la parte|
    |                        |      |          |                    |non-immagine di  |
    |                        |V:1,  |          |                    |file JPEG        |
    |jhead                   |I:11  |109       |immagine(Exif)      |(fotografie      |
    |                        |      |          |                    |digitali)        |
    |                        |      |          |                    |aderenti conformi|
    |                        |      |          |                    |ad Exif          |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |utilità a riga di|
    |                        |V:1,  |          |                    |comando per      |
    |exif                    |I:12  |339       |immagine(Exif)      |mostrare         |
    |                        |      |          |                    |informazioni EXIF|
    |                        |      |          |                    |in file JPEG     |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |utilità per      |
    |                        |      |          |                    |leggere i tag    |
    |exiftags                |V:0,  |292       |immagine(Exif)      |EXIF da un file  |
    |                        |I:5   |          |                    |JPEG di una      |
    |                        |      |          |                    |fotocamera       |
    |                        |      |          |                    |digitale         |
    |------------------------+------+----------+--------------------+-----------------|
    |exifprobe               |V:0,  |499       |immagine(Exif)      |legge metadati da|
    |                        |I:4   |          |                    |immagini digitali|
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |decodifica       |
    |dcraw                   |V:2,  |535       |immagine(Raw)→ppm   |immagini raw di  |
    |                        |I:19  |          |                    |fotocamere       |
    |                        |      |          |                    |digitali         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |trova immagini   |
    |findimagedupes          |V:0,  |79        |immagine→fingerprint|simili           |
    |                        |I:1   |          |                    |visivamente o    |
    |                        |      |          |                    |duplicati        |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |fonde immagini   |
    |ale                     |V:0,  |839       |immagine→immagine   |per migliorarne  |
    |                        |I:0   |          |                    |la fedeltà o     |
    |                        |      |          |                    |creare mosaici   |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:0,  |          |                    |genera gallerie  |
    |imageindex              |I:2   |145       |immagine(Exif)→html |HTML statiche da |
    |                        |      |          |                    |immagini         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:0,  |          |                    |strumento        |
    |outguess                |I:2   |261       |jpeg,png            |steganografico   |
    |                        |      |          |                    |universale       |
    |------------------------+------+----------+--------------------+-----------------|
    |librecad                |V:4,  |8205      |DXF                 |editor di dati   |
    |                        |I:18  |          |                    |CAD (KDE)        |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:4,  |          |                    |editor di        |
    |blender                 |I:38  |79166     |blend, TIFF, VRML, …|contenuti 3D per |
    |                        |      |          |                    |animazioni, ecc. |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |V:0,  |          |                    |editor di modelli|
    |mm3d                    |I:0   |3778      |ms3d, obj, dxf, …   |3D basato su     |
    |                        |      |          |                    |OpenGL           |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |metapacchetto per|
    |open-font-design-toolkit|I:0   |10        |ttf, ps, …          |creazione di tipi|
    |                        |      |          |                    |di caratteri open|
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |editor di tipi di|
    |                        |V:0,  |          |                    |carattere per    |
    |fontforge               |I:8   |4191      |ttf, ps, …          |caratteri PS,    |
    |                        |      |          |                    |TrueType e       |
    |                        |      |          |                    |OpenType         |
    |------------------------+------+----------+--------------------+-----------------|
    |                        |      |          |                    |programma per    |
    |                        |V:0,  |          |                    |gridfitting e    |
    |xgridfit                |I:0   |806       |ttf                 |hinting di tipi  |
    |                        |      |          |                    |di carattere     |
    |                        |      |          |                    |TrueType         |
    +---------------------------------------------------------------------------------+


    Suggerimento

    Cercare ulteriori strumenti per le immagini usando l'espressione
    regolare "~Gworks-with::image" in aptitude(8) (vedere
    Sezione 2.2.6, «Opzioni per i metodi di ricerca in aptitude»).

    Sebbene programmi con interfaccia utente grafica come gimp(1)
    siano molto potenti, strumenti a riga di comando come imagemagick
    (1) sono piuttosto utili per manipolare in modo automatico
    immagini usando script.

    Il formato standard di fatto per i file immagini delle fotocamere
    digitali è EXIF (Exchangeable Image File Format) che è il formato
    per file immagine JPEG con tag aggiuntivi con metadati. Può
    contenere informazioni come la data, l'orario e le impostazioni
    della fotocamera.

    I diritti sulla compressione senza perdita di dati
    Lempel-Ziv-Welch (LZW) sono scaduti. Le utilità GIF (Graphics
    Interchange Format) che usano il metodo di compressione LZW sono
    ora disponibili liberamente sul sistema Debian.

    Suggerimento

    Qualsiasi fotocamera digitale o scanner con un supporto di
    archiviazione removibile funziona in Linux attraverso i lettori
    di archiviazione USB dato che segue le regole progettuali per i
    file system delle fotocamere e usa il file system FAT. Vedere
    Sezione 10.1.7, «Supporti di archiviazione removibili».

%

11.7. Conversioni di dati vari

    Ci sono molti altri programmi per convertire dati. I pacchetti
    seguenti, trovati usando l'espressione regolare
    "~Guse::converting" in aptitude(8) (vedere Sezione 2.2.6,
    «Opzioni per i metodi di ricerca in aptitude»), hanno catturato
    la mia attenzione.

    Tabella 11.18. Elenco di strumenti di conversione di dati vari

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|  parola  |      descrizione       |
    |         |      |          |  chiave  |                        |
    |---------+------+----------+----------+------------------------|
    |         |V:2,  |          |rpm/      |convertitore di         |
    |alien    |I:34  |161       |tgz→deb   |pacchetti estranei in   |
    |         |      |          |          |pacchetti Debian        |
    |---------+------+----------+----------+------------------------|
    |         |      |          |          |convertitore da         |
    |         |      |          |          |"Electric Book"         |
    |         |V:0,  |          |          |(popolare in Giappone)  |
    |freepwing|I:0   |421       |EB→EPWING |in un singolo formato   |
    |         |      |          |          |JIS X 4081 (un          |
    |         |      |          |          |sottoinsieme di EPWING  |
    |         |      |          |          |V1)                     |
    |---------+------+----------+----------+------------------------|
    |         |V:9,  |          |          |convertitore e gestione |
    |calibre  |I:36  |54876     |tutto→EPUB|di una biblioteca per   |
    |         |      |          |          |libri elettronici       |
    +---------------------------------------------------------------+


    Si possono estrarre i dati dal formato RPM anche nel modo
    seguente.

    $ rpm2cpio file.src.rpm | cpio --extract

Capitolo 12. Programmazione

    Vengono forniti in questo capitolo alcune informazioni base da
    cui partire per imparare a programmare su un sistema Debian
    abbastanza da seguire il codice sorgente impacchettato. Quello
    che segue è un elenco dei pacchetti importanti per la
    programmazione e dei corrispettivi pacchetti di documentazione.

    Tabella 12.1. Elenco di pacchetti di aiuto per la programmazione

    +---------------------------------------------------------------+
    |   pacchetto   |popcon|dimensione|       documentazione        |
    |---------------+------+----------+-----------------------------|
    |autoconf       |V:41, |1846      |"info autoconf" fornito da   |
    |               |I:282 |          |autoconf-doc                 |
    |---------------+------+----------+-----------------------------|
    |automake       |V:42, |1830      |"info automake" fornito da   |
    |               |I:279 |          |automake1.10-doc             |
    |---------------+------+----------+-----------------------------|
    |bash           |V:791,|6469      |"info bash" fornito da       |
    |               |I:999 |          |bash-doc                     |
    |---------------+------+----------+-----------------------------|
    |bison          |V:9,  |2815      |"info bison" fornito da      |
    |               |I:103 |          |bison-doc                    |
    |---------------+------+----------+-----------------------------|
    |cpp            |V:319,|42        |"info cpp" fornito da cpp-doc|
    |               |I:770 |          |                             |
    |---------------+------+----------+-----------------------------|
    |ddd            |V:0,  |4184      |"info ddd" fornito da ddd-doc|
    |               |I:10  |          |                             |
    |---------------+------+----------+-----------------------------|
    |exuberant-ctags|V:5,  |341       |exuberant-ctags(1)           |
    |               |I:37  |          |                             |
    |---------------+------+----------+-----------------------------|
    |flex           |V:9,  |1279      |"info flex" fornito da       |
    |               |I:93  |          |flex-doc                     |
    |---------------+------+----------+-----------------------------|
    |gawk           |V:368,|2558      |"info gawk" fornito da       |
    |               |I:454 |          |gawk-doc                     |
    |---------------+------+----------+-----------------------------|
    |gcc            |V:165,|45        |"info gcc" fornito da gcc-doc|
    |               |I:604 |          |                             |
    |---------------+------+----------+-----------------------------|
    |gdb            |V:13, |9789      |"info gdb" fornito da gdb-doc|
    |               |I:114 |          |                             |
    |---------------+------+----------+-----------------------------|
    |gettext        |V:48, |5843      |"info gettext" fornito da    |
    |               |I:312 |          |gettext-doc                  |
    |---------------+------+----------+-----------------------------|
    |gfortran       |V:11, |16        |"info gfortran" fornito da   |
    |               |I:98  |          |gfortran-doc (Fortran 95)    |
    |---------------+------+----------+-----------------------------|
    |fpc            |I:3   |121       |fpc(1) e html forniti da     |
    |               |      |          |fp-docs (Pascal)             |
    |---------------+------+----------+-----------------------------|
    |glade          |V:0,  |1730      |aiuto fornito attraverso menu|
    |               |I:8   |          |(compilatore UI)             |
    |---------------+------+----------+-----------------------------|
    |               |V:935,|          |"info libc" fornito da       |
    |libc6          |I:999 |12771     |glibc-doc e                  |
    |               |      |          |glibc-doc-reference          |
    |---------------+------+----------+-----------------------------|
    |make           |V:157,|1592      |"info make" fornito da       |
    |               |I:609 |          |make-doc                     |
    |---------------+------+----------+-----------------------------|
    |xutils-dev     |V:1,  |1466      |imake(1), xmkmf(1), ecc.     |
    |               |I:12  |          |                             |
    |---------------+------+----------+-----------------------------|
    |mawk           |V:372,|242       |mawk(1)                      |
    |               |I:997 |          |                             |
    |---------------+------+----------+-----------------------------|
    |perl           |V:610,|705       |perl(1) e pagine html forniti|
    |               |I:992 |          |da perl-doc e perl-doc-html  |
    |---------------+------+----------+-----------------------------|
    |python         |V:293,|68        |python(1) e pagine html      |
    |               |I:923 |          |forniti da python-doc        |
    |---------------+------+----------+-----------------------------|
    |               |V:31, |          |tcl(3) e pagine dettagliate  |
    |tcl            |I:414 |22        |del manuale forniti da       |
    |               |      |          |tcl-doc                      |
    |---------------+------+----------+-----------------------------|
    |tk             |V:30, |22        |tk(3) e pagine dettagliate di|
    |               |I:406 |          |manuale forniti da tk-doc    |
    |---------------+------+----------+-----------------------------|
    |ruby           |V:137,|35        |ruby(1) e guida interattiva  |
    |               |I:318 |          |di riferimento forniti da ri |
    |---------------+------+----------+-----------------------------|
    |vim            |V:106,|3231      |menu di aiuto(F1) fornito da |
    |               |I:398 |          |vim-doc                      |
    |---------------+------+----------+-----------------------------|
    |               |      |          |scarica le specifiche "The   |
    |susv2          |I:0   |16        |Single UNIX Specifications   |
    |               |      |          |v2"                          |
    |---------------+------+----------+-----------------------------|
    |               |      |          |scarica le specifiche "The   |
    |susv3          |I:0   |16        |Single UNIX Specifications   |
    |               |      |          |v3"                          |
    +---------------------------------------------------------------+


    Guide di riferimento in linea sono disponibili digitando "man
    nome" dopo aver installato i pacchetti manpages e manpages-dev.
    Le guide di riferimento in linea per gli strumenti GNU sono
    disponibili digitando "info nome_programma", dopo aver installato
    i pertinenti pacchetti di documentazione. Può essere necessario
    includere gli archivi "contrib e non-free, oltre all'archivio
    main, dato che alcune documentazioni GFDL non sono considerate
    conformi alle DFSG.

    Avvertimento
   
    Non usare "test" come nome di un file di prova eseguibile. "test"
    è un comando interno della shell.

    Attenzione

    I programmi software compilati direttamente dai sorgenti
    andrebbero installati in "/usr/local" o "/opt" per evitare
    conflitti.

    Suggerimento

    Esempi di codice per creare la "Canzone 99 bottiglie di birra"
    dovrebbe dare buone idee per praticamente tutti i linguaggi di
    programmazione.

%

12.1. Script shell

    Uno script di shell è un file di testo con il bit di esecuzione
    impostato e contiene i comandi nel formato seguente.

    #!/bin/sh
     ... righe di comando

    La prima riga specifica l'interprete di shell che legge ed esegue
    il contenuto di questo file.

    Leggere script di shell è il modo migliore per capire come
    funzioni un sistema *nix. In questa sezione vengono forniti
    alcune nozioni di riferimento e promemoria per la programmazione
    di shell. Vedere "Errori in shell" (http://www.greenend.org.uk/
    rjk/2001/04/shell.html) per imparare dagli errori.

    A differenza della modalità interattiva della shell (vedere
    Sezione 1.5, «Il semplice comando di shell» e Sezione 1.6,
    «Elaborazione di testo stile Unix»), gli script di shell usano
    spesso parametri, costrutti condizionali e cicli.

%

12.1.1. Compatibilità con la shell POSIX

    Molti script di sistema possono essere interpretati da una
    qualsiasi delle shell POSIX (vedere Tabella 1.13, «Elenco di
    programmi shell»). La shell predefinita per il sistema è "/bin/
    sh" che è un collegamento simbolico che punta al programma reale.

      * bash(1) per lenny o precedenti
   
      * dash(1) per squeeze o successivi

    Evitare di scrivere uno script di shell con bashismi o zshismi
    per renderlo portabile tra tutte le shell POSIX. Si può
    controllare uno script con checkbashisms(1).

    Tabella 12.2. Elenco di bashismi tipici

    +---------------------------------------------------------------+
    |         Buono: POSIX          |     Da evitare: bashismo      |
    |-------------------------------+-------------------------------|
    |if [ "$pippo" = "$pluto" ] ;   |if [ "$pippo" == "$pluto" ] ;  |
    |then …                         |then …                         |
    |-------------------------------+-------------------------------|
    |diff -u file.c.orig file.c     |diff -u file.c{.orig,}         |
    |-------------------------------+-------------------------------|
    |mkdir /pippopluto /            |mkdir /pippo{pluto,paperino}   |
    |pippopaperino                  |                               |
    |-------------------------------+-------------------------------|
    |nomefunzione() { … }           |function nomefunzione() { … }  |
    |-------------------------------+-------------------------------|
    |formato ottale: "\377"         |formato esadecimale: "\xff"    |
    +---------------------------------------------------------------+


    Il comando "echo" deve essere usato con le precauzioni seguenti
    dato che la sua implementazione è diversa negli svariati comandi
    interni della shell ed esterni.

      * Evitare l'uso di qualsiasi opzione di comando tranne "-n".
   
      * Evitare l'uso di sequenze di escape nelle stringhe dato che
        la loro gestione è variabile.

    Nota
   
    Sebbene l'opzione "-n" non faccia veramente parte della sintassi
    POSIX, è generalmente accettata.

    Suggerimento
   
    Se è necessario inserire sequenze di escape nella stringa in
    output, usare il comando "printf" al posto del comando "echo".

%

12.1.2. Parametri di shell

    Negli script di shell vengono spesso usati parametri speciali.

    Tabella 12.3. Elenco di parametri di shell

    +---------------------------------------------------------------+
    |  parametro di  |                    valore                    |
    |     shell      |                                              |
    |----------------+----------------------------------------------|
    |$0              |nome della shell o dello script di shell      |
    |----------------+----------------------------------------------|
    |$1              |primo (1°) argomento di shell                 |
    |----------------+----------------------------------------------|
    |$9              |nono (9°) argomento di shell                  |
    |----------------+----------------------------------------------|
    |$#              |numero di parametri posizionali               |
    |----------------+----------------------------------------------|
    |"$*"            |"$1 $2 $3 $4 … "                              |
    |----------------+----------------------------------------------|
    |"$@"            |"$1" "$2" "$3" "$4" …                         |
    |----------------+----------------------------------------------|
    |$?              |stato d'uscita del comando più recente        |
    |----------------+----------------------------------------------|
    |$$              |PID dello script di shell                     |
    |----------------+----------------------------------------------|
    |$!              |PID del compito sullo sfondo avviato più      |
    |                |recentemente                                  |
    +---------------------------------------------------------------+


    Le nozioni base da ricordare riguardanti la espansione dei
    parametri sono le seguenti.

    Tabella 12.4. Elenco di espansioni di parametri di shell

    +---------------------------------------------------------------+
    |   forma della    | valore se  |                               |
    | espressione con  |   var è    | valore se var non è impostata |
    |    parametri     | impostata  |                               |
    |------------------+------------+-------------------------------|
    |${var:-stringa}   |"$var"      |"stringa"                      |
    |------------------+------------+-------------------------------|
    |${var:+stringa}   |"stringa"   |"null"                         |
    |------------------+------------+-------------------------------|
    |${var:=stringa}   |"$var"      |"stringa" (ed esegue "var=     |
    |                  |            |stringa")                      |
    |------------------+------------+-------------------------------|
    |                  |            |invia con echo "stringa" allo  |
    |${var:?string}    |"$var"      |stderr (ed esce con stato di   |
    |                  |            |errore)                        |
    +---------------------------------------------------------------+


    I due punti ":" in tutti gli operatori nell'elenco precedente
    sono di fatto opzionali.

      * con ":" l'operatore = controlla che il suo operando esista e
        sia non nullo
   
      * senza ":" l'operatore = controlla solo che il suo operando 
        esista

    Tabella 12.5. Elenco di sostituzioni chiave di parametri di shell

    +---------------------------------------------------------------+
    | forma della sostituzione di |            risultato            |
    |          parametri          |                                 |
    |-----------------------------+---------------------------------|
    |${var%suffisso}              |rimuove il più piccolo modello di|
    |                             |suffisso                         |
    |-----------------------------+---------------------------------|
    |${var%%suffisso}             |rimuove il più grande modello di |
    |                             |suffisso                         |
    |-----------------------------+---------------------------------|
    |${var#prefisso}              |rimuove il più piccolo modello di|
    |                             |prefisso                         |
    |-----------------------------+---------------------------------|
    |${var##prefisso}             |rimuove il più grande modello di |
    |                             |prefisso                         |
    +---------------------------------------------------------------+


%

12.1.3. Costrutti condizionali della shell

    Ogni comando restituisce uno stato di uscita che può essere usato
    in costrutti condizionali.

      * Successo: 0 ("Vero")
   
      * Errore: non 0 ("Falso")

    Nota
   
    "0" nel contesto condizionale della shell significa "Vero",
    mentre "0" nel contesto condizionale in C significa "Falso".

    Nota
   
    "[" è l'equivalente del comando "test che valuta i propri
    argomenti sino a "]" come un'espressione condizionale.

    Le espressioni condizionali di base che è bene ricordare sono le
    seguenti.

      * "<comando> && <se_successo_esegue_anche_questo_comando> ||
        true"

      * "<comando> || <se_non_successo_esegue_anche_questo_comando> |
        | true"

      * Una porzione su più righe di script come la seguente

    if [ <espressione_condizionale> ]; then
     <se_successo_esegue_questo_comando>
    else
     <se_non_successo_esegue_questo_comando>
    fi

    In questo caso il "|| true" finale era necessario per assicurare
    che lo script non termini accidentalmente a tale riga quando la
    shell è invocata con l'opzione "-e".

    Tabella 12.6. Elenco di operatori per paragonare file in
    espressioni condizionali

    +---------------------------------------------------------------+
    |  equazione   |  condizione perché venga restituito il valore  |
    |              |                 logico "vero"                  |
    |--------------+------------------------------------------------|
    |-e <file>     |<file> esiste                                   |
    |--------------+------------------------------------------------|
    |-d <file>     |<file> esiste ed è una directory                |
    |--------------+------------------------------------------------|
    |-f <file>     |<file> esiste ed è un file regolare             |
    |--------------+------------------------------------------------|
    |-w <file>     |<file> esiste ed è scrivibile                   |
    |--------------+------------------------------------------------|
    |-x <file>     |<file> esiste ed è eseguibile                   |
    |--------------+------------------------------------------------|
    |<file1> -nt   |<file1> è più recente di <file2> (data di       |
    |<file2>       |modifica)                                       |
    |--------------+------------------------------------------------|
    |<file1> -ot   |<file1> è più vecchio di <file2> (data di       |
    |<file2>       |modifica)                                       |
    |--------------+------------------------------------------------|
    |<file1> -ef   |<file1> e <file2> sono sullo stesso device e    |
    |<file2>       |stesso numero inode                             |
    +---------------------------------------------------------------+


    Tabella 12.7. Elenco di operatori per paragonare stringhe in
    espressioni condizionali

    +---------------------------------------------------------------+
    | equazione |condizione perché venga restituito il valore logico|
    |           |                      "vero"                       |
    |-----------+---------------------------------------------------|
    |-z <str>   |la lunghezza di <str> è zero                       |
    |-----------+---------------------------------------------------|
    |-n <str>   |la lunghezza di <str> è diversa da zero            |
    |-----------+---------------------------------------------------|
    |<str1> =   |<str1> e <str2> sono uguali                        |
    |<str2>     |                                                   |
    |-----------+---------------------------------------------------|
    |<str1> !=  |<str1> e <str2> non sono uguali                    |
    |<str2>     |                                                   |
    |-----------+---------------------------------------------------|
    |<str1> <   |se ordinate, <str1> viene prima di <str2>          |
    |<str2>     |(dipendente dalla localizzazione)                  |
    |-----------+---------------------------------------------------|
    |<str1> >   |se ordinate, <str1> viene dopo di <str2>           |
    |<str2>     |(dipendente dalla localizzazione)                  |
    +---------------------------------------------------------------+


    Gli operatori aritmetici di comparazione di interi nelle
    espressioni condizionali sono "-eq", "-ne", "-lt", "-le", "-gt" e
    "-ge".

%

12.1.4. Cicli di shell

    Ci sono diverse espressioni per cicli usabili nella shell POSIX.

      * "for x in pippo1 pippo2 … ; do comando ; done" ripete il
        ciclo assegnando gli elementi nell'elenco "pippo1 pippo2 …"
        alla variabile "x" ed eseguendo "comando".

      * "while condizione ; do comando ; done" ripete "comando"
        fintanto che "condizione" è vera.
   
      * "until condizione ; do comando ; done" ripete "comando"
        fintanto che "condition" è non vera.

      * "break" permette di uscire dal ciclo.

      * "continue" permette di riprendere dalla successiva iterazione
        del ciclo.

    Suggerimento
   
    L'iterazione numerica in stile linguaggio C può essere realizzata
    usando seq(1) come "pippo1 pippo2 …"

    Suggerimento
   
    Vedere Sezione 9.3.9, «Ripetere un comando su diversi file».

%

12.1.5. La sequenza di elaborazione della riga di comando di shell

    A grandi linee la shell elabora uno script nel modo seguente.

      * La shell legge una riga.

      * La shell raggruppa parte della riga come un unico elemento se
        è racchiusa in "…" o '…'.

      * La shell spezza le altre parti della riga in elementi in base
        ai caratteri seguenti.

          + Spazi bianchi: <spazio> <tabulazione> <a capo>

          + Metacaratteri: < > | ; & ( )

      * La shell controlla, per ciascun elemento non racchiuso tra
        "…" o '…', la presenza di parole riservate per regolare il
        proprio comportamento.

          + Parole riservate: if then elif else fi for in while
            unless do done case esac

      * La shell espande gli alias se non sono racchiusi in "…" o
        '…'.

      * La shell espande il carattere tilde se non è racchiuso in "…"
        o '…'.

          + "~" → directory home dell'utente attuale

          + "~<utente>" → directory home di <utente>

      * La shell espande parametri nei loro valori, se non sono
        racchiusi in '…'.

          + Parametro: "$PARAMETRO" o "${PARAMETRO}"

      * La shell espande sostituzioni di comandi, se non sono
        racchiuse in '…'.

          + "$( comando )" → output di "comando"

          + "` command `" → output di "comando"

      * La shell espande glob di nomi percorso nei nomi di file
        corrispondenti, se non sono racchiusi in "…" o '…'.

          + * → qualsiasi carattere

          + ? → un carattere

          + […] → uno qualunque dei caratteri in "…"

      * La shell cerca comando tra le cose seguenti e lo esegue.

          + Definizione di funzione

          + comando interno

          + file eseguibile in "$PATH"

      * La shell si sposta alla riga seguente e ripete nuovamente
        questo processo dall'inizio di questa sequenza.

    Virgolette singole all'interno di virgolette doppie non hanno
    alcun effetto.

    L'esecuzione di "set -x" nella shell o l'invocazione della shell
    con l'opzione "-x" fanno sì che la shell stampi tutti i comandi
    eseguiti. Ciò è piuttosto utile per il debug.

%

12.1.6. Programmi di utilità per script di shell

    Per far sì che il proprio programma di shell sia il più portabile
    possibile tra i sistemi Debian, è una buona idea limitare i
    programmi di utilità a quelli forniti dai pacchetti essenziali.

      * "aptitude search ~E" elenca i pacchetti essenziali.

      * "dpkg -L <nome_pacchetto> |grep '/man/man.*/'" elenca le
        pagine man per i comandi forniti dal pacchetto
        <nome_pacchetto>.

    Tabella 12.8. Elenco di pacchetti contenenti piccoli programmi di
    utilità per script di shell

    +---------------------------------------------------------------+
    | pacchetto  | popcon  |dimensione|         descrizione         |
    |------------+---------+----------+-----------------------------|
    |coreutils   |V:891,   |17478     |Utilità GNU di base          |
    |            |I:999    |          |                             |
    |------------+---------+----------+-----------------------------|
    |debianutils |V:925,   |230       |utilità varie specifiche di  |
    |            |I:999    |          |Debian                       |
    |------------+---------+----------+-----------------------------|
    |bsdmainutils|V:60,    |26        |raccolte di ulteriori utilità|
    |            |I:996    |          |da FreeBSD                   |
    |------------+---------+----------+-----------------------------|
    |bsdutils    |V:673,   |393       |utilità di base per          |
    |            |I:999    |          |4.4BSD-Lite                  |
    |------------+---------+----------+-----------------------------|
    |moreutils   |V:11,    |237       |utilità Unix aggiuntive      |
    |            |I:35     |          |                             |
    +---------------------------------------------------------------+


    Suggerimento

    Sebbene moreutils possa non esistere al di fuori di Debian, offre
    piccoli programmi interessanti. Quello più degno di nota è sponge
    (8) che piuttosto utile quando si desidera sovrascrivere il file
    originale.

%

12.1.7. Dialogo di script di shell

    L'interfaccia utente di un semplice programma shell può essere
    migliorata dalla banale interazione con i comandi echo e read ad
    una più interattiva con l'uso dei cosiddetti programmi di dialogo
    ecc.

    Tabella 12.9. Elenco di programmi per interfaccia utente

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione|            descrizione            |
    |---------+------+----------+-----------------------------------|
    |x11-utils|V:180,|712       |xmessage(1): mostra un messaggio o |
    |         |I:599 |          |richiesta in una finestra (X)      |
    |---------+------+----------+-----------------------------------|
    |         |V:87, |          |mostra riquadri di dialogo         |
    |whiptail |I:995 |71        |amichevoli da script di shell      |
    |         |      |          |(newt)                             |
    |---------+------+----------+-----------------------------------|
    |         |V:15, |          |mostra riquadri di dialogo         |
    |dialog   |I:123 |1222      |amichevoli da script di shell      |
    |         |      |          |(ncurses)                          |
    |---------+------+----------+-----------------------------------|
    |zenity   |V:87, |384       |mostra riquadri di dialogo grafici |
    |         |I:409 |          |da script di shell (gtk2.0)        |
    |---------+------+----------+-----------------------------------|
    |         |      |          |Shell Scripts Frontend Tool,       |
    |ssft     |V:0,  |75        |strumento per frontend per script  |
    |         |I:0   |          |di shell (contenitore per zenity,  |
    |         |      |          |kdialog, e dialog con gettext)     |
    |---------+------+----------+-----------------------------------|
    |gettext  |V:48, |5843      |"/usr/bin/gettext.sh": traduce     |
    |         |I:312 |          |messaggi                           |
    +---------------------------------------------------------------+


%

12.1.8. Esempio di script di shell con zenity

    Questo è un semplice script che crea un'immagine ISO con dati
    RS02 forniti da dvdisaster(1).

    #!/bin/sh -e
    # gmkrs02 : Copyright (C) 2007 Osamu Aoki <osamu@debian.org>, Public Domain
    #set -x
    error_exit()
    {
      echo "$1" >&2
      exit 1
    }
    # Inizializza le variabili
    DATA_ISO="$HOME/Desktop/iso-$$.img"
    LABEL=$(date +%Y%m%d-%H%M%S-%Z)
    if [ $# != 0 ] && [ -d "$1" ]; then
      DATA_SRC="$1"
    else
      # Seleziona la directory per creare l'immagine ISO dalla cartella sul desktop
      DATA_SRC=$(zenity --file-selection --directory  \
        --title="Seleziona la radice dell'albero di directory per creare l'immagine ISO") \
        || error_exit "Uscita durante la selezione della directory"
    fi
    # Controlla la dimensione dell'archivio
    xterm -T "Controllo dimensione $DATA_SRC" -e du -s $DATA_SRC/*
    SIZE=$(($(du -s $DATA_SRC | awk '{print $1}')/1024))
    if [ $SIZE -le 520 ] ; then
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="La dimensione dei dati va bene per un CD di backup:\\n $SIZE MB"
    elif [ $SIZE -le 3500 ]; then
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="La dimensione dei dati va bene per un DVD di backup:\\n $SIZE MB"
    else
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="Dimensione dei dati troppo grande per farne il backup: $SIZE MB"
      error_exit "Dimensione dei dati troppo grande per farne il backup :\\n $SIZE MB"
    fi
    # solo xterm sicuramente ha un'opzione -e funzionante
    # Crea immagine raw ISO
    rm -f "$DATA_ISO" || true
    xterm -T "genisoimage $DATA_ISO" \
      -e genisoimage -r -J -V "$LABEL" -o "$DATA_ISO" "$DATA_SRC"
    # Crea dati ridondanti RS02 supplementari
    xterm -T "dvdisaster $DATA_ISO" -e  dvdisaster -i "$DATA_ISO" -mRS02 -c
    zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
      --text="dati ISO/RS02 ($SIZE MB) \\n creati per: $DATA_ISO"
    # EOF

    Si potrebbe voler creare un lanciatore sul desktop con un comando
    definito in modo simile a "/usr/local/bin/gmkrs02 %d".

%

12.2. Make

    Make è un'utilità per mantenere gruppi di programmi. Quando make
    (1) viene eseguito legge il file di regole, "Makefile" e aggiorna
    il file target se dipende da file prerequisiti che sono stati
    modificati dall'ultima volta che esso stesso è stato modificato
    oppure se il file target non esiste. L'esecuzione di questi
    aggiornamenti può avvenire in modo concorrente.

    La sintassi del file di regole è la seguente.

    target: [ prerequisiti ... ]
     [TAB]  comaando1
     [TAB]  -comando2 # ignora errori
     [TAB]  @comando3 # sopprime echo

    Qui "[TAB] è il codice di TAB. Ciascuna riga è interpretata dalla
    shell dopo la sostituzione delle variabili di make. Usare "\"
    alla fine di una riga per continuare lo script. Usare "$$" per
    inserire "$" per valori di ambiente per uno script di shell.

    Regole implicite per il target ed i prerequisiti possono essere
    scritte, per esempio, nel modo seguente.

    %.o: %.c header.h

    In questo caso il target contiene il carattere "%" (esattamente
    un carattere). Il "%" fa corrispondenza con qualsiasi
    sottostringa non vuota nei nomi di file dei target effettivi.
    Similmente i prerequisiti usano "%" per mostrare come i loro nomi
    trovino corrispondenza nei nomi dei target effettivi.

    Tabella 12.10. Elenco di variabili automatiche di make

    +---------------------------------------------------------------+
    |    variabile    |                   valore                    |
    |   automatica    |                                             |
    |-----------------+---------------------------------------------|
    |$@               |target                                       |
    |-----------------+---------------------------------------------|
    |$<               |primo prerequisito                           |
    |-----------------+---------------------------------------------|
    |$?               |tutti i prerequisiti più recenti             |
    |-----------------+---------------------------------------------|
    |$^               |tutti i prerequisiti                         |
    |-----------------+---------------------------------------------|
    |$*               |"%" nome base con corrispondenza con il      |
    |                 |modello target                               |
    +---------------------------------------------------------------+


    Tabella 12.11. Elenco di espansioni delle variabili di make

    +--------------------------------------------------------+
    |espansione di variabile|          descrizione           |
    |-----------------------+--------------------------------|
    |pippo1 := pluto        |espansione valida una volta sola|
    |-----------------------+--------------------------------|
    |pippo2 = pluto         |espansione ricorsiva            |
    |-----------------------+--------------------------------|
    |pippo3 += pluto        |accoda                          |
    +--------------------------------------------------------+


    Eseguire "make -p -f/dev/null" per vedere le regole interne
    automatiche.

%

12.3. C

    Si può impostare l'ambiente appropriato per compilare programmi
    scritti nel linguaggio di programmazione C nel modo seguente.

    # apt-get install glibc-doc manpages-dev libc6-dev gcc build-essential

    Il pacchetto libc6-dev, cioè la libreria GNU C, fornisce la
    libreria standard C che è una raccolta di file header e routine
    di libreria usati dal linguaggio di programmazione C.

    Vedere come documenti di riferimento per C i seguenti.

      * "info libc" (documento di riferimento per le funzioni della
        libreria C)

      * gcc(1) e "info gcc"
   
      * ogni_nome_di_funzione_della_libreria_C(3)

      * Kernighan & Ritchie, "The C Programming Language", 2nd
        edition (Prentice Hall)

%

12.3.1. Semplice programma in C (gcc)

    Un semplice esempio "esempio.c" può essere compilato con una
    libreria "libm" in un eseguibile "eseg_esempio" nel modo
    seguente.

    $ cat > esempio.c << EOF
    #include <stdio.h>
    #include <math.h>
    #include <string.h>

    int main(int argc, char **argv, char **envp){
            double x;
            char y[11];
            x=sqrt(argc+7.5);
            strncpy(y, argv[0], 10); /* previeni buffer overflow */
            y[10] = '\0'; /* riempi per assicurare che la stringa finisca con '\0' */
            printf("%5i, %5.3f, %10s, %10s\n", argc, x, y, argv[1]);
            return 0;
    }
    EOF
    $ gcc -Wall -g -o eseg_esempio esempio.c -lm
    $ ./eseg_esempio
            1, 2.915, ./run_exam,     (null)
    $ ./eseg_esempio 1234567890qwerty
            2, 3.082, ./run_exam, 1234567890qwerty

    In questo esempio, l'uso di "-lm" è necessario per fare il link
    alla libreria "/usr/lib/libm.so" nel pacchetto libc6 per sqrt(3).
    La libreria reale è in "/lib/" con nome file "libm.so.6", che è
    un collegamento simbolico a "libm-2.7.so".

    Si guardi l'ultimo elemento nel testo di output: ci sono più di
    10 caratteri anche se è stato specificato "%10s".

    L'uso di funzioni che operano su puntatori di memoria senza
    controlli sui limiti, come sprintf(3) e strcpy(3) è deprecato per
    prevenire exploit di tipo buffer overflow che sfruttano gli
    effetti di superamento dei limiti di grandezza dei dati.

%

12.4. Debug

    Il debug è un'importante fase del processo di programmazione.
    Sapere come fare il debug dei programmi rende buoni utenti Debian
    in grado di creare segnalazioni di bug significative.

%

12.4.1. Esecuzione base di gdb

    Lo strumento di debug principale in Debian è gdb(1) che permette
    di ispezionare un programma mentre viene eseguito.

    Installare gdb e i programmi correlati nel modo seguente.

    # apt-get install gdb gdb-doc build-essential devscripts

    Un buon tutorial su gdb viene fornito da "info gdb" o lo si può
    trovare altrove in rete. Quello che segue è un piccolo esempio
    d'uso di gdb(1) su di un "programma" compilato con l'opzione "-g"
    per produrre informazioni di debug.

    $ gdb program
    (gdb) b 1                # imposta un punto di interruzione alla riga 1
    (gdb) run argomenti      # esegue programma con argomenti
    (gdb) next               # riga successiva
    ...
    (gdb) step               # passo successivo
    ...
    (gdb) p param             # stampa parametro
    ...
    (gdb) p param=12          # imposta il valore a 12
    ...
    (gdb) quit

    Suggerimento
   
    Molti comandi gdb(1) possono essere abbreviati. L'espansione del
    tasto di tabulazione funziona come nella shell.

%

12.4.2. Fare il debug di pacchetti Debian

    Dato che tutti i binari installati in un sistema Debian
    dovrebbero essere, in modo predefinito, snelliti con strip, la
    maggior parte dei simboli di debug non è presente nei normali
    pacchetti. Per poter fare il debug di pacchetti Debian con gdb(1)
    devono essere installati i corrispondenti pacchetti *-dbg o
    *-dbgsym (ad esempio libc6-dbg per libc6, coreutils-dbgsym per
    coreutils).

    I pacchetti nello stile vecchio forniscono il proprio pacchetto
    *-dbg corrispettivo. È messo direttamente nell'archivio
    principale Debian insieme al pacchetto originale stesso. I
    pacchetti più recenti possono generare automaticamente pacchetti
    *-dbgsym quando compilati e tali pacchetti di debug sono messi
    separatamente nell'archivio debian-debug. Per maggiori
    informazioni fare riferimento agliarticoli sul Wiki Debian.

    Se un pacchetto di cui si deve fare il debug non fornisce il
    proprio pacchetto *-dbg o *-dbgsym, è necessario installarlo dopo
    averlo ricompilato nel modo seguente.

    $ mkdir /percorso/nuovo ; cd /percorso/nuovo
    $ sudo apt-get update
    $ sudo apt-get dist-upgrade
    $ sudo apt-get install fakeroot devscripts build-essential
    $ apt-get source nome_pacchetto
    $ cd nome_pacchetto*
    $ sudo apt-get build-dep ./

    Correggere i bug se necessario.

    Spostare la versione del pacchetto ad una che non crei conflitti
    con le versioni ufficiali di Debian, ad esempio una che termini
    con "+debug1" quando si ricompilano versioni di cui esiste un
    pacchetto, o una che termini con "~pre1" quando si ricompilano
    versioni non ancora rilasciate in pacchetti nel modo seguente.

    $ dch -i

    Compilare ed installare i pacchetti con i simboli di debug nel
    modo seguente.

    $ export DEB_BUILD_OPTIONS=nostrip noopt
    $ debuild
    $ cd ..
    $ sudo debi nome_pacchetto*.changes

    È necessario controllare gli script di compilazione del pacchetto
    ed assicurarsi di usare "CFLAGS=-g -Wall" per la compilazione di
    binari.

%

12.4.3. Ottenere un backtrace

    Quando un programma va in crash, è una buona idea inviare un
    segnalazione di bug riportando le informazioni di backtrace.

    Il backtrace può essere ottenuto eseguendo le azioni seguenti.

      * Eseguire il programma in gdb(1).

      * Riprodurre il crash.
   
          + Ciò causa il ritorno al prompt di gdb.

      * Digitare "bt" al prompt di gdb.

    Nel caso in cui in programma si blocca, si può farlo andare in
    crash premendo Ctrl-C nel terminale in cui è in esecuzione gdb,
    ottenendo così il prompt di gdb.

    Suggerimento

    Spesso si vede un backtrace in cui una o più delle prime righe
    sono in "malloc()" o "g_malloc()". Quando ciò accade è probabile
    che il backtrace non sia molto utile. Il metodo più semplice per
    trovare informazioni utili è di impostare la variabile d'ambiente
    "$MALLOC_CHECK_" al valore 2 (malloc(3)). Lo si può fare mentre
    si esegue gdb nel modo seguente.

     $ MALLOC_CHECK_=2 gdb hello

%

12.4.4. Comandi gdb avanzati

    Tabella 12.12. Elenco di comandi gdb avanzati

    +---------------------------------------------------------------+
    |    comando    |      descrizione degli scopi del comando      |
    |---------------+-----------------------------------------------|
    |(gdb) thread   |ottenere un backtrace per tutti i thread di un |
    |apply all bt   |programma multi-thread                         |
    |---------------+-----------------------------------------------|
    |(gdb) bt full  |ottenere i parametri nello stack delle chiamate|
    |               |di funzione                                    |
    |---------------+-----------------------------------------------|
    |(gdb) thread   |ottenere un backtrace e parametri: combinazione|
    |apply all bt   |delle due opzioni precedenti                   |
    |full           |                                               |
    |---------------+-----------------------------------------------|
    |(gdb) thread   |ottenere un backtrace e i parametri per le     |
    |apply all bt   |prime dieci chiamate nello stack per eliminare |
    |full 10        |l'output irrilevante                           |
    |---------------+-----------------------------------------------|
    |(gdb) set      |scrivere un registro dell'output di gdb in un  |
    |logging on     |file (il file predefinito è "gdb.txt")         |
    +---------------------------------------------------------------+


%

12.4.5. Fare il debug di errori X

    Se un programma gnome preview1 ha ricevuto un errore X, si
    dovrebbe leggere un messaggio del tipo seguente.

    The program 'preview1' received an X Window System error.

    Se ciò avviene, si può provare ad eseguire il programma con
    "--sync" ed interrompere alla funzione "gdk_x_error" per ottenere
    un backtrace.

%

12.4.6. Controllare le dipendenze dalle librerie

    Per scoprire le dipendenze di un programma da librerie, usare ldd
    (1) nel modo seguente.

    $ ldd /bin/ls
            librt.so.1 => /lib/librt.so.1 (0x4001e000)
            libc.so.6 => /lib/libc.so.6 (0x40030000)
            libpthread.so.0 => /lib/libpthread.so.0 (0x40153000)
            /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)

    Affinché ls(1) funzioni in un ambiente "chroot", le librerie in
    questione devono essere disponibili nell'ambiente "chroot".

    Vedere Sezione 9.3.6, «Tenere traccia delle attività di un
    programma».

%

12.4.7. Strumenti per rilevazione di memory leak

    In Debian sono disponibili svariati strumenti di rilevazione di
    memory leak.

    Tabella 12.13. Elenco di strumenti per rilevazione di memory leak

    +---------------------------------------------------------------+
    |  pacchetto   |popcon |dimensione|         descrizione         |
    |--------------+-------+----------+-----------------------------|
    |libc6-dev     |V:249, |14357     |mtrace(1): funzionalità di   |
    |              |I:620  |          |debug malloc in glibc        |
    |--------------+-------+----------+-----------------------------|
    |valgrind      |V:6,   |80378     |strumento di debug e         |
    |              |I:46   |          |profilazione per la memoria  |
    |--------------+-------+----------+-----------------------------|
    |electric-fence|V:0,   |70        |strumento di debug malloc(3) |
    |              |I:5    |          |                             |
    |--------------+-------+----------+-----------------------------|
    |leaktracer    |V:0,   |57        |tracciatore di memory leak   |
    |              |I:3    |          |per programmi C++            |
    |--------------+-------+----------+-----------------------------|
    |libdmalloc5   |V:0,   |393       |libreria per il debug        |
    |              |I:3    |          |dell'allocazione di memoria  |
    +---------------------------------------------------------------+


%

12.4.8. Strumenti di analisi statica del codice

    Esistono strumenti simili a lint per l'analisi statica del
    codice.

    Tabella 12.14. Elenco di strumenti per l'analisi statica del
    codice

    +---------------------------------------------------------------+
    |  pacchetto  |popcon|dimensione|          descrizione          |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |strumento per controllare      |
    |splint       |I:4   |2315      |staticamente la presenza di bug|
    |             |      |          |in programmi C                 |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |strumento per esaminare codice |
    |flawfinder   |I:0   |181       |sorgente C/C++ e per cercare   |
    |             |      |          |punti deboli per la sicurezza  |
    |-------------+------+----------+-------------------------------|
    |             |V:610,|          |interprete con controllore     |
    |perl         |I:992 |705       |interno statico del codice:    |
    |             |      |          |B::Lint(3perl)                 |
    |-------------+------+----------+-------------------------------|
    |pylint       |V:2,  |1371      |strumento di controllo statico |
    |             |I:13  |          |del codice Python              |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |strumento di controllo della   |
    |weblint-perl |I:1   |32        |sintassi e dello stile di base |
    |             |      |          |per HTML                       |
    |-------------+------+----------+-------------------------------|
    |             |V:0,  |          |controllore veloce di          |
    |linklint     |I:0   |344       |collegamenti e strumento per   |
    |             |      |          |manutenzione di siti web       |
    |-------------+------+----------+-------------------------------|
    |libxml2-utils|V:22, |182       |utilità con xmllint(1) per     |
    |             |I:246 |          |convalidare file XML           |
    +---------------------------------------------------------------+


%

12.4.9. Disassemblatore di binari

    Si può disassemblare codice binario con objdump(1) nel modo
    seguente.

    $  objdump -m i386 -b binary -D /usr/lib/grub/x86_64-pc/stage1

    Nota
   
    Per disassemblare codice in modo interattivo si può usare gdb(1).

%

12.5. Flex - un Lex migliorato

    Flex è un veloce generatore di analizzatori lessicali compatibile
    con Lex.

    Un tutorial per flex(1) viene fornito da "info flex".

    È necessario fornire i propri "main()" e "yywrap()". Altrimenti
    il proprio programma flex dovrebbe apparire così per compilare
    senza una libreria. Questo è dovuto al fatto che "yywrap" è una
    macro e "%option main" abilita implicitamente "%option noyywrap".

    %option main
    %%
    .|\n    ECHO ;
    %%

    In alternativa si può compilare con l'opzione per linker " -lfl"
    alla fine della propria riga di comando cc(1) (come "-ll" per AT&
    T-Lex). In questo caso non è necessario usare "%option".

%

12.6. Bison - Yacc migliorato

    Svariati pacchetti Debian forniscono un generatore di parser LR
    lookahead o parser LALR combatibile con Yacc.

    Tabella 12.15. Elenco di generatori di parser LALR compatibili
    con Yacc

    +---------------------------------------------------------------+
    |pacchetto|popcon |dimensione|           descrizione            |
    |---------+-------+----------+----------------------------------|
    |bison    |V:9,   |2815      |generatore GNU di parser LALR     |
    |         |I:103  |          |                                  |
    |---------+-------+----------+----------------------------------|
    |byacc    |V:0,   |160       |generatore Berkeley di parser LALR|
    |         |I:6    |          |                                  |
    |---------+-------+----------+----------------------------------|
    |btyacc   |V:0,   |243       |generatore di parser backtracking |
    |         |I:0    |          |basato su byacc                   |
    +---------------------------------------------------------------+


    Un tutorial per bison(1) viene fornito da "info bison".

    È necessario fornire i propri "main()" e "yyerror()". "main()"
    chiama "yyparse()" che a sua volta chiama "yylex()", solitamente
    creato con Flex.

     %%
   
     %%

%

12.7. Autoconf

    Autoconf è uno strumento per produrre script shell che
    configurano automaticamente pacchetti software di codice
    sorgente, in modo da adattarsi a molti tipi di sistemi *nix
    usando l'intero sistema di compilazione GNU.

    autoconf(1) produce lo script di configurazione "configure".
    "configure" crea automaticamente un "Makefile" personalizzato
    usando il modello "Makefile.in".

%

12.7.1. Compilare ed installare un programma

    Avvertimento
   
    Non sovrascrivere mai file di sistema quando si installano
    programmi compilati in proprio.

    Debian non tocca i file in "/usr/local/" o "/opt". Perciò se si
    compila un programma dai sorgenti, installarlo in "/usr/local/"
    in modo che non interferisca con Debian.

    $ cd src
    $ ./configure --prefix=/usr/local
    $ make
    $ make install # questo mette i file nel sistema

%

12.7.2. Disinstallare un programma

    Se si hanno i sorgenti originali e questi usano autoconf(1)/
    automake(1), e se ci si ricorda la configurazione usata, eseguire
    quanto segue per disinstallare un programma.

    $ ./configure "tutte-le-opzioni-che-erano-state-usate"
    # make uninstall

    In alternativa, se si è assolutamente certi che il processo di
    installazione mette i file solo in "/usr/local/" e lì non c'è
    nulla di importante, si può cancellare tutto ciò che contiene con
    la riga di comando seguente.

    # find /usr/local -type f -print0 | xargs -0 rm -f

    Se non si è sicuri di dove siano installati i file, si dovrebbe
    prendere in considerazione l'uso di checkinstall(8) dal pacchetto
    checkinstall, che fornisce un percorso di disinstallazione
    pulita. Ora permette di creare un pacchetto Debian con l'opzione
    "-D".

%

12.8. Pazzie con corti script Perl

    Benché qualsiasi script AWK possa essere riscritto
    automaticamente in Perl usando a2p(1), gli script AWK di una sola
    riga si convertono meglio manualmente in script Perl di una riga.

    Si consideri il seguente pezzetto di script AWK.

    awk '($2=="1957") { print $3 }' |

    Ciò equivale ad una qualsiasi delle righe seguenti.

    perl -ne '@f=split; if ($f[1] eq "1957") { print "$f[2]\n"}' |

    perl -ne 'if ((@f=split)[1] eq "1957") { print "$f[2]\n"}' |

    perl -ne '@f=split; print $f[2] if ( $f[1]==1957 )' |

    perl -lane 'print $F[2] if $F[1] eq "1957"' |

    perl -lane 'print$F[2]if$F[1]eq+1957' |

    L'ultima è una sorta di indovinello; sfrutta le seguenti
    caratteristiche di Perl.

      * Gli spazi bianchi sono opzionali.
   
      * Esiste una conversione automatica da numero a stringa.

    Per le opzioni per la riga di comando vedere perlrun(1). Per
    altri script Perl pazzi può essere interessante guardare Perl
    Golf.

%

12.9. Web

    Pagine web dinamiche interattive di base possono essere create
    nel modo seguente.

      * Le interrogazioni vengono presentate all'utente del browser
        usando moduli HTML.

      * La compilazione e il cliccare sulle voci nel modulo invia una
        delle stringhe URL seguenti con i parametri codificati dal
        browser al web server.

          + "http://www.foo.dom/cgi-bin/program.pl?VAR1=VAL1&VAR2=
            VAL2&VAR3=VAL3"

          + "http://www.foo.dom/cgi-bin/program.py?VAR1=VAL1&VAR2=
            VAL2&VAR3=VAL3"

          + "http://www.foo.dom/program.php?VAR1=VAL1&VAR2=VAL2&VAR3=
            VAL3"

      * "%nn" nell'URL viene sostituito dal carattere con valore
        esadecimale nn.

      * Viene impostata la variabile d'ambiente: "QUERY_STRING="VAR1=
        VAL1 VAR2=VAL2 VAR3=VAL3"".

      * Il programma CGI (uno qualsiasi dei "program.*") sul server
        web è eseguito con la variabile d'ambiente "$QUERY_STRING".

      * Lo stdout del programma CGI viene inviato al browser web ed è
        presentato come pagina web dinamica interattiva.

    Per ragioni di sicurezza è bene non creare a mano nuovi metodi
    per analizzare i parametri CGI. Per loro esistono moduli Perl e
    Python comprovati. PHP è fornito con queste funzionalità. Quando
    è necessaria l'archiviazione dei dati client vengono usati i
    cookie HTTP. Quando è necessaria l'elaborazione dei dati lato
    client, viene spesso usato Javascript.

    Per maggiori informazioni vedere CGI (Common Gateway Interface),
    Apache Software Foundation e JavaScript.

    Cercare "CGI tutorial" su Google digitando l'URL codificato http:
    //www.google.com/search?hl=en&ie=UTF-8&q=CGI+tutorial
    direttamente nell'indirizzo del browser è un buon modo per vedere
    lo script CGI in azione sul server di Google.

%

12.10. Traduzione di codice sorgente

    Esistono programmi per convertire codice sorgente.

    Tabella 12.16. Elenco di strumenti per la traduzione di codice
    sorgente

    +---------------------------------------------------------------+
    |pacchetto|popcon|dimensione| parola  |       descrizione       |
    |         |      |          | chiave  |                         |
    |---------+------+----------+---------+-------------------------|
    |perl     |V:610,|705       |AWK→PERL |converte codice sorgente |
    |         |I:992 |          |         |da AWK a PERL:a2p(1)     |
    |---------+------+----------+---------+-------------------------|
    |         |V:0,  |          |         |converte codice sorgente |
    |f2c      |I:6   |442       |FORTRAN→C|da FORTRAN 77 a C/C++:   |
    |         |      |          |         |f2c(1)                   |
    |---------+------+----------+---------+-------------------------|
    |         |V:0,  |          |         |convertitore da NASM     |
    |intel2gas|I:0   |178       |intel→gas|(formato Intel) a GAS    |
    |         |      |          |         |(GNU Assembler)          |
    +---------------------------------------------------------------+


%

12.11. Creare pacchetti Debian

    Se si desidera creare un pacchetto Debian, leggere i documenti
    seguenti.

      * Capitolo 2, Gestione dei pacchetti in Debian per capire le
        basi del sistema dei pacchetti

      * Sezione 2.7.13, «Fare il port di un pacchetto nel sistema
        stabile» per capire le basi del processo di port

      * Sezione 9.10.4, «Sistema chroot» per capire le basi delle
        tecniche chroot

      * debuild(1), pbuilder(1) e pdebuild(1)
   
      * Sezione 12.4.2, «Fare il debug di pacchetti Debian» per la
        ricompilazione per il debug

      * Guida Debian per il nuovo manutentore come tutorial
        (pacchetto maint-guide)

      * Debian Developer's Reference (pacchetto developers-reference)

      * Manuale Debian Policyl (pacchetto debian-policy)

      * Guide for Debian Maintainers (il pacchetto debmake-doc)

    Ci sono pacchetti come debmake, dh-make, dh-make-perl, ecc., che
    aiutano nella creazione dei pacchetti.

Appendice A. Appendice

    Ecco il dietro le quinte di questo documento.

A.1. Il labirinto Debian

    Il sistema Linux è una piattaforma informatica molto potente per
    un computer in rete. Tuttavia imparare come usare tutte le sue
    funzionalità non è semplice. Impostare la coda di stampa LPR con
    una stampante non PostScript è stato un buon esempio di problema
    su cui si può inciampare. (Ora non ci sono più problemi dato che
    le installazioni più recenti usano il nuovo sistema CUPS.)

    Esiste una mappa dettagliata completa chiamata "CODICE SORGENTE".
    È molto accurata, ma estremamente difficile da capire. Esistono
    anche documenti di consultazione chiamati HOWTO e mini-HOWTO;
    sono più facili da comprendere ma tendono a dare troppi dettagli
    e a perdere di vista il quadro generale. Io ho a volte dei
    problemi a trovare la giusta sezione in un lungo HOWTO quando ho
    bisogno di trovare un paio di comandi da eseguire.

    Spero che questa "Debian Reference (versione 2.77)" (2021-01-10
    06:32:51 UTC) possa fornire un buon punto di partenza per le
    persone nel labirinto Debian.

A.2. Storia del copyright

    La Debian Reference è stata iniziata da Osamu Aoki <osamu at
    debian dot org> come promemoria personale per l'amministrazione
    di sistema. Molti dei contenuti derivano dalle conoscenze
    ottenute dalla mailing-list debian-user e da altre risorse
    Debian.

    Seguendo un suggerimento di Josip Rodin, che è stato molto attivo
    nel DDP (Debian Documentation Project), è stata creata la "Debian
    Reference (versione 1, 2001-2007) come parte della documentazione
    del DDP.

    Dopo 6 anni, Osamu ha realizzato che la "Debian Reference
    (versione 1)" era sorpassata ed ha iniziato a riscrivere molti
    dei suoi contenuti. La nuova "Debian Reference (versione 2)" è
    stata rilasciata nel 2008.

    Si può rintracciare l'origine e l'ispirazione del tutorial nelle
    fonti seguenti.

      * "Linux User's Guide" di Larry Greenfield (dicembre 1996)

          + reso obsoleto dal "Debian Tutorial"

      * "Debian Tutorial" di Havoc Pennington. (11 dicembre, 1998)

          + scritto in parte da Oliver Elphick, Ole Tetlie, James
            Treacy, Craig Sawyer e Ivan E. Moore II

          + reso obsoleto da "Debian GNU/Linux: Guide to Installation
            and Usage"

      * "Debian GNU/Linux: Guide to Installation and Usage" di John
        Goerzen ed Ossama Othman (1999)

          + reso obsoleto dalla "Debian Reference (versione 1)"

    Si può rintracciare parte dell'origine e dell'ispirazione per la
    descrizione dei pacchetti e degli archivi nei documenti seguenti.

      * "Debian FAQ" (versione marzo 2002, quando era mantenuta da
        Josip Rodin)

    Si può rintracciare parte dell'origine e dell'ispirazione per gli
    altri contenuti nei documenti seguenti.

      * "Debian Reference (versione 1)" di Osamu Aoki (2001–2007)
   
          + resa obsoleta da questa nuova "Debian Reference (versione
            2)" nel 2008.

    La precedente "Debian Reference (versione 1)" è stata creata con
    il contributo di molti.

      * l'enorme contributo di Thomas Hood sugli argomenti di
        configurazione della rete

      * il significativo contributo di Brian Nelson sugli argomenti
        relativi ad X ed a VCS

      * l'aiuto sugli script build e molte correzioni nei contenuti
        da parte di Jens Seidel

      * l'accurata revisione di David Sewell

      * molti aiuti da parte di chi ha tradotto, contribuito e
        segnalato bug

    Molte pagine di manuale e info del sistema Debian sono state
    usate come riferimento principale per la stesura di questo
    documento. Tanto che Osamu Aoki ha ritenuto nei limiti del fair
    use molte parti de esse, specialmente le definizioni dei comandi,
    che sono state riprese letteralmente dopo attenti sforzi
    editoriali per inserirle nello stile e nello scopo di questo
    documento.

    La descrizione dello strumento di debug gdb è stata estesa usando
    i contenuti del Debian wiki sul backtrace con il consenso di Ari
    Pollak, Loïc Minier e Dafydd Harries.

    I contenuti della "Debian Reference (versione 2.77)" (2021-01-10
    06:32:51 UTC) sono per la maggior parte miei tranne per quanto
    specificato in precedenza. Anche questi sono stati aggiornati
    grazie a contributi.

    Il documento "Debian Reference (versione 1)" è stato tradotto da
    Davide Di Lazzaro (mc0315 at mclink dot it).

    Il documento "Debian Reference (versione 2)" è tradotto da
    Beatrice Torracca (beatricet at libero dot it), usando laddove il
    testo aveva subito modifiche marginali rispetto alla versione 1
    parti del lavoro di traduzione di Davide Di Lazzaro, dopo i
    necessari cambiamenti. Il documento è stato revisionato da
    Vittore Luccio (vluccio at gmail dot com).

    L'autore, Osamu Aoki, ringrazia tutti coloro che con il loro
    aiuto hanno reso questo documento possibile.

A.3. Formato del documento

    I sorgenti del documento originale in inglese sono attualmente
    scritti usando file di testo AsciiDoc; quest'ultimo è usato per
    motivi di comodità dato che richiede meno scrittura del puro XML
    e supporta le tabelle in un formato molto intuitivo. Si
    dovrebbero considerare i file XML e PO come i veri file sorgenti.
    Attraverso script di compilazione è convertito nel formato XML
    DocBook e i dati generati automaticamente sono inseriti a formare
    il sorgente XML Docbook finale. Questo sorgente finale può essere
    convertito in HTML, epub, testo semplice, PostScript e PDF.
    (Alcuni formati possono non essere distribuiti.)

