Guía de referencia de Debian

                             Osamu Aoki

Copyright © 2013-2021 Osamu Aoki

    La Guía de Referencia de Debian (version 2.77) (2021-01-10
    06:32:51 UTC) pretende aportar una visión amplia del sistema
    Debian y servir de guía al usuario después de la instalación. Se
    tratan diferentes aspectos de la administración del sistema,
    usando ejemplos en el intérprete de órdenes, para todo tipo de
    usuarios.

Resumen

Este libro es libre. Usted puede redistribuirlo y/o modificarlo
cumpliendo las condiciones de cualquier versión de la Licencia
Pública General GNU compatible con las Directrices de software libre
de Debian (DFSG).

---------------------------------------------------------------------

La Guía de referencia de Debian (version 2.77) (2021-01-10 06:32:51
UTC) pretende aportar una visión amplia del sistema Debian y servir
de guía al usuario después de la instalación.

El lector al que va dirigido esta obra es aquel que desea aprender
archivos de órdenes, pero que no esta preparado para entender el
código fuente C que le permita comprender el funcionamiento interno
de un sistema GNULinux.

Para instrucciones de instalación, consulte:

  * Guía de Instalación de Debian GNU/Linux de la versión estable,

  * Guía de Instalación de Debian GNU/Linux para la distribución «en
    pruebas» .

1. Aviso

    Esta guía se ofrece sin ninguna garantía. Todas las marcas son
    propiedad de sus respectivos dueños.

    Debian es un sistema vivo. Por ello es difícil mantener este
    documento totalmente actualizado y sin errores. Para escribir
    este documento se usa la versión «inestable» del sistema Debian.
    Cuando lo lea puede que parte de su contenido se encuentre
    desactualizado.

    Por favor, considere este documento como una fuente secundaria de
    información. No sustituye a ninguna guía acreditada. El autor y
    los colaboradores no asumen ninguna responsabilidad por las
    consecuencias de errores, omisiones o ambiguedades de este
    documento.

2. ¿Qué es Debian?

    El Proyecto Debian es una comunidad de personas cuya finalidad es
    crear un sistema operativo libre. Esta distribución se
    caracteriza por:

      * un conjunto de criterios para definir qué es software libre:
        el Contrato Social de Debian y las Directrices de Software
        Libre de Debian (DFSG);

      * el esfuerzo voluntario de personas ubicadas a lo largo de
        Internethttps://www.debian.org;

      * gran cantidad de paquetes de software de alta calidad
        compilados

      * tiene como objetivos la estabilidad y la seguridad,
        permitiendo que las actualizaciones de seguridad se realicen
        de manera sencilla

      * centrado en la actualización fluida a las versiones recientes
        de los paquetes de los archivos «inestable» y «en pruebas»

      * soporte de gran número de arquitecturas hardware.

    El Software Libre de Debian tiene su origen en GNU, Linux, BSD,
    X, ISC, Apache, Ghostscript, Sistema de Impresión Común de Unix
    (Common Unix Printing System) , Samba, GNOME, KDE, Mozilla,
    LibreOffice, Vim, TeX, LaTeX, DocBook, Perl, Python, Tcl, Java,
    Ruby, PHP, Berkeley DB, MariaDB, PostgreSQL, SQLite, Exim,
    Postfix, Mutt, FreeBSD, OpenBSD, Plan 9 y otros muchos proyectos
    libres e independientes. Debian integra la diversidad del
    software libre en un único sistema.

3. Acerca de este documento

3.1. Directrices

    El presente documento usa las siguientes directrices:

      * proporciona un visión global evitando los casos menos
        frecuentes (visión holística)

      * simplicidad y brevedad (KISS)

      * se aprovecha lo ya hecho (utiliza enlaces a fuentes ya
        existentes)

      * centrado en la consola y herramientas sin interfaz gráfico de
        usuario. ( Usaejemplos del intérprete de órdenes)

      * es objetivo (utiliza estadísticas popcon etc.).

    Sugerencia
   
    Trataré de mostrar las facetas jerárquicas y de bajo nivel del
    sistema.

%

3.2. Prerrequisitos

    Aviso

    Más allá de este documento, debe tener la capacidad de buscar por
    si mismo las respuestas. Este documento ofrece un punto de
    partida.

    Debe encontrar sus propias soluciones consultando las fuentes
    originales:

      * El manual del administrador de Debian,

      * el sitio web de Debian https://www.debian.org que contiene
        información general,

      * la documentación en el directorio «/usr/share/doc
        <nombre_del_paquete>»,

      * las páginas de manual al estilo de Unix: «dpkg -L
        <nombre_del_paquete>|grep '/man/man.*/'»,

      * las páginas de información (info page) al estilo GNU: «dpkg
        -L <nombre_de_paquete> |grep '/info/'»,
   
      * el informe de errores: https://bugs.debian.org/
        <nombre_del_paquete>,

      * la wiki de Debian https://wiki.debian.org/ para profundizar y
        aprender sobre temas concretos,

      * las guías cómo del Proyecto de Documentación de Linux (TLDP)
        en http://tldp.org,

      * la especificación de UNIX en la página web de dicho sistema
        de Open Group en http://www.unix.org/,

      * la enciclopedia libre Wikipedia en https://www.wikipedia.org
        /.

    Nota

    Para obtener documentación detallada de un paquete, necesitará
    instalar el paquete correspondiente, cuyo nombre es el nombre del
    paquete con el sufijo «-doc».

%

3.3. Convenciones

    Este documento proporciona información con un estilo de
    presentación simple con ejemplos del intérprete de órdenesbash(1)
    .

    # <orden como superusuario>
    $ <orden como usuario>

    Estos cursores del intérprete de órdenes diferencian el tipo de
    cuenta que tiene asociada un conjunto de variables de entorno
    como: «PS1='\$'» y «PS2=' '». Estos valores han sido
    seleccionados para mejorar la claridad del documento y no tienen
    por qué ajustarse a los de un sistema real en funcionamiento.

    Nota
   
    Consulte el significado de las variables de entorno «$PS1» y
    «$PS2» en bash(1).

    Cuando sea necesario ejecutar una acción determinada por parte
    del administrador del sistema se utilizará una oración
    imperativa, p. ej. «Pulse la tecla Intro después de escribir cada
    orden en el intérprete de órdenes.»

    La descripción de una columna y similares en una tabla puede
    contener un sintagma nominal siguiendo las reglas de la
    descripción corta de los paquetes que eliminan los artículos como
    «un» y «la». También pueden contener una oración en infinitivo
    como un sintagma nominal seguido de la descripción corta de la
    orden según la reglas de las páginas de manual. Esto puede
    parecer que no tiene sentido, pero son reglas elegidas para
    mantener el estilo tan simple como es posible. Los sintagmas
    nominales no se inician en mayúsculas y no finalizan con un punto
    según las reglas de descripciones cortas.

    Nota
   
    Los nombres propios, incluidas las órdenes, mantienen las
    mayúsculas y las minúsculas independientemente de su lugar.

    La cita de un fragmento de una orden en un párrafo aparecerá con
    otro tipo de letra entre comillas dobles como «aptitude
    safe-upgrade».

    El contenido de un archivo de configuración en formato texto
    citado en un párrafo aparecerá con otro tipo de letra entre
    comillas dobles, como «deb-src».

    Una orden se cita por su nombre en otro tipo de letra, seguida
    opcionalmente por el número de la sección de las páginas manual a
    la que pertenece entre paréntesis, como bash(1). Le recomiendo
    que escriba lo siguiente para obtener más información sobre dicha
    orden.

    $ man 1 bash

    Una página de manual se citada por su nombre en otro tipo de
    letra seguido del número de la sección de la página de manual a
    la que pertenece entre paréntesis, como sources.list(5). Le
    recomiendo que escriba lo siguiente para obtener más información
    sobre dicha página de manual.

    $ man 5 sources.list

    Una página de información se cita con su orden en otro tipo de
    letra entre comillas dobles como, «info make». Le recomiendo
    ejecutar lo siguiente para obtener más información sobre dicha
    página de información.

    $ info make

    El nombre de un archivo se cita con otro tipo de letra entre
    comillas dobles, como «/etc/passwd». Para ver el contenido de
    dicho archivo de configuración puede escribir lo siguiente:

    $ sensible-pager "/etc/passwd"

    El nombre de un directorio se cita en otro tipo de letra entre
    comillas, como por ejemplo «/etc/apt/». Puede descubrir su
    contenido escribiendo lo siguiente:

    $ mc "/etc/apt/"

    El nombre de un paquete se cita por su nombre con un tipo de
    letra diferente, como vim. Le animo a obtener más información
    sobre el paquete escribiendo lo siguiente.

    $ dpkg -L vim
    $ apt-cache show vim
    $ aptitude show vim

    Un documento puede indicar su ubicación con su nombre de archivo
    en otro tipo de letra entre comillas dobles, como «/usr/share/doc
    /base-passwd/users-and-groups.txt.gz» y «/usr/share/doc/
    base-passwd/users-and-groups.html» o por su URL, como https://
    www.debian.org. Le animo a leer dichos documentos escribiendo lo
    siguiente:

    $ zcat "/usr/share/doc/base-passwd/users-and-groups.txt.gz" | sensible-pager
    $ sensible-browser "/usr/share/doc/base-passwd/users-and-groups.html"
    $ sensible-browser "https://www.debian.org"

    Una variable de entorno se cita con su nombre en otro tipo de
    letra precedido de «$» y entre comillas dobles como «$TERM».
    Descubra el valor de dicha variable escribiendo lo que se
    muestra.

    $ echo "$TERM"

%

3.4. Estadísticas de uso (popcon)

    El objetivo de datos de las estadísticas de uso es determinar la
    popularidad de cada paquete. Fue creado el 2021-01-10 06:32:17
    UTC y contiene 197967 informes de uso de los 178828 paquetes
    binarios y las 26 arquitecturas.

    Nota

    Tenga en cuenta que la distribución «inestable» de amd64 contiene
    únicamente 62716 paquetes. Las estadísticas de uso incluyen
    informes de equipos instalados con otras versiones.

    En las estadisticas de uso, un número precedido de «V» es el
    número de «votos» que se calcula mediante la fórmula «1000 *
    (número de paquetes utilizados recientemente en el equipo)/(total
    de informes de uso remitidos)».

    En las estadística de uso, un número precedido de «I» se refiere
    al «número de instalaciones» calculado por «1000 * (número de
    instalaciones del paquete)/(el total de informes de uso)».

    Nota

    Las estadísticas de uso no determina la importancia de los
    paquetes. Existen muchos factores que puede afectar a las
    estadísticas. Por ejemplo, algunos sistemas que participan en
    estas, pueden tener directorios como «/bin/» con la opción
    «noatime» para mejorar el desempeño del sistema desactivando su
    sistema de «voto».

%

3.5. El tamaño del paquete

    El tamaño que tenga un paquete es una medida objetiva. Se obtiene
    del valor de «Tamaño sin comprimir:» que devuelve la orden
    apt-cache show» o «aptitude show» (en la arquitectura amd64 de la
    distribución «inestable»). La unidad es en KiB (Kibibyte =
    equivalente a 1024 bytes).

    Nota

    Un paquete con un tamaño pequeño puede indicar que en la
    distribución «inestable» es un paquete «ficticio» que instala
    otro con contenido real según sus dependencias. Un paquete
    «ficticio» permite transiciones fluidas o la división de un
    paquete en varios.

    Nota

    Cuando al tamaño del paquete le sigue «(*)» significa que no está
    disponible en la distribución «inestable» y que el valor que
    aparece es el tamaño en la distribución «experimental».

%

3.6. Cómo informar de errores en este documento

    Puede informar de un error en el paquete debian-reference
    utilizando reportbug(1). Por favor, incluya la corrección
    ejecutando «diff -u» con el texto plano o la fuente.

%

4. Consejos para usuarios noveles

    Aquí hay algunos consejos para usuarios noveles:

      * haga copias de seguridad de sus datos

      * proteja su contraseña y claves de seguridad

      * KISS ('keep it simple stupid', mantenlo simple estúpido)

          + no complique su sistema

      * lea sus archivos de registro

          + el PRIMER error es el que cuenta

      * RTFM ('read the fine manual', lea el manual)

      * busque en Internet antes de preguntar

      * no use la cuenta del superusuario cuando no es necesario

      * no modifique el sistema de gestión de paquetes

      * no escriba nada que no entienda

      * no cambie los permisos de los archivos (si no conoce su
        impacto en la seguridad)

      * no cierra su terminal de superusuario hasta que PRUEBE sus
        cambios

      * tenga a mano un medio alternativo de arranque (dispositivo de
        memoria USB, CD…)

%

5. Algunos comentarios para usuarios noveles

    Los usuarios noveles encontrarán esclarecedoras las siguientes
    citas de la lista de correo de Debian:

      * «Así es Unix. Te ofrece suficiente cuerda para que te
        ahorques tu mismo.» --- Miquel van Smoorenburg <miquels at
        cistron.nl>
   
      * «Unix ES muy amigable ... únicamente que es muy puntilloso
        eligiendo a sus amigos.» --- Tollef Fog Heen <tollef at
        add.no>

    El artículo de Wikipedia «la filosofía de Unix» contiene citas
    muy interesantes.

Capítulo 1. Tutoriales de GNU/Linux

    Aprender a usar un sistema informático es como aprender un idioma
    nuevo. Aunque los libros de ayuda y la documentación son útiles,
    uno debe practicarlo. Para ayudarle a comenzar sin tropiezos, he
    escrito algunos puntos básicos.

    La calidad del diseño de Debian GNU/Linux tiene su origen en el
    sistema operativo Unix, un sistema operativo multiusuario y
    multitarea. Debe aprender a aprovechar el poder de estas
    características y las similitudes entre Unix y GNU/Linux.

    No utilice únicamente documentos de GNU/Linux y utilice también
    documentos de Unix , ya que esto le permitirá acceder a mucha
    información útil.

    Nota

    Si tiene experiencia con las herramientas de la línea de órdenes
    de algún sistema tipo Unix probablemente ya conozca lo que se
    explica en este documento. Utilice este documento para refrescar
    sus conocimientos.

%

1.1. Introducción a la consola

1.1.1. El cursor del intérprete de órdenes

    Si no ha instalado el Sistema de Ventanas X con un gestor de
    inicio de sesión como gdm3, al iniciar el sistema se le presenta
    la pantalla de identificación en modo texto. Suponiendo que el
    nombre de su equipo sea foo, la pantalla de identificación tendrá
    el aspecto siguiente:

    foo login:

    Si ha instalado un entorno gráfico de usuario como GNOME o KDE,
    podrá acceder a una pantalla de identificación en modo texto
    pulsando Ctrl-Alt-F1 y podrá regresar al modo gráfico pulsando
    Alt-F7 (vea Sección 1.1.6, “Consolas virtuales” de lo que daremos
    detalles más adelante).

    En el diálogo de entrada escriba su nombre de usuario, p. ej.
    pingüino y pulse la tecla Intro, a continuación escriba su
    contraseña y pulse Intro otra vez.

    Nota

    De acuerdo a la tradición Unix, el nombre de usuario y la
    contraseña en un sistema Debian son sensibles a mayúsculas. El
    nombre de usuario normalmente se elige de tal modo que esté
    compuesto únicamente por minúsculas. La primera cuenta de usuario
    normalmente se crea durante la instalación. El superusuario (root
    ) puede crear cuentas de usuario adicionales con la orden adduser
    (8).

    El sistema empieza mostrando el mensaje de bienvenida almacenado
    en «/etc/motd» (Mensaje del día) y muestra un cursor para
    realizar la petición de órdenes.

    Debian GNU/Linux jessie/sid foo tty1
    foo login: penguin
    Password:
    Last login: Mon Sep 23 19:36:44 JST 2013 on tty3
    Linux snoopy 3.11-1-amd64 #1 SMP Debian 3.11.6-2 (2013-11-01) x86_64

    The programs included with the Debian GNU/Linux system are free software;
    the exact distribution terms for each program are described in the
    individual files in /usr/share/doc/*/copyright.

    Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
    permitted by applicable law.
    foo:~$

    Ahora nos encontramos en el intérprete de órdenes (shell). El
    intérprete de órdenes interpreta las órdenes del usuario.

%

1.1.2. El cursor del intérprete de órdenes en X

    Si usted instaló el Sistema de Ventanas X con un gestor de inicio
    de sesión como gdm3 de GNOME al seleccionar la tarea «Entorno de
    escritorio» durante la instalación, se le presentará la pantalla
    de inicio de sesión cuando arranque su sistema. Podrá escribir
    ahí su nombre de usuario y su contraseña para acceder a la cuenta
    de usuario sin privilegios. Puede utilizar el tabulador para
    alternar entre el nombre de usuario y la contraseña, o utilizar
    el ratón pulsando su butón principal.

    Puede obtener un cursor del intérprete de órdenes en un entorno
    de trabajo gráfico abriendo un programa x-terminal-emulator como 
    gnome-terminal(1), rxvt(1) o xterm(1). Si usa el entorno de
    escritorio Gnome para abrir un intérprete de órdenes debe hacer
    clic en «Aplicaciones« → «Accesorios« → «Terminal«.

    Usted puede ampliar la información en la sección Sección 1.1.6,
    “Consolas virtuales”.

    En algunos entornos de escritorio (como fluxbox), no existe un
    punto de acceso al menú tal cual. Si se encuentra en este caso,
    simplemente pruebe a hacer clic con el (botón derecho del ratón)
    sobre el fondo de escritorio y surgirá un menú.

%

1.1.3. La cuenta de superusuario (root)

    La cuenta de root también es conocida como superusuario o usuario
    privilegiado. Con esta cuenta podrá llevar a cabo las siguientes
    tareas administrativas:

      * leer, escribir y borrar cualquier archivo del sistema
        independientemente de los permisos de dicho archivo;

      * cambiar la propiedad y los permisos de cualquier archivo del
        sistema;
   
      * cambiar la contraseña de cualquier usuario sin privilegios
        del sistema;

      * entrar en la cuenta de cualquier usuario sin usar su
        contraseña.

    El poder ilimitado de la cuenta de superusuario necesita de un
    uso basado en la consideración y la responsabilidad.

    Aviso
   
    Nunca comparta la contraseña del superusuario con nadie.

    Nota

    Los permisos de acceso a un archivo (incluidos los dispositivos
    como un CD-ROM u otros, que son simplemente otro archivo para el
    sistema Debian) pueden hacer que sea inaccesible a los usuarios
    distintos del superusuario. Aunque el uso de la cuenta de
    superusuario es una manera rápida de comprobar este tipo de
    situaciónes, resolverlas es algo que debe hacerse estableciendo
    adecuadamente los permisos del archivo y la relación de usuarios
    que pertenece a cada grupo (véase Sección 1.2.3, “Permisos del
    sistema de archivos”).

%

1.1.4. El cursor del intérprete de órdenes de superusuario

    A continuación podrá ver algunos métodos para acceder al
    intérprete de órdenes del superusuario utilizando la contraseña
    del mismo.

      * Escriba root en la pantalla de inicio de sesión en modo
        texto.

      * En el entorno de escritorio Gnome, haga clic en
        «Aplicaciones» → «Accesorios» → «Terminal de «Root».

      * Escriba «su -l» desde cualquier intérprete de órdenes.

          + esto no conserva el entorno del usuario actual;

      * Escriba «su» en cualquier intérprete de órdenes.

          + esto conserva parte del entorno del usuario actual.

%

1.1.5. Herramientas gráficas para la administración del sistema

    Si el menú de su escritorio no inicia las herramientas gráficas
    de administración del sistema con los permisos adecuados
    automáticamente, puede iniciarlas desde el intérprete de órdenes
    del superusuario de un emulador de terminal de X como 
    gnome-terminal(1), rxvt(1), o xterm(1). Vea Sección 1.1.4, “El
    cursor del intérprete de órdenes de superusuario” y
    Sección 7.8.5, “Ejecutando clientes X como superusuario”.

    Aviso

    Nunca inicie una sesión gráfica con la cuenta de superusuario
    escribiendo root en el cuadro de diálogo de un gestor de inicio
    de sesión como gdm3(1).

    Aviso

    Nunca ejecute programas gráficos remotos no confiables en el
    sistema de ventanas X cuando se esté mostrando información
    crítica, porque dichos programas pueden realizar una intercepción
    pasiva de toda su pantalla de X.

%

1.1.6. Consolas virtuales

    En el sistema Debian que se instala por defecto hay seis consolas
    tipo VT100 intercambiables, disponibles para iniciar un
    intérprete de órdenes directamente en el equipo Linux. A menos
    que se encuentre en un entorno gráfico, podrá cambiar entre ellas
    presionando simultáneamente la tecla Alt situado en la izquierda
    y una de las teclas F1 — F6. Cada consola en modo texto permite
    acceder independientemente a la cuenta y acceder a un entorno
    multiusuario. Este entorno multiusuario es una gran
    característica de Unix y es muy adictivo.

    Si se encuentra en el Sistema de Ventanas X, puede acceder a la
    primera consola de texto presionando Ctrl-Alt-F1, es decir, la
    tecla Ctrl situada a la izquierda, la tecla Alt situada a la
    izquierda y la tecla F1 pulsadas simultáneamente. Puede volver al
    Sistema de Ventanas X, que habitualmente se encontrará en la
    consola virtual 7, presionando Alt-F7.

    También puede cambiar a otra consola virtual, p. ej. a la consola
    1, desde el intérprete de órdenes.

    # chvt 1

%

1.1.7. Cómo cerrar el intérprete de órdenes

    Pulsando Ctrl-D, es decir, la tecla Ctrl de la izquierda y la
    tecla d simultáneamente en el intérprete de órdenes, se cerrará.
    Si se encuentra en una consola de modo texto, volverá a ver la
    pantalla de inicio de sesión. Aunque es normal referirse a estos
    caracteres de control como «control D» en mayúscula, no es
    necesario pulsar la tecla de mayúsculas. La abreviatura ^D
    también es muy utilizada para Ctrl-D. Otra forma de cerrar el
    intérprete de órdenes es escribiendo «exit».

    Si se encuentra en un x-terminal-emulator(1) también puede
    cerrarlo de esta manera.

%

1.1.8. Cómo apagar el sistema

    Como en cualquiero otro Sistema Operativo moderno donde el
    trabajo con archivos implica usarmemorias caché de los datos para
    mejorar la eficiencia, el sistema Debian necesita que se efectúe
    el procedimiento de cierre de forma correcta antes de que se
    pueda cortar la corriente con seguridad. Esto es así para
    mantener la integridad de los archivos, obligando que todos los
    cambios que están en la memoria se escriban al disco. Si hay
    activo algún programa de control de energía, el procedimiento de
    cierre apagará el sistema automáticamente (en otro caso, tendrá
    que apretar el botón de encendido durante unos segundos).

    Puede apagar el sistema en el modo multiusuario estándar desde el
    intérprete de órdenes:

    # shutdown -h now

    Puede apagar el sistema en el modo monousuario desde el
    intérprete de órdenes como se muestra.

    # poweroff -i -f

    Otro forma de conseguirlo es pulsar Ctrl-Alt-Suprimir (la tecla
    Ctrl de la izquierda, la tecla Alt de la izquierda, y la tecla
    Supr al mismo tiempo) para apagar si «/etc/inittab» contiene
    «ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -h now». Vea inittab
    (5) para más detalles.

    Vea Sección 6.9.6, “Apagar un sistemas remoto utilizando SSH”.

%

1.1.9. Cómo recuperar la configuración normal de una consola

    Cuando la pantalla se vuelve loca tras hacer alguna cosa
    divertida como «cat <un-archivo-binario>», escriba «reset» en el
    intérprete de órdenes. Puede que no sea posible ver la orden en
    la pantalla mientras la teclea. Además, puede escribir «clear»
    para limpiar la pantalla.

1.1.10. Paquetes complementarios recomendados para usarios sin
experiencia

    Una instalación mínima del sistema Debian sin ningún entorno de
    escritorio proporciona la funcionalidad básica de Unix, sin
    embargo es una buena idea instalar algunos paquetes de terminal
    de caracteres adicionales basados en curses o en modo texto como
    mc y vim mediante la orden apt-get(8) para que los nuevos
    usuarios empiecen a tener experiencia con lo siguiente.

    # apt-get update
     ...
    # apt-get install mc vim sudo
     ...

    Si los paquetes antes mencionados están instalados con
    anterioridad, no se instalará ningún paquete nuevo.

    Tabla 1.1. Relación de paquetes con programas interesantes en
    modo texto

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño|           descripción            |
    |---------+-----------+------+----------------------------------|
    |mc       |V:59, I:236|1482  |Un gestor de archivos, a pantalla |
    |         |           |      |completa, en modo texto           |
    |---------+-----------+------+----------------------------------|
    |         |           |      |Un programa para proporcionar     |
    |         |V:563,     |      |algunos privilegios de            |
    |sudo     |I:806      |4555  |superusuario a los usuarios de    |
    |         |           |      |acuerdo a la configuración        |
    |         |           |      |establecida                       |
    |---------+-----------+------+----------------------------------|
    |         |           |      |Editor de texto Unix Vi IMproved  |
    |vim      |V:106,     |3231  |(Vi Mejorado), un editor de texto |
    |         |I:398      |      |para programadores (versión       |
    |         |           |      |estándar)                         |
    |---------+-----------+------+----------------------------------|
    |         |           |      |Editor de texto Unix Vi IMproved  |
    |vim-tiny |V:62, I:970|1553  |(Vi Mejorado), un editor de texto |
    |         |           |      |para programadores (versión       |
    |         |           |      |compacta)                         |
    |---------+-----------+------+----------------------------------|
    |emacs-nox|V:4, I:17  |18364 |El proyecto GNU Emacs, un editor  |
    |         |           |      |de texto ampliable basado en Lisp |
    |---------+-----------+------+----------------------------------|
    |w3m      |V:31, I:284|2289  |Navegadores web en modo texto     |
    |---------+-----------+------+----------------------------------|
    |gpm      |V:11, I:17 |530   |Copiar y pegar, al estilo Unix, en|
    |         |           |      |la consola de texto (demonio)     |
    +---------------------------------------------------------------+


    Puede ser una buena idea que usted leyera algo de documentación
    útil.

    Tabla 1.2. Relación de paquetes con documentación útil

    +---------------------------------------------------------------+
    |      paquete       |popularidad|tamaño|      descripción      |
    |--------------------+-----------+------+-----------------------|
    |                    |           |      |Documentación del      |
    |                    |           |      |Proyecto Debian,       |
    |doc-debian          |I:854      |166   |Preguntas Frecuentes   |
    |                    |           |      |(FAQ) y otros          |
    |                    |           |      |documentos             |
    |--------------------+-----------+------+-----------------------|
    |                    |           |      |Manual de la           |
    |debian-policy       |I:36       |4306  |Directrices Debian y   |
    |                    |           |      |documentos asociados   |
    |--------------------+-----------+------+-----------------------|
    |                    |           |      |Directrices e          |
    |developers-reference|I:6        |1917  |información para       |
    |                    |           |      |desarrolladores de     |
    |                    |           |      |Debian                 |
    |--------------------+-----------+------+-----------------------|
    |maint-guide         |I:4        |987   |Guía para nuevos       |
    |                    |           |      |Mantenedores de Debian |
    |--------------------+-----------+------+-----------------------|
    |debian-history      |I:1        |4285  |Historia del Proyecto  |
    |                    |           |      |Debian                 |
    |--------------------+-----------+------+-----------------------|
    |debian-faq          |I:849      |817   |Preguntas frecuentes   |
    |                    |           |      |(FAQ) sobre Debian     |
    +---------------------------------------------------------------+


    Puede instalar algunos de estos paquetes haciendo:

    # apt-get install nombre_del_paquete

%

1.1.11. Una cuenta de usuario adicional

    Si no quiere utilizar su cuenta de usuario aprende y práctica,
    puede crear una cuenta de usuario, p. ej. pescado, para ello
    realice lo que se muetra.

    # adduser pescado

    Conteste a todas las preguntas.

    Con ello se creará una nueva cuenta llamada pescado. Cuando
    termine de practicar, puede borrar esta cuenta y su directorio de
    usuario como se muestra.

    # deluser --remove-home pescado

%

1.1.12. Configuración de sudo

    Para una estación de trabajo típica de un único usuario o un
    escritorio Debian en un portátil, es normal realizar una
    configuración sencilla de sudo(8) como se indica a continuación
    para permitir al usuario no privilegiado, p. ej. pinguino,
    obtener los privilegios administrativos simplemente con su
    contraseña de usuario sin utilizar la contraseña del
    superusuario.

    # echo «pinguino  ALL=(ALL) ALL« >> /etc/sudoers

    También es usual hacerlo de la siguiente manera para permitir al
    usuario no privilegiado, p. ej. pinguino, ganar los privilegios
    administrativos sin usar ninguna contraseña como se muestra.

    # echo «pinguino  ALL=(ALL) NOPASSWD:ALL« >> /etc/sudoers

    Este truco solamente se debe usar en una estación de trabajo con
    un único usuario en la que usted sea el administrador y usuario
    único.

    Aviso

    No establezca de esta manera privilegios para cuentas de usuarios
    no privilegiados en una estación de trabajo multiusuario porque
    es perjudicial para la seguridad del sistema.

    Atención
   
    La contraseña de la cuenta pinguino, en los ejemplos de arriba,
    requiere tanta protección como la contraseña del superusuario.

    Atención

    Los privilegios administrativos pertenecen a alguien autorizado a
    realizar tareas de administración del sistema en la estación de
    trabajo. Nunca le de a un administrador del departamento de
    Sistemas de su compañía ni a su jefe tales privilegios a menos
    que estén autorizados y sean capaces.

    Nota

    Para proporcionar privilegios de acceso a determinados
    dispositivos y determinados archivos debería considerar usar 
    grupos para proporcionar acceso limitado en lugar de utilizar los
    privilegios de superusuario vía sudo(8).

    Nota

    Con una configuración mejor pensada y cuidadosa, sudo(8) puede
    proporcionar privilegios administrativos limitados a otros
    usuarios en un sistema compartido sin compartir la contraseña de
    superusuario. Esto puede ayudar en el mantenimiento de un equipo
    con múltiples administradores de manera que usted pueda saber
    quién hizo qué. Por otra parte, puede preferir que nadie más
    tenga tales privilegios.

%

1.1.13. Hora de jugar

    Ahora está listo para practicar con su sistema Debian sin riesgo
    mientras use una cuenta de usuario sin privilegios.

    Esto se debe a que el sistema Debian está, incluso en una
    instalación por defecto, configurado con los permisos de archivos
    adecuados que impide que los usuarios no privilegiados dañen el
    sistema. Por supuesto, puede haber aún algunos agujeros que
    podrían ser explotados, pero aquellos a quienes interesen esos
    detalles, que no trataremos aquí, pueden obtener la información
    precisa en Manual de seguridad de Debian.

    Aprenderemos a utilizar un sistema Debian como un sistema tipo
    Unix como se muestra:

      * Sección 1.2, “Sistema de archivos tipo Unix” (conceptos
        básicos),

      * Sección 1.3, “Midnight Commander (MC)” (método de
        supervivencia),

      * Sección 1.4, “Fundamentos de entornos de trabajo tipo Unix”
        (método básico),

      * Sección 1.5, “Órdenes simples para el intérprete de órdenes”
        (mecanismos del intérprete de órdenes (shell)),

      * Sección 1.6, “Operaciones de texto al estilo de Unix” (método
        de procesado de texto).

%

1.2. Sistema de archivos tipo Unix

    En GNU/Linux y otros sistemas operativos tipo Unix, los archivos
    se organizan en directorios. Todos los archivos y directorios
    están ordenados en un gran árbol que tiene como raíz «/». Se le
    llama árbol porque si se dibuja el sistema de archivos, parece un
    árbol pero cabeza abajo.

    Estos archivos y directorios pueden distribuirse entre varios
    dispositivos. mount(8) se utiliza para añadir el sistema de
    archivos que se encuentra en un dispositivo al gran árbol de
    archivos. Inversamente, umount(8) lo desconecta del gran árbol de
    archivos. En los núcleos más recientes de Linux, mount(8), con
    determinadas opciones, puede unir parte de un sistema de ficheros
    en otro sitio del árbol o puede montar un sistema de archivos
    como compartido, privado, esclavo o no enlazable. Las opciones
    soportadas para cada sistema de ficheros están disponibles en «/
    usr/share/doc/linux-doc-*/Documentation/filesystems/».

    Los directorios de los sistemas Unix son llamados carpetas en
    otros sistemas. Por favor, note que no existe el concepto de 
    unidad como «A:» en ningún sistema Unix. Solamente hay un sistema
    de archivos y todo se encuentra en él. Esto es una gran ventaja
    en comparación con Windows.

%

1.2.1. Información básica sobre archivos en Unix

    Aquí damos algo de información básica sobre los archivos en Unix:

      * Los nombres de archivos son sensibles a mayúsculas. Es decir,
        «MIARCHIVO» y «MiArchivo» son archivos diferentes.

      * El directorio raíz significa la raíz del sistema de archivos
        representado simplemente por «/». No lo confunda con el
        directorio del superusuario: «/root».

      * Cada directorio tiene un nombre que puede contener cualquier
        letra o símbolo excepto «/». El directorio raíz es una
        excepción: su nombre es «/» (pronunciado «barra« o «el
        directorio raíz«) y no puede ser renombrado.

      * Cada archivo o directorio es identificado con un nombre
        completamente cualificado, nombre absoluto, o ruta), dando la
        secuencia de directorios que deben atravesarse para
        alcanzarlo. Los tres términos son sinónimos.

      * Todos los nombres completamente cualificados comienzan con el
        directorio «/», y se coloca una «/» entre cada dos nombres de
        directorio o archivo en el nombre de fichero completo. La
        primera «/» es el directorio de más alto nivel (la raíz) y
        las demás «/» separan subdirectorios sucesivos hasta que
        alcanzamos la última entrada, que es el nombre real del
        archivo en cuestión. Las palabras pueden ser confusas.
        Elijamos el siguiente nombre completamente cualificado como
        un ejemplo: «/usr/share/keytables/es.map.gz». Es de uso
        generalizado el referirse a la última entrada «es.map.gz»
        como un nombre de archivo.

      * El directorio raíz tiene un cierto número de ramificaciones,
        como «/etc/» y «/usr/». Estos subdirectorios a su vez se
        ramifican en más subdirectorios, como «/etc/init.d/» y «/usr/
        local/». El todo, visto colectivamente, es llamado el árbol
        de directorios. Puede pensar que un nombre de archivo
        absoluto es una ruta desde la raíz del árbol («/») hasta la
        hoja de una rama (un archivo). También oirá hablar del árbol
        de directorios como de un árbol genealógico que descienden de
        un elemento único llamado raíz («/»: así, los subdirectorios
        tienen padres y una ruta muestra la genealogía completa de un
        archivo. Hay, además, rutas relativas que comienzan de alguna
        otra manera que con el directorio raíz. Debe recordar que el
        directorio «../» hace referencia al directorio padre. Esta
        terminología se utiliza también para otras estructuras
        semejantes a los directorios, como las estructuras
        jerárquicas de datos.

      * No existen directorios, que forman parte de las rutas que
        describen archivos, que se correspondan con dispositivos
        físicos, como discos duros. Esto cambia respecto a RT-11, CP/
        M, OpenVMS, MS-DOS, AmigaOS y Microsoft Windows, donde la
        ruta contiene el nombre del dispositivo, como «C:\». Sin
        embargo, existen directorios que referencian dispositivos
        físicos como parte del sistema de archivos. Lea
        Sección 1.2.2, “Sistemas de archivos internos”).

    Nota

    Es posible usar casi cualquier letra o símbolo en el nombre de un
    archivo, pero es una mala idea. Es preferible evitar el uso de
    cualquier carácter que tenga un significado especial en la línea
    de órdenes, incluido espacios, tabulaciones, saltos de línea y
    otros caracteres especiales: { } ( ) [ ] ' ` " \ / > < | ; ! # &
    ^ * % @ $. Si quiere separar palabras en un nombre, son buenas
    elecciones el punto, el guión y el guión bajo. Además puede
    empezar cada palabra con mayúscula, «ComoEsto». Los usuarios con
    experiencia suelen evitar los espacios en los nombres de archivo.

    Nota
   
    La palabra «root» puede referirse a «superusuario» o «directorio
    raíz». El contexto determinará su significado correcto.

    Nota

    El término ruta se utiliza tanto para los nombres de archivos que
    especifican la ruta completa, como hemos hecho con anterioridad,
    como en la ruta para la búsqueda de órdenes. El significado
    correcto vendrá determinado por el contexto.

    Los detalles de las buenas prácticas de la jerarquía de archivos
    es descrita en el estándar de la jerarquía del sistema de
    archivos (Filesystem Hierarchy Standard ) («/usr/share/doc/
    debian-policy/fhs/fhs-2.3.txt.gz» y hier(7)). Como usuario novel
    debe recordar lo siguiente:

    Tabla 1.3. Relación de directorios clave y su uso

    +---------------------------------------------------------------+
    |directorio|                 uso del directorio                 |
    |----------+----------------------------------------------------|
    |/         |directorio raíz                                     |
    |----------+----------------------------------------------------|
    |/etc/     |archivos principales para la configuración del      |
    |          |sistema                                             |
    |----------+----------------------------------------------------|
    |/var/log/ |archivos de registro del sistema                    |
    |----------+----------------------------------------------------|
    |/home/    |todos los directorios personales de usuario sin     |
    |          |privilegios                                         |
    +---------------------------------------------------------------+


%

1.2.2. Sistemas de archivos internos

    Siguiendo la tradición de Unix, el sistema Debian GNU/Linux
    ofrece el sistemas de archivos «/dev/» que representa de manera
    unificada el almacenamiento físico en discos duros u otros
    dispositivos de almacenamiento y la interacción con los
    dispositivos hardware como las consolas en modo texto o las
    consolas en serie remotas.

    Cada archivo, directorio, tubería con nombre (sirve para
    compartir datos entre dos programas) o dispositivo físico tiene
    en el sistema Debian GNU/Linux una estructura con metainformación
    llamada inodo que describe sus propiedades como quién es su dueño
    (owner), el grupo al que pertenece, la fecha de último acceso,
    etc. La idea de incluir todo en el sistema de archivos fue una
    innovación de Unix y las versiones modernas de los núcleos de
    Linux la han llevado más allá. Hoy en día puede encontrar en el
    sistema de archivos incluso información de procesos en ejecución.

    La representación unificada y abstracta tanto de entidades
    físicas como de procesos internos es sumamente útil ya que
    permite el uso de la misma orden para el mismo tipo de operación
    en dispositivos totalmente diferentes. Incluso es posible cambiar
    la forma de trabajar del núcleo escribiendo datos en archivos
    especiales que están enlazándolos a procesos en ejecución.

    Sugerencia
   
    Si necesita determinar la correspondencia entre un árbol de
    archivos y un elemento físico, ejecute mount(8) sin parámetros.

%

1.2.3. Permisos del sistema de archivos

    Los permisos en el sistema de archivos en los sistemas tipo Unix
    se definen basandose en tres categorías o tipos de usuarios:

      * el usuario que es dueño del archivo (u);

      * los usuarios que pertenecen al mismo grupo al que pertenece
        el archivo (h);

      * el resto de usuarios (o) también denominado «universo» o
        «todos».

    Para cada archivo, cada permiso permite las siguientes acciones:

      * el permiso de lectura (r) permite al dueño examinar el
        contenido del archivo;

      * el permiso de escritura (w) permite al dueño modificar el
        archivo;

      * el permiso de ejecución (x) permite al dueño ejecutar el
        archivo como una orden.

    Para los directorios, cada permiso permite las siguientes
    acciones:

      * el permiso de lectura (r) permite al dueño obtener una
        relación del contenido del directorio;

      * el permiso de escritura (w) permite al dueño añadir o borrar
        archivos al directorio;

      * el permiso de ejecución (x) permite al dueño acceder a los
        archivos del directorio.

    El permiso de ejecución de un directorio no solo indican que se
    puede leer los archivos que contiene, sí no también permite ver
    sus atributos, como el tamaño y la fecha de modificación.

    ls(1) se usa para mostrar los permisos (y más detalles) de
    archivos o directorios. Cuando se ejecuta con el parámetro «-l»,
    muestra la información siguiente ordenada por campos:

      * tipo de fichero (primer carácter),

      * permisos del archivo (nueve caracteres, tres para el usuario,
        tres para el grupo y los tres últimos para el resto, en este
        orden),

      * número de enlaces duros al archivo,

      * nombre del usuario que es dueño del archivo,

      * nombre del grupo al que pertenece,

      * tamaño del archivo expresado en caracteres (bytes),

      * fecha y hora del archivo (mtime),

      * nombre del archivo.

    Tabla 1.4. La interpretación del primer carácter de cada línea de
    la salida de «ls -l» se interpreta como se muestra

    +---------------------------------------------------+
    |carácter|               significado                |
    |--------+------------------------------------------|
    |-       |archivo normal                            |
    |--------+------------------------------------------|
    |d       |directorio                                |
    |--------+------------------------------------------|
    |l       |enlace simbólico                          |
    |--------+------------------------------------------|
    |c       |nodo de dispositivo orientado a caracteres|
    |--------+------------------------------------------|
    |b       |nodo de dispositivo orientado a bloques   |
    |--------+------------------------------------------|
    |p       |tubería con nombre                        |
    |--------+------------------------------------------|
    |s       |socket                                    |
    +---------------------------------------------------+


    Para cambiar el dueño de un archivo, el superusuario utiliza la
    orden chown(1). Para alterar el grupo de un archivo, su dueño
    utiliza la orden chgrp(1). Para modificar los permisos del acceso
    al archivo o directorio, su dueño o el superusuario utilizan la
    orden chmod(1). La sintaxis para operar sobre un archivo foo es
    la que se muestra.

    # chown <nuevo_dueño> foo
    # chgrp <nuevo_grupo> foo
    # chmod  [ugoa][+-=][rwxXst][,...] foo

    Por ejemplo, se puede asignar a un árbol de directorios como
    dueño al usuario foo y como grupo bar como se muestra.

    # cd /ruta/a/un/lugar/
    # chown -R foo:bar .
    # chmod -R ug+rwX,o=rX .

    Existen tres bits adicionales de permisos especiales.

      * El bit set user ID (s o S en lugar del permiso del dueño x)

      * El bit set group ID (s o S en lugar del permiso del grupo x)

      * El bit sticky (t o T en vez del permiso de todos x)

    Estos bits aparecerán en mayúsculas en la salida de la orden «ls
    -l» si los permisos de ejecución correspondientes están sin
    asignar.

    La configuración de set user ID en un archivo ejecutable permite
    a un usuario ejecutarlo con todos los privilegios de su dueño (al
    ejecutarlo con el identificador del dueño, por ejemplo root).
    Igualmente la configuración set group ID en un archivo ejecutable
    permite al usuario ejecutarlo con todos los privilegios de su
    grupo (al ejecutarlo con el identificador del grupo, por ejemplo 
    root). Esto crea riesgos de seguridad, por lo que su
    configuración debe ser extremadamente cuidadosa.

    La configuración del bit set group ID en un directorio permite la
    creación de archivosal estilo BSD, donde todos los archivos
    creados en el directorio pertenecen al mismo grupo que el
    directorio.

    Activar el sticky bit en un directorio impide que sus archivos
    sean eliminados por alguien que no es su dueño. En los
    directorios con permisos de escritura para todos, como «/tmp», o
    para su grupo, con el fin de asegurar la integridad de los
    archivos, se debe eliminar los permisos de escritura de los
    archivos. Además se debe configurar el sticky bit en el
    directorio para evitar que cualquier usuario con permiso de
    escritura en él pueda borrar un archivo y después crear otro con
    el mismo nombre.

    Aquí están algunos ejemplos interesantes.

    $ ls -l /etc/passwd /etc/shadow /dev/ppp /usr/sbin/exim4
    crw------T 1 root root   108, 0 Oct 16 20:57 /dev/ppp
    -rw-r--r-- 1 root root     2761 Aug 30 10:38 /etc/passwd
    -rw-r----- 1 root shadow   1695 Aug 30 10:38 /etc/shadow
    -rwsr-xr-x 1 root root   973824 Sep 23 20:04 /usr/sbin/exim4
    $ ls -ld /tmp /var/tmp /usr/local /var/mail /usr/src
    drwxrwxrwt 14 root root  20480 Oct 16 21:25 /tmp
    drwxrwsr-x 10 root staff  4096 Sep 29 22:50 /usr/local
    drwxr-xr-x 10 root root   4096 Oct 11 00:28 /usr/src
    drwxrwsr-x  2 root mail   4096 Oct 15 21:40 /var/mail
    drwxrwxrwt  3 root root   4096 Oct 16 21:20 /var/tmp

    La orden chmod(1) tiene otra forma de describir los permisos
    mediante números. Este modo numérico utiliza 3 o 4 dígitos en
    base octal (base 8).

    Tabla 1.5. El modo numérico en chmod(1) es como se muestra.

    +---------------------------------------------------------------+
    |   dígito   |                   significado                    |
    |------------+--------------------------------------------------|
    |1º dígito   |suma de set user ID (=4), set group ID (=2) y     |
    |(opcional)  |sticky bit (=1)                                   |
    |------------+--------------------------------------------------|
    |2º dígito   |suma de los permisos de lectura (=4), escritura (=|
    |            |2) y ejecución (=1) para el usuario               |
    |------------+--------------------------------------------------|
    |3º dígito   |idem para el grupo                                |
    |------------+--------------------------------------------------|
    |4º dígito   |idem para todos                                   |
    +---------------------------------------------------------------+


    Parece más complicado de lo que realmente es. Si se fija en las
    primeras columnas (de la 2 a la 10) de la salida de la orden «ls
    -l» y lee en binario (base 2) la representación de los permisos
    del archivo («-» siendo «0» y cualquiera de «rwx» un «1»), la
    conversión a octal (base 8) representarían los permisos del
    archivo.

    Por ejemplo, intente lo siguiente

    $ touch foo bar
    $ chmod u=rw,go=r foo
    $ chmod 644 bar
    $ ls -l foo bar
    -rw-r--r-- 1 penguin penguin 0 Oct 16 21:39 bar
    -rw-r--r-- 1 penguin penguin 0 Oct 16 21:35 foo

    Sugerencia

    Si necesita acceder a información de salida de la orden «ls -l»
    en un archivo de órdenes, es mejor utilizar las órdenes como test
    (1), stat(1) y readlink(1). La funcionalidad interna del
    intérprete de órdenes como«[» o «test» también puede ser
    utilizada.

%

1.2.4. Gestión de permisos para nuevos archivos: umask

    Los permisos que se asignan por defecto a los nuevos archivos y
    directorios cuando estos se crean están definidos por la orden
    interna del intérprete de órdenes umask. Consulte dash(1), bash
    (1) y builtins(7).

     (permisos del archivo) = (permisos concedidos al archivo) & ~(valor umask)

    Tabla 1.6. Ejemplos de valores de umask

    +---------------------------------------------------------------+
    |umask| permisos creados |  permisos creados  |       uso       |
    |     | para un archivo  | para un directorio |                 |
    |-----+------------------+--------------------+-----------------|
    |0022 |-rw-r--r--        |-rwxr-xr-x          |modificable solo |
    |     |                  |                    |por el usuario   |
    |-----+------------------+--------------------+-----------------|
    |0002 |-rw-rw-r--        |-rwxrwxr-x          |modificable por  |
    |     |                  |                    |el grupo         |
    +---------------------------------------------------------------+


    El sistema Debian utiliza por defecto un esquema de grupos
    privados de usuarios (UPG). Un grupo privado de usuario se crea
    cuando sea añade un nuevo usuario al sistema. El UPG tiene el
    mismo nombre que el usuario para el cual fue creado y ese usuario
    es el único miembro de ese grupo. En el esquema UPG es seguro
    asignar a la máscara (umask) el valor 0002 ya que cada usuario
    tiene un grupo privado propio. (En algunas variantes de Unix, es
    común que todos los usuarios no privilegiados pertenezcan al
    mismo grupo users siendo buena idea asignar el valor 0022 a la
    máscara por motivos de seguridad.)

    Sugerencia
   
    Active UPG añadiendo «umask 002» en el archivo ~/.bashrc.

%

1.2.5. Permisos para grupos de usuarios (grupo)

    Para que los permisos de un grupo se apliquen a un usuario, el
    necesario añadir el usuario al grupo usando «sudo vigr» para
    editar /etc/group y «sudo vigr -s» para editar /etc/gshadow. Para
    que se active la nueva configuración de grupos es necesario
    cerrar la sesión e iniciarla (o ejecutar «exec newgrp»).

    Nota

    Otra manera dinámica consiste en añadir usuarios a grupos durante
    el proceso de acreditación añadiendo la línea «auth optional
    pam_group.so» al archivo «/etc/pam.d/common-auth» y configurar «/
    etc/security/group.conf». (Consulte Capítulo 4, Acreditación.)

    En el sistema Debian los dispositivos hardware son también
    archivos. Si tiene problemas para que un usuario acceda a
    dispositivos como el CD-ROM o dispositivos de memoria USB, podría
    solucionarse añadiendo el usuario al grupo pertinente.

    Algunos grupos importantes del propio sistema permiten a sus
    miembros acceder a archivos y directorios específicos sin
    privilegios de superusuario.

    Tabla 1.7. Relación de grupos importantes del sistema para el
    acceso a archivos

    +---------------------------------------------------------------+
    | grupo |   descripción de archivos y dispositivos accesibles   |
    |-------+-------------------------------------------------------|
    |dialout|acceso directo y completo a los puertos serie («/dev/  |
    |       |ttyS[0-3]»)                                            |
    |-------+-------------------------------------------------------|
    |       |acceso limitado a los puertos series para establecer   |
    |dip    |conexiones a internet por via telefónica (dialup IP) a |
    |       |pares confiables                                       |
    |-------+-------------------------------------------------------|
    |cdrom  |dispositivos CD-ROM, DVD+/-RW                          |
    |-------+-------------------------------------------------------|
    |audio  |dispositivo audio                                      |
    |-------+-------------------------------------------------------|
    |video  |dispositivo de video                                   |
    |-------+-------------------------------------------------------|
    |scanner|escáner                                                |
    |-------+-------------------------------------------------------|
    |adm    |registros de supervisión del sistema                   |
    |-------+-------------------------------------------------------|
    |staff  |algunos directorios para la administración básica del  |
    |       |sistema: «/usr/local», «/home»                         |
    +---------------------------------------------------------------+


    Sugerencia

    Necesita pertenecer al grupo dialout para reconfigurar el modem,
    marcar, etc. Pero si el superusuario crea archivos de
    configuraciones predefinidas para algunos pares en «/etc/ppp/
    peers/», únicamente necesitará pertenecer al grupo dip para crear
    conexiones a internet porvia telefónica a estos pares usando las
    órdenes pppd(8), pon(1) y poff(1).

    Algunos grupos importantes proporcionados por el sistema permiten
    a sus miembros ejecutar determinadas órdenes sin privilegios de
    superusuario.

    Tabla 1.8. Relación de grupos importantes del sistema para la
    ejecución de órdenes específicas

    +---------------------------------------------------------------+
    | grupo |                  órdenes permitidas                   |
    |-------+-------------------------------------------------------|
    |sudo   |ejecuta sudo sin su contraseña                         |
    |-------+-------------------------------------------------------|
    |lpadmin|ejecuta órdenes para añadir, modificar y eliminar las  |
    |       |impresoras disponibles                                 |
    +---------------------------------------------------------------+


    Puede consultar una relación completa de los usuarios y grupos
    del sistema en el documento «Users and Groups« /usr/share/doc/
    base-passwd/users-and-groups.html del paquete base-passwd.

    Consulte las órdenes para la gestión de usuarios y grupos: passwd
    (5), group(5), shadow(5), newgrp(1), vipw(8), vigr(8) y pam_group
    (8).

%

1.2.6. Marcas de tiempo

    Existen tres tipos de marcas o sellos de tiempo para un archivo
    GNU/Linux.

    Tabla 1.9. Relación de tipos de marcas de tiempo

    +------------------------------------------------+
    |tipo |significado (definición histórica en Unix)|
    |-----+------------------------------------------|
    |mtime|el momento de modificación (ls -l)        |
    |-----+------------------------------------------|
    |ctime|el momento de cambio de estado (ls -lc)   |
    |-----+------------------------------------------|
    |atime|el momento del último acceso (ls -lu)     |
    +------------------------------------------------+


    Nota
   
    ctime no es el momento de creación del archivo.

    Nota
   
    El significado actual de atime en sistemas GNU/Linux puede no ser
    diferente del de Unix clásico.

      * la sobreescritura de un archivo modifica todas sus
        propiedades de tiempo , mite, ctime y atime;

      * el cambio de dueño o de permisos de un archivo modifica sus
        propiedades ctime y atime;

      * la lectura de un archivo en un sistema Unix clásico modifica
        su propiedad atime.

      * La lectura de un archivo en GNU/Linux modifica su propiedad 
        atime si está montado con la opción «strictatime»

      * La lectura de un archivo por primera vez o después de un día
        cambia la propiedad atime en un sistema GNU/Linux si el
        sistema de archivos está montado con la opción «relatime».
        (comportamiento por defecto desde Linux 2.6.30)

      * La lectura del archivo no cambia su propiedad atime en un
        sistema GNU/Linux si el sistema de archivos está montado con
        la opción «noatime».

    Nota

    Las opciones de montaje «noatime» y «relatime» se diseñaron para
    mejorar el desempeño de lectura del sistema de archivos de forma
    normal. La simple lectura de un archivo con la opción
    «strictatime» genera una operación de escritura para actualizar
    la propiedad atime. El atributo atime se usa poco excepto para el
    archivo mbox(5). Consulte mount(8).

    Utilice la orden touch(1) para cambiar las marcas de tiempo de
    los archivos existentes.

    La orden ls muestra como salida, en lo referente a las marcas de
    tiempo, el formato de la antigua configuración regional («C») si
    está no es inglesa («fr_FR.UTF-8»).

    $ LANG=fr_FR.UTF-8  ls -l foo
    -rw-rw-r-- 1 penguin penguin 0 oct. 16 21:35 foo
    $ LANG=C  ls -l foo
    -rw-rw-r-- 1 penguin penguin 0 Oct 16 21:35 foo

    Sugerencia
   
    Consulte Sección 9.2.5, “Personalización de la visualización de
    la fecha y hora” para personalizar la salida de «ls -l».

%

1.2.7. Enlaces

    Existen dos métodos para asociar un archivo «foo» con otro nombre
    «bar»:

      * enlace duro,

          + duplica el nombre para un archivo ya existente;

          + «ln foo bar»
   
      * enlace simbólico o «simlink».

          + es un archivo especial que referencia o apunta al nombre
            del archivo que quiere referenciar;

          + «ln -s foo bar».

    Con el siguiente ejemplo se muestra los cambios en el contador de
    enlaces y las sutiles diferencias de la orden rm.

    $ umask 002
    $ echo "Contenido original" > foo
    $ ls -li foo
    1449840 -rw-rw-r-- 1 penguin penguin 17 Oct 16 21:42 foo
    $ ln foo bar     # enlace duro
    $ ln -s foo baz  # enlace blando
    $ ls -li foo bar baz
    1449840 -rw-rw-r-- 2 penguin penguin 17 Oct 16 21:42 bar
    1450180 lrwxrwxrwx 1 penguin penguin  3 Oct 16 21:47 baz -> foo
    1449840 -rw-rw-r-- 2 penguin penguin 17 Oct 16 21:42 foo
    $ rm foo
    $ echo "Nuevo contenido" > foo
    $ ls -li foo bar baz
    1449840 -rw-rw-r-- 1 penguin penguin 17 Oct 16 21:42 bar
    1450180 lrwxrwxrwx 1 penguin penguin  3 Oct 16 21:47 baz -> foo
    1450183 -rw-rw-r-- 1 penguin penguin 12 Oct 16 21:48 foo
    $ cat bar
    Contenido original
    $ cat baz
    Nuevo contenido

    Los enlaces duros deben ser construidos en el mismo sistema de
    archivos y comparten el mismo «inodo» como revela el parámetro
    «-i» de la orden ls(1).

    Los enlaces simbólicos siempre tienen permisos de acceso al
    archivo nominales «rwxrwxrwx», como se mostró en el ejemplo
    anterior, con los permisos reales que tenga el archivo al que
    referencia.

    Atención

    En general es preferible no crear nunca enlaces simbólicos o
    enlaces duros excepto que tenga poderosas razones. Los enlaces
    simbólicos puede causar problemas graves al crear bucles en el
    sistema de archivos.

    Nota
   
    En general es preferible crear enlaces simbólicos a enlaces
    duros, al menos que tenga alguna buena razón para ello.

    El directorio . enlaza al propio directorio en el que aparece,
    por lo que la cuenta de enlaces de cualquier nuevo directorio es
    2. El directorio «..» enlaza al directorio padre, por lo que la
    cuenta de enlaces del directorio se incrementa con la creación de
    nuevos subdirectorios.

    Si proviene de Windows, pronto comprenderá lo bien diseñado que
    están los enlaces de Unix, comparados con su equivalente en
    Windows que son los accesos directos (shortcuts). Gracias su
    implementación en el sistema de archivos, las aplicaciones no
    distinguen entre el archivo original y su enlace. En el caso de
    los enlaces duros, ciertamente no existe diferencia.

%

1.2.8. Tuberías con nombre (FIFOs)

    Una tubería con nombre es un archivo que se comporta como una
    tubería. Usted introduce algo dentro del archivo y sale por el
    otro lado. Por esa razón se dice que es FIFO o
    primero-en-entrar-primero-en-salir: lo primero que se introduce
    en la tubería es lo primero en salir por el otro lado.

    Si se escribe en una tubería con nombre, los procesos que han
    escrito en la tubería no pueden terminar hasta que la información
    que han escrito es leída de la tubería. Si se lee de una tubería
    con nombre, el proceso lector espera hasta que no hay nada que
    leer antes de terminar. El tamaño de la tubería es siempre cero
    --- no almacena datos, la tubería solo comunica los dos procesos
    de igual manera que lo hace el intérprete de órdenes mediante la
    sintaxis «|». Sin embargo, desde que la tubería tiene un nombre,
    los dos procesos no tienen que estar en la misma línea de órdenes
    y ni siquiera ser ejecutados por el mismo usuario. Las tuberías
    fueron una innovación muy relevante de Unix.

    Por ejemplo, intente lo siguiente

    $ cd; mkfifo mypipe
    $ echo "hola" >mypipe & # lo manda a segundo plano
    [1] 8022
    $ ls -l mypipe
    prw-rw-r-- 1 penguin penguin 0 Oct 16 21:49 mypipe
    $ cat mypipe
    hola
    [1]+  Done                    echo "hola" >mypipe
    $ ls mypipe
    mypipe
    $ rm mypipe

%

1.2.9. «Sockets»

    Los «sockets» se usan de forma generalizada en las comunicaciones
    en Internet, bases de datos y sistemas operativos. Son similares
    a las tuberías con nombre (FIFO) y permiten que los procesos
    intercambien información entre diferentes equipos. Para los
    «sockets» los procesos no necesitan estar ejecutandose al mismo
    tiempo, ni ser hijos del mismo proceso padre. Este es el mejor
    sistema para la comuniación entre procesos (IPC). El intercambio
    de información puede ocurrir en la red entre equipos. Los dos
    tipos de «sockets» más comunes son los «sockets« Internet y los
    «sockets» de dominio Unix.

    Sugerencia
   
    «netstat -an» ofrece una visión muy útil de los «sockets»
    abiertos en el sistema.

%

1.2.10. Archivos de dispositivos

    Los archivos de dispositivos referencian a dispositivos físicos o
    virtuales del sistema, como el disco duro, la tarjeta de video,
    la pantalla o el teclado. Un ejemplo de dispositivo virtual es la
    consola, representado por «/dev/console».

    Hay dos tipos de archivos de dispositivos:

      * dispositivos orientados a carácter,

          + se accede a un carácter cada vez,

          + 1 carácter = 1 byte,

          + p. ej. teclado, puerto serie, …
   
      * dispositivo orientado a bloque.

          + se accede a unidades grandes llamadas bloques,

          + 1 bloque > 1 byte,

          + p. ej. un disco duro, …

    Los archivos de dispositivos se pueden leer y escribir , aunque
    el fichero puede contener datos binarios los cuales son un
    galimatias incomprensibles para humanos. Algunas veces escribir
    datos directamente en esos ficheros puede ayudar a resolver
    problemas de conexión con los dispositivos. Por ejemplo, usted
    puede enviar un archivo de texto al dispositivo de la impresora«/
    dev/lp0» o mandar órdenes de modem por el puerto serie «/dev/
    ttyS0». Pero, al menos que se haga con cuidado, puede causar un
    problema mayor. Así que tenga cuidado.

    Nota
   
    Comúnmente a la impresora se accede utilizando lp(1).

    El número de nodo del dispositivo se muestra por la ejecución de 
    ls(1) como se muestra.

    $ ls -l /dev/sda /dev/sr0 /dev/ttyS0 /dev/zero
    brw-rw---T  1 root disk     8,  0 Oct 16 20:57 /dev/sda
    brw-rw---T+ 1 root cdrom   11,  0 Oct 16 21:53 /dev/sr0
    crw-rw---T  1 root dialout  4, 64 Oct 16 20:57 /dev/ttyS0
    crw-rw-rw-  1 root root     1,  5 Oct 16 20:57 /dev/zero

      * «/dev/sda» tiene como número de disposito mayor 8 y como
        número de dispositivo menor 0. Los usuario pueden realizar
        operaciones de lectura/escritura haciendo si pertenecen al
        grupo disk.

      * «/dev/sr0» tiene como número de dispositivo mayor 11 y como
        menor 0. Los usuarios pueden realizar operaciones de lectura/
        escritura si pertenecen al grupo cdrom.

      * «/dev/ttyS0» tiene el número de dispositivo mayor 4 y menor
        64. Los usuarios pueden realizar operaciones de lectura/
        escritura si pertenecen al grupo dialout.

      * «/dev/zero» tiene como número mayor de dispositivo 1 y como
        menor 5. Todos los usuarios pueden realizar operaciones de
        lectura/escritura.

    En un sistema Linux moderno, el sistema de archivos en «/dev/» se
    rellena de forma automática mediante udev(7).

%

1.2.11. Archivos de dispositivos especiales

    Existen algunos archivos de dispositivos especiales.

    Tabla 1.10. Relación de archivos de dispositivos especiales

    +---------------------------------------------------------------+
    |archivo de| acción  |                respuesta                 |
    |dispostivo|         |                                          |
    |----------+---------+------------------------------------------|
    |/dev/null |lectura  |devuelve el «carácter de final de archivo |
    |          |         |(EOF)»                                    |
    |----------+---------+------------------------------------------|
    |/dev/null |escritura|no devuelve nada (un pozo sin fondo al que|
    |          |         |enviar datos)                             |
    |----------+---------+------------------------------------------|
    |/dev/zero |lectura  |devuelve «el carácter \0 (NUL)» (difiere  |
    |          |         |del número cero representado en ASCII)    |
    |----------+---------+------------------------------------------|
    |/dev/     |         |devuelve caracteres aleatorios creados por|
    |random    |lectura  |el generador de números aleatorios        |
    |          |         |confiable, ofreciendo entropía real (baja)|
    |----------+---------+------------------------------------------|
    |          |         |devuelve caracteres de forma aleatoria    |
    |/dev/     |lectura  |desde el generador de números             |
    |urandom   |         |pseudo-aleatorios de seguridad            |
    |          |         |criptográfica                             |
    |----------+---------+------------------------------------------|
    |/dev/full |escritura|devuelve el error de disco lleno (ENOSPC) |
    +---------------------------------------------------------------+


    Con frecuencia son utilizados en las redirecciones del intérprete
    de órdenes (consulte Sección 1.5.8, “Secuencias de órdenes
    comunes y redirecciones del intérprete de órdenes”).

%

1.2.12. procfs y sysfs

    Los pseudo sistemas de archivos procfs y sysfs, que se montan en
    «/proc» y «/sys», son estructuras de datos internas del núcleo
    que se muestran al espacio de usuario. Expresado de otra forma,
    estas entradas son virtuales actuan como una ventana apropiada al
    funcionamiento del sistema operativo.

    El directorio «/proc» contiene (entre otras cosas) un
    subdirectorio por cada proceso que se está ejecutando en el
    sistema operativo, cuyo nombre es el identificador del proceso
    (PID). Las herramientas del sistema que acceden ainformación de
    los procesos, como ps(1), obtienen dicha información de la
    estructura de este directorio.

    Los el subárbol de directorios «/proc/sys/» contienen interfaces
    que permiten cambiar algunos parámetros del núcleo en tiempo de
    ejecución. (Se puede realizar las mismas operaciones por medio de
    la ordensysctl(8) o de su archivo de configuración «/etc/
    sysctl.conf».)

    La gente normalmente se alarma del gran tamaño de que un archivo
    en particular, «/proc/kcore». Es (más o menos) una copia del
    contenido de la memoria del equipo. Es útil para depurar el
    núcleo y es un archivo virtual que es una referencia a la memoria
    del equipo, así es que no hay que preocuparse por su tamaño.

    El subárbol de «/sys» contiene las estructuras de datos
    exportadas del núcleo, sus atributos y las relaciones entre
    ellas. También contiene algunas interfaces para cambiar algunos
    parámetros del núcleo en tiempo de ejecución.

    Consulte «proc.txt(.gz)», «sysfs.txt(.gz)» y otros documentos que
    forman parte de la documentación del núcleo de Linux («/usr/share
    /doc/linux-doc-*/Documentation/filesystems/*») incluidos en el
    paquete linux-doc-*.

%

1.2.13. tmpfs

    El sistema de archivos temporal tmpfs tiene la función de
    mantener todos los archivos en la memoria virtual. Los datos de
    «tmpfs« de la caché de páginas de la memoria puede ser enviada al
    área de intercambio en disco cuando sea necesario.

    El directorio «/run» se monta como tmpfs al comienzo del proceso
    de arranque. Así se permite la escritura sobre él, incluso cuando
    el directorio «/» está montado en solo lectura. Aquí se guardan
    los archivos en estado temporal y sustituye a varios directorios
    de la Jerarquía Estándar del Sistema de Ficheros versión 2.3:

      * «/var/run» → «/run»,

      * «/var/lock» → «/run/lock»,

      * «/dev/shm» → «/run/shm».

    Consulte el documento del núcleo de Linux «tmpfs.txt(.gz)» («/usr
    /share/doc/linux-doc-*/Documentation/filesystems/*») que está en
    el paquete linux-doc-*.

%

1.3. Midnight Commander (MC)

    Midnight Commander (MC) es una «navaja multiusos» GNU para la
    consola de Linux y otros entornos de terminal. Aporta a los
    nuevos usuarios una experiencia de consola basada en menús que es
    más sencilla de aprender que las órdenes estándar de Unix.

    Necesitará instalar el paquete de Midnight Commander llamado «mc
    como se muestra.

    $ sudo apt-get install mc

    Podrá explorar el sistema Debian utilizando la orden mc(1). Esta
    es la mejor forma de aprender. Por favor, navege entre algunos
    directorios interesantes utilizando las teclas del cursor e
    «Intro»:

      * «/etc» y sus subdirectorios;

      * «/var/log» y sus subdirectorios;
   
      * «/usr/share/doc» y sus subdirectorios;

      * «/sbin» y «/bin».

%

1.3.1. Personalización de MC

    Para cambiar el directorio de trabajo de MC después de salir y no
    tener que ejecutar una orden cd al último directorio, le sugiero
    que cambie «~/.bashrc» para incluir el archivo de órdenes que
    está en el paquete mc.

    . /usr/lib/mc/mc.sh

    Consulte mc(1) (en la opción «-P») para comprobar por qué. (Si no
    comprende exactamente lo que estoy diciendo puede hacerlo más
    tarde.)

%

1.3.2. Primeros pasos con MC

    Para ejecutar MC escriba lo que se muestra.

    $ mc

    MC permite ejecutar todas las operaciones sobre archivos a través
    de sus menús, con el mínimo esfuerzo para el usuario. Para
    acceder a la pantalla de ayuda presione F1. Puede probar MC con
    solo pulsar las teclas de los cursores y las teclas de función.

    Nota

    En algunas consolas como gnome-terminal(1), la pulsación de las
    teclas de función las recibe la consola. Esta funcionalidad se
    desactiva en «Editar» → «Atajos de teclado» para gnome-terminal.

    Si encuentra problemas de codificación de los caracteres y
    parecen no tener sentido, añadir «-a» como parámetro a la orden
    MC ayudará a evitar problemas.

    Si esto no soluciona el problema consulte Sección 9.4.6, “La
    configuración del terminal”.

%

1.3.3. Gestor de archivos de MC

    Por defecto hay dos paneles con dos directorios y su contenido.
    Otro modo útil es asignar el panel derecho para que muestre los
    permisos de los archivos, etc. A continuación mostraremos algunas
    claves. Con el demonio gpm(8) ejecutándose, se puede usar el
    ratón en la consola de caracteres de Linux. (Asegurese de pulsar
    la tecla de mayúsculas para obtener el comportamiento normal
    cuando corte y pege en MC.)

    Tabla 1.11. Funciones de las teclas en MC

    +---------------------------------------------------------------+
    |   tecla    |                     función                      |
    |------------+--------------------------------------------------|
    |F1          |menú de ayuda                                     |
    |------------+--------------------------------------------------|
    |F3          |visión del contenido del archivo                  |
    |------------+--------------------------------------------------|
    |F4          |editor interno                                    |
    |------------+--------------------------------------------------|
    |F9          |activa el menú superior                           |
    |------------+--------------------------------------------------|
    |F10         |salida de Midnight Commander                      |
    |------------+--------------------------------------------------|
    |Tab         |moverse entre los paneles                         |
    |------------+--------------------------------------------------|
    |Insertar o  |marcar el fichero para seleccionar varios para    |
    |Ctrl-T      |otra operación como copiar                        |
    |------------+--------------------------------------------------|
    |Del         |borrar el archivo (tenga cuidado---active el modo |
    |            |seguro de borrado en MC)                          |
    |------------+--------------------------------------------------|
    |Cursores    |se explican por si mismas                         |
    +---------------------------------------------------------------+


%

1.3.4. Trucos de la línea de órdenes en MC

      * La orden cd cambia el directorio en el panel seleccionado

      * Ctrl-Intro o Alt-Intro copia el nombre del archivo a la orden
        en la línea de órdenes Se utiliza en combinación con las
        órdenes cp(1) y mv(1) para añadir parámetros a las órdenes.

      * Alt-Tab muestra los posibles archivos elegibles por expansión
        del nombre en el intérprete de órdenes.

      * Se puede especificar los directorios de inicio de ambos
        paneles como parámetros a MC; por ejemplo, «mc /etc/ /root».

      * Esc + tecla numérica n → tecla de función n (p. ej., Esc + 1
        → F1, etc.; Esc + 0 → F10).

      * Pulsando Esc antes que la tecla tiene el mismo efecto que
        presionar Alt y otra tecla a la vez.; p. ej. pulse Esc+c para
        obtener Alt-C. Esc es llamada la meta-tecla y algunas veces
        se representa como «M-».

%

1.3.5. El editor interno de MC

    El editor interno tiene un esquema de corta-y-pega interesante.
    Al pulsarF3 comienza la selección, una segunda pulsación de F3
    finaliza la selección y resalta lo seleccionado. Entonces puede
    mover el cursor. Si presiona F6 el áŕea seleccionada se moverá a
    la posición del cursor. Si presiona F5 el área seleccionadad se
    copia e inserta en la posición del cursor. F2 guarda el archivo.
    F10 permite salir. La mayor parte de las teclas cursor funcionan
    de forma intuitiva.

    El editor puede abrirse directamente con un archivo usando una de
    las siguientes órdenes:

    $ mc -e nombre_de_archivo_a_editar

    $ mcedit nombre_de_archivo_a_editar

    El editor posee una sola ventana, pero se pueden usar varias
    consolas de Linux para obtener el mismo comportamiento. Para
    copiar entre ventanas, use las teclas Alt-F<n> para cambiar entre
    consolas virtuales y utilice «Archivo→Insertar archivo» or
    «Archivo→Copiar a un archivo» para mover una parte de un archivo
    a otro.

    El editor interno puede ser reemplazado por cualquier otro editor
    de su elección.

    De hecho, muchos programas usan la variable de entorno «$EDITOR»
    o «$VISUAL» para determinar el editor a utilizar. Si al principio
    no está cómodo con vim(1) o nano(1), puede cambiar su valor a
    «mcedit» añadiendo la siguientes líneas a «~/.bashrc».

    export EDITOR=mcedit
    export VISUAL=mcedit

    Si es posible, mi recomendación es asignarles el valor «vim».

    Si está incómodo con vim(1) puede utilizar mcedit(1) para la
    mayor parte de las tareas de administración del sistema.

%

1.3.6. El visor interno de MC

    MC posee un visor inteligente. Es una gran herramienta para
    buscar palabras en los documentos. Yo siempre lo uso para
    archivos del directorio «/usr/share/doc». Es la manera más rápida
    de navegar a través de la ingente cantidad de información de
    Linux. Este visor puede iniciarse de forma separada utilizando
    una de las órdenes que se muestran.

    $ mc -v ruta/al/archivo_a_visualizar

    $ mcview ruta/al/archivo_a_visualizar

%

1.3.7. Selección inteligente del visor en MC

    Pulse Intro en un archivo y el programa, de acuerdo a su
    contenido, abrirá el archivo (consulte Sección 9.3.11,
    “Personalizando el inicio de un programa”). Es una funcionalidad
    de MC muy útil.

    Tabla 1.12. Accion de la tecla Intro en MC

    +---------------------------------------------------------------+
    |   tipo de archivo    |        acción de la tecla Intro        |
    |----------------------+----------------------------------------|
    |archivo ejecutable    |ejecuta la orden                        |
    |----------------------+----------------------------------------|
    |archivo de página de  |envia el contenido a la aplicación de   |
    |manual                |visualización                           |
    |----------------------+----------------------------------------|
    |archivo html          |envia el contenido al navegador web     |
    |----------------------+----------------------------------------|
    |archivos «*.tar.gz» y |muestra su contenido como si fuera un   |
    |«*.deb»               |subdirectorio                           |
    +---------------------------------------------------------------+


    Para que opere de forma correcta el visor y las funciones
    virtuales de archivo, los archivos visibles no deben tener
    permisos de ejecución. Puede cambiar su estado con chmod(1) o en
    el menú de archivo de MC.

%

1.3.8. Sistema de archivos FTP virtual de MC

    MC puede acceder a archivos en Internet a través de FTP. Vaya al
    menú pulsando F9, entonces pulse «p» para activar el sistema de
    archivos FTP virtual. Escriba la URL con el formato
    «nombre_de_usuario:contraseña@nombre_del_equipo.nombre_del_domino»,
    para que acceda al directorio remoto con la apariencia de tratarse
    de uno local.

    Pruebe con la URL «[http.us.debian.org/debian]» y navege a través
    del archivo de Debian.

%

1.4. Fundamentos de entornos de trabajo tipo Unix

    Aunque MC permite realizar casi cualquier cosa, es importante que
    aprenda a utilizar la línea de órdenes y el intérprete de órdenes
    y acostumbrarse a un entorno de trabajo tipo Unix.

%

1.4.1. El intérprete de órdenes (shell)

    Puede elegir el intérprete de órdenes (shell) mediante chsh(1).

    Tabla 1.13. Relación de intérpretes de órdenes

    +---------------------------------------------------------------+
    |       |           |      |Intérprete|                         |
    |paquete|popularidad|tamaño|de órdenes|       descripción       |
    |       |           |      |  POSIX   |                         |
    |-------+-----------+------+----------+-------------------------|
    |       |V:791,     |      |          |Bash: el intérprete de   |
    |bash   |I:999      |6469  |Sí        |órdenes GNU Bourne Again |
    |       |           |      |          |SHell (estándar de facto)|
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |TENEX C Shell: una       |
    |tcsh   |V:9, I:29  |1316  |No        |versión mejorada de      |
    |       |           |      |          |Berkeley csh             |
    |-------+-----------+------+----------+-------------------------|
    |       |V:907,     |      |          |Intérprete de órdenes    |
    |dash   |I:992      |221   |Sí        |Debian Almquist, bueno   |
    |       |           |      |          |para archivos de órdenes |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |Intérprete de órdenes Z: |
    |zsh    |V:37, I:73 |2442  |Sí        |un intérprete de órdenes |
    |       |           |      |          |con muchas mejoras       |
    |-------+-----------+------+----------+-------------------------|
    |mksh   |V:4, I:12  |1469  |Sí        |Versión de el intérprete |
    |       |           |      |          |de órdenes Korn          |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |Intérprete de órdenes    |
    |csh    |V:2, I:8   |343   |No        |OpenBSD C, una versión de|
    |       |           |      |          |Berkeley csh             |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |Intérprete de órdenes    |
    |sash   |V:0, I:6   |1054  |Sí        |Stand-alone con órdenes  |
    |       |           |      |          |internas (no es el       |
    |       |           |      |          |estándar «/bin/sh»)      |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |la versión AT&T actual   |
    |ksh    |V:3, I:16  |3284  |Sí        |del intérprete de órdenes|
    |       |           |      |          |Korn                     |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |implementación del       |
    |rc     |V:0, I:2   |169   |No        |intérprete de órdenes rc |
    |       |           |      |          |de AT&T Plan 9           |
    |-------+-----------+------+----------+-------------------------|
    |       |           |      |          |Intérprete de órdenes que|
    |posh   |V:0, I:0   |190   |Sí        |cumple con las           |
    |       |           |      |          |directrices estándar     |
    |       |           |      |          |(derivado de pdksh)      |
    +---------------------------------------------------------------+


    Sugerencia

    Aunque los intérpretes de órdenes tipo POSIX comparten la
    sintaxis básica, pueden cambiar el comportamiento de algunos
    elementos básicos como sus variables o la expansión de nombres de
    archivos con comodines. Por favor, compruebe su documentación
    para obtener más detalles.

    En este capítulo se sobreentiende que el intérprete de órdenes es
    bash.

%

1.4.2. Personalización de bash

    Puede personalizar bash(1) en el archivo de configuración «~
    /.bashrc».

    Por ejemplo, pruebe con lo que se muestra.

    # activa el completado programable de la terminal bash
    f ! shopt -oq posix; then
      if [ -f /usr/share/bash-completion/bash_completion ]; then
        . /usr/share/bash-completion/bash_completion
      elif [ -f /etc/bash_completion ]; then
        . /etc/bash_completion
      fi
    fi

    # CD al finalizar MC
    . /usr/lib/mc/mc.sh

    # asigna  CDPATH de la forma correcta
    CDPATH=.:/usr/share/doc:~:~/Desktop:~
    export CDPATH

    PATH="${PATH+$PATH:}/usr/sbin:/sbin"
    # añade el PATH el bin del usuario si este existe
    if [ -d ~/bin ] ; then
      PATH="~/bin${PATH+:$PATH}"
    fi
    export PATH

    EDITOR=vim
    export EDITOR

    Sugerencia

    Puede encontrar más posibilidades de personalización de bash,
    como Sección 9.2.7, “Órdenes coloreadas” en Capítulo 9, Trucos
    del sistema.

    Sugerencia
   
    El paquete bash-completion permite programar el completado
    estándar de las palabas en bash.

%

1.4.3. Combinaciones de teclas

    En un entorno tipo Unix, hay algunas teclas que tiene un uso
    especial. Tenga en cuenta que en una consola modo texto de Linux,
    solo las teclas Ctrl y Alt del lado izquierdo funcionan de la
    forma esperada. Algunas combinaciones de teclas que conviene
    recordar se muestran a continuación.

    Tabla 1.14. Relación de combinaciones de teclado en bash

    +---------------------------------------------------------------+
    |           tecla            | decripción de la combinación de  |
    |                            |              teclas              |
    |----------------------------+----------------------------------|
    |Ctrl-U                      |borra el contenido desde el cursor|
    |                            |al inico de la línea              |
    |----------------------------+----------------------------------|
    |Ctrl-H                      |borra el carácter anterior al     |
    |                            |cursor                            |
    |----------------------------+----------------------------------|
    |Ctrl-D                      |fin de la entrada (finaliza el    |
    |                            |intérprete de órdenes en uso)     |
    |----------------------------+----------------------------------|
    |Ctrl-C                      |finaliza el programa en ejecución |
    |----------------------------+----------------------------------|
    |Ctrl-Z                      |para temporalemente el programa   |
    |                            |que pasa a segundo plano          |
    |----------------------------+----------------------------------|
    |Ctrl-S                      |para la salida por pantalla       |
    |----------------------------+----------------------------------|
    |Ctrl-Q                      |reanuda la salida por pantalla    |
    |----------------------------+----------------------------------|
    |Ctrl-Alt-Del                |reinicia/apaga el sistema,        |
    |                            |consulte inittab(5)               |
    |----------------------------+----------------------------------|
    |tecla izquierda Alt         |meta-tecla para Emacs e interfaces|
    |(opcionalmente, tecla de    |similares de usuario              |
    |Windows)                    |                                  |
    |----------------------------+----------------------------------|
    |flecha arriba               |retrocede en el histórico de      |
    |                            |órdenes bash                      |
    |----------------------------+----------------------------------|
    |Ctrl-R                      |búsqueda en el histórico de       |
    |                            |órdenes de bash                   |
    |----------------------------+----------------------------------|
    |Tab                         |completa la entrada de la orden   |
    |                            |con el nombre de archivo en bash  |
    |----------------------------+----------------------------------|
    |Ctrl-V Tab                  |introduce Tab sin completar la    |
    |                            |orden en bash                     |
    +---------------------------------------------------------------+


    Sugerencia
   
    La funcionalidad del terminal de Ctrl-S puede deshabilitarse con 
    stty(1).

%

1.4.4. Operaciones con el ratón al estilo Unix

    Las operaciones con el ratón al estilo de Unix necesitan ratones
    de tres botones.

    Tabla 1.15. Relación de operaciones con el ratón al estilo Unix

    +---------------------------------------------------------------+
    |          acción           |             respuesta             |
    |---------------------------+-----------------------------------|
    |boton izquierdo y arrastre |selección y copia al portapapeles  |
    |del ratón                  |                                   |
    |---------------------------+-----------------------------------|
    |botón izquierdo            |inicio de la selección             |
    |---------------------------+-----------------------------------|
    |botón derecho              |fin de la selección y copia al     |
    |                           |portapapeles                       |
    |---------------------------+-----------------------------------|
    |botón de en medio          |pegar del portapapeles en la       |
    |                           |posición del cursor                |
    +---------------------------------------------------------------+


    La rueda central que se encuentra en los ratones actuales
    sustituye al tercer botón. Si dispone de un ratón con únicamente
    dos botones la función del botón de en medio se realiza pulsando
    a la vez el botón izquierdo y el derecho. Para utilizar el ratón
    en las consolas de Linux necesita que se esté ejecutando como
    demonio gpm(8).

%

1.4.5. El paginador

    La orden less(1) es un paginador mejorado (permite navegar por el
    contenido de los archivos). Lee el archivo indicado como
    parámetro en su orden o la entrada estándar. Pulse «h» si
    necesita ayuda mientras utiliza la orden less. Es capaz de más
    que more(1) y puede ser mejorado ejecutando «eval $(lesspipe)» o
    «eval $(lessfile)» en el archivo de órdenes de inicio. Consulte «
    /usr/share/doc/less/LESSOPEN». La opción «-R» permite la salida
    en crudo y permite las secuencias de escape ANSI coloreadas.
    Consulte less(1).

%

1.4.6. El editor de texto

    Debería ser competente con Vim o Emacs que son habituales en los
    sistemas tipo Unix.

    Pienso que el correcto es Vim, ya que el editor Vi esta siempre
    disponible en el mundo Linux/Unix. (En realidad, los programas,
    bien el original vi o el nuevonvi los puede encontrar en
    cualquier lugar. Yo elegí Vim en vez de la versión nueva ya que
    ofrece ayuda a través de tecla F1 siendo similar y más potente.)

    Si elige Emacs o XEmacs como su editor también son buenas
    opciones, especialemente para la programación. Emacs tiene una
    extensa cantidad de características también, incluyendo funciones
    como lector de noticias, editor de directorios, aplicación de
    correo, etc. Cuando se usa para programar o editar archivos de
    órdenes, reconocerá el formato en el que está trabajando y
    tratará de ayudarle. Algunos mantienen que el único programa que
    necesita Linux es Emacs. Aprender Emacs durante diez minutos
    ahora puede ahorrar muchas horas después. Es recomendable usar el
    manual de GNU Emacs para aprender.

    Todos estos programas normalmente incluyen una aplicación de
    tutorial para que usted pueda aprender a través de la práctica.
    Se inicia en «vim» pulsando la tecla F1. Debería al menos leer
    las primeras treinta y cinco líneas. Después realizar el curso de
    entrenamiento posicionando el cursor en«|tutor|» y pulsando
    Ctrl-].

    Nota

    Los buenos editores, como Vim y Emacs, gestionan de manera
    adecuada codificaciones UTF-8 y otras menos comunes o más
    exóticas. Es una buena idea usar el entorno X con la
    configuración regional UTF-8 e instalar los programas y tipos de
    letra necesarias para ello. Los editores tienen opciones para
    asignar una codificación independientemente de la del entorno X.
    Por favor, consulte su documentación para codificaciones de
    varios bytes.

%

1.4.7. Configuración del editor de texto por defecto

    Debian tiene un buen número de editores. Recomendamos instalar el
    paquete vim, como mencionamos con anterioridad.

    Debian tiene un acceso unificado al editor por defecto del
    sistema mediante la orden «/usr/bin/editor», y así otros
    programas (p. ej. reportbug(1)) puedan llamarlo. Puede cambiarlo
    como se muestra.

    $ sudo update-alternatives --config editor

    Mi recomendación es la opción «/usr/bin/vim.basic» mejor que «/
    usr/bin/vim.tiny» para los usuario noveles ya que permite
    realzado de sintaxis.

    Sugerencia

    Muchos programas utilizan las variables de entorno «$EDITOR» o
    «$VISUAL» para determinar el editor a usar (consulte
    Sección 1.3.5, “El editor interno de MC” y Sección 9.3.11,
    “Personalizando el inicio de un programa”). Para un sistema
    Debian coherente asigne este valor a «/usr/bin/editor».
    (Históricamente, «$EDITOR» era «ed» y «$VISUAL» era «vi».)

%

1.4.8. Personalición de vim

    Puede personalizar el comportamiento de vim(1) mediante «~
    /.vimrc».

    Por ejemplo, intente lo siguiente

    " -------------------------------
    " Configuración local
    "
    set nocompatible
    set nopaste
    set pastetoggle=<f2>
    syn on
    if $USER == "root"
     set nomodeline
     set noswapfile
    else
     set modeline
     set swapfile
    endif
    " Relleno para evitar que la línea superior se reconozca como modeline
    " Relleno
    " Relleno

%

1.4.9. Grabación de las actividades del intérprete de órdenes

    La salida del intérprete de órdenes puede colapsar su pantalla y
    puede perderse para siempre. Es una buena práctica registrar la
    actividad del intérprete de órdenes en un archivo para poder
    revisarlo más tarde. Este registro es esencial para llevar a buen
    término cualquier tarea de administración de un sistema.

    El método básico de registro del intérprete de órdenes es operar
    con script(1).

    Por ejemplo, intente lo siguiente

    $ script
    Script started, file is typescript

    Ejecute las órdenes que desee después de script.

    Pulse Ctrl-D para finalizar script.

    $ vim typescript

    Consulte Sección 9.2.3, “Registro correcto de las actividades del
    intérprete de órdenes”.

%

1.4.10. Órdenes básicas de Unix

    Aprendamos las órdenes fundamentales de UNIX. Aquí utilizaremos
    «Unix» en su sentido genérico. Normalmente cualquier sistema
    operativo tipo Unix tiene un conjunto de órdenes similares. El
    sistema Debian no es una excepción. No se preocupe si en este
    momento algunas órdenes no funcionan como esperaba. Si se utiliza
    alias en el intérprete de órdenes, las salidas de las órdenes
    correspondientes difieren. Estos ejemplos no pretenden ejecutarse
    en orden.

    Pruebe las siguientes órdenes desde una cuenta de usuario sin
    privilegios.

    Tabla 1.16. Relación de órdenes Unix fundamentales

    +---------------------------------------------------------------+
    |       orden        |               descripción                |
    |--------------------+------------------------------------------|
    |pwd                 |muestra el nombre del directorio actual/de|
    |                    |trabajo                                   |
    |--------------------+------------------------------------------|
    |whoami              |muestra el nombre del usuario actual      |
    |--------------------+------------------------------------------|
    |                    |muestra la identidad del usuario actual   |
    |id                  |(nombre, uid, gid y grupos a los que      |
    |                    |pertenece)                                |
    |--------------------+------------------------------------------|
    |file <foo>          |muestra el tipo de archivo de «<foo>»     |
    |--------------------+------------------------------------------|
    |type -p             |muestra la ubicación del archivo de la    |
    |<nombre_de_la_orden>|orden «<nombre_de_la_orden>»              |
    |--------------------+------------------------------------------|
    |which               |, ,                                       |
    |<nombre_de_la_orden>|                                          |
    |--------------------+------------------------------------------|
    |type                |muestra información de la orden «         |
    |<nombre_de_la_orden>|<nombre_de_la_orden>»                     |
    |--------------------+------------------------------------------|
    |apropos             |encuentra órdenes relacionadas con la «   |
    |<palabra_clave>     |<palabra_clave>»                          |
    |--------------------+------------------------------------------|
    |man -k              |, ,                                       |
    |<palabra_clave>     |                                          |
    |--------------------+------------------------------------------|
    |whatis              |muestra una descripción de una línea de la|
    |<nombre_de_la_orden>|orden «<nombre_de_la_orden>»              |
    |--------------------+------------------------------------------|
    |man -a              |muestra la descripción de la orden «      |
    |<nombre_de_la_orden>|<nombre_de_la_orden>» (al estilo Unix)    |
    |--------------------+------------------------------------------|
    |info                |muestra una descripción detallada de la   |
    |<nombre_de_la_orden>|orden «<nombre_de_la_orden>» (al estilo   |
    |                    |GNU)                                      |
    |--------------------+------------------------------------------|
    |                    |relación el contenido del directorio      |
    |ls                  |(excluye aquellos archivos o directorios  |
    |                    |que comienzan por .)                      |
    |--------------------+------------------------------------------|
    |ls -a               |relación el contenido del directorio      |
    |                    |(todos los archivos y directorios)        |
    |--------------------+------------------------------------------|
    |                    |relación el contendido del directorio     |
    |ls -A               |(casi todos los archivos y directorios, a |
    |                    |saber, oculta «..» y «.»)                 |
    |--------------------+------------------------------------------|
    |ls -la              |relación todo el contenido del directorio |
    |                    |con información detallada                 |
    |--------------------+------------------------------------------|
    |                    |relación el contenido completo del        |
    |ls -lai             |directorio con el número del inodo e      |
    |                    |información detallada                     |
    |--------------------+------------------------------------------|
    |ls -d               |relación los directorios que cuelgan del  |
    |                    |directorio actual                         |
    |--------------------+------------------------------------------|
    |tree                |muestra el contenido de los directorios en|
    |                    |formato de árbol                          |
    |--------------------+------------------------------------------|
    |lsof <foo>          |relación los procesos que tienen abierto  |
    |                    |el archivo «<foo>»                        |
    |--------------------+------------------------------------------|
    |lsof -p <pid>       |relación los archivos abiertos por el     |
    |                    |proceso con el identificador: «<pid>»     |
    |--------------------+------------------------------------------|
    |mkdir <foo>         |crear un nuevo directorio «<foo>» en el   |
    |                    |directorio actual                         |
    |--------------------+------------------------------------------|
    |rmdir <foo>         |borra el directorio «<foo>» del directorio|
    |                    |actual                                    |
    |--------------------+------------------------------------------|
    |                    |cambia al directorio «<foo>» que se       |
    |cd <foo>            |encuentre en el directorio actual o en los|
    |                    |directorios incluidos en la variable      |
    |                    |«$CDPATH»                                 |
    |--------------------+------------------------------------------|
    |cd /                |cambia al directorio raíz                 |
    |--------------------+------------------------------------------|
    |cd                  |cambia al directorio principal del usuario|
    |                    |actual                                    |
    |--------------------+------------------------------------------|
    |cd /<foo>           |cambia al directorio con ruta absoluta «  |
    |                    |<foo>»                                    |
    |--------------------+------------------------------------------|
    |cd ..               |cambia al directorio padre                |
    |--------------------+------------------------------------------|
    |cd ~<foo>           |cambia al directorio principal del usuario|
    |                    |«<foo>»                                   |
    |--------------------+------------------------------------------|
    |cd -                |cambia al directorio anterior             |
    |--------------------+------------------------------------------|
    |</etc/motd pager    |muestra el contenido de «/etc/motd» usando|
    |                    |el paginador por defecto                  |
    |--------------------+------------------------------------------|
    |touch <junkfile>    |crea un archivo vacio «<junkfile>»        |
    |--------------------+------------------------------------------|
    |cp <foo> <bar>      |copia el archivo existente «<foo>» en un  |
    |                    |archivo nuevo «<bar>»                     |
    |--------------------+------------------------------------------|
    |rm <junkfile>       |borra el archivo «<junkfile>»             |
    |--------------------+------------------------------------------|
    |                    |renombra el archivo existente «<foo>» con |
    |mv <foo> <bar>      |un nuevo nombre «<bar>» («<bar>» no debe  |
    |                    |existir con anterioridad)                 |
    |--------------------+------------------------------------------|
    |                    |mueve el archivo existente «<foo>» a una  |
    |mv <foo> <bar>      |nueva ubicación «<bar>/<foo>» (el         |
    |                    |directorio «<bar>» debe existir           |
    |                    |previamente)                              |
    |--------------------+------------------------------------------|
    |                    |mueve un archivo existente «<foo>» a una  |
    |                    |nueva ubicación con el nombre nuevo «<bar>|
    |mv <foo> <bar>/<baz>|/<baz>» (el directorio «<bar>» debe       |
    |                    |existir con anterioridad pero el archivo «|
    |                    |<bar>/<baz>» no)                          |
    |--------------------+------------------------------------------|
    |                    |el archivo existente «<foo>» únicamente   |
    |chmod 600 <foo>     |tiene permisos de lectura y escritura para|
    |                    |el dueño (y no se permite la ejecución por|
    |                    |nadie)                                    |
    |--------------------+------------------------------------------|
    |                    |hace que un archivo existente «<foo>»     |
    |chmod 644 <foo>     |pueda ser leido por cualquiera, que       |
    |                    |únicamente el dueño pueda escribir sobre  |
    |                    |él (y nadie puede ejecutarlo)             |
    |--------------------+------------------------------------------|
    |                    |hace que un archivo «<foo>» pueda ser     |
    |chmod 755 <foo>     |leido por cualquiera y modificado solo por|
    |                    |el dueño (cualquiera puede ejecutarlo)    |
    |--------------------+------------------------------------------|
    |find . -name        |encuentra archivos que cumplen la «       |
    |<expresión_regular> |<expresión_regular>» del intérprete de    |
    |                    |órdenes (lento)                           |
    |--------------------+------------------------------------------|
    |                    |encuentra archivos que cumplen «          |
    |locate -d .         |<expresión_regular>» del intérprete de    |
    |<expresión_regular> |órdenes (rápido ya que utiliza una base de|
    |                    |datos que se actualiza de forma periódica)|
    |--------------------+------------------------------------------|
    |grep -e «<expresión |muestra todos los archivos del directorio |
    |regular>» *.html    |actual con el sufijo «.html» que contienen|
    |                    |la «<expresión_regular>»                  |
    |--------------------+------------------------------------------|
    |                    |muestra información de los procesos a     |
    |top                 |pantalla completa, pulsando «q» para      |
    |                    |terminar                                  |
    |--------------------+------------------------------------------|
    |                    |muestra información de todos los procesos |
    |ps aux | pager      |ejecutándose utilizando para la salida el |
    |                    |estilo BSD                                |
    |--------------------+------------------------------------------|
    |                    |muestra información de todo s los procesos|
    |ps -ef | pager      |ejecutándose utilizando para la salida el |
    |                    |estilo Unix system-V                      |
    |--------------------+------------------------------------------|
    |ps aux | grep -e "  |muestra todos los procesos «exim» y       |
    |[e]xim4*"           |«exim4»                                   |
    |--------------------+------------------------------------------|
    |ps axf | pager      |muestra información de todos los procesos |
    |                    |con la salida al estilo de arte ASCII     |
    |--------------------+------------------------------------------|
    |kill <1234>         |elimina el proceso cuyo identificador de  |
    |                    |proceso es: «<1234>»                      |
    |--------------------+------------------------------------------|
    |gzip <foo>          |comprime «<foo>» y crea «<foo>.gz» usando |
    |                    |la codificación Lempel-Ziv (LZ77)         |
    |--------------------+------------------------------------------|
    |gunzip <foo>.gz     |descomprime «<foo>.gz» y crea «<foo>»     |
    |--------------------+------------------------------------------|
    |                    |comprime «<foo>» y crea «<foo>.bz2» usando|
    |                    |el algoritmo de compresión de texto por   |
    |bzip2 <foo>         |ordenación de bloques Burrows-Wheeler y   |
    |                    |codificación Huffman (ofrece mejor        |
    |                    |compresión que gzip)                      |
    |--------------------+------------------------------------------|
    |bunzip2 <foo>.bz2   |descomprime «<foo>.bz2» y crea «<foo>»    |
    |--------------------+------------------------------------------|
    |                    |comprime «<foo>» y crea «<foo>.xz» usando |
    |xz <foo>            |el algoritmo Lempel–Ziv–cadenas de Markov |
    |                    |(ofrece mejor compresión que bzip2)       |
    |--------------------+------------------------------------------|
    |unxz <foo>.xz       |descomprime «<foo>.xz» y crea «<foo>»     |
    |--------------------+------------------------------------------|
    |tar -xvf <foo>.tar  |extrae archivos del archivo «<foo>.tar»   |
    |--------------------+------------------------------------------|
    |tar -xvzf           |extrae los archivos del archivo comprimido|
    |<foo>.tar.gz        |mediante gzip «<foo>.tar.gz»              |
    |--------------------+------------------------------------------|
    |tar -xvjf           |extrae archivos del archivo «             |
    |<foo>.tar.bz2       |<foo>.tar.bz2»                            |
    |--------------------+------------------------------------------|
    |tar -xvJf           |extrae los archivos del archivo «         |
    |<foo>.tar.xz        |<foo>.tar.xz»                             |
    |--------------------+------------------------------------------|
    |tar -cvf <foo>.tar  |archiva el contenido de la carpeta «<bar>/|
    |<bar>/              |» en el archivo «<foo>.tar»               |
    |--------------------+------------------------------------------|
    |tar -cvzf           |archiva el contenido de la carpeta «<bar>/|
    |<foo>.tar.gz <bar>/ |» en el archivo comprimido «<foo>.tar.gz» |
    |--------------------+------------------------------------------|
    |tar -cvjf           |archiva el contenido de la carpeta «<bar>/|
    |<foo>.tar.bz2 <bar>/|» en el archivo «<foo>.tar.bz2»           |
    |--------------------+------------------------------------------|
    |tar -cvJf           |archiva el contenido de la carpeta «<bar>/|
    |<foo>.tar.xz <bar>/ |» en el archivo «<foo>.tar.xz»            |
    |--------------------+------------------------------------------|
    |zcat README.gz |    |muestra el contenido del archivo          |
    |pager               |comprimido «README.gz» utilizando el      |
    |                    |paginador por defecto                     |
    |--------------------+------------------------------------------|
    |zcat README.gz > foo|crea un archivo «foo» con el contenido    |
    |                    |descomprimido de «README.gz»              |
    |--------------------+------------------------------------------|
    |zcat README.gz >>   |adjunta el contenido descomprimido de     |
    |foo                 |«README.gz» al final del archivo «foo» (si|
    |                    |no existe, lo creará primero)             |
    +---------------------------------------------------------------+


    Nota

    Unix tiene una tradición de ocultar los archivos que comienzan
    con «.». Tradicionalmente contienen información de configuración
    y de preferencias de usuario.

    Nota
   
    Para la orden cd, consulte builtins(7).

    Nota

    El paginador por defecto del sistema Debian es more(1) que es
    básico y no permite el desplazamiento para atrás. La instalación
    del paquete less con la orden «apt-get install less», convertirá
    a less(1) en el paginador por defecto y este sí permite el
    desplazamiento hacia atrás con las teclas de cursor.

    Nota

    En la expresión regular de la orden «ps aux | grep -e «[e]
    xim4*«», «[» y «]» permite a grep que no encaje consigo mismo. La
    expresión regular «4*» significa cero o más repeticiones del
    carácter «4» y de este modo permite a grep encajar con «exim» y
    con «exim4». Aunque el intérprete de órdenes utiliza «*» para el
    completado de nombres y las expresiones regulares, sus
    significados son distintos. Aprenda expresiones regulares
    consultando grep(1).

    Por favor, para entrenar recorra los directorios y de un vistazo
    al sistema utilizando las órdenes que acabamos de introducir. Si
    tiene dudas sobre cualquier orden de consola, asegúrese de leer
    la página del manual.

    Por ejemplo, intente lo siguiente

    $ man man
    $ man bash
    $ man builtins
    $ man grep
    $ man ls

    El estilo de la páginas de manual puede ser un poco aspero, ya
    que puede ser bantante conciso, especialmente las más antiguas y
    típicas pero una vez que se acostumbre, llegará a apreciar su
    concisión.

    Recuerde que muchas órdenes de la familia Unix, incluidas las que
    provienen de GNU y BSD muestran un resumen de la ayuda si las
    ejecuta en alguna de las siguientes maneras (o sin parámetros en
    algunos casos).

    $ <nombre_de_la_orden> --help
    $ <nombre_de_la_orden> -h

%

1.5. Órdenes simples para el intérprete de órdenes

    Ahora ya tiene una idea de como utilizar un sistema Debian. Vamos
    a ver en profundidad el mecanismo de la ejecución de órdenes en
    el sistema Debian. En este tema haremos una simplificación de la
    realidad para las personas con poca experiencia. Para una
    explicación más completa consulte bash(1).

    Una orden básica se divide en varios componentes:

     1. asignación de variables (opcional),

     2. nombre de la orden,

     3. parámetros (opcional),

     4. redirecciones (optional: > , >> , < , << , etc.),

     5. operadores de control (optional: && , || , <nueva_línea> , ;
        , & , ( , ) ).

%

1.5.1. Ejecución de órdenes y variables de entorno

    El comportamiento de algunas órdenes Unix cambia dependiendo del
    valor de algunas variables de entorno.

    El sistema PAM inicia las variables de entorno a los valores por
    defecto y después otros programas de aplicación pueden
    restablecerlas:

      * los gestores de inicio de sesión como gdm3 restablecen las
        variables de entorno;
   
      * el intérprete de órdenes restablece las variables de entorno
        mediante «~/.bash_profile» y «~/.bashrc».

%

1.5.2. La variable «$LANG»

    La variable de la configuración regional «$LANG» tiene tres
    partes: «xx_YY.ZZZZ».

    Tabla 1.17. Tres partes del valor de la configuración regional

    +---------------------------------------------------------------+
    |      valor de      |                                          |
    |   configuración    |               significado                |
    |      regional      |                                          |
    |--------------------+------------------------------------------|
    |xx                  |códigos de la lengua según la ISO 639 (en |
    |                    |minúsculas) como «en»                     |
    |--------------------+------------------------------------------|
    |YY                  |código del país de la ISO 3166 (en        |
    |                    |mayúsculas) como «US»                     |
    |--------------------+------------------------------------------|
    |ZZZZ                |codificación de caracteres, siempre       |
    |                    |«UTF-8»                                   |
    +---------------------------------------------------------------+


    Consulte «info gettext» para obtener información sobre los
    códigos de lenguas y de paises.

    En un sistema moderno Debian la codificación de caracteres, al
    menos que tenga una buena razón, debería valer siempre UTF-8.

    Consulte Sección 8.4, “Configuración regional” para obtener más
    detalles de la configuracion regional.

    Nota
   
    En el sistema Debian, para utilizar todas las configuraciones
    regionales asegurese de instalar el paquete locales-all.

    Nota

    «LANG=en_US» no es «LANG=C» ni «LANG=en_US.UTF-8». Es «LANG=
    en_US.ISO-8859-1» (consulte Sección 8.4.1, “Fundamentos de
    codificación”).

    Tabla 1.18. Relación de recomendaciones para la configuración
    regional

    +---------------------------------------------------------------+
    |recomendación de la configuración |    lengua (territorio)     |
    |             regional             |                            |
    |----------------------------------+----------------------------|
    |en_US.UTF-8                       |Inglés (USA)                |
    |----------------------------------+----------------------------|
    |en_GB.UTF-8                       |Inglés (Gran Bretaña)       |
    |----------------------------------+----------------------------|
    |fr_FR.UTF-8                       |Francés (Francia)           |
    |----------------------------------+----------------------------|
    |de_DE.UTF-8                       |Alemán (Alemania)           |
    |----------------------------------+----------------------------|
    |it_IT.UTF-8                       |Italiano (Italia)           |
    |----------------------------------+----------------------------|
    |es_ES.UTF-8                       |Español (España)            |
    |----------------------------------+----------------------------|
    |ca_ES.UTF-8                       |Catalán (España)            |
    |----------------------------------+----------------------------|
    |sv_SE.UTF-8                       |Sueco (Suecia)              |
    |----------------------------------+----------------------------|
    |pt_BR.UTF-8                       |Portugués (Brasil)          |
    |----------------------------------+----------------------------|
    |ru_RU.UTF-8                       |Ruso (Rusia)                |
    |----------------------------------+----------------------------|
    |zh_CN.UTF-8                       |Chino (República Popular de |
    |                                  |China)                      |
    |----------------------------------+----------------------------|
    |zh_TW.UTF-8                       |Chino (República de China   |
    |                                  |(Taiwan))                   |
    |----------------------------------+----------------------------|
    |ja_JP.UTF-8                       |Japonés (Japón)             |
    |----------------------------------+----------------------------|
    |ko_KR.UTF-8                       |Coreano (República de Corea)|
    |----------------------------------+----------------------------|
    |vi_VN.UTF-8                       |Vietnamita (Vietnam)        |
    +---------------------------------------------------------------+


    La forma más común de ejecutar la orden en un intérprete de
    órdenes es como se muestra.

    $ date
    Sun Jun  3 10:27:39 JST 2007
    $ LANG=fr_FR.UTF-8 date
    dimanche 3 juin 2007, 10:27:33 (UTC+0900)

    Aquí date(1) se ejecuta para diferentes valores de la variable de
    entorno «$LANG».

      * En la primera orden «$LANG» tiene el valor por defecto de la
        configuración regional «en_US.UTF-8».
   
      * En la segunda orden «$LANG» asigna la configuración regional
        a francés UTF-8 con el valor «fr_FR.UTF-8».

    La mayor parte de las órdenes ejecutadas no van precedidas de la
    definición de variables de entorno. Otra forma alternativa del
    ejemplo anterior es la que se muestra.

    $ LANG=fr_FR.UTF-8
    $ date
    dimanche 3 juin 2007, 10:27:33 (UTC+0900)

    Como puede comprobar la salida de la orden muestra la salida en
    francés ya que depende de la variable de entorno. Si se quiere
    que los subprocesos hereden la variable (p. ej. cuando se ejecuta
    un archivo de órdenes) necesita utilizar export como se muestra.

    $ export LANG

    Nota

    Cuando utiliza la terminal de consola normal, el entorno de
    escritorio asigna la variable de entorno «$LANG» para ser 
    exportada. Así el ejemplo anterior no es la mejor manera de
    comprobar el efecto de export.

    Sugerencia

    Cuando escriba un informe de error, si no utiliza un entorno en
    inglés, es una buena idea ejecutar y comprobar las órdenes con
    «LANG=en_US.UTF-8».

    Para completar sus conocimientos sobre «$LANG» y las variable de
    entorno relacionadas consulte locale(5) y locale(7).

    Nota

    Mi recomendación es que configure el entorno del sistema
    únicamente mediante la variable «$LANG» y evite la variables
    «$LC_*» a menos que sea absolutamente necesario.

%

1.5.3. La variable «$PATH»

    Cuando escribe una orden en el intérprete de órdenes, este busca
    la orden en la relación de directorios contenidos en la variable
    de entorno «$PATH». El valor de la variable de entorno «$PATH»
    también se le conoce como la ruta de búsqueda del intérprete de
    órdenes.

    En la instalación por defecto de Debian, la variable de entorno
    «$PATH» de las cuentas de usuario puede no incluir «/sbin» y «/
    usr/sbin». Por ejemplo, la orden ifconfig necesita ser ejecutada
    con la ruta completa con «/sbin/ifconfig». (Órdenes parecidas
    como ip están ubicadas en «/bin».)

    Puede cambiar la variable de entorno «$PATH» del intérprete de
    órdenes en los archivos «~/.bash_profile» o «~/.bashrc».

%

1.5.4. La variable «$HOME»

    Muchas órdenes almacenan configuraciones específicas del usuario
    en su directorio principal y cambian su comportamiento en función
    de estas. El directorio principal del usuario es determinado por
    el valor de la variable de entorno «$HOME».

    Tabla 1.19. Relación de valores de «$HOME»

    +---------------------------------------------------------------+
    |valor de «$HOME»|  características de ejecución del programa   |
    |----------------+----------------------------------------------|
    |/               |programa ejecutándose por el proceso init     |
    |                |(demonio)                                     |
    |----------------+----------------------------------------------|
    |/root           |programa ejecutándose desde el intérprete de  |
    |                |órdenes del superusuario                      |
    |----------------+----------------------------------------------|
    |/home/          |programa ejecutándose desde el intérprete de  |
    |<usuario_normal>|órdenes de un usuario normal                  |
    |----------------+----------------------------------------------|
    |/home/          |programa ejecutándose desde el menú en el     |
    |<usuario_normal>|escritorio gráfico de un usuario normal       |
    |----------------+----------------------------------------------|
    |/home/          |programa ejecutándose como superusuario con   |
    |<usuario_normal>|«sudo programa»                               |
    |----------------+----------------------------------------------|
    |/root           |programa ejecutándose como superusuario con   |
    |                |«sudo -H programa»                            |
    +---------------------------------------------------------------+


    Sugerencia

    El intérprete de órdenes sustituye «~/» por el directorio
    principal del usuario actual, esto es, «$HOME/». El intérprete de
    órdenes sustituye «~foo/» por el directorio principal del usuario
    foo, a saber, «/home/foo/».

%

1.5.5. Opciones de la línea de órdenes

    Algunas órdenes tienen parámetros. Se llaman opciones a los
    parámetros que comienzan con «-» o «--» y controlan el
    comportamiento de la orden.

    $ date
    Mon Oct 27 23:02:09 CET 2003
    $ date -R
    Mon, 27 Oct 2003 23:02:40 +0100

    Aquí el parámetro de la línea de la orden «-R» cambia el
    comportamiento de la salida de date(1) de acuerdo al formato
    estándar de fecha RFC2822.

%

1.5.6. Expansión de un patrón en el intérprete de órdenes

    A menudo querrá que una orden afecte a un grupo de archivos sin
    escribir el nombre de cada uno de ellos. Para cubrir esta
    necesidad existe la expansión de patrones de nombres de archivos
    dentro del intérprete de órdenes glob, (algunas veces también
    llamado uso de comodines).

    Tabla 1.20. Patrones para la expansión de nombres de archivos del
    intérprete de órdenes

    +---------------------------------------------------------------+
    |patrón|           descripción de la regla de encaje            |
    |------+--------------------------------------------------------|
    |*     |nombres de archivos que no comienza con «.»             |
    |------+--------------------------------------------------------|
    |.*    |nombres de archivos que comienza con «.»                |
    |------+--------------------------------------------------------|
    |?     |un único carácter                                       |
    |------+--------------------------------------------------------|
    |[…]   |un único carácter que pertenezca al grupo de caracteres |
    |      |entre corchetes                                         |
    |------+--------------------------------------------------------|
    |[a-z] |un único carácter con cualquier valor comprendido entre |
    |      |«a» y «z»                                               |
    |------+--------------------------------------------------------|
    |[^…]  |un único carácter que no pertenezca al grupo de         |
    |      |caracteres encerrados entre corchetes (excluyendo «^»)  |
    +---------------------------------------------------------------+


    Por ejemplo, intente lo siguiente

    $ mkdir junk; cd junk; touch 1.txt 2.txt 3.c 4.h .5.txt ..6.txt
    $ echo *.txt
    1.txt 2.txt
    $ echo *
    1.txt 2.txt 3.c 4.h
    $ echo *.[hc]
    3.c 4.h
    $ echo .*
    . .. .5.txt ..6.txt
    $ echo .*[^.]*
    .5.txt ..6.txt
    $ echo [^1-3]*
    4.h
    $ cd ..; rm -rf junk

    Consulte glob(7).

    Nota

    Si prueba «*» en la orden find(1) con «-name» test etc., encajará
    «.» como parte inicial del nombre de archivo, al contrario que en
    la expansión de nombres del intérprete de órdenes . (Esta es una
    funcionalidad nueva de POSIX)

    Nota

    BASH puede cambiar el comportamiento de la expansión de nombres
    de archivo con sus opciones internas como «dotglob», «noglob»,
    «nocaseglob», «nullglob», «extglob», etc. Consulte bash(1).

%

1.5.7. Valor devuelto por la orden

    Cada orden devuelve su estado de salida en el valor devuelto (en
    la variable: «$?»).

    Tabla 1.21. Códigos de salida de una orden

    +---------------------------------------------------------------+
    |estado de salida de una |  valor numérico   |   valor lógico   |
    |         orden          |     devuelto      |     devuelto     |
    |------------------------+-------------------+------------------|
    |éxito                   |cero, 0            |CIERTO            |
    |------------------------+-------------------+------------------|
    |error                   |diferente de cero, |FALSO             |
    |                        |-1                 |                  |
    +---------------------------------------------------------------+


    Por ejemplo, pruebe con lo que se muestra.

    $ [ 1 = 1 ] ; echo $?
    0
    $ [ 1 = 2 ] ; echo $?
    1

    Nota

    Tenga en cuenta que en el contexto lógico del intérprete de
    órdenes, éxito es tratado de forma lógica como CIERTO que tiene
    un valor 0 (cero). Quizá esto sea poco intuitivo y por ello
    necesite ser recordado.

1.5.8. Secuencias de órdenes comunes y redirecciones del intérprete
de órdenes

    Intentemos recordar las siguientes expresiones como parte de una
    orden de una única línea.

    Tabla 1.22. Expresiones de una orden

    +---------------------------------------------------------------+
    | expresión |                    descripción                    |
    |de la orden|                                                   |
    |-----------+---------------------------------------------------|
    |orden &    |ejecución en segundo plano de la orden en un       |
    |           |intérprete de órdenes hijo                         |
    |-----------+---------------------------------------------------|
    |orden1 |   |envía a la tubería la salida estándar de la orden1 |
    |orden2     |a la entrada estándar de la orden2 (se ejecutan de |
    |           |forma concurrente )                                |
    |-----------+---------------------------------------------------|
    |orden1 2>&1|envía a la tubería la salida estándar y el error   |
    || orden2   |estándar de la orden1 a la entrada estándar de la  |
    |           |orden2 (se ejecutan de forma concurrente )         |
    |-----------+---------------------------------------------------|
    |orden1 ;   |ejecuta la orden1 y la orden2 de forma secuencial  |
    |orden2     |                                                   |
    |-----------+---------------------------------------------------|
    |orden1 &&  |ejecuta la orden1; y si ha tenido éxito, ejecuta la|
    |orden2     |orden2 secuencialmente (devuelve éxito si tanto la |
    |           |orden1 como la orden2 finalizan con éxito)         |
    |-----------+---------------------------------------------------|
    |orden1 ||  |ejecuta la orden1; si no tiene éxito, se ejecuta la|
    |orden2     |orden2 de forma secuencial (devuelve éxito si      |
    |           |orden1 o orden2 se ejecutan con éxito)             |
    |-----------+---------------------------------------------------|
    |orden > foo|redirecciona la salida estándar de la orden al     |
    |           |archivo foo (y si existe lo sobreescribe)          |
    |-----------+---------------------------------------------------|
    |orden 2>   |redirecciona el error estándar de orden al archivo |
    |foo        |foo (sobreescribiendolo)                           |
    |-----------+---------------------------------------------------|
    |orden >>   |redirecciona la salida estándar de orden al        |
    |foo        |archivofoo (concatenándola)                        |
    |-----------+---------------------------------------------------|
    |orden 2>>  |redirecciona el error estándar de orden al archivo |
    |foo        |foo (concatenándola)                               |
    |-----------+---------------------------------------------------|
    |orden > foo|redirecciona salida estándar y el error estándar de|
    |2>&1       |orden al archivo foo                               |
    |-----------+---------------------------------------------------|
    |orden < foo|envia a la entrada estándar de orden el contenido  |
    |           |del archivo foo                                    |
    |-----------+---------------------------------------------------|
    |orden <<   |envía a la entrada estándar de orden las líneas    |
    |delimitador|siguientes hasta que encuentra un «delimitador»    |
    |           |(aquí el documento)                                |
    |-----------+---------------------------------------------------|
    |           |envía a la entrada estándar de la orden las líneas |
    |orden <<-  |siguientes hasta que se encuentre con el           |
    |delimitador|«delimitador» ( en las líneas de entrada los       |
    |           |tabuladores al inicio son eliminados)              |
    +---------------------------------------------------------------+


    El sistema Debian es un sistema multitarea. Mediante trabajos en
    segundo plano se pueden ejecutar por parte de los usuario
    múltiples programas desde un único intérprete de órdenes. La
    gestión de los procesos en segundo plano se realiza con las
    órdenes internas: jobs, fg, bg y kill. Por favor, lea las
    secciones de bash(1) «SIGNALS», «JOB CONTROL» y builtins(1).

    Por ejemplo, intente lo siguiente

    $ </etc/motd pager

    $ pager </etc/motd

    $ pager /etc/motd

    $ cat /etc/motd | pager

    Aunque los cuatro ejemplos de redirección del intérprete de
    órdenes son equivalentes, el último ejemplo ejecuta una orden más
    cat y desperdicia recursos sin razón alguna.

    El intérprete de órdenes permite abrir archivos utilizando la
    orden interna exec con un descriptor de archivo arbitrario.

    $ echo Hola >foo
    $ exec 3<foo 4>bar  # abre los archivos
    $ cat <&3 >&4       # redirige la entrada estándar (stdin) a 3 y la salida estándaar (stdout) a 4
    $ exec 3<&- 4>&-    # cierra los archivos
    $ cat bar
    Hola

    Los descriptores de archivo de 0 a 2 están predefinidos.

    Tabla 1.23. Descriptores de archivos predefinidos

    +--------------------------------------------------+
    |dispositivo|  descripción   |descriptor de archivo|
    |-----------+----------------+---------------------|
    |stdin      |entrada estándar|0                    |
    |-----------+----------------+---------------------|
    |stdout     |salida estándar |1                    |
    |-----------+----------------+---------------------|
    |stderr     |error estándar  |2                    |
    +--------------------------------------------------+


%

1.5.9. Alias de órdenes

    Usted puede definir alias para las órdenes más utilizadas.

    Por ejemplo, intente lo siguiente

    $ alias la='ls -la'

    Ahora, «la» funciona como forma corta de «ls -la» la cual muetra
    una relación de todos los archivos en el formato largo.

    Se pueden enumerar los alias existentes mediante alias (consulte
    el epígrafe «SHELL BUILTIN COMMANDS» de bash(1)).

    $ alias
    ...
    alias la='ls -la'

    Se puede determinar la ruta exacta o la identidad de la orden
    mediante «type» (consulte el epígrafe «SHELL BUILTIN COMMANDS» de
    bash(1)).

    Por ejemplo, intente lo siguiente

    $ type ls
    ls is hashed (/bin/ls)
    $ type la
    la is aliased to ls -la
    $ type echo
    echo is a shell builtin
    $ type file
    file is /usr/bin/file

    En el ejemplo anterior ls fue consultado recientemente y «file»
    no lo fue, de este modo «ls» está indexado, a saber, el
    intérprete de órdenes tiene un registro interno que determina
    rápidamente la ubicación de la orden «ls».

    Sugerencia
   
    Consulte Sección 9.2.7, “Órdenes coloreadas”.

%

1.6. Operaciones de texto al estilo de Unix

    En un entorno de trabajo del estilo de Unix, el tratamiento de
    texto se realiza por medio del uso de tuberías que unen un
    conjunto de herramientas para formar una cadena.. Esta fue otra
    de las innovaciones esenciales de Unix.

%

1.6.1. Herramientas de texto Unix

    Algunas herramientas que trabajan con texto son usada muy
    frecuntemente en un sistema tipo Unix.

      * Sin expresiones regulares se usan:

          + cat(1) genera a la salida el resultado de concaternar
            archivos;

          + tac(1) genera a la salida el resultado de concatenar al
            revés cada uno de los archivos;

          + cut(1) genera como salida la parte de las líneas
            seleccionadas;

          + head(1) muestra las primeras líneas de los archivos;

          + tail(1) muestra las últimas líneas de los archivos;

          + sort(1) ordena las líneas de los archivos de texto;

          + uniq(1) borra las líneas duplicadas de un archivo
            ordenado;

          + tr(1) sustituye o borra caracteres;

          + diff(1) compara archivos línea a línea.

      * Las expresiones regulares básicas (BRE) son usadas por:

          + grep(1) encaja texto con patrones;

          + ed(1) es un editor de texto antiguo;

          + sed(1) es un editor de flujo;

          + vim(1) es un editor interactivo;

          + emacs(1) es un editor interactivo (en cierta manera
            amplía BRE).

      * Las expresiones regulares ampliadas (ERE son utilizadas por:

          + egrep(1) encaja texto y patrones;

          + awk(1) realiza procesamiento de texto sencillo;

          + tcl(3tcl) puede realizar cualquier procesamiento de texto
            imaginable: consulte re_syntax(3). Frecuentemente se
            utiliza en combinación con tk(3tk);

          + perl(1) puede realizar cualquier procesamiento de texto
            imaginable. Consulte perlre(1);

          + pcregrep(1) del paquete pcregrep encaja texto con
            patrones expresados con Expresiones Regulares Compatibles
            con Perl(PCRE);

          + python(1) utilizando el módulo re puede realizar
            cualquier procesamiento de textos imaginable. Consulte «/
            usr/share/doc/python/html/index.html».

    Si no esta seguro de que hacen exactamente estas órdenes, por
    favor utilice «man orden» para averiguarlo por usted mismo.

    Nota

    El criterio de ordenación y alcance de las expresiones son
    dependientes de la configuración regional. Si desea obtener el
    comportamiento tradicional de una orden, utilice la configuración
    regional C en lugar de UTF-8 anteponiendo la orden «LANG=C»
    (consulte Sección 1.5.2, “La variable «$LANG»” y Sección 8.4,
    “Configuración regional”).

    Nota

    Las expresiones regulares de Perl(perlre(1)), Perl Compatible
    Regular Expressions (PCRE) y las expresiones regulares de Python
    ofrecidas por su módulo re tienen muchas expresiones comunes a
    las tradicionales ERE.

%

1.6.2. Expresiones regulares

    Las expresiones regulares son utilizadas por muchas herramientas
    de procesamiento de texto. Son similares a la expansión de
    nombres de archivo en el intérprete de órdenes, aunque más
    complicadas y poderosas.

    Las expresiones regulares especifican un patrón de encaje y está
    compuesto por caracteres de texto y metacaracteres.

    Un metacarácter es un carácter que tiene un significado especial.
    Existen dos tendencias principales, BRE y ERE dependiendo de cada
    herramienta de texto, como hemos descrito anteriormente.

    Tabla 1.24. Metacaracteres para BRE y ERE

    +---------------------------------------------------------------+
    |   BRE   | ERE  |     descripción de la expresión regular      |
    |---------+------+----------------------------------------------|
    |\ . [ ] ^|\ . [ |                                              |
    |$ *      |] ^ $ |metacaracteres comunes                        |
    |         |*     |                                              |
    |---------+------+----------------------------------------------|
    |\+ \? \( |      |                                              |
    |\) \{ \} |      |En BRE el único metacarácter de escape es «\» |
    |\|       |      |                                              |
    |---------+------+----------------------------------------------|
    |         |+ ? ( |En ERE el único metacarácter diferente de «\» |
    |         |) { } |de escape                                     |
    |         ||     |                                              |
    |---------+------+----------------------------------------------|
    |c        |c     |que encaja con el no metacarácter «c»         |
    |---------+------+----------------------------------------------|
    |\c       |\c    |encaja con un carácter literal «c» incluso si |
    |         |      |«c» representa un metacarácter                |
    |---------+------+----------------------------------------------|
    |.        |.     |encaja cualquier carácter incluyendo el de    |
    |         |      |nueva línea                                   |
    |---------+------+----------------------------------------------|
    |^        |^     |posición al comienzo de la cadena de          |
    |         |      |caracteres                                    |
    |---------+------+----------------------------------------------|
    |$        |$     |posición al final de la cadena de caracteres  |
    |---------+------+----------------------------------------------|
    |\<       |\<    |posición al comienzo de la palabra            |
    |---------+------+----------------------------------------------|
    |\>       |\>    |posición al final de la palabra               |
    |---------+------+----------------------------------------------|
    |[abc…]   |[abc…]|encaja cualquier carácter incluido en «abc...»|
    |---------+------+----------------------------------------------|
    |[^abc…]  |[^    |encaja con cualquier carácter excepto «abc…»  |
    |         |abc…] |                                              |
    |---------+------+----------------------------------------------|
    |r*       |r*    |encaja con cero o más «r», siendo «r» una     |
    |         |      |expresión regular                             |
    |---------+------+----------------------------------------------|
    |r\+      |r+    |encaja con una o más «r», siendo «r» una      |
    |         |      |expresión regular                             |
    |---------+------+----------------------------------------------|
    |r\?      |r?    |encaja con cero o una «r», siendo «r» una     |
    |         |      |expresión regular                             |
    |---------+------+----------------------------------------------|
    |r1\|r2   |r1|r2 |encaja una de las expresiones regulares «r1» o|
    |         |      |«r2»                                          |
    |---------+------+----------------------------------------------|
    |\(r1\|r2 |(r1|  |encaja una expresión regular «r1» o «r2» y    |
    |\)       |r2)   |tratada el resultado como una expresión       |
    |         |      |regular entre paréntesis                      |
    +---------------------------------------------------------------+


    Emacs utiliza principalmente el tipo de expresión regular BRE
    pero ha sido ampliada para utilizar «+» y «?» como metacaracteres
    como en ERE. De este modo, no es necesario añadirles el prefijo «
    \» en las expresiones regulares de emacs.

    grep(1) puede utilizarse para realizar búsquedas de texto por
    medio de expresiones regulares.

    Por ejemplo, intente lo siguiente

    $ egrep 'GNU.*LICENSE|Yoyodyne' /usr/share/common-licenses/GPL
    GNU GENERAL PUBLIC LICENSE
    GNU GENERAL PUBLIC LICENSE
    Yoyodyne, Inc., hereby disclaims all copyright interest in the program

    Sugerencia
   
    Consulte Sección 9.2.7, “Órdenes coloreadas”.

%

1.6.3. Sustitución de expresiones

    En la sustitución de expresiones, algunos caracteres tiene un
    significado especial.

    Tabla 1.25. Sustitución mediante expresiones regulares

    +---------------------------------------------------------------+
    | expresión  |        descripción del texto a reemplazar        |
    | sustituida |                                                  |
    |------------+--------------------------------------------------|
    |&           |lo que encaja con la expresión regular (utilice \&|
    |            |en emacs)                                         |
    |------------+--------------------------------------------------|
    |\n          |lo que encaja con la enésima expresión regular    |
    |            |entre paréntesis (donde «n» es un número)         |
    +---------------------------------------------------------------+


    La cadena de sustitución en Perl es «$&» en vez de «&» y «$n» en
    vez de «\n».

    Por ejemplo, intente lo siguiente

    $ echo zzz1abc2efg3hij4 | \
    sed -e 's/\(1[a-z]*\)[0-9]*\(.*\)$/=&=/'
    zzz=1abc2efg3hij4=
    $ echo zzz1abc2efg3hij4 | \
    sed -e 's/\(1[a-z]*\)[0-9]*\(.*\)$/\2===\1/'
    zzzefg3hij4===1abc
    $ echo zzz1abc2efg3hij4 | \
    perl -pe 's/(1[a-z]*)[0-9]*(.*)$/$2===$1/'
    zzzefg3hij4===1abc
    $ echo zzz1abc2efg3hij4 | \
    perl -pe 's/(1[a-z]*)[0-9]*(.*)$/=&=/'
    zzz=1abc2efg3hij4=

    En la sustitución de texto, en las diferentes herramientas,
    preste especial atención al encaje de las expresiones regulares 
    entre corchetes o paréntesis con las cadenas de caracteres.

    Algunos editores permiten la utilización de expresiones regulares
    para la búsqueda y/o sustitución de texto.

    En el intérprete de órdenes se puede escribir una misma orden en
    varias líneas anteponiendo el caraćter de barra invertida «\» al
    carácter de nueva línea que será sustituido por el vacío.

    Por favor, consulte las páginas de manual de estas órdenes.

%

1.6.4. Sustituciones globales mediante expresiones regulares

    La orden ed(1) permite sustituir todas las ocurrencias de
    «LA_EXPRESIÓN_REGULAR» por «EL_TEXTO» en el «archivo».

    $ ed file <<EOF
    ,s/EXPRESIÓN_REGULAR_A_SUSTITUIR/TEXTO_SUSTITUTO/g
    w
    q
    EOF

    La orden sed(1) sustituye todas las ocurrencias de
    «LA_EXPRESIÓN_REGULAR» por «EL_TEXTO» en el «archivo».

    $ sed -i -e 's/LA_EXPRESIÓN_REGULAR_A_SUSTITUIR/TEXTO_SUSTITUTO/g' archivo

    La orden vim(1) puede sustituir todas las ocurrencias de
    «LA_EXPRESIÓN_REGULAR» por «EL_TEXTO» en el «archivo» utilizando
    las órdenes ex(1).

    $ vim '+%s/LA_EXPRESIÓN_REGULAR_A_SUSTITUIR/TEXTO_SUSTITUTO/gc' '+w' '+q' archivo

    Sugerencia
   
    La bandera «c» de la orden anterior hace que se pida la
    confirmación interactiva de cada una de las sustituciones.

    Varios archivos pueden ser procesados de forma similar
    («archivo1», «archivo2» y «archivo3») mediante las expresiones
    regulares de vim(1) o perl(1).

    $ vim '+argdo %s/EXPRESIÓN_REGULAR_A_SUSTITUIR/TEXTO_SUSTITUTO/ge|update' '+q' archivo1 archivo2 archivo3

    Sugerencia
   
    La bandera «e» evita el error de «no encaje error» rompa la
    proceso de encaje múltiple.

    $ perl -i -p -e 's/EXPRESIÓN_REGULAR_A_SUSTITUIR/TEXTO_SUSTITUTO/g;' archivo1 archivo2 archivo3

    En el ejemplo en perl(1), «-i» es para la edición de cada
    elemento que encaja con el patrón y «-p» se utiliza para repetir
    la operación sobre cada uno de los archivos que aparecen como
    argumentos.

    Sugerencia

    La utilización del parámetro «-i.bak» en vez de «-i» mantiene
    cada archivo original añadiendole «.bak» al nombre del archivo.
    Esto permite deshacer los cambios de forma sencilla si nos hemos
    equivocado al realizar la sustitución.

    Nota
   
    ed(1) y vim(1) utiliza BRE; perl(1) utiliza ERE.

%

1.6.5. Extracción de datos en archivos de texto en forma de tabla

    Consideremos un archivo de texto llamado «DPL» con los siguientes
    campos: nombres de los líderes del proyecto Debian con
    anteriroridad a 2004 y su fecha de inicio, utilizando como
    separador el espacio en blanco.

    Ian     Murdock   Agosto  1993
    Bruce   Perens    Abril   1996
    Ian     Jackson   Enero 1998
    Wichert Akkerman  Enero 1999
    Ben     Collins   Abril   2001
    Bdale   Garbee    Abril   2002
    Martin  Michlmayr Marzo   2003

    Sugerencia
   
    Consulte «Historia breve de Debian» para conocer quién es el
    último lider del proyecto Debian.

    Awk se utiliza a menudo para obtener datos de este tipo de
    archivos.

    Por ejemplo, intente lo siguiente

    $ awk '{ print $3 }' <DPL                   # mes de comienzo
    Agosto
    Abril
    Enero
    Enero
    Abril
    Abril
    Marzo
    $ awk '($1=="Ian") { print }' <DPL          # DPL llamado Ian
    Ian     Murdock   August  1993
    Ian     Jackson   January 1998
    $ awk '($2=="Perens") { print $3,$4 }' <DPL # Cuando comenzó Perens
    Abril 1996

    Los intérprete de órdenes, como Bash, puede ser usado para
    analizar este tipo de archivos.

    Por ejemplo, intente lo siguiente

    $ while read first last month year; do
        echo $month
      done <DPL
    ... la misma salida que el primer ejemplo de Awk

    Aquí la orden interna read usa los caracteres de «$IFS»
    (separadores internos) para dividir las líneas en palabras.

    Si asigna el valor «:» a «$IFS», se puede analizar «/etc/passwd»
    con el intérprete de órdenes de la forma adecuada.

    $ anteriorIFS=«$IFS«   # guarda el valor actual
    $ IFS=':'
    $ while read user password uid gid resto_de_linea; do
        if [ "$usuario" = "bozo" ]; then
          echo "ID de $usuario es $uid"
        fi
      done < /etc/passwd
    ID de bozo es 1000
    $ IFS="$anteriorIFS"   # restaura el valor antiguo

    (Para hacer lo mismo con Awk asigne el separador de campos
    mediante «FS=':'».)

    El intérprete de órdenes utiliza IFS para separar los resultados
    de la expansión de parámetros, sustitución de órdenes y
    expansiones aritméticas. Las palabras entre comillas dobles o
    simples no son tenidas en cuenta en estas operaciones. El valor
    por defecto de IFS es la relación <espacio>, <tabulador> y
    <nueva_línea>.

    Tenga cuidado cuando utilice estos trucos en el intérprete de
    órdenes. Cuando el intérprete de órdenes trabaje en algunas
    partes de un archivo de órdenes y su entrada pueden ocurrir cosas
    extrañas.

    $ IFS=":,"                        # utiliza ":" y "," como IFS
    $ echo IFS=$IFS,   IFS="$IFS"     # muestra si es una función interna
    IFS=  , IFS=:,
    $ date -R                         # salida de la orden
    Sat, 23 Aug 2003 08:30:15 +0200
    $ echo $(date -R)                 # intérprete de órdenes hijo --> a la entrada del principal
    Sat  23 Aug 2003 08 30 36 +0200
    $ unset IFS                       # inicia IFS a su valor por defecto
    $ echo $(date -R)
    Sat, 23 Aug 2003 08:30:50 +0200

%

1.6.6. Fragmentos de órdendes utilizados con tuberías

    Los fragmentos de órdenes siguientes son muy potentes cuando
    forman parte de una cadena de órdenes unidas por tuberías.

    Tabla 1.26. Relación de fragmentos de órdenes con tuberías

    +---------------------------------------------------------------+
    |   fragmento de archivo de   |                                 |
    |órdenes (escrito en una única|       efecto de la orden        |
    |           línea)            |                                 |
    |-----------------------------+---------------------------------|
    |find /usr -print             |lista todos los archivos que se  |
    |                             |encuentran por debajo de «/usr»  |
    |-----------------------------+---------------------------------|
    |seq 1 100                    |escribe del 1 al 100             |
    |-----------------------------+---------------------------------|
    |                             |ejecuta la orden de forma        |
    || xargs -n 1 <orden>         |repetida para cada elemento de la|
    |                             |tubería y utilizando este como   |
    |                             |argumento                        |
    |-----------------------------+---------------------------------|
    |                             |divide los elementos de la       |
    || xargs -n 1 echo            |tubería separados por espacios en|
    |                             |líneas                           |
    |-----------------------------+---------------------------------|
    || xargs echo                 |une todas la líneas de la tubería|
    |                             |en una                           |
    |-----------------------------+---------------------------------|
    || grep -e                    |selecciona las líneas de la      |
    |<patrón_de_expresión_regular>|tubería que encajan con el       |
    |                             |<patrón_de_expresión_regular>    |
    |-----------------------------+---------------------------------|
    |                             |selecciona las líneas de la      |
    || grep -v -e                 |tubería que no tienen encaje con |
    |<patrón_de_expresión_regular>|el                               |
    |                             |<patrón_de_la_expresión_regular> |
    |-----------------------------+---------------------------------|
    |                             |selecciona el tercer campo de    |
    || cut -d: -f3 -              |cada línea de la tubería         |
    |                             |utilizando como separado «:»     |
    |                             |(archivo de contraseñas etc.)    |
    |-----------------------------+---------------------------------|
    |                             |selecciona el tercer campo de    |
    || awk '{ print $3 }'         |cada línea de la tubería         |
    |                             |utilizando como separador        |
    |                             |espacios en blanco               |
    |-----------------------------+---------------------------------|
    |                             |selecciona el tercer campo de    |
    || awk -F'\t' '{ print $3 }'  |cada línea de la tubería         |
    |                             |utilizando como separador el     |
    |                             |tabulador                        |
    |-----------------------------+---------------------------------|
    |                             |elimina los retornos de carro y  |
    || col -bx                    |sustituye los tabuladores por    |
    |                             |espacios                         |
    |-----------------------------+---------------------------------|
    || expand -                   |sustituye los tabuladores por    |
    |                             |espacios                         |
    |-----------------------------+---------------------------------|
    || sort| uniq                 |ordena y elimina duplicados      |
    |-----------------------------+---------------------------------|
    || tr 'A-Z' 'a-z'             |convierte mayúsculas a minúsculas|
    |-----------------------------+---------------------------------|
    || tr -d '\n'                 |concatena las líneas en una sola |
    |-----------------------------+---------------------------------|
    || tr -d '\r'                 |elimina el retorno de carro      |
    |-----------------------------+---------------------------------|
    || sed 's/^/# /'              |añade «#» al comienzo de cada    |
    |                             |línea                            |
    |-----------------------------+---------------------------------|
    || sed 's/\.ext//g'           |elimina «.ext»                   |
    |-----------------------------+---------------------------------|
    || sed -n -e 2p               |imprime la segunda línea         |
    |-----------------------------+---------------------------------|
    || head -n 2 -                |imprimer las primeras dos líneas |
    |-----------------------------+---------------------------------|
    || tail -n 2 -                |imprime las últimas dos líneas   |
    +---------------------------------------------------------------+


    Un archivo de órdenes de una sola línea puede repetirse sobre
    varios archivos utilizando find(1) y xargs(1) siendo capaz de
    realizar tareas muy complicadas. Consulte Sección 10.1.5, “Formas
    de selección de archivos” y Sección 9.3.9, “Repetición de una
    orden sobre archivos”.

    Cuando la utilización de órdenes de forma interactiva se complica
    demasiado debe considerarse escribir un archivo de órdenes
    (consulte Sección 12.1, “Los archivos de órdenes”).

Capítulo 2. Gestión de paquetes Debian

    Nota
   
    Este capítulo ha sido escrito según la última distribución
    estable, cuyo nombre de publicación es: bullseye.

    Debian es una organización constituida por voluntarios que
    construyen versiones de paquetes binarios precompilados 
    compatibles basados en software libre y lo distribuyen en su
    archivo,

    El archivo de Debian lo constituyen múltiples nodos espejo a los
    que se accede por medio de los protocolos HTTP y FTP. También
    esta disponible en CD-ROM/DVD.

    El sistema de gestión de paquetes Debian, cuando se usa de forma
    adecuada desde el archivo, ofrece al usuario la instalación en el
    sistema de un conjunto de paquetes binarios consistentes.
    Actualmente existen 62716 paquetes disponibles para la
    arquitectura amd64.

    El sistema de gestión de paquetes de Debian tiene un pasado
    enriquecedor y muchas opciones para el interfaz de usuario y para
    el motor de acceso al archivo. Le recomendamos los siguientes:

      * apt(8) para todas las operaciones de la línea de órdenes,
        incluidas la actualización de la distribución (dist-upgrade),
        la instalación y el borrado de paquetes. Dicha herramienta
        esta disponible desde Debian Jessie (Debian 8).

      * apt-get(8) para llamar desde los archivos de órdenes al
        sistema de gestión de paqutes de Debian. Es una opción de
        reserva en antiguos sistemas Debian en los que apt no esta
        disponible.

      * aptitude(8) para la gestión interactiva mediante interfaz de
        texto para la gestión de los paquetes instalados y búsquedas
        sobre los paquetes disponibles

    Tabla 2.1. Relación de herramientas para la gestión de paquetes
    de Debian

    +---------------------------------------------------------------+
    |      paquete      |popularidad|tamaño|      descripción       |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |«Advanced Packaging     |
    |                   |           |      |Tool» (APT), interfaz de|
    |                   |           |      |usuario de dpkg         |
    |                   |           |      |encargado de            |
    |apt                |V:868,     |4299  |proporcionar los métodos|
    |                   |I:999      |      |de acceso al archivo    |
    |                   |           |      |mediante «http», «ftp» y|
    |                   |           |      |«file» (incluye las     |
    |                   |           |      |órdenes apt/apt-get/    |
    |                   |           |      |apt-cache)              |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |gestor de paquetes      |
    |aptitude           |V:80, I:431|4249  |interactivo basado en la|
    |                   |           |      |terminal: aptitude(8)   |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |herramienta de selección|
    |                   |           |      |de tareas en la         |
    |tasksel            |V:36, I:975|393   |instalación de un       |
    |                   |           |      |sistema Debian (interfaz|
    |                   |           |      |de usuario para APT)    |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |paquete mejorado de APT,|
    |                   |V:324,     |      |para permitir la        |
    |unattended-upgrades|I:447      |325   |instalación automática  |
    |                   |           |      |de actualizaciones de   |
    |                   |           |      |seguridad               |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |gestor de paquetes      |
    |                   |           |      |basado en terminal (era |
    |dselect            |V:3, I:32  |2591  |el estándar anterior,   |
    |                   |           |      |interfaz de usuario de  |
    |                   |           |      |APT y otros métodos de  |
    |                   |           |      |acceso anteriores)      |
    |-------------------+-----------+------+------------------------|
    |dpkg               |V:925,     |6856  |sistema de gestión de   |
    |                   |I:999      |      |paquetes de Debian      |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |gestor de paquetes      |
    |synaptic           |V:47, I:320|7873  |gráfico (interfaz de    |
    |                   |           |      |usuario de GNOME para   |
    |                   |           |      |APT)                    |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |utilidades de APT:      |
    |apt-utils          |V:339,     |1162  |apt-extracttemplates(1),|
    |                   |I:996      |      |apt-ftparchive(1) y     |
    |                   |           |      |apt-sortpkgs(1)         |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |herramienta de          |
    |apt-listchanges    |V:369,     |421   |notificación de cambios |
    |                   |I:851      |      |en el histórico de      |
    |                   |           |      |paquetes                |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |relación de bugs        |
    |apt-listbugs       |V:7, I:12  |465   |críticos después de cada|
    |                   |           |      |instalación APT         |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |utilidad APT para la    |
    |apt-file           |V:18, I:78 |90    |búsqueda de paquetes —  |
    |                   |           |      |interfaz de línea de    |
    |                   |           |      |órdenes                 |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |relación de dependencias|
    |apt-rdepends       |V:0, I:6   |40    |recursivas de los       |
    |                   |           |      |paquetes                |
    +---------------------------------------------------------------+


2.1. Prerequisitos de la gestión de paquetes Debian

%

2.1.1. Configuración de paquetes

    Aquí se muestra algunos puntos fundamentales para realizr la
    configuración de paquetes de un sistema Debian:

      * Se respeta la configuración manual del administrador del
        sistema. Dicho de otra forma, por convenio el sistema de
        configuracion de paquetes no realiza configuraciones de
        manera intrusiva.

      * Cada paquete viene con su propio archivo de órdenes para su
        configuración con un interfaz de usuario estándar llamado 
        debconf(7) que facilita el proceso de la instalación inicial
        del paquete.

      * Los desarrolladores de Debian lo hacen lo mejor posible para
        que tenga una experiencia de actualización perfecta a través
        de los archivos de órdenes para la configuración del paquete.

      * Las funcionalidades completas del software empaquetado están
        disponibles para el administrador del sistema. Sin embargo,
        aquellas que representan riesgos para la seguridad están
        deshabilitadas en la instalación por defecto.

      * Si manualmente activa un servicio peligroso para la
        seguridad, será el responsable de los riesgos que contenga.

      * El administrador del sistema puede realizar manualmente
        configuraciones esotéricas. Esto puede interferir con los
        programas de ayuda estándar que se utilizan para la
        configuración del sistema.

%

2.1.2. Precauciones principales

    Aviso

    No mezcle paquetes de diferentes fuentes. Probablemente romperá
    la consistencia entre paquetes del sistema lo que requiere un
    conocimiento de su gestión interna, como son el compilador ABI,
    versiones de bibliotecas, funcionalidades de intérpretes, etc.

    Los administradores de sistemas novatos deberían utilizar la
    distribución «estable» de Debian y aplicar unicamente
    actualizaciones de seguridad. Queremos decir, que es mejor evitar
    algunas de las siguientes acciones válidas, como precaución,
    hasta que entienda el sistema Debian muy bien. Aquí están algunos
    consejos:

      * no incluya los repositorios de la distribución «en pruebas» o
        «inestable» en «/etc/apt/sources.list»;

      * no mezcle repositorios estándar de Debian con otros, como por
        ejemplo de Ubuntu en «/etc/apt/sources.list»;

      * no cree «/etc/apt/preferences»;

      * no cambie el comportamiento por defecto de las herramientas
        del gestión de paquetes por medio de sus archivos de
        configuración su no conoce todas sus implicaciones;

      * no instale paquetes de forma aleatoria por medio de «dpkg -i
        <paquete_aleatorio>»;

      * no instale paquetes de forma aleatoria mediante «dpkg
        --force-all -i <paquete_aleatorio>»;

      * no borre o modifique archivos en el directorio «/var/lib/
        dpkg»;

      * no sobreescriba el sistema de archivos al instalar software
        compilado directamente de su código fuente.

          + Si lo necesita instálelos en «/usr/local» o «/opt».

    Los efectos de falta de compatibilidad causado por las acciones
    anteriores sobre el sistema de gestión de paquetes Debian puede
    dejar su sistema inservible.

    Los administradores de sistemas Debian que operan servidores
    críticos, deberian tomar precauciones adicionales:

      * No instalar ningún paquete de Debian, incluyendo las
        actualizaciones de seguridad, sin probarlo con su
        configuración especifica en un entorno seguro.

          + en último término como administrador es el responsable de
            su sistema;

          + el largo historial de estabilidad del sistema Debian no
            es una garantía por sí misma.

%

2.1.3. Conviviendo con actualizaciones continuas

    Tras mis advertencias anteriores sé que muchos lectores desearán
    ejecutar las distribuciones de Debian «en prueba» o «inestable»
    como su sistema principal de escritorio. Esto es debido a que
    funcionan muy bien, son actualizados frecuentemente y disponen de
    las últimas funcionalidades.

    Atención

    Para sus servidores de producción es recomendable la distribución
    «estable» con sus actualizaciones de seguridad. También es
    recomendable para los equipos de escritorio a los que quiera
    dedicar poco tiempo en su administración.

    La configuración de la distribución elegida se realiza incluyendo
    su nombre en «/etc/apt/sources.list»: «testing», «unstable»; o su
    nombre de publicación: «bookworm», «sid». Esto le hará entrar en 
    el ciclo de las actualizaciones eternas.

    El uso de la distribución «en pruebas» o «inestable» es muy
    aparente pero acarrea algunos riesgos. Aunque la distribución
    «inestable» del sistema Debian permanece estable la mayor parte
    de tiempo ha habido algunos problemas de paquetes en las
    distribuciones del sistema Debian «en pruebas» e «inestable» y
    algunos de ellos no fueron fáciles de resolver. Lo cual puede
    resultarle muy doloroso. A veces tendrá paquetes rotos o pérdida
    de funcionalidades durante semanas.

    Algunas ideas para asegurar la recuperación fácil y rápida de
    errores en los paquetes de Debian son:

      * haga que su sistema tenga un arranque dual instalando la
        distribución «estable» en otra partición;

      * tenga un CD de la instalación manual para un arranque de
        rescate;

      * considere instalar apt-listbugs para comprobar la información
        del Sistema de Seguimiento de Errores Debian (BTS) antes de
        actualizar;

      * conozca suficientemente la infraestructura del sistema de
        paquetes para indagar cuando surjan problemas;

      * cree un entorno chroot o similar para comprobar las
        actualizaciones del sistema (consulte Sección 9.10, “Sistemas
        virtualizados”).

    (Si no puede realizar alguna de estas medidas de seguridad
    probablemente no esté preparado para las distribuciones «en
    prueba» e «inestable»).

    La iluminación de las siguientes secciones salva a las personas
    de la eterna lucha kármica de actualizar el infierno y las dejan
    llegar al nirvana de Debian.

%

2.1.4. Fundamentos del archivo de Debian

    Examinemos el archivo de Debian desde el punto de vista de un
    usuario del sistema.

    Sugerencia

    Las directrices oficiales del archivo de Debian están definidas
    en el Manual de Directrices Debian, Capítulo 2 - El archivo de
    Debian.

    Para el acceso normal mediante HTTP el archivo está definido en
    el archivo «/etc/apt/sources.list» de la siguiente manera, p. ej.
    para la sistema actual stable = bullseye.

    deb http://deb.debian.org/debian/ bullseye main contrib non-free
    deb-src http://deb.debian.org/debian/ bullseye main contrib non-free
   
    deb http://security.debian.org/ bullseye/updates main contrib
    deb-src http://security.debian.org/ bullseye/updates main contrib

    Entre el nombre de publicación «bullseye» o el nombre de la
    distribución «estable» prefiero inclinarme por el primero para
    evitar sorpresas cuando se libere la nueva distribución
    «estable».

    El significado de «/etc/apt/sources.list» está descrito en 
    sources.list(5) y los puntos más importantes son:

      * la línea «deb» se define para paquetes binarios;

      * la línea «deb-src» se define para los paquetes de código
        fuente;

      * el primer elemento es la URL raíz del archivo de Debian;

      * el segundo elemento es el nombre de la distribución: bien el
        nombre de la distribución o el nombre de publicación;

      * el tercero y siguientes son la relación de nombres de área
        válidos del archivo de Debian.

    Las líneas «deb-src» pueden ser omitadas de forma segura (o
    comentadas añadiendo «#» al comienzo de la línea) haciendo que
    aptitude no tenga acceso a la metainformación de las fuentes. La
    URL puede utilizar los protocolos «http://», «ftp://», «file://»,
    ….

    Sugerencia

    Si en el ejemplo anterior se sustituye «sid» en vez de «bullseye»
    no se necesita la línea para las actualizaciones de seguridad
    «deb: http://security.debian.org/ …» en «/etc/apt/sources.list».
    Esto es debido a que no hay área de actualizaciones de seguridad
    en «sid» (unstable).

    A continuación se muestra la relación de los archivos de Debian,
    junto con sus nombres de distribución o su nombre de publicación,
    utilizados por el archivo de configuración.

    Tabla 2.2. Relación de sitios de archivo de Debian

    +---------------------------------------------------------------+
    |  URL del archivo  |nombre de distribución (y |   propósito    |
    |                   |     de publicación)      |                |
    |-------------------+--------------------------+----------------|
    |https://           |                          |distribución    |
    |deb.debian.org/    |«stable» (bullseye)       |«estable»       |
    |debian/            |                          |(bullseye)      |
    |-------------------+--------------------------+----------------|
    |https://           |                          |distribución «en|
    |deb.debian.org/    |«testing» (bookworm)      |pruebas»        |
    |debian/            |                          |(bookworm)      |
    |-------------------+--------------------------+----------------|
    |https://           |                          |distribución    |
    |deb.debian.org/    |«unstable» (sid)          |«inestable»     |
    |debian/            |                          |(sid)           |
    |-------------------+--------------------------+----------------|
    |                   |                          |distribución    |
    |https://           |                          |previa          |
    |deb.debian.org/    |«experimental»            |«experimental»  |
    |debian/            |                          |(opcional, solo |
    |                   |                          |para desarrollo)|
    |-------------------+--------------------------+----------------|
    |                   |                          |actualizaciones |
    |https://           |                          |para la         |
    |deb.debian.org/    |«stable-proposerd-updates»|siguiente       |
    |debian/            |                          |distribución    |
    |                   |                          |«estable»       |
    |                   |                          |(opcional)      |
    |-------------------+--------------------------+----------------|
    |                   |                          |actualizaciones |
    |http://            |                          |de seguridad    |
    |security.debian.org|«stable/updates»          |para la         |
    |/                  |                          |distribución    |
    |                   |                          |«estable»       |
    |                   |                          |(importante)    |
    |-------------------+--------------------------+----------------|
    |                   |                          |actualizaciones |
    |http://            |                          |de seguridad    |
    |security.debian.org|«testing/updates»         |para la         |
    |/                  |                          |distribución «en|
    |                   |                          |pruebas»        |
    |                   |                          |(importante)    |
    |-------------------+--------------------------+----------------|
    |                   |                          |actualizaciones |
    |https://           |                          |compatibles     |
    |deb.debian.org/    |bullseye-updates          |sobre filtros de|
    |debian/            |                          |spam, clientes  |
    |                   |                          |IM, etc. para   |
    |                   |                          |bullseye        |
    |-------------------+--------------------------+----------------|
    |https://           |                          |paquetes nuevos |
    |deb.debian.org/    |bullseye-backports        |adaptados a     |
    |debian/            |                          |bullseye        |
    |                   |                          |(opcional)      |
    +---------------------------------------------------------------+


    Atención

    La mejor estabilidad se consigue utilizando únicamente la
    distribución «estable» con las actualizaciones de seguridad.
    Utilizar la mayor parte de la distribución «estable» y algunos
    paquetes de las distribución «en pruebas» o «inestable» es más
    inestable que ejecutar únicamente la distribución «inestable»
    debido al acoplamiento de las versiones de las bibliotecas etc.
    Si realmente necesita la última versión de algún programa que no
    esté en «estable» le pedimos que utilice los paquetes del archivo
    bullseye-updates y http://backports.debian.org (consulte
    Sección 2.7.4, “Actualizaciones y portes hacia atrás”). Dichos
    archivos deben usarse con sumo cuidado.

    Atención

    Por defecto debería tener únicamente una de las distribuciones
    «estable», «en pruebas» o «inestable» en las líneas «deb». Si se
    tiene en las líneas «deb» una combinación de las distribuciones
    «estable», «en pruebas» e «inestable» los programas APT son más
    lentos y sólo la última distribución es útil. El uso de múltiples
    distribuciones requiere utilizar el archivo «/etc/apt/
    preferences» con un fin específico (consulte Sección 2.7.3,
    “Seleccionando la versión candidata”).

    Sugerencia

    En un sistema Debian que utilice «estable» y/o «en pruebas» es
    una buena práctica incluir las líneas correspondientes «http://
    security.debian.org/» en «/etc/apt/sources.list» para permitir
    las actualizaciones de seguridad como se mostró en el ejemplo
    anterior.

    Nota

    El equipo de seguridad de Debian soluciona los problemas de
    seguridad de la distribución «estable». Su actividad es muy
    rigurosa y fiable. En la distribución «en pruebas» son
    solucionados por el equipo de seguridad de Debian en pruebas. Por
    diferentes razones su actividad no es tan rigurosa como en la
    distribución «estable» y puede que tenga que esperar a la
    migración o la corrección de los paquetes de «inestable». Los
    problemas de seguridad de la distribución «inestable» son
    corregidos por los desarrolladores individuales. Los paquetes de
    la distribución «inestable» mantenidos habitualmente suelen estar
    en buen estado aprovechando las últimas soluciones de seguridad
    ascendentes. Consulte Debian security FAQ para conocer como se
    gestionan los problemas de seguridad en Debian.

    Tabla 2.3. Relación de áreas de archivo Debian

    +---------------------------------------------------------------+
    |  área  |  número de   |  criterio de componente del paquete   |
    |        |   paquetes   |                                       |
    |--------+--------------+---------------------------------------|
    |main    |61595         |cumplen con DFSG y sin dependencias con|
    |        |              |non-free                               |
    |--------+--------------+---------------------------------------|
    |contrib |349           |cumplen con DFSG pero con dependencias |
    |        |              |con non-free                           |
    |--------+--------------+---------------------------------------|
    |non-free|772           |no cumplen con DFSG                    |
    +---------------------------------------------------------------+


    El número de paquetes que se indica es para la arquitectura
    amd64. El área main proporciona el sistema Debian (consulte
    Sección 2.1.5, “Debian es 100% software libre”).

    Al navegar por cada URL junto a dists o pool conocerá mejor la
    organización del archivo de Debian.

    Una distribución puede ser nombrada de dos formas, por la
    distribución o nombre de publicación. La palabra distribución es
    usada de forma inambigua como sinónimo de versión en gran parte
    de la documentación. La relación existente entre la distribución
    y el nombre de publicación se resume en la tabla siguiente.

    Tabla 2.4. Relación entre los nombres de publicación y
    distribución

    +---------------------------------------------------------------+
    |     Momento     |distribución = |distribución = |distribución |
    |                 |    estable    | «en pruebas»  |= «inestable»|
    |-----------------+---------------+---------------+-------------|
    |después de la    |nombre de      |nombre de      |nombre de    |
    |publicación de   |publicación =  |publicación =  |publicación =|
    |bullseye         |bullseye       |bookworm       |sid          |
    |-----------------+---------------+---------------+-------------|
    |después de la    |nombre de      |nombre de      |nombre de    |
    |publicción de    |publicación =  |publicación =  |publicación =|
    |bookworm         |bookworm       |trixie         |sid          |
    +---------------------------------------------------------------+


    La historia de los nombres de publicación se cuenta en ¿Debian
    FAQ: 6.2.1 Qué otros nombres clave han sido usados en el pasado?

    En la terminología de archivo de Debian de forma estricta, se usa
    la palabra «sección» especificamente para la categorización de
    paquetes por el tipo de aplicación. (Sin embargo las palabras
    «sección principal» algunas veces es usado para describir el área
    del archivo Debian llamado «main».)

    Cada vez que un desarrollador Debian (DD) realiza una nueva
    entrega a la distribución «inestable» (a través del procesamiento
    de entrada), se les pide que se aseguren que la entrega de
    paquetes sea compatible con el último conjunto de paquetes de la
    distribución «inestable».

    Si un desarrollador de Debian con su actualización rompe la
    compatibilidad de alguna biblioteca importante de forma
    intencionada etc, normalmente se anuncia en la lista de correo de
    desarrollo (debian-devel mailing list) etc.

    Después de que un conjunto de paquetes han sido movidos de forma
    automática desde la distribución «inestable» a la distribución
    «en pruebas» el archivo de órdenes de mantenimiento que lo movió
    comprueba su madurez (más de 10 días de antiguedad), el estado RC
    de los informes de errores de los paquetes y comprueba su
    compatibilidad con el último conjunto de paquetes de la
    distribución «en pruebas». Este proceso hace que la distribución
    «en pruebas» este actualizada y se pueda utilizar.

    Durante el proceso gradual de estabilización del archivo,
    liderado por el equipo de publicación, la distribución «en
    pruebas» se va corrigiendo por medio de intervenciones manuales
    para hacerla completamente consistente y libre de errores.
    Entonces se crea la nueva distribución «estable» asignándole a
    esta el nombre de publicación de la antigua distribución «en
    pruebas». También se crea un nuevo nombre de publicación para la
    nueva distribución «en pruebas». El contenido inicial de la nueva
    distribución «en pruebas» es exactamente el mismo que el de la
    nueva versión de la distribución «estable».

    Tanto la distribución «inestable» como la distribución «en
    pruebas» pueden sufrir fallos técnicos temporales debido a
    diferentes factores:

      * entrega de paquetes rotos al archivo (más frecuentemente a
        «inestable»);

      * retraso en la aceptación de nuevos paquetes al archivo (en la
        mayor parte de los casos en «inestable»);
   
      * problemas de sincronización de cadencia (para «en pruebas» e
        «inestable»);

      * acciones manuales sobre el archivo como la eliminación de
        paquetes (generalmente para «en pruebas») etc.

    Así que si decide usar esos archivos, usted debe ser capaz de
    arreglar o indagar sobre este tipo de problemas.

    Atención

    Incluso unos meses después de la publicación de una nueva
    distribución «estable», la mayoría de los usuarios de escritorio
    deberían usar dicha distribución junto con sus actualizaciones de
    seguridad a pesar de usar de forma habitual las distribuciones
    «en pruebas» o «inestable». Durante este periodo de transición,
    tanto «inestable» como «en pruebas» no son útiles para la mayor
    parte de la gente. La distribución «inestable» es difícil de
    mantener en buenas condiciones de funcionamiento ya que sufre
    repentinamente actualizaciones importantes de los paquetes
    principales. La distribución «en pruebas» tampoco es utilizable
    ya es idéntica a la distribución «estable» pero sin soporte de
    seguridad (Anuncio de 12-2008 de seguridad en pruebas de Debian).
    Después de un mes aproximadamente la distribución «inestable» se
    puede utilizar con cuidado.

    Sugerencia

    Al utilizar la distribución «en pruebas» el problema causado por
    la eliminación de un paquete normalmente se soluciona
    temporalmente instalando el paquete correspondiente la
    distribución «inestable» el cual será entregado para corregir el
    error.

    Consulte el Manual de Directrices Debian para obtener más
    información sobre las definiciones del archivo.

      * «Secciones»

      * «Prioridades»
   
      * «Sistema base»

      * «Paquetes esenciales»

%

2.1.5. Debian es 100% software libre

    Debian es 100% software libre ya que:

      * Debian instala por defecto únicamente software libre para
        respetar las libertades del usuario.

      * Debian proporciona únicamente software libre en el área
        principal.
   
      * Debian recomienda ejecutar únicamente el software libre del
        área principal.

      * Ningún paquete del área principal depende o recomienda
        paquetes de non-free o contrib.

    Algunas personas se preguntan si los siguientes 2 hechos se
    contradicen o no:

      * «Debian se mantendrá 100% libre». (Es la primera claúsula del
        Contrato Social de Debian)
   
      * los servidores de Debian albergan algunos paquetes de
        non-free y contrib

    Esto no se contradice por lo siguiente:

      * el sistema Debian es 100% libre y sus paquetes son albergados
        por los servidores Debian en el área principal
   
      * los paquetes de fuera del sistema Debian son albergados por
        los servidores Debian en las áreas non-free y contrib.

    Se explica de forma precisa en las claúsulas cuarta y quinta del
    Contrato Social de Debian:

      * Nuestra prioridad son nuestros usuarios y el software libre

          + Nos guiaremos por las necesidades de nuestros usuarios y
            de la comunidad del software libre. Sus intereses serán
            una prioridad para nosotros. Daremos soporte a las
            necesidades de nuestros usuarios para que puedan trabajar
            en muchos tipos distintos de entornos de trabajo. No
            pondremos objeciones al software no libre que vaya a
            ejecutarse sobre Debian ni cobraremos a las personas que
            quieran desarrollar o usar ese tipo de software (no
            libre). Permitiremos a otros crear distribuciones de
            valor añadido basadas en Debian sin cobrarles nada por
            ello. Es más, entregaremos un sistema integrado de alta
            calidad sin restricciones legales que pudieran prevenir
            este tipo de uso.
   
      * Trabajos que no siguen nuestros estándares de software libre

          + Reconocemos que algunos de nuestros usuarios necesitan
            usar trabajos que no sigan las directrices de software
            libre de Debian (DFSG). Por ello, hemos creado las
            secciones «contrib» y «non-free» en nuestro archivo para
            estos trabajos. Los paquetes en estas secciones no son
            parte del sistema Debian, aunque han sido configurados
            para usarse con Debian. Animamos a los distribuidores de
            CDs a que lean las licencias de los paquetes en estas
            secciones para poder determinar si pueden distribuir este
            software en sus CDs. Así pues, aunque los trabajos que no
            sean libres no son parte de Debian, damos soporte para su
            uso, y proporcionamos infraestructura (como nuestro
            sistema de informe de errores y listas de distribución)
            para paquetes no libres.

    Los usuarios deben ser conscientes de los riesgos que asumen al
    utilizar los paquetes de las áreas non-free y contrib:

      * restricciones a la libertad con dichos paquetes

      * falta de soporte de Debian para dichos paquetes (Debian no
        puede ayudar al software propietario por no tener acceso a su
        código fuente)

      * contagio al 100% del sistema libre Debian

    Las Directrices de Software Libre Debian son los estándares del
    software libre de Debian. Debian entiende «software» en un ámbito
    amplio, incluidos los documentos, firmware, logotipos y materia
    gráfico de los paquetes. Esto hace que el estándar de software
    libre de Debian sea uno de los más estrictos.

    Con el fin de cumplir con los estrictos estándares del software
    libre de main, Debian eliminó la marca Mozilla de paquetes como
    Firefox, Thunderbird y Seamonkey eliminando su logotipo y otro
    material gráfico y los ponía a disposición como Iceweasel,
    Icedove, e Iceape, respectivamente. Estos paquetes desde la
    publicación de Debian Stretch (Debian 9) han recuperado sus
    nombres originales una vez solucionado el problema.

    Los paquetes más frecuentes en non-free y contrib son paquetes de
    libre distribución pertenecientes a alguno de los tipos:

      * paquetes de documentación que cumplen la Licencia de
        Documentación Libre GNU con secciones fijas como las de GCC y
        Make (la mayor parte se encuentran en la secciónnon-free/
        doc.)

      * los paquetes de firmware contienen datos binarios sin su
        código fuente como los enumerados en Sección 9.9.6,
        “Controladores y firware del hardware” como non-free (la
        mayor parte en sección non-free/kernel.)

      * paquetes de juegos y tipos de letra con restricciones para su
        uso comercial y/o modificación de su contenido

    Dese cuenta que el número de paquetes en non-free y contrib es
    menos del dos por ciento del número de paquetes de main. El
    permitir el acceso a las áreas non-free y contrib no oculta el
    origen del paquete. Al utilizar aptitude(8) a pantalla completa
    le proporciona una vista holística y el control sobre los
    paquetes que están instalados y a qué área pertenecen para poder
    mantener su sistema tan libre como desee.

%

2.1.6. Dependencias de paquetes

    El sistema Debian ofrece un conjunto coherente de paquetes
    binarios proporcinado por su mecanismo de declaración de
    dependencias entre paquetes binarios por medo de los campos de
    control de archivos. Aquí se muestra una versión simplificada de
    ello:

      * «Depende» (Depends)

          + Declara una dependencia obligatoria y es obligatorio que
            todos los paquetes enumerados sean instalados al mismo
            tiempo o que estén instalados previamente.

      * «Predepende» (Pre-depends)

          + Son como las dependencias, con la excepción de que es
            obligatorio que estén instalados completamente con
            anterioridad.

      * «Recomienda» (Recommends)

          + Determina una dependencia fuerte, pero no obligatoria. La
            mayoría de los usuarios no querrán instalar el paquete al
            menos que todos los paquetes enumerados en este campo
            estén instalados.

      * «Sugiere» (Suggests)

          + Declara una dependencia débil. Muchos usuario podrían
            beneficiarse de su instalación si bien tendrán una
            funcionabilidad suficiente sin ellos.

      * «Mejora» (Enhances)
   
          + Declara una dependencia débil como «sugeridas» pero
            funciona en la dirección contraria.

      * «Rompe» (Breaks)

          + Declara una incompatibilidad, generalmente con una
            versión concreta. La solución más común es actualizar
            todos los paquetes que se encuentran enumerados en este
            campo.

      * «Incompatibles» (Conflicts)

          + Declara su total incompatibilidad. Todos los paquetes
            enumerados en este campo deben ser eliminados para
            conseguir instalar el paquete.

      * «Sustituye» (Replaces)

          + Se declara cuando los archivos instalados por el paquete
            sustituyen a los archivos de los paquetes que se
            enumeran.

      * «Proporciona» (Provides)

          + Se declara cuando el paquete proporciona todos los
            archivos y funcionalidades de los paquetes enumerados.

    Nota

    Tenga en cuenta, que lo correcto es definir «Proporciona»,
    «Imcompatible» y «Sustituye» a la vez en el caso de un paquete
    virtual. Esto asegura que solo un paquete real que proporciona el
    virtual puede ser instalado a la vez.

    La definición «oficial», incluyendo la dependencia del código
    fuente, está en Manual de directrices de Debian: Capítulo 7 -
    Declaración de relaciones entre paquetes.

%

2.1.7. Flujo de eventos de las órdenes de gestión de paquetes

    Aquí hay un resumen simplificado del flujo de eventos de las
    órdenes de gestión de paquetes con APT:

      * «Update» («apt update», «aptitude update» o «apt-get
        update»):

         1. Recupera los metadatos del archivo remoto

         2. Reconstruye y actualiza la copia local de los metadatos
            del archivo que utiliza APT

      * «Upgrade» («apt upgrade» y «apt full-upgrade» o «aptitude
        safe-upgrade» y «aptitude full-upgrade» o «apt-get upgrade» y
        «apt-get dist-upgrade»):

         1. Para todos los paquetes instalados elige las versiones
            candidatas que normalmente son las últimas disponibles
            (las excepciones están explicadas en Sección 2.7.3,
            “Seleccionando la versión candidata” )

         2. Realiza la resolución de dependencias del paquete

         3. Recupera del archivo remoto los paquetes binarios que han
            sido seleccionados si la versión candidata es diferente
            de la versión instalada

         4. Desempaqueta los paquetes binarios recuperados

         5. Ejecuta el archivo de órdenes preinst

         6. Instala los archivos binarios

         7. Ejecuta el arhivos de órdenes postinst

      * «Install» («apt install …», «aptitude install …» o «apt-get
        install …»):

         1. Selecciona los paquetes de la relación de la línea de
            órdenes

         2. Realiza la resolución de dependencias del paquete

         3. Recupera del repositorio remoto los archivos binarios que
            han sido seleccionados

         4. Desempaqueta los paquetes binarios recuperados

         5. Ejecuta el archivo de órdenes preinst

         6. Instala los archivos binarios

         7. Ejecuta el arhivos de órdenes postinst

      * «Remove» («apt remove …», «aptitude remove …» o «apt-get
        remove …»):

         1. Selecciona los paquetes de la relación de la línea de
            órdenes

         2. Realiza la resolución de dependencias del paquete

         3. Ejecuta el archivo de órdenes prerm

         4. Elimina los archivos instalados excepto los archivos de
            configuración

         5. Ejecuta el archivo de órdenes postrm

      * «Purge» («apt purge …», «aptitude purge …» o «apt-get purge
        …»):

         1. Selecciona los paquetes de la relación de la línea de
            órdenes

         2. Realiza la resolución de dependencias del paquete

         3. Ejecuta el archivo de órdenes prerm

         4. Elimina los archivos instalados incluidos los archivos de
            configuración

         5. Ejecuta el archivo de órdenes postrm

    De forma intencionada, se han eliminado los detalles técnicos en
    beneficio de la visión holística.

%

2.1.8. Soluciones a problemas básicos en la gestión de paquetes

    Debería leer la documentación oficial al respecto. Concretamente,
    ell primer documento a leer sería «/usr/share/doc/
    <nombre_del_paquete>/README.Debian». Otra documentación a
    consultar sería «/usr/share/doc/<nombre_del_paquete>/». Si tiene
    asignado como intérprete de órdenes Sección 1.4.2,
    “Personalización de bash”, escriba lo siguiente:

    $ cd <nombre_del_paquete>
    $ pager README.Debian
    $ mc

    Para obtener información especifica puede que necesite instalar
    el paquete de documentación correspondiente con el sufijo «-doc».

    Si tiene problemas con un paquete concreto, asegúrese de
    comprobar primero el sistema de seguimiento de errores Debian
    (BTS).

    Tabla 2.5. Relación de los principales sitios web para resolver
    problemas de un paquete concreto

    +---------------------------------------------------------------+
    |           sitio web            |            orden             |
    |--------------------------------+------------------------------|
    |Página principal de el sistema  |sensible-browser «https://    |
    |de seguimiento de errores Debian|bugs.debian.org/»             |
    |(BTS)                           |                              |
    |--------------------------------+------------------------------|
    |El informe de errores con el    |sensible-browser «https://    |
    |nombre de un paquete            |bugs.debian.org/              |
    |                                |<nombre_del_paquete>»         |
    |--------------------------------+------------------------------|
    |El informe del error, si se     |sensible-browser «https://    |
    |conoce su número de error       |bugs.debian.org/              |
    |                                |<número_de_error>»            |
    +---------------------------------------------------------------+


    Búsqueda en Google incluyendo alguno de los siguientes criterios
    de búsqueda «site:debian.org», «site:wiki.debian.org»,
    «site:lists.debian.org», etc.

    Cuando presente un informe de error, por favor utilice la orden 
    reportbug(1).

%

2.2. Operaciones básicas de la gestión de paquetes

    Un sistema Debian dispone de diferentes herramientas basadas en
    APT para llevar a cabo las operaciones de gestión de paquetes. En
    este documento explicaremos tres herrramientas básicas para la
    gestión de paquetes: apt, apt-get / apt-cache y aptitude.

    Para realizar las operaciones de gestión de paquetes que incluyen
    su instalación o la actualización de su metainformación
    necesitará privilegios de superusuario.

%

2.2.1. apt vs. apt-get / apt-cache vs. aptitude

    A pesar de que aptitude es una herramienta interactiva muy
    amigable el cual es la que utilizo personalmente por defecto,
    debe tener en cuenta algunas advertencias:

      * la orden aptitude no es recomendable para actualizaciones del
        sistema entre distrubuciónes del sistema Debian estable tras
        la publicación de una distribución nueva .

          + para ello está recomendado la utilización de «apt
            full-upgrade» o «apt-get dist-upgrade». Consulte el Error
            #411280.

      * La orden aptitude algunas veces recomienda la eliminación
        masiva de paquetes para la actualización del sistema Debian
        «en pruebas» o «inestable».

          + Esta situación ha aterrado a muchos administradores de
            sistema. No se asuste.

          + parece causado principalmente por la distorsión de
            dependencias o recomendaciones de paquetes por
            metapaquetes como gnome-core.

          + se resuelve eligiendo «Cancelar las acciones pendiente»
            en el menú de órdenes de aptitude, saliendo de aptitude y
            utilizando «apt full-upgrade».

    Las órdenes apt-get y apt-cache son las herramientas más básicas
    basadas en APT para la gestión de paquetes .

      * apt-get y apt-cache ofrecen únicamente interfaz de usuario
        por línea de órdenes.

      * apt-get es más adecuado para la actualización principal del
        sistema entre distribuciones, etc.

      * apt-get tiene un motor robusto para la resolución de
        dependencias entre los paquetes.

      * apt-get necesita menos recursos «hardware». Utiliza menos
        memoria y se ejecuta más rápido.

      * apt-cache tiene un sistema estándar de búsqueda que utiliza
        expresiones regulares sobre el nombre y la descripción del
        paquete.

      * apt-get y apt-cache permiten gestionar varias versiones de
        mismo paquete utilizando /etc/apt/preferences aunque es
        bastante difícil de manejar.

    La orden apt es un interfaz de alto nivel para la gestión de
    paquetes desde la línea de órdenes. Es un recubrimiento de
    apt-get, apt-cache y órdenes parecidas ideado para ser utilizado
    por el usuario final y mejorar por defecto algunas opciones de
    uso interactivo.

      * apt tiene una barra de progreso cuando se instalan paquetes
        mediante apt install.
   
      * por defecto apt borra los paquetes .deb descargados en la
        caché después de instalarlos con éxito

    Sugerencia

    Se recomienda la utilización de la nueva orden apt(8) para el uso
    interactivo y utilizar apt-get(8) y apt-cache(8) para los
    archivos de órdenes.

    La orden aptitude es la herramienta de gestión de paquetes basada
    en APT más flexible.

      * aptitude tiene un interfaz de usuario interactivo a pantalla
        completa.

      * aptitude también posee un interfaz de usuario por línea de
        órdenes.

      * aptitude esta más pensado para operaciones de la gestión
        interactiva de paquetes diaria como examinar los paquetes
        instalados y buscar entre los paquetes disponibles.

      * aptitude necesita más recursos «hardware». Utiliza más
        memoria y se ejecuta más lentamente.

      * aptitude tiene un sistema de búsqueda mejorado basado en
        expresiones regulares sobre metainformación de paquetes.

      * aptitude permite gestionar múltiples versiones de paquetes
        sin utilizar /etc/apt/preferences y es muy intuitivo.

2.2.2. Operaciones básicas de gestión de paquetes utilizando la línea
de órdenes

    Aquí están algunas operaciones básicas para la gestión de
    paquetes por medio de la línea de órdenes utilizando apt(8), 
    aptitude(8) y apt-get(8) /apt-cache(8).

    Tabla 2.6. Operaciones básicas de gestión de paquetes utilizando la
    línea de órdenes apt(8), aptitude(8) y apt-get(8)/apt-cache(8)

    +-------------------------------------------------------------------------------+
    |  Sintaxis de apt  |    Sintaxis de    |Sintaxis de apt-get|    descripción    |
    |                   |     aptitude      |    /apt-cache     |                   |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |actualiza la       |
    |apt update         |aptitude update    |apt-get update     |metainformación de |
    |                   |                   |                   |los paquetes       |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |instala la versión |
    |apt install foo    |aptitude install   |apt-get install foo|candidata del      |
    |                   |foo                |                   |paquete «foo» y sus|
    |                   |                   |                   |dependecias        |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |actualiza los      |
    |                   |                   |                   |paquetes ya        |
    |                   |aptitude           |                   |instalados a las   |
    |apt upgrade        |safe-upgrade       |apt-get upgrade    |nuevas versiones   |
    |                   |                   |                   |candidatas sin     |
    |                   |                   |                   |eliminar ningún    |
    |                   |                   |                   |paquete            |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |actualiza los      |
    |                   |                   |                   |paquetes ya        |
    |                   |                   |                   |instalados a las   |
    |apt full-upgrade   |aptitude           |apt-get            |nuevas versiones   |
    |                   |full-upgrade       |dist-upgrade       |candidatas y       |
    |                   |                   |                   |elimina los        |
    |                   |                   |                   |paquetes que       |
    |                   |                   |                   |necesite           |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |elimina el paquete |
    |apt remove foo     |aptitude remove foo|apt-get remove foo |«foo» sin eliminar |
    |                   |                   |                   |sus archivos de    |
    |                   |                   |                   |configuración      |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |elimina los        |
    |                   |                   |                   |paquetes           |
    |apt autoremove     |N/A                |apt-get autoremove |autoinstalados que |
    |                   |                   |                   |ya no son          |
    |                   |                   |                   |necesarios         |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |elimina el paquete |
    |apt purge foo      |aptitude purge foo |apt-get purge foo  |«foo» y sus        |
    |                   |                   |                   |archivos de        |
    |                   |                   |                   |configuración      |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |limpia por completo|
    |                   |                   |                   |el repositorio     |
    |apt clean          |aptitude clean     |apt-get clean      |local de los       |
    |                   |                   |                   |archivos de        |
    |                   |                   |                   |paquetes           |
    |                   |                   |                   |descargados        |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |limpia el          |
    |                   |                   |                   |repositorio local  |
    |apt autoclean      |aptitude autoclean |apt-get autoclean  |de los archivos de |
    |                   |                   |                   |paquetes           |
    |                   |                   |                   |descargados que son|
    |                   |                   |                   |obsoletos          |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |muestra información|
    |apt show foo       |aptitude show foo  |apt-cache show foo |detallada sobre el |
    |                   |                   |                   |paquete «foo»      |
    |-------------------+-------------------+-------------------+-------------------|
    |apt search         |aptitude search    |apt-cache search   |busca paquetes que |
    |<expresión_regular>|<expresión_regular>|<expresión_regular>|concuerden con     |
    |                   |                   |                   |<expresión_regular>|
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |argumenta la razón |
    |                   |                   |                   |por la que el      |
    |N/A                |aptitude why       |N/A                |paquete que        |
    |                   |<expresión_regular>|                   |concuerda con la   |
    |                   |                   |                   |<expresión_regular>|
    |                   |                   |                   |debe ser instalado |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |argumenta la razón |
    |                   |                   |                   |por la que el      |
    |                   |aptitude why-not   |                   |paquete que        |
    |N/A                |<expresión_regular>|N/A                |concuerda con la   |
    |                   |                   |                   |<expresión_regular>|
    |                   |                   |                   |no debe ser        |
    |                   |                   |                   |instalado          |
    |-------------------+-------------------+-------------------+-------------------|
    |                   |                   |                   |enumera los        |
    |N/A                |aptitude search    |apt-mark showmanual|paquetes que se    |
    |                   |'~i!~M'            |                   |instalaron de forma|
    |                   |                   |                   |manual             |
    +-------------------------------------------------------------------------------+


    Nota

    Aunque la orden aptitude proporciona funcionalidades sofisticadas
    como un mejor motor de resolución de dependencias de paquetes, su
    complejidad ha causado (y todavía puede causar) algunos problemas
    como el Error #411123, el Error #514930 y el Error #570377. En
    caso de duda, por favor, utilice las órdenes apt, apt-get y
    apt-cache en vez de la orden aptitude.

    Nota

    Desde que tanto apt, apt-get como aptitude comparten el estado de
    los paquetes autoinstalados (consulte Sección 2.5.5, “Estado del
    paquete para APT”) desde lenny, se pueden utilizar estas
    herramientas de forma combinada sin mayores problemas (consulte
    Error #594490).

    La orden «aptitude why <expresión_regular>» puede mostrar mas
    información si se utiliza «aptitude -v why <expresión_regular>».
    Utilizando «apt rdepends <paquete>» o «apt-cache rdepends
    <paquete>» se puede obtener información parecida.

    Cuando se ejecuta la orden aptitude en modo de línea de órdenes y
    aparece algún problema como un conflicto entre paquetes, si pulsa
    la tecla «e» como respuesta al cursor puede cambiar al modo
    interactivo a pantalla completa.

    Puede añadir opciones después de la orden «aptitude».

    Tabla 2.7. Opciones más importantes de la orden aptitude(8)

    +---------------------------------------------------------------+
    |opción de la|                   descripción                    |
    |   orden    |                                                  |
    |------------+--------------------------------------------------|
    |-s          |emula el resultado de la orden                    |
    |------------+--------------------------------------------------|
    |-d          |descarga únicamente pero no instala o actualiza   |
    |------------+--------------------------------------------------|
    |-D          |muestra aclaraciónes breves antes de la           |
    |            |instalación o eliminación automáticos             |
    +---------------------------------------------------------------+


    Para más información consulte aptitude(8) y «aptitude user's
    manual» en «/usr/share/doc/aptitude/README».

    Sugerencia

    El paquete dselect está todavía disponible y fue la herramienta
    preferida para la gestión de paquetes en modo interactivo a
    pantalla completa en distribuciones anteriores.

%

2.2.3. Uso interactivo de aptitude

    Para la gestión interactiva de paquetes, se inicia aptitude en
    modo interactivo desde el cursor de la consola como sigue:

    $ sudo aptitude -u
    Password:

    Con esto actualiza la copia local del archivo y muestra la
    relación de paquetes en un menú a pantalla completa. La
    configuración de aptitude está en «~/.aptitude/config».

    Sugerencia

    Si quiere utilizar en la orden anterior la configuración del
    superusuario en vez la del usuario utilice «sudo -H aptitude …»
    en vez de «sudo aptitude …».

    Sugerencia

    Aptitude automaticamente ejecuta las acciones pendientes como si
    hubiera empezado en modo interactivo. Si esto no le gusta, puede
    inicializarlo desde el menú: «Acción» → «Cancelar las acciones
    pendientes».

%

2.2.4. Combinaciones de teclado en aptitude

    En el modo de pantalla completa las combinaciones de teclado para
    comprobar el estado de los paquetes y ejecutar las «acciones
    planificadas» son:

    Tabla 2.8. Relación de combinaciones de teclado de aptitude

    +---------------------------------------------------------------+
    |     tecla      |                   función                    |
    |----------------+----------------------------------------------|
    |F10 o Ctrl-t    |menú                                          |
    |----------------+----------------------------------------------|
    |?               |muestra la ayuda de las combinaciones de      |
    |                |teclas (una relación más completa)            |
    |----------------+----------------------------------------------|
    |F10 → Ayuda →   |                                              |
    |Manual de       |muestra el Manual de Usuario                  |
    |usuario         |                                              |
    |----------------+----------------------------------------------|
    |u               |actualiza la información de archivo del       |
    |                |paquete                                       |
    |----------------+----------------------------------------------|
    |+               |marca el paquete para ser actualizado o       |
    |                |instalado                                     |
    |----------------+----------------------------------------------|
    |-               |marca el paquete para ser eliminado (mantiene |
    |                |los archivos de configuración)                |
    |----------------+----------------------------------------------|
    |_               |marca el paquete para ser purgado (borra los  |
    |                |archivos de configuración)                    |
    |----------------+----------------------------------------------|
    |=               |marca el paquete para ser conservado (hold)   |
    |----------------+----------------------------------------------|
    |U               |marca todos los paquetes actualizables (sería |
    |                |el equivalente a una actualización completa)  |
    |----------------+----------------------------------------------|
    |g               |comienza la descarga y la instalación de los  |
    |                |paquetes seleccionados                        |
    |----------------+----------------------------------------------|
    |q               |sale de la pantalla actual y guarda los       |
    |                |cambios                                       |
    |----------------+----------------------------------------------|
    |x               |sale de la pantalla actual sin guardar los    |
    |                |cambios                                       |
    |----------------+----------------------------------------------|
    |Intro           |muestra la información de un paquete          |
    |----------------+----------------------------------------------|
    |C               |muestra el registro de cambios del paquete    |
    |----------------+----------------------------------------------|
    |l               |cambia el número de paquetes que se muestran  |
    |----------------+----------------------------------------------|
    |/               |busca el primer encaje                        |
    |----------------+----------------------------------------------|
    |\               |repite la última búsqueda                     |
    +---------------------------------------------------------------+


    La especificación del nombre del archivo de la línea de orden y
    el menú del sistema después de presionar «l» y «/ /» coge la
    expresión regular de aptitude como se describe a continuación. La
    expresión regular de aptitude explícitamente puede coincidir con
    un nombre de paquete utilizando una cadena iniciada por «~ n y
    seguido por el nombre del paquete.

    Sugerencia

    Usted necesita pulsar «U» para hacer que todos los paquetes se
    actualicen a la versión candidata en el interfaz visual. De otra
    manera solo los paquetes seleccionados y otros que son
    dependecias de versiones de estos son actualizados a la versión
    candidata.

%

2.2.5. Visualización de paquetes en aptitude

    En el modo interactivo a pantalla completa de aptitude(8), los
    paquetes que se enumeran son visualizados como el siguiente
    ejemplo:

    idA   libsmbclient                             -2220kB 3.0.25a-1  3.0.25a-2

    El significado de está línea empezando por la izquierda es:

      * La bandera del «estado actual« (la primera letra)

      * La bandera de la «acción planeada« (la segunda letra)

      * La bandera «automática« (la tercera letra)

      * El nombre del paquete

      * La variación del espacio de disco usado según la «acción
        planeada«

      * La versión actual del paquete

      * La versión candidata del paquete

    Sugerencia
   
    Pulsando ? se muestra al final de la pantalla de Ayuda una
    relación completa de las banderas.

    La versión candidata se elige de acuerdo a la configuración local
    del equipo (consulte apt_preferences(5) y Sección 2.7.3,
    “Seleccionando la versión candidata”).

    Existen diferentes formas de mostrar los paquetes en la opción de
    menú «Vistas».

    Tabla 2.9. Relación de vistas en aptitude

    +---------------------------------------------------------------+
    |     vista     |  estado  |      descripción de la vista       |
    |---------------+----------+------------------------------------|
    |Vista del      |          |consulte Tabla 2.10, “La            |
    |paquete        |Bueno     |clasificación de la vista de        |
    |               |          |paquetes estándar” (por defecto)    |
    |---------------+----------+------------------------------------|
    |               |          |relación de paquete los cuales se   |
    |Recomendaciones|Bueno     |recomiendan por algún paquete       |
    |de auditoria   |          |marcado para instalación pero sin   |
    |               |          |instalar por el momento             |
    |---------------+----------+------------------------------------|
    |Relación plana |          |relación de paquetes sin clasificar |
    |de paquetes    |Bueno     |(para usar con expresiones          |
    |               |          |regulares)                          |
    |---------------+----------+------------------------------------|
    |Navegador de   |          |relación de paquetes clasificados de|
    |etiquetas      |Muy usable|acuerdo a sus etiquetas Debian      |
    |Debian         |          |(debtags)                           |
    |(Debtags)      |          |                                    |
    |---------------+----------+------------------------------------|
    |Navegación por |          |relación de paquetes clasificados   |
    |categorías     |Abandonado|por su categoría (usado en lugar de |
    |               |          |Navegación por etiquetas Debian)    |
    +---------------------------------------------------------------+


    Nota
   
    Por favor, ¡ayúdenos mejorando el marcado de paquetes con
    debtags!

    La vista estándar «Vista de paquetes» los clasifica en cierto
    modo como dselect con algunas funcionalidades extra.

    Tabla 2.10. La clasificación de la vista de paquetes estándar

    +---------------------------------------------------------------+
    |     categoría     |          descripción de la vista          |
    |-------------------+-------------------------------------------|
    |Paquetes           |la relación organizada de paquetes según   |
    |actualizables      |sección → área → paquete                   |
    |-------------------+-------------------------------------------|
    |Nuevos paquetes    |, ,                                        |
    |-------------------+-------------------------------------------|
    |Paquetes instalados|, ,                                        |
    |-------------------+-------------------------------------------|
    |Paquetes no        |, ,                                        |
    |instalados         |                                           |
    |-------------------+-------------------------------------------|
    |Paquetes creados   |                                           |
    |localmente y       |, ,                                        |
    |obsoletos          |                                           |
    |-------------------+-------------------------------------------|
    |Paquetes virtuales |relación de paquetes con la misma función  |
    |-------------------+-------------------------------------------|
    |                   |relación de paquetes con diferentes        |
    |Tareas (tasks)     |funciones que normalmente son necesarios   |
    |                   |para una tarea                             |
    +---------------------------------------------------------------+


    Sugerencia
   
    La vista de tareas puede usarse para realizar una selección de
    paquetes para sus tareas.

%

2.2.6. Opciones del método de búsqueda con aptitude

    Aptitude ofrece varias opciones para la búsqueda de paquetes
    usando su fórmula de expresiones regulares.

      * Línea de órdenes del intérprete de órdenes:

          + «aptitude search '<expresión_regular_de_aptitude>'»
            enumera el estado de instalación, nombre del paquete y
            descripción corta de los paquetes que encajan

          + «aptitude show '<nombre_del_paquete>'» muestra la
            descripción detallada del paquete

      * Modo interactivo de pantalla completa:

          + «l» limita la visualización del paquete a los que encajan

          + «/» para buscar los paquetes que encajan

          + «\» busca hacia atrás el paquete que encaja

          + «n» para encontrar el siguiente

          + «N» para buscar el siguiente (hacia atrás)

    Sugerencia

    La cadena del <nombre_del_paquete> se trata como el encaje exacto
    de la cadena al nombre del paquete al menos que empiece
    explícitamente con «~» para ser un fórmula de expresión regular.

%

2.2.7. La fórmula de la expresión regular de aptitude

    La fórmula de expresiones regulares de aptitude es parecido a la
    extensión ERE (consulte Sección 1.6.2, “Expresiones regulares”)
    de mutt y aquellos significados de las extensiones de reglas de
    concordancia especiales y específicas de aptitude son las
    siguientes:

    Tabla 2.11. Relación de fórmulas de expresiones regulares de aptitute

    +-------------------------------------------------------------------+
    | descripción de |                                                  |
    |   las reglas   |         fórmula de la expresión regular          |
    | extendidas de  |                                                  |
    |     encaje     |                                                  |
    |----------------+--------------------------------------------------|
    |nombre del      |                                                  |
    |paquete que     |~n<nombre_de_la_expresión_regula>                 |
    |encaja          |                                                  |
    |----------------+--------------------------------------------------|
    |encaja en la    |~d<descripcion_de_la_expresión_regular>           |
    |descripción     |                                                  |
    |----------------+--------------------------------------------------|
    |nombre de la    |~t<expresión_regular_de_tareas>                   |
    |tarea que encaja|                                                  |
    |----------------+--------------------------------------------------|
    |encaja con las  |~G<expresion_regular_de_etiquetas>                |
    |etiquetas debian|                                                  |
    |----------------+--------------------------------------------------|
    |encaja con el   |~m<expresión_regular_del_desarrollador>           |
    |desarrollador   |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con la   |                                                  |
    |sección del     |~s<expresión_regular_de_sección>                  |
    |paquete         |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con la   |                                                  |
    |versión del     |~V<expresión_regular_de_la_versiónn>              |
    |paquete         |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con la   |~A{bullseye,bookworm,sid}                         |
    |distribución    |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con el   |~O{debian,…}                                      |
    |origen          |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con la   |~p{extra,important,optional,required,standard}    |
    |prioridad       |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquetes        |~E                                                |
    |esenciales      |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |~v                                                |
    |virtuales       |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |~N                                                |
    |nuevos paquetes |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |~a                                                |
    |acciones        |{install,upgrade,downgrade,remove,purge,hold,keep}|
    |pendientes      |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |~i                                                |
    |instalados      |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |                                                  |
    |marcados con A  |~M                                                |
    |-mark (paquetes |                                                  |
    |auto-instalados)|                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |                                                  |
    |instalados sin  |                                                  |
    |la marca A      |~i!~M                                             |
    |(paquetes       |                                                  |
    |seleccionados   |                                                  |
    |por el          |                                                  |
    |administrador)  |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |                                                  |
    |instalados y que|~U                                                |
    |se pueden       |                                                  |
    |actualizar      |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes        |~c                                                |
    |eliminados pero |                                                  |
    |no purgados     |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquete         |                                                  |
    |eliminados y    |~g                                                |
    |purgados o que  |                                                  |
    |se pueden       |                                                  |
    |eliminar        |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes que    |~b                                                |
    |declaran una    |                                                  |
    |dependencia rota|                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes que    |                                                  |
    |declaran una    |~B<type>                                          |
    |dependencia rota|                                                  |
    |de un <ipo>     |                                                  |
    |----------------+--------------------------------------------------|
    |encaja el       |                                                  |
    |<patrón> sobre  |                                                  |
    |paquetes que    |~D[<tipo>:]<patrón>                               |
    |tienen una      |                                                  |
    |dependencia     |                                                  |
    |<tipo>          |                                                  |
    |----------------+--------------------------------------------------|
    |encaja el       |                                                  |
    |<patrón> con    |                                                  |
    |paquetes que    |~DB[<tipo>:]<patrón>                              |
    |tienen una      |                                                  |
    |dependencia rota|                                                  |
    |de <tipo>       |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con      |                                                  |
    |paquetes en los |                                                  |
    |cuales el       |                                                  |
    |<patrón> encaja |~R[<tipo>:]<patrón>                               |
    |con paquetes que|                                                  |
    |declaran una    |                                                  |
    |dependecia      |                                                  |
    |<tipo>          |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquetes que son|                                                  |
    |una dependencia |                                                  |
    |rota <tipo> de  |~RB[<tipo>:]<patrón>                              |
    |los paquetes que|                                                  |
    |encajan con el  |                                                  |
    |<patrón>        |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquetes con los|                                                  |
    |que los paquetes|~R~i                                              |
    |instalados      |                                                  |
    |tienen          |                                                  |
    |dependencias    |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquetes que no |                                                  |
    |dependen de     |!~R~i                                             |
    |ningún paquete  |                                                  |
    |instalado       |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquete que     |                                                  |
    |dependen o son  |~R~i|~Rrecommends:~i                              |
    |recomendados por|                                                  |
    |otros paquetes  |                                                  |
    |instalados      |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con los  |                                                  |
    |paquetes según  |                                                  |
    |el <patrón>     |~S filtro <patrón>                                |
    |filtrados por la|                                                  |
    |versión         |                                                  |
    |----------------+--------------------------------------------------|
    |encaja con todos|                                                  |
    |los paquetes    |~T                                                |
    |(verdad)        |                                                  |
    |----------------+--------------------------------------------------|
    |no encaja con   |                                                  |
    |ningún paquete  |~F                                                |
    |(falso)         |                                                  |
    +-------------------------------------------------------------------+


      * Las expresiones regulares son las mismas de ERE que usa la
        típica herramienta de textos en un entorno Unix: «^», «.*»,
        «$» etc. como en egrep(1), awk(1) y perl(1).

      * El <tipo> de dependencias es uno de («depends«, «predepends«,
        «recommends«, «suggests«, «conflicts«, «replaces«,
        «provides«) los especificados en las relaciones entre
        paquetes.

      * El <tipo> de dependencia por defecto es «depends«.

    Sugerencia
   
    Cuando el <patrón_de_la_expresión_regular> es la cadena «null«,
    coloca inmediatamente después de la orden «~T».

    Algunos atajados:

      * «~P<término>» == «~Dprovides:<término>»

      * «~C<término>» == «~Dconflicts:<término>»

      * «…~W término» == «(…|término)»

    Los usuarios familiarizados con mutt aprenderán rápidamente, ya
    que mutt fue la inspiración para la sintaxis de las expresiones.
    Consulte «SEARCHING, LIMITING, AND EXPRESSIONS« en el «Manual de
    Usuario« «/usr/share/doc/aptitude/README».

    Nota

    Con la versión de lenny de aptitude(8), la nueva sintaxis en
    formato largo como «?broken» puede ser usada de forma equivalente
    para el uso de expresiones regulares en lugar de la anteriro 
    formato corto «~b». Ahora el carácter de espacio « » es
    considerado como uno de los caracteres de finalización de la
    expresión regular al igual que la tilde «~». Consulte el «Manual
    de Usuario« para la nueva sintaxis de formato largo.

%

2.2.8. Resolución de dependencias en aptitude

    La selección de un paquete con aptitude no marca únicamente los
    paquetes definidos en su relación de «dependencias:» sino también
    aquellos en la relación de «Recomendados:» si la opción «F10 →
    Options → Preferences → Dependency handling« esta configurada de
    esa manera. Estos paquetes instalados de forma automática son
    eliminados de forma automatizada por aptitude si no van a ser
    necesarios en el futuro.

    La bandera que controla el comportamiento de «autoinstalado« de
    la orden aptitude puede modifcarse también usando la orden 
    apt-mark(8) del paquete apt.

%

2.2.9. Registro de la actividad de los paquetes

    Usted puede comprobar el histórcio de acciones sobre paquetes en
    los archivos de registro.

    Tabla 2.12. Los archivos de registro de acciones sobre paquetes

    +---------------------------------------------------------------+
    |   archivo   |                    contenido                    |
    |-------------+-------------------------------------------------|
    |/var/log/    |Registra la actividad a nivel de dpkg para todas |
    |dpkg.log     |las acciones sobre paquetes                      |
    |-------------+-------------------------------------------------|
    |/var/log/apt/|Registro de acciones genéricas APT               |
    |term.log     |                                                 |
    |-------------+-------------------------------------------------|
    |/var/log/    |Registro de acciones de la orden aptitude        |
    |aptitude     |                                                 |
    +---------------------------------------------------------------+


    En realidad, no es fácil conseguir una comprensión rápida de
    estos registros. La manera más fácil se explica en
    Sección 9.2.10, “Guardando cambios en los archivos de
    configuración”.

%

2.3. Ejemplos de operaciones con aptitude

    Algunos ejemplos de operaciones con aptitude(8):

2.3.1. Enumera los paquetes cuyos nombres encajan con la expresión
regular

    Las órdenes siguientes enumeran los paquetes cuyos nombres
    encajan con la expresión regular.

    $ aptitude search '~n(pam|nss).*ldap'
    p libnss-ldap - NSS module for using LDAP as a naming service
    p libpam-ldap - Pluggable Authentication Module allowing LDAP interfaces

    Es bastante útil para encontrar el nombre exacto de un paquete.

2.3.2. Navega por la relación de paquetes que encajan con la
expresión regular

    La expresión regular «~dipv6» con la nueva vista «New Flat
    Package List« con el símbolo «l» prompt, muestra en la vista los
    paquetes cuya descripción encaja y le permite navegar de forma
    interactiva entre ellos.

%

2.3.3. Purga los paquetes eliminados definitivamente

    Se pueden borrar todos los archivos de configuración de los
    paquetes eliminados.

    Compruebe los resultados de la siguiente orden:

    # aptitude search '~c'

    Si piensa que es correcto la purga de los paquetes enumerados,
    ejecute la siguiente orden:

    # aptitude purge '~c'

    Puede hacer lo mismo en modo interactivo para tener un control
    más detallado.

    En la «Nueva Vista de Paquetes«, puede añadir una expresión
    regular a «~c» con el cursor «|». Esto limita los paquetes que se
    visualizan a únicamente lso que encajan con la expresión regular,
    esto es, «eliminado pero no purgado«. Todos estos paquetes que
    encajan con la expresión regular serán mostrados al presionar «[»
    en la cabecera de más alto nivel.

    Entonces, pulse «_» en la cabecera de mayor nivel como «Paquetes
    no instalados«. Solo los paquetes que encajan con el patrón de la
    expresion regular bajo dicho encabezado serán marcados para ser
    purgados. Usted puede no incluir algunos paquetes de la purga
    presionando «=» de forma manual sobre cada uno de ellos.

    Esta técnica es bastante útil y funciona para muchas teclas de
    órdenes.

%

2.3.4. Estado de instalación ordenado de forma automática/manual

    A continuación mostraremos como mantenemos en orden el estado de
    instalación de los paquetes (después de realizar instalaciones
    sin usar aptitude etc.).

     1. Lance aptitude en modo interactivo como «root«.

     2. Pulse «u», «U», «f» and «g» para actualizar la relación de
        paquetes y los paquetes.

     3. Pulse «l» para acceder a la pantalla de los paquetes
        limitandolos a «~i(~R~i|~Rrecommends:~i)» y pulse «M» sobre
        «Paquetes I» como auto instalados.

     4. Pulse «l» para acceder a la pantalla de paquetes limitados
        como «~prequired|~pimportant|~pstandard|~E» y pulse «m» sobre
        «Paquetes Instalados» como instalados de forma manual.

     5. Pulse «l» para acceder a la pantalla limitados por«~i!~M» y
        elimine los paquetes sin usa pulsando «-» sobre cada uno de
        ellos después muestrelos pulsando «[» sobre «Paquetes
        Instalados».
   
     6. Pulse «|», para entrar en la pantalla de paquetes limitada
        por «~i»; entonces pulse «m» sobre Tareas», para marcar
        aquellos paquetes instalados manualmente.

     7. Salga de aptitude.

     8. Ejecute «apt-get -s autoremove|less» como superusuario para
        comprobar lo que no usa.

     9. Reinicie aptitude en modo interactivo y marque los paquetes
        que necesite con «m».

    10. Vuelva a ejecutar «apt-get -s autoremove|less» como
        superusuario para volver a comprobar que solo ha ELIMINADO
        los paquetes que deseaba.

    11. Ejecute «apt-get autoremove|less» como superusuario para
        eliminar los paquetes sin uso.

    La acción «m» sobre «Tasks» es opcional y se usa para evitar la
    situación de eliminar paquetes de forma masiva en el futuro.

%

2.3.5. Actualización mayor del sistema

    Nota

    Cuando se cambia a una nueva distribución etc, se debe considerar
    implantar una instalación limpia del nuevo sistema incluso cuando
    Debian es actualizable como se describe a continuación.
    Proporciona la oportunidad de eliminar la basura almacenada y
    acceder a las mejores combinaciones de las últimas versiones de
    los paquetes. Sin dudarlo, debería realizar una copia de respaldo
    completa del sistema a un lugar seguro (consulte Sección 10.2,
    “Respaldo y recuperación”) antes de hacerlo. Nosotros
    recomendamos crear un arranque dual en una partición diferente
    para realizar una transición suave.

    Se puede realizar una actualización mayor del sistema a una nueva
    distribución cambiando el contenido del archivo «/etc/apt/
    sources.list» y ejecutando la orden «apt update; apt
    dist-upgrade».

    Para actualizar desde la distribución estable a «en pruebas» o
    «inestable», se debe cambiar «bullseye» en el ejemplo de «/etc/
    apt/sources.list» Sección 2.1.4, “Fundamentos del archivo de
    Debian” por «bookworm» o «sid».

    De hecho, se puede encontrar con algunas complicaciones debido a
    alguna transicion entre paquetes, la mayor parte debido a
    dependencias. Cuanto mayores es la actualización, más problemas
    importantes se puede encontrar. Para la transición desde una
    distribución antigua de estable a la nueva estable después de su
    publicación, puede leer las nuevas «Release Notes« y seguir el
    procedimiento concreto que se describe para minimizar los
    problemas.

    Cuando decide migrar de estable a «en pruebas» después de una
    publicación formal, no existen «Release Notes« de ayuda. La
    diferencia entre estable y «en pruebas» puede ser bastante mayor
    después de la liberación de una nueva distribución estable y la
    actuailización se puede convertir en una situación complicada.

    Usted debería ser precavido cuando realiza un actualización
    completa y consultar la información actualizada sobre ello y usar
    el sentido común.

     1. Lea las anterior «Release Notes«.

     2. Realice una copia de respaldo (o de seguridad) completa
        (especialmente los datos y las configuraciones).

     3. Disponga de un medio alternativo de arranque por si falla el
        cargador de arranque.

     4. Informe con anterioridad y de forma correctamente a los
        usuarios.

     5. Registre las operaciones de la actualización con script(1).

     6. Para evitar su eliminación marque los paquetes que lo
        requieran como «sin marcado automático» (unmarkauto), p. ej.,
        «aptitude unmarkauto vim».

     7. Minimize los paquetes instalados con el de minimizar la
        posibilidad de conflictos, p. ej., elimine los paquetes de la
        tarea «Escritorio«.

     8. Elimine el archivo «/etc/apt/preferences» (evita el problema
        de prioridades (apt-pinning)).

     9. Realice actualizaciones siguiendo los pasos de forma sensata:
        vieja_estable → estable → «en pruebas» → «inestable».

    10. Actualice el archivo «/etc/apt/sources.list» para referenciar
        unicamente el nuevo repositorio y ejecutar «aptitude update».

    11. Instale, opcionalmente, primero los nuevos paquetes
        fundamentales , p. ej., «aptitude install perl».

    12. Ejecute la orden «apt-get -s dist-upgrade» para comprobar su
        efecto.

    13. Finalmente , ejecute la orden «apt-get dist-upgrade».

    Atención
   
    No es aconsejable omitir la distribución principal de Debian, la
    estable, cuando se actualiza entre distribuciones.

    Atención

    En «Release Notes« anteriores, GCC, el núcleo de Linux ,
    initrd-tools, Glibc, Perl, las herramientas APT, etc. han
    necesitado una atención especial para la actualización mayor del
    sistema.

    Para actualizar de forma diaria la versión «inestable», consulte
    Sección 2.4.3, “Protección frente a problemas con paquetes”.

2.4. Operaciones avanzadas de gestión de paquetes

2.4.1. Operaciones avanzadas de gestión de paquetes desde la línea de
órdenes

    A continuación puede encontrar otras operaciones de gestión de
    paquetes para las cuales aptitude es demasiada abstracta o no
    posee la funcionalidad que se necesita.

    Tabla 2.13. Relación de operaciones avanzadas con paquetes

    +---------------------------------------------------------------+
    |             orden             |            acción             |
    |-------------------------------+-------------------------------|
    |COLUMNS=120 dpkg -l            |enumera el estado de los       |
    |<patrón_del_nombre_del_paquete>|paquetes instalados para el    |
    |                               |informe de errores             |
    |-------------------------------+-------------------------------|
    |dpkg -L <nombre_del_paquete>   |enumera el contenido de un     |
    |                               |paquete instalado              |
    |-------------------------------+-------------------------------|
    |dpkg -L <nombre_del_paquete> | |relación las páginas del manual|
    |egrep '/usr/share/man/man.*/.+'|para un paquete instalado      |
    |-------------------------------+-------------------------------|
    |dpkg -S                        |enumera los paquetes instalados|
    |<patrón_del_nombre_de_archivo> |que tienen un archivo que      |
    |                               |encaja con el patrón           |
    |-------------------------------+-------------------------------|
    |apt-file search                |enumera los paquetes en el     |
    |<patrón_nombre_de_archivo>     |repositorio que encajan con el |
    |                               |nombre de archivo              |
    |-------------------------------+-------------------------------|
    |apt-file list                  |enumera el contenido de los    |
    |<patrón_nombre_de_paquete>     |paquetes del repositorio que   |
    |                               |encajan                        |
    |-------------------------------+-------------------------------|
    |dpkg-reconfigure               |reconfigura el paquete dado    |
    |<nombre_del_paquete>           |                               |
    |-------------------------------+-------------------------------|
    |dpkg-reconfigure -p=low        |reconfigura el paquete dado    |
    |<nombre_del_paquete>           |realizando el mayor número de  |
    |                               |preguntas                      |
    |-------------------------------+-------------------------------|
    |configure-debian               |reconfigura los paquetes desde |
    |                               |el menú de pantalla completa   |
    |-------------------------------+-------------------------------|
    |                               |auditoria del sistema referente|
    |dpkg --audit                   |a paquete instalados           |
    |                               |parcialmente                   |
    |-------------------------------+-------------------------------|
    |dpkg --configure -a            |configura todos los paquetes   |
    |                               |instalados parcialmente        |
    |-------------------------------+-------------------------------|
    |                               |muestra la versión, la         |
    |apt-cache policy               |prioridad y la información del |
    |<nombre_del_paquete_binario>   |repositorio de un paquete      |
    |                               |binario                        |
    |-------------------------------+-------------------------------|
    |apt-cache madison              |muestra la versión disponible y|
    |<nombre_del_paquete>           |la informacion del repositorio |
    |                               |de un paquete                  |
    |-------------------------------+-------------------------------|
    |apt-cache showsrc              |muestra la información del     |
    |<nombre_del_paquete_binario>   |paquete fuente que corresponde |
    |                               |con el paquete binario         |
    |-------------------------------+-------------------------------|
    |apt-get build-dep              |instala los paquetes           |
    |<nombre_del_paquete>           |requieridos para construir el  |
    |                               |paquete                        |
    |-------------------------------+-------------------------------|
    |aptitude build-dep             |instala los paquetes           |
    |<nombre_del_paquete>           |requieridos para construir el  |
    |                               |paquete                        |
    |-------------------------------+-------------------------------|
    |apt-get source                 |descarga la fuente (desde el   |
    |<nombre_del_paquete>           |repositorio estándar)          |
    |-------------------------------+-------------------------------|
    |dget <URL_del_archivo_dsc>     |descarga el código del paquete |
    |                               |(desde otro repositorio)       |
    |-------------------------------+-------------------------------|
    |dpkg-source -x                 |construye el árbol de las      |
    |<nombre_del_paquete>_<version>-|fuentes para un conjunto de    |
    |<versión_de_debian>.dsc        |paquetes fuente («orig.tar.gz» |
    |                               |y «debian.tar.gz»/«*.diff.gz») |
    |-------------------------------+-------------------------------|
    |                               |construye el/los paquete(s)    |
    |debuild binary                 |desde un árbol de fuentes      |
    |                               |locales                        |
    |-------------------------------+-------------------------------|
    |                               |construye el paquete del núcleo|
    |make-kpkg imagen_del_núcleo    |desde el árbol fuente del      |
    |                               |kernel                         |
    |-------------------------------+-------------------------------|
    |make-kpkg --initrd             |construye el paquete del núcleo|
    |imagen_del_núcleo              |desde el árbol fuente de este  |
    |                               |con initramfs activado         |
    |-------------------------------+-------------------------------|
    |dpkg -i <nombre_del_paquete>_  |instala un paquete local en el |
    |<version>-<versión_de_debian>_ |sistema                        |
    |<arquitectura>.deb             |                               |
    |-------------------------------+-------------------------------|
    |                               |instala un paquete local en el |
    |apt install /ruta/al/          |sistema y trata de resolver de |
    |<package_filename>.deb         |forma automática sus           |
    |                               |dependencias                   |
    |-------------------------------+-------------------------------|
    |debi <nombre_del_paquete>_     |instala el(los) paquete(s)     |
    |<version>-<versión_de_debian>_ |locales en el sistema          |
    |<arquitectura>.dsc             |                               |
    |-------------------------------+-------------------------------|
    |dpkg --get-selections '*' >    |guardar información de estado  |
    |selección.txt                  |de selección de nivel de       |
    |                               |paquete dpkg                   |
    |-------------------------------+-------------------------------|
    |dpkg --set-selections          |asigna la información de estado|
    |<seleccion.txt                 |de selección de nivel del      |
    |                               |paquete dpkg                   |
    |-------------------------------+-------------------------------|
    |                               |establecer estado de selección |
    |echo <nombre_paquete> hold |   |de nivel de paquete dpkg para  |
    |dpkg --set-selections          |un paquete a mantener          |
    |                               |(equivalente a ' aptitude hold |
    |                               |< nombre_del_paquete > ')      |
    +---------------------------------------------------------------+


    Nota

    Para paquetes que sean multi-arch, usted puede necesitar
    especificar el nombre de la arquitectura para algunas órdenes.
    Por ejemplo, use «dpkg -L libglib2.0-0:amd64» para enumerar el
    contenido del paquete libglib2.0-0 para la arquitectura amd64.

    Atención

    Las herramientas de bajo nivel como «dpkg -i …» y «debi …» deben
    ser usadas con cuidado por el administrador del sistema. No toman
    en cuenta de forma automática las dependencias entre paquetes. La
    opción de la línea de órdenes «--force-all» y parecidas (see dpkg
    (1)) estan hechas para ser usadas únicamente por usuarios
    expertos. Usarlas sin entender plenamente sus consecuencias
    pueder corromper el sistema entero.

    Tenga en cuenta:

      * Todas las órdenes de configuración e instalación necesitan
        ser ejecutadas por el superusuario.

      * A diferencia de aptitude que usa expresiones regulares
        (consulte Sección 1.6.2, “Expresiones regulares”), otras
        órdenes para la gestión de paquetes usan patrones como el
        intérprete de órdenes glob (consulte Sección 1.5.6,
        “Expansión de un patrón en el intérprete de órdenes”).

      * apt-file(1) que está en el paquete apt-file necesita ejecutar
        previamente «apt-file update».

      * configure-debian(8) que está en el paquete configure-debian
        usa como su motor dpkg-reconfigure(8).

      * dpkg-reconfigure(8) ejecuta los archivos de órdenes de los
        paquetes usando como su motordebconf(1).

      * Las órdenes «apt-get build-dep», «apt-get source» y
        «apt-cache showsrc» necesitan las entradas «deb-src» en «/etc
        /apt/sources.list».

      * dget(1), debuild(1) y debi(1) necesitan el paquete
        devscripts.

      * Consulte el procedimiento de (re)empaquetado mediante
        «apt-get source» en Sección 2.7.13, “Portar un paquete a un
        sistema estable”.

      * La orden make-kpkg necesita el paquete kernel-package
        (consulte Sección 9.9, “El núcleo”).

      * Para el empaquetado general consulte Sección 12.11, “Haciendo
        un paquete Debian”.

%

2.4.2. Verificación de los archivos de un paquete instalado

    La instalación de debsums permite de la verificación de los
    archivos de los paquetes instalados comparando los valores MD5sum
    en el archivo «/var/lib/dpkg/info/*.md5sums» con debsums(1). Para
    saber como funciona MD5sum consulteSección 10.3.5, “El resumen
    MD5”.

    Nota

    Ya que la base de datos de MD5sum pueden ser alterados por un
    intruso, debsums(1) su uso como herramienta de seguridad es
    limitada. Solo es aceptable para que el administrador compruebe
    modificaciones locales o daños producidos por errores del medio
    de almacenamiento.

%

2.4.3. Protección frente a problemas con paquetes

    Muchos usuario prefieren usar la distribución «inestable» del
    sistema Debian por sus nuevos paquetes y funcionalidades. Esto
    hace que el sistema sea más propenso a paquetes con errores
    críticos.

    La instalación del paquete apt-listbugs protege su sistema contra
    errores críticos comprobando estos de forma automática BTS de
    Debian cuando se actualiza mediante el sistema APT.

    La instalación del paquete apt-listchanger aporta noticias
    importantes en «NEWS.Debian» cuando se actualiza mediante el
    sistema APT.

%

2.4.4. Buscando metadatos en los paquetes

    Aunque hoy en día https://packages.debian.org/ proporciona
    métodos fáciles para buscar metainformación de los paquetes,
    comprobaremos métodos más tradicionales.

    Las órdenes grep-dctrl(1), grep-status(1) y grep-available(1) se
    pueden usar para buscar cualquier archivo que tenga el formato
    general de un archivo de control de paquetes de Debian.

    «dpkg -S <patrón_de_archivo_de_nombres>» pueden ser usados para
    buscar nombres de paquetes los cuales contienen archivos que
    encajan con el nombre instalado por dpkg. Pero pasa por alto los
    archivos creados por los archivos de órdenes de mantenimiento.

    Si necesita realizar búsquedas más elaboradas de metadatos de
    dpkg , necesita ejecutar la orden «grep -e regex_pattern *» en el
    directorio «/var/lib/dpkg/info/». Esto realiza búsquedas de las
    palabras mencionadas en los archivos de órdenes de los paquetes y
    textos de preguntas de la instalación.

    Si desea realizar búsquedas recursivas en dependencias de
    paquetes , se debería usar apt-rdepends(8).

%

2.5. Gestión interna de los paquetes Debian

    Aprendamos como funciona internamente el sistema de paquetes
    Debian. Esto puede ayudarle a encontrar su propia solución en
    algunos problemas con paquetes.

%

2.5.1. Metadatos de archivos

    Los metadatos de archivos para cada distribución son almacenados
    en «dist/<codename>» en cada sitio espejo de Debian , p. ej.,
    «http://deb.debian.org/debian/». La estructura de su repositorio
    puede navegarse con un navegador web. Existen seis tipos de
    metadatos clave.

    Tabla 2.14. El contenido de metadatos del repositorio Debian

    +---------------------------------------------------------------+
    |   archivo    |      ubicación      |        contenido         |
    |--------------+---------------------+--------------------------|
    |Distribución  |Alto de la           |descripción del archivo e |
    |              |distribución         |información de integridad |
    |--------------+---------------------+--------------------------|
    |              |Alto de la           |archivo de firma para el  |
    |Release.gpg   |distribución         |archivo firmado «Release» |
    |              |                     |con el archivo llave      |
    |--------------+---------------------+--------------------------|
    |              |                     |relación de todos los     |
    |Contenido-    |Alto de la           |archivos para todos los   |
    |<arquitectura>|distribución         |paquetes en el repositorio|
    |              |                     |pertinente                |
    |--------------+---------------------+--------------------------|
    |              |raíz de cada         |descripción de archivo    |
    |Distribución  |combinación de       |usada para la regla de    |
    |              |distribución/área/   |apt_preferences(5)        |
    |              |arquitectura         |                          |
    |--------------+---------------------+--------------------------|
    |              |raíz de cada         |concatenado de debian/    |
    |Paquetes      |combinación          |control para paquetes     |
    |              |distribución/área/   |binarios                  |
    |              |arquitectura-binaria |                          |
    |--------------+---------------------+--------------------------|
    |              |raíz de cada         |concatenado de debian/    |
    |Fuentes       |combinación          |control para paquetes     |
    |              |distribución/área/   |fuente                    |
    |              |fuente               |                          |
    +---------------------------------------------------------------+


    En el archivo reciente, estos metadatos se almacenan como los
    archivos comprimidos y diferencial para reducir tráfico de red.

%

2.5.2. Archivo «Release» del nivel superior y autenticación

    Sugerencia
   
    El archivo de la raíz «Release» es usado para firmar el
    repositorio del sistema seguro APT.

    Cada distribución del repositorio de Debian tiene un archivo
    «Release» en su raíz, p. ej., el de «http://deb.debian.org/debian
    /dists/unstable/Release», sería:

    Origin: Debian
    Label: Debian
    Suite: unstable
    Codename: sid
    Date: Sat, 14 May 2011 08:20:50 UTC
    Valid-Until: Sat, 21 May 2011 08:20:50 UTC
    Architectures: alpha amd64 armel hppa hurd-i386 i386 ia64 kfreebsd-amd64 kfreebsd-i386 mips mipsel powerpc s390 sparc
    Components: main contrib non-free
    Description: Debian x.y Unstable - Not Released
    MD5Sum:
     bdc8fa4b3f5e4a715dd0d56d176fc789 18876880 Contents-alpha.gz
     9469a03c94b85e010d116aeeab9614c0 19441880 Contents-amd64.gz
     3d68e206d7faa3aded660dc0996054fe 19203165 Contents-armel.gz
    ...

    Nota

    En el puede encontrar la razón de ser entre la «versión« y el
    «nombre en clave« en Sección 2.1.4, “Fundamentos del archivo de
    Debian”. «Distribución« se utiliza cuando se refiere a la
    «versión« y «nombre en clave«. Todos nombres «área« almacenadas
    en el repositorio son enumeradas en «Componentes«.

    La integridad del archivo en la raíz «Release» se verifica por
    medio de la infraestructura criptográfica llamada secure apt.

      * El archivo de firma criptográfica «Release.gpg» se crea desde
        el auténtico archivo «Release» de la raíz y el archivo de la
        llave secreta Debian.

      * La archivo de la llave pública de debian se puede encontrat
        en «/etc/apt/trusted.gpg»;

          + automaticamente instalando el anillo de llaves con el
            último paquete base-files, o

          + manuelmente mediante las herramientas gpg o apt-kery con
            la última clave publicada en ftp-master.debian.org.

      * El sistema secure APT comprueba criptograficamente la
        integridad del archivo «Release» de la raíz mediante el
        archivo «Release.gpg» y la clave pública del repositorio
        Debian en /etc/apt/trusted.gpg».

    La integrdidad de todos los archivos de «Packages» y «Sources»
    son verificados usando valores MD5sum del archivo de la raíz
    «Release». La integridad de todos los archivos de paquetes son
    comprobados usando los valores de MD5sum en los
    archivos«Packages» and «Sources». Consulte debsums(1) y
    Sección 2.4.2, “Verificación de los archivos de un paquete
    instalado”.

    Ya que la verificación de la firma criptográfica es un proceso
    intensivo en uso de la CPU, el uso del valor MD5sum para cada
    paquete mientra se usa el archivo de firma criptográfica de la
    raíz «Release» proporciona buena seguridad y eficiencia (consulte
    Sección 10.3, “Infraestructura de seguridad de la información”).

%

2.5.3. Archivos «Release» a nivel de archivo

    Sugerencia
   
    Los archivos de nivel «Release» son usados para establecer las
    instrucciones de apt_preferences(5).

    Hay archivos de nivel «Release para todas las ubicaciones
    especificadas por las líneas «deb» en /etc/apt/sources.list»,
    como «http://deb.debian.org/debian/dists/unstable/main/
    binary-amd64/Release» o http://deb.debian.org/debian/dists/sid/
    main/binary-amd64/Release» como el siguiente:

    Archive: unstable
    Origin: Debian
    Label: Debian
    Component: main
    Architecture: amd64

    Atención

    Para la etiqueta «Archive:» , los nombres de distribución
    («stable», «testing», «unstable», …) son utilizados en el
    repositorio Debian mientras que los nombres de publicación
    («trusty», «xenial», «artful», …) son utilizados en el
    repositorio Ubuntu.

    Para algunos repositorios, como experimental y
    bullseye-backports, que contienen paquetes que no deberían
    instalarse automaticamente, existe una línea añadida, p. ej.,
    «http://deb.debian.org/debian/dists/experimental/main/
    binary-amd64/Release» como el siguiente:

    Archive: experimental
    Origin: Debian
    Label: Debian
    NotAutomatic: yes
    Component: main
    Architecture: amd64

    Tenga en cuenta que los repositorios normales sin «NotAutomatic:
    yes», el valor por defecto de la prioridad de instalación
    (Pin-Priority) es 500, mientras que en los repositorios
    especiales con «NotAutomatic: yes», el valor por defecto de la
    prioridad de instalación (Pin-Priority) es 1 (consulte 
    apt_preferences(5) y Sección 2.7.3, “Seleccionando la versión
    candidata”).

%

2.5.4. Actualizando la meta información de los paquetes

    Cuando las herramientas APT, como aptitude, apt-get, synaptic,
    apt-file, auto-apt, … son usadas, necesitamos actualizar la copia
    local de la metainformación de la información que contienen el
    repositorio de Debian. Estas copias locales siguen los nombres de
    archivo de los nombres de la distribucion, área y arquitectura
    especificada en «/etc/apt/sources.list» (see Sección 2.1.4,
    “Fundamentos del archivo de Debian”).

      * «/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribution>_Release»

      * «/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribution>_Release.gpg»

      * «/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribution>_<area>_binary-<architecture>_Packages»

      * «/var/lib/apt/lists/deb.debian.org_debian_dists_
        <distribution>_<area>_source_Sources»

      * «/var/cache/apt/apt-file/deb.debian.org_debian_dists_
        <distribution>_Contents-<architecture>.gz» (para apt-file)

    Los 4 primeros tipos de archivo son compartidos por todas las
    órdenes relevantes de actualización APT y son actualizados desde
    la línea de órdenes por «apt-get update» o «aptitude update». La
    metainformación de los «paquetes» es actualizada si existe la
    línea «deb» en «/etc/apt/sources.list». La metainformación de las
    «fuentes» es actualizada si existe la línea «deb-src» en «/etc/
    apt/sources.list».

    La metainformación de los «paquetes» y de las «fuentes» contienen
    el campo «Filename:» que apunta a la ubicación del archivo de los
    paquetes fuente y binarios. En este momento, estos paquetes se
    ubican en el subárbol del directorio «pool/» para mejorar la
    transición entre distribuciones.

    Se pueden realizar búsquedas interactivas en las copias locales
    de la metainformación de los «paquetes» mediante la orden
    aptitude. La orden de búsqueda especializada grep-dctrl(1) puede
    buscar metainformación en las copias locales de los «paquetes» y
    las «fuentes».

    La copia local de la metainformación de «Contents-<architecture>»
    puede ser actualizada mediante «apt-file update» y su ubicación
    es diferente de las otras cuatro. Consulte apt-file(1). (La orden
    auto-apt usa por defecto una ubicación diferente para su copia
    local de «Contents-<architecture>.gz».)

%

2.5.5. Estado del paquete para APT

    Además de acceder de foma remota a la metainformación, desde
    lenny, la herramienta APT almacena la información local referente
    al estado de la instalación en «/var/lib/apt/extended_states» el
    cual usan el resto de herramientas APT para realizar el
    seguimiento de todos los paquetes autoinstalados.

%

2.5.6. El estado del paquete en aptitude

    Además de acceder de forma remota a la metainformación, la orden
    aptitude almacena el estado de la instalación de forma local en «
    /var/lib/aptitude/pkgstates» y este es usado únicamente por
    aptitude.

%

2.5.7. Copias locales de los paquetes descargados

    Todos los paquetes descargados de forma remota mediante APT son
    almacenados en «/var/cache/apt/archives» hasta que se limpia.

    La directriz de limpieza de los archivos de la caché en aptitude
    es configurable mediante «Options» → «Preferences» y puede ser
    invocada por medio de su menú «Clean package cache» o «Clean
    obsolete files» en «Actions».

%

2.5.8. Nombres de archivos de paquetes Debian

    Los archivos que son paquetes Debian tienen una estructura para
    nombrarlos determinada.

    Tabla 2.15. La estructura del nombre de los paquetes Debian

    +---------------------------------------------------------------+
    |      tipo de paquete       |      estructura del nombre       |
    |----------------------------+----------------------------------|
    |El paquete binario (apodado |<nombre_del_paquete>_             |
    |deb)                        |<versión_actual>-<debian-versión>_|
    |                            |<arquitectura>.deb                |
    |----------------------------+----------------------------------|
    |El paquete binario para el  |<nombre_del_paquete>_             |
    |instalador de debian        |<versión_actual>-<debian-versión>_|
    |(apodado udeb)              |<arquitectura>.udeb               |
    |----------------------------+----------------------------------|
    |El paquete fuente (fuente   |<nombre_del_paquete>_             |
    |actual)                     |<versión_actual>-                 |
    |                            |<debian-versión>.orig.tar.gz      |
    |----------------------------+----------------------------------|
    |El paquete fuente 1.0       |<nombre_del_paquete>_             |
    |(cambios Debian)            |<versión_actual>-                 |
    |                            |<debian-versión>.diff.gz          |
    |----------------------------+----------------------------------|
    |El paquete fuente 3.0       |<nombre_del_paquete>_             |
    |(envoltura (quilt)) (cambios|<versión_actual>-                 |
    |Debian)                     |<debian-versión>.debian.tar.gz    |
    |----------------------------+----------------------------------|
    |El paquete fuente           |<nombre_del_paquete>_             |
    |(descripción)               |<versión_actual>-                 |
    |                            |<debian-versión>.dsc              |
    +---------------------------------------------------------------+


    Sugerencia
   
    Únicamente describiremos aquí el formato del paquete fuente. Para
    obtener mayor información consulte dpkg-source(1).

    Tabla 2.16. Los caracteres permitidos en cada campo del nombre
    del paquete en Debian

    +---------------------------------------------------------------+
    |  nombre del campo  |  caracteres permitidos (en   |existencia |
    |                    |      expresión regular)      |           |
    |--------------------+------------------------------+-----------|
    |<nombre_del_paquete>|[a-z,A-Z,0-9,.,+,-]+          |obligatorio|
    |--------------------+------------------------------+-----------|
    |<época>:            |[0-9]+:                       |opcional   |
    |--------------------+------------------------------+-----------|
    |<versión_actual>    |[a-z,A-Z,0-9,.,+,-,:]+        |obligatorio|
    |--------------------+------------------------------+-----------|
    |<debian.versión>    |[a-z,A-Z,0-9,.,+,~]+          |opcional   |
    +---------------------------------------------------------------+


    Nota

    Se puede comprobar el orden de las versiones de los paquetes con
    la ordendpkg(1), p. ej., «dpkg --compare-versions 7.0 gt 7.~pre1
    ; echo $?» .

    Nota

    El instalador debian (d-i) usa la extensión de archivo udeb para
    sus paquetes binarios en vez de la normal deb. Un paquete udeb es
    una versión reducida de un paquete deb a la cual se le han
    eliminado los contenidos no esenciales como la documentación con
    el fin de ahorrar espacio mientras se relajan los requisitos de
    la directriz de los paquetes. Ambos paquetes, deb y udeb,
    comparten la misma estructura de paquetes. La «u» tiene el
    significado de micro.

%

2.5.9. La orden dpkg

    dpkg(1) es la herramienta de más bajo nivel para la gestión de
    paquetes Debian. Es una herramienta muy poderosa y por tanto es
    necesario usarla con cuidado.

    Cuando se instala un paquete llamado «<nombre_del_paquete>», dpkg
    sigue el siguiente procedimiento:

     1. Desempaqueta el archivo deb (equivale a «ar -x»)

     2. Ejecuta «<nombre_del_paquete>.preinst» usando debconf(1)
   
     3. Instala el contenido del paquete en el sistema (equivalente a
        «tar -x»)

     4. Ejecuta «<nombre_del_paquete>.postinst» usando debconf(1)

    El sistema debconf proporciona las llamadas interactivas de
    usuario estándar a la ayuda I18N y L10N (Capítulo 8, I18N y L10N
    ).

    Tabla 2.17. Los archivos destacados creados por dpkg

    +---------------------------------------------------------------+
    |           archivo            |   descripción del contenido    |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |relación de archivos de         |
    |<nombre_del_paquete>.conffiles|configuración (modificables por |
    |                              |el usuario)                     |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |relación de archivos y          |
    |<nombre_del_paquete>.list     |directorios instalados por el   |
    |                              |paquete                         |
    |------------------------------+--------------------------------|
    |                              |relación de resumen             |
    |/var/lib/dpkg/info/           |criptográfico MD5 de los        |
    |<nombre_del_paquete>.md5sums  |archivos instalados por el      |
    |                              |paquete                         |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |archivos de órdenes del paquete |
    |<nombre_del_paquete>.preinst  |que se ejecutan antes de su     |
    |                              |instalación                     |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |archivo de órdenes que se       |
    |<nombre_del_paquete>.postinst |ejecutan después de la          |
    |                              |instalación del paquete         |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |archivo de órdenes del paquete  |
    |<nombre_del_paquete>.prerm    |que se ejecuta antes de la      |
    |                              |eliminación del paquete         |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |archivo de órdenes del paquete  |
    |<nombre_del_paquete>.postrm   |para ser ejecutada después de la|
    |                              |eliminación del paquete         |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/info/           |archivo de órdenes para el      |
    |<nombre_del_paquete>.config   |sistema debconf                 |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/alternatives/   |la información alternativa usada|
    |<nombre_del_paquete>          |por la orden update-alternatives|
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/available       |la información disponible para  |
    |                              |todo el paquete                 |
    |------------------------------+--------------------------------|
    |                              |la información de la ubicación  |
    |/var/lib/dpkg/diversions      |alternativa usada por dpkg(1) y |
    |                              |asignada por dpkg-divert(8)     |
    |------------------------------+--------------------------------|
    |                              |la información estadística      |
    |/var/lib/dpkg/statoverride    |manual utilizada por dpkg(1) y  |
    |                              |asignada por dpkg-statoverride  |
    |                              |(8)                             |
    |------------------------------+--------------------------------|
    |/var/lib/dpkg/status          |la información del estado de    |
    |                              |todos los paquetes              |
    |------------------------------+--------------------------------|
    |                              |la primera juego de copias de   |
    |/var/lib/dpkg/status-old      |respaldo del archivo «var/lib/  |
    |                              |dpkg/status»                    |
    |------------------------------+--------------------------------|
    |                              |el segundo juego de copias de   |
    |/var/backups/dpkg.status*     |respaldo y anteriores del       |
    |                              |archivo «var/lib/dpkg/status»   |
    +---------------------------------------------------------------+


    El archivo «status» además es utilizado por herramintas como dpkg
    (1), «dselect update» y «apt-get -u dselect-upgrade».

    La orden de búsqueda especializada grep-dctrl(1) permite buscar
    en las copias locales de «status» y la metainformación
    «disponible».

    Sugerencia

    En el entorno del instalador de debian, la orden udpkg se usa
    para abrir los paquetes udeb. La orden udpkg es una versión
    reducida de la orden dpkg.

%

2.5.10. La orden update-alternatives

    En sistema Debian existe un mecanismo para tener instalados a la
    vez varios programas que realizan la misma función sin problemas
    usando update-alternatives(1). Por ejemplo, se pueden hacer que
    la orden vi seleccione vim cuando se tienen instalados los
    paquetes tanto vim y nvi.

    $ ls -l $(type -p vi)
    lrwxrwxrwx 1 root root 20 2007-03-24 19:05 /usr/bin/vi -> /etc/alternatives/vi
    $ sudo update-alternatives --display vi
    ...
    $ sudo update-alternatives --config vi
      Selection    Command
     ----------------------------------------------
          1        /usr/bin/vim
    *+    2        /usr/bin/nvi

    Enter to keep the default[*], or type selection number: 1

    El sistema «alternatives« de Debian mantiene un conjunto de
    enlaces simbólicos en «/etc/alternatives/». El uso del proceso de
    selección se encuentran en los archivos de «/var/lib/dpkg/
    alternatives/».

%

2.5.11. La orden dpkg-statoverride

    El cambio de permisos (Stat overrides) que se realiza mediante la
    orden dpkg-statoverride(8) es una manera de conseguir quedpkg(1)
    use un dueño o unos permisos de uso diferentes para un archivo
    cuando se instala un paquete. Si se especifica «--update» y el
    archivo existe , los nuevos permisos y el dueño se cambian al
    instante.

    Atención

    Los permisos o dueño en un archivo de un paquete cambiados por
    las órdenes chmod o chown ejecutadas por el administrador del
    sistema se restauran en la siguiente actualización del paquete.

    Nota

    Hemos usado la palabra archivo en los párrafos anteriores, pero
    realmente estos cambios pueden ser realizados sobre cualquier
    objeto del sistema de archivos que gestione dpkg, incluidos
    directorios, dispositivos, etc.

%

2.5.12. La orden dpkg-divert

    Las ubicaciones alternativas de un archivo que se realizan
    mediante la orden dpkg-divert(8) son una forma de obligar a dpkg
    (1) de instalar un archivo en una ubicación alternativa y no en
    su ubicación por defecto. Los archivos de órdenes de
    mantenimiento del paquete son los encargados del uso de
    dpkg-divert. Es una práctica en desuso su utilización por el
    administrador del sistema.

%

2.6. Recuperación de un sistema

    Cuando se mantiene un sistema Debian distribución «inestable», se
    espera que el administrador sea capaz de recuperarlo de
    situaciones en las que se encuentren paquetes rotos.

    Atención
   
    Algunos métodos que vamos a exponer conllevan acciones muy
    peligrosas. ¡Usted ha sido avisado!.

%

2.6.1. Incompatibilidad con la configuración antigua del usuario

    Si el programa de interfaz gráfico de usuario del escritorio es
    inestable después de una actualización de versión importante, se
    debe sospechar de como interacciona con los archivos de
    configuración antiguos. La estabilidad en una cuenta de usuario
    recien creada confirmará esta hipótesis. ( Es un fallo habitual
    de empaquetado que generalmente no es tenido en cuenta por el
    empaquetador),

    Para recuperar la estabilidad, se deben mover los archivos de la
    configuración local correspondientes y reiniciar el interfaz
    gráfico. Puede que necesite leer los archivos de configuración
    antiguos para recuperar información de configuración
    posteriormente. ( No los borre antes de tiempo).

%

2.6.2. Superposición de archivos por diferentes paquetes

    Los sistemas de gestión de paquetes, al nivel de archivo, como 
    aptitude(8) o apt-get(1), ni siquiera tratan de instalar paquetes
    con archivos superpuestos usando las dependencias de los paquetes
    (see Sección 2.1.6, “Dependencias de paquetes”).

    Los errores de los mantenedores de paquetes o la inconsistencia
    en el despliegue de archivos de fuentes mezclados (see
    Sección 2.7.2, “Paquetes de fuentes varias en los repositorios”)
    por parte del administrador del sistema puede crear situaciones
    con una definición incorrecta de las dependencias del paquete.
    Cuando se instala un paquete que superpone archivos usando 
    aptitude(8) o apt-get(1), dpkg(1) se encarga de devolver un error
    al programa que lo llamó sin sobreescribir los archivos
    existentes.

    Atención

    El uso de paquetes de terceras partes añade riesgos
    significativos para el sistema a través de los archivos de
    órdenes de mantenimiento, ya que son ejecutados con los
    privilegios de superusuario y pueden realizar cualquier cosa en
    su sistema. La orden dpkg(1) solo ofrece protección contra la
    sobreescritura en el desempaquetado.

    Se puede arreglar una instalación deficiente eliminando en primer
    lugar el paquete incompatible anterior <old-package>.

    $ sudo dpkg -P <old-package>

%

2.6.3. Arreglando un archivo de órdenes de un paquete roto

    Cuando una orden en un archivo de órdenes de un paquete devuelve
    un error y el archivo de órdenes finaliza con el error, el
    sistema de gestión de paquetes cancela sus acciones y finaliza
    con paquetes instalados parcialmente. Cuando un paquete contiene
    un error en los archivos de órdenes de eliminación, el paquete
    puede volverse imposible de eliminar y bastante molesto.

    Para un problema con los archivos de órdenes de un paquete «
    <nombre_del_paquete>», debe comprobar los siguientes archivos de
    órdenes del paquete:

      * «/var/lib/dpkg/info/<nombre_del_paquete>.preinst»

      * «/var/lib/dpkg/info/<nombre_del_paquete>.postinst»
   
      * «/var/lib/dpkg/info/<nombre_del_paquete>.prerm»

      * «/var/lib/dpkg/info/<nombre_del_paquete>.postrm»

    Modifique el archivo de órdenes del paquete erroneo como
    superusurio aplicando las siguiente técnicas:

      * deshabilite la línea incorrecta precediendola del carácter «#
        »
   
      * oblige a devolver éxito añadiendo a la línea incorrecta «||
        true»

    Configure todos los paquetes instalados parcialmente con la
    siguiente orden:

    # dpkg --configure -a

%

2.6.4. Recuperación con la orden dpkg

    Ya que dpkg es una herramienta de paquetes de muy bajo nivel,
    puede ser útil en situaciones críticas como un sistema que no
    inicia sin conexión a la red. Asumamos que el paquete foo esta
    roto y necesita ser sustituido.

    Se pueden encontrar versiones antiguas del paquete foo libres de
    errores en las copias locales (cachés) en el directorio de caché
    de paquetes: «/var/cache/apt/archives/». (Si no, se pueden
    descargar del repositorio de https://snapshot.debian.org/ or
    copiar desde la caché de paquetes de un equipo en
    funcionamiento).

    Si puede iniciar el sistema, se puede instalar con la siguiente
    orden:

    # dpkg -i /ruta/a/foo_<versión_antigua>_<arquictectura>.deb

    Sugerencia

    Si el sistema tiene un error menor, otra alternativa es realizar
    un actualización del sistema completo a una versión anterior
    (downgrade) como en Sección 2.7.10, “Volver al estado anterior
    por emergencia” por medio de las herramientas de alto nivel del
    sistema APT.

    Si el sistema no se puede iniciar desde el disco duro, se pueden
    encontrar otras formas de iniciarlo.

     1. Iniciar el sistema mediante un CD de instalación de Debian en
        modo rescate.

     2. Montar el sistema que no inicia en el disco duro en «/
        destino».

     3. Instalar una versión anterior del paquete foo mediante:

    # dpkg --root /destino -i /ruta/a/foo_<versión_antigua>_<arquitectura>.deb

    Este ejemplo funciona incluso si la orden dpkg del disco duro
    está roto.

    Sugerencia

    Cualquier sistema GNU/Linux iniciado por otro sistema en disco
    duro, CD live GNU/Linux CD, llavero USB iniciable, o inicio
    mediante red pueede ser usado para recuperar un sistema roto.

    Si trata de instalar de esta manera un paquete y dicha
    instalación falla debido a la violación de alguna dependencia y
    es la única manera de solucionarlo, se puede ignorar la
    dependencia utilizando dpkg's «--ignore-depends»,
    «--force-depends» y otras opciones. Si lo hace así, será
    necesario un gran esfuerzo para más tarde restaurar la propia
    dependencia. Consulte para más detalles dpkg(8).

    Nota

    Si su sistema esta inoperativo por errores graves, debería
    realizar una copia de respaldo del sistema a un lugar seguro (see
    Sección 10.2, “Respaldo y recuperación”) y realizar una
    instalación limpia. Esto le llevará menos tiempo y al final
    tendrá un mejor resultado.

%

2.6.5. Recuperando datos de la selección de paquetes

    Si por alguna razón estuviera dañado el archivo «/var/lib/dpkg/
    status», el sistema Debian perdería la información de la
    selección de los paquetes y quedaría seriamente dañado. Busque un
    archivo antiguo «/var/lib/dpkg/status» en «/var/lib/dpkg/
    status-old» o «/var/backups/dpkg.status.*».

    Mantener «/var/backups/» en una partición separada puede ser una
    buena idea ya que dicho directorio contiene gran cantidad de
    información impotante del sistema.

    Cuando los daños son serios, recomiendo realizar una
    reinstalación limpia del sistema haciendo una copia de respaldo
    del sistema anterior. Incluso si ha desaparecido todo lo que
    había en «/var/», todavía puede recuperar alguna información de
    los directorios en «/usr/share/doc/» que le ayudarán en su nueva
    instalación.

    Reinstalando un sistema mínimo (de escritorio).

    # mkdir -p /ruta/al/viejo/sistema

    Monte el sistema antiguo en «/ruta/al/viejo/sistema».

    # cd /ruta/al/viejo/sistema/usr/share/doc
    # ls -1 >~/ls1.txt
    # cd /usr/share/doc
    # ls -1 >>~/ls1.txt
    # cd
    # sort ls1.txt | uniq | less

    A continuación se enumerarían los nombres de los paquetes a
    instalar. (Puede haber algunos nombres que no correspondan a
    paquetes como «texmf».)

2.7. Consejos para la gestión de paquetes

%

2.7.1. Como seleccionar paquetes Debian

    Se pueden buscar los paquetes que cumplan sus requisitos con
    aptitude bien en base a la descripción del paquete o con la
    relación de «Tareas«.

    Si se encuentra con dos paquetes parecidos y no sabe cual
    instalar sin realizar «pruebas y errores«, debe aplicarse el 
    sentido común Pienso que los siguientes consejos son útiles para
    seleccionar los paquetes adecuados:

      * Esencial: si > no

      * Área: main > contrib > non-free

      * Prioridad: required > important > standard > optional > extra

      * Tareas: paquetes enumerados como tareas como «Entorno de
        escritorio«

      * Paquetes elegidos como dependecias de paquetes (p. ej.,
        python2.4 por python)

      * Estadísticas: a mayor número de votos e instalaciones
   
      * Registro de cambios: actualizaciones regulares del
        desarrollador

      * BTS: sin errores RC (ni críticos, ni graves, ni errores
        leves)

      * BTS: atención ofrecida por el desarrollador a los informes de
        errores

      * BTS: mayor número de errores solucionados recientemente

      * BTS: menor número de errores que no sean nuevas
        funcionalidades

    Debian comenzó como un proyecto voluntario con un modelo de
    desarrollo distribuido, sus repositorios contienen muchos
    paquetes con diferentes objetivos y calidad. Se deben tomar las
    decisiones propias acerca de qué hacer con ellos.

%

2.7.2. Paquetes de fuentes varias en los repositorios

    Atención

    La instalación de paquetes desde fuentes de múltiples
    repositorios no se permite en la distribución oficial Debian
    excepto para las combinaciones oficiales de repositorios como
    estable con actualizaciones de seguridad y bullseye-updates.

    Se muestra un ejemplo de las operaciones que incluyen la versión
    más reciente de paquetes encontrados en «inestable» mientras se
    realiza el seguimiento en una única ocasión de «en pruebas».

     1. Cambie el archivo «/etc/apt/sources.list» de forma temporal a
        una entrada única «unstable».

     2. Ejecute «aptitude update».

     3. Ejecute «aptitude install <nombre_del_paquete>».

     4. Recupere la versión original de«/etc/apt/sources.list» para
        «en pruebas».

     5. Ejecute «aptitude update».

    No cree el archivo «/etc/apt/preferences» ni preocupese por la
    forma de hacerlo manualmente mediante «apt-pinning«. Ya que es
    muy engorroso.

    Atención

    Cuando se usan archivos de múltiples fuentes, usted se debe
    asegurar de la compatibilidad de los paquetes por usted mismo, ya
    que Debian no lo garantiza. Si existe incompatibilidad entre
    paquetes, se puede romper el sistema. Usted debe ser capaz de
    decidir dichos requisitos técnicos. El uso de archivos de
    múltiples fuentes desconocidas es una operación completamente
    opcional y su uso es algo que se desaconseja encarecidamente.

    Las reglas generales para la instalación de paquetes de
    diferentes repositorios son:

      * Los paquetes no binarios («Arquitectura: todas») son seguros 
        de instalar.

          + paquetes de documentación: no tienen requisitos
            especiales

          + paquetes de intérpretes: los intérpretes compatibles
            deben estar disponibles

      * Los paquetes binarios (no «arquitecturas: todas»)
        generalmente se encuentran con bloqueos y son inseguros de
        instalar.

          + compatiblidad de las versiones de biblioteca (incluida
            «libc»)

          + relacionados con la compatibilidad de versiones de los
            programas de utilidad

          + Núcleo ABI de compatibilidad

          + C++ ABI de compatibilidad

          + …

    Nota

    Para asegurar la instalación segura de un paquete, algunos
    paquetes binarios comerciales «non-free« pueden incluir
    bibliotecas enlazadas estaticamente. Se debe comprobar su
    compatibilidad ABI.

    Nota

    Con la excepción de evitar la rotura de algún paquete de forma
    transitoria, es una mala idea la instalación de paquetes binarios
    de repositorios binarios no soportados oficialmente. Esto es
    cierto incluso si se utiliza «apt-pinning« (consulte
    Sección 2.7.3, “Seleccionando la versión candidata”). Debería
    evaluar la técnica de chroot (consulte Sección 9.10, “Sistemas
    virtualizados”) o similares para ejecutar programas de
    repositorios diferentes.

%

2.7.3. Seleccionando la versión candidata

    Sin el archivo «/etc/apt/preferences», el sistema APT elige la 
    versión candidata como la última versión disponible utilizando la
    versión de la cadena de caracteres. Este es el proceso normal y
    recomentado para el uso del sistema APT. Todas las combinaciones
    de repositorios con soporte oficial no necesitan el archivo «/etc
    /apt/preferences» ya que algunos respositorios no deberían usarse
    para realizar actualizaciones y para que el funcionamiento sea el
    correcto se marcan como NotAutomatic.

    Sugerencia

    La forma en que se comparan las cadenas de caracteres de las
    versiones puede ser comprobada mediante, p. ej., «dpkg
    --compare-versions ver1.1 gt ver1.1~1; echo $?» (consulte dpkg(1)
    ).

    Cuanso se usa como origen para instalación de paquetes, un
    conjunto mixto de repositorios con regularidad (consulte
    Sección 2.7.2, “Paquetes de fuentes varias en los repositorios”),
    mediante el archivo «/etc/apt/preferences» se puede automatizar
    este tipo de operaciones complejas, creando dicho archivo con las
    entradas adecuadas y modificando la forma en que se seleccionan
    la versión candidata de los paquetes según se describe en 
    apt_preferences(5). Esta operación recibe el nombre de alteración
    de la selección de paquetes (apt-pinning).

    Aviso

    El uso de apt-pinning por un usuario no experimentado es una
    causa segura de problemas graves. Se debe evitar la alteración de
    la selección de paquetes (apt-pinning) excepto cuando sea
    absolutamente indispensable.

    Atención

    Cuando use apt-pinning, usted se debe asegurar de la
    compatibilidad de los paquetes ya que Debian no lo garantiza. La
    alteración de la selección de paquetes es una operación opcional
    y es algo que no le animo a experimentar.

    Atención

    Las reglas de apt_preferences(5) utilizan los archivos «Release»
    a nivel de archivo (consulte Sección 2.5.3, “Archivos «Release» a
    nivel de archivo”). Así «apt-pinning» funciona únicamante con los
    nombres de los repositorios normales de Debian y repositorios de
    seguridad de Debian. (Esto es diferente para los repositorios de
    Ubuntu). Por ejemplo, se puede hacer «Pin: release a=unstable»
    pero no se puede hacer «Pin: release a=sid» en el archivo «/etc/
    apt/preferences».

    Atención

    Cuando se usan repositorios que no son de Devian como parte de
    «apt-pinning«, debería comprobar lo que hacen y comprobar su
    credibilidad. Por ejemplo, Ubuntu y Debian no deben mezclarse.

    Nota

    Incluso si no crea el archivo «/etc/apt/preferences», se pueden
    realizar operaciones complejas de forma correcta sin
    «apt-pinning« (consulte Sección 2.6.4, “Recuperación con la orden
    dpkg”y Sección 2.7.2, “Paquetes de fuentes varias en los
    repositorios”).

    Aquí está una explicación simplificada de la técnica apt-pinning.

    El sistema APT elige el valor de la prioridad de pin
    (Pin-Priority) mayor actualizando el paquete desde la fuente
    disponible indicado en el archivo «/etc/apt/sources.list» como el
    paquete de la versión candidata. Si la «pin-priority« del paquete
    es mayor que 1000, esta restricción de la versión para la 
    actualización se descarta para permitir realizar un «downgrading«
    (consulte Sección 2.7.10, “Volver al estado anterior por
    emergencia”).

    El valor Pin-Priority de cada paquete se deine por las entradas
    de «Pin-Priority« en el archivo «/etc/apt/preferences» o usa su
    valor por defecto.

    Tabla 2.18. Relación de valores Pin-Priority importantes para la
    técnica apt-pinning.

    +---------------------------------------------------------------+
    |Pin-Priority|        efectos apt-pinning en el paquete         |
    |------------+--------------------------------------------------|
    |1001        |instala el paquete incluso si esto significa un   |
    |            |«downgrade« del paquete                           |
    |------------+--------------------------------------------------|
    |990         |se usa como valor por defecto para la distribución|
    |            |objetivo del repositorio                          |
    |------------+--------------------------------------------------|
    |500         |se usa como valor por defecto para el repositorio |
    |            |normal                                            |
    |------------+--------------------------------------------------|
    |100         |usada como valor por defecto para repositorios «  |
    |            |NotAutomatic« y «ButAutomaticUpgrades             |
    |------------+--------------------------------------------------|
    |100         |usada para el paquete instalado                   |
    |------------+--------------------------------------------------|
    |1           |usado como el valor por defecto para repositorios |
    |            |«NotAutomatic«                                    |
    |------------+--------------------------------------------------|
    |-1          |para no instalar nunca el paquete aunque sea      |
    |            |recomendado                                       |
    +---------------------------------------------------------------+


    La distribución objetivo del repositorio puede ser asignado por
    varios métodos,

      * Añadir al archivo de configuración «/etc/apt/apt.conf» la
        línea«APT::Default-Release «stable«;»
   
      * línea de órdenes, p. ej., «apt-get install -t testing
        some-package»

    Los repositorios «NotAutomatic« y «ButAutomaticUpgrades« es
    asignado por el servidor teniendo su archivo de nivel «Release«
    (consulte Sección 2.5.3, “Archivos «Release» a nivel de archivo”)
    contiene tanto «NotAutomatic: yes» como «ButAutomaticUpgrades:
    yes». El repositorio «NotAutomatic« es asignado por el servidor
    teniendo su archivo de nivel «Release« el literal «NotAutomatic:
    yes».

    La situación de apt-pinning del <paquete> que se encuentra en
    múltiples repositorios de origen puede mostrarse con «apt-cache
    policy <paquete>».

      * Una línea que empieza por «Package pin:» muestra la versión
        del paquete de pin si la asociación se define solo con
        <package> p. ej., «Package pin:0.190».

      * No existirá la línea !Package pin:» si no se ha definido
        ninguna asociación con el <paquete>.

      * El valor de «Pin-Priority« asociado con el <paquete> es
        mostrado al lado derecho de todas las cadenas de caracteres
        de las versiones, p. ej. 0.181 700».

      * «0» se muestra a la derecha de todas las cadenas de
        caracteres de las versiones si esta definida la asociación
        con el <paquete> p. ej., «0.181 0».

      * Los valores de la Pin-Priority de los repositorios (definido
        como «Package: *» en el archivo «/etc/apt/preferences» ) se
        muestra a la izquierda de todas las rutas de archivo, p.ej.,
        «100 http://deb.debian.org/debian/ bullseye-backports/main
        Packages».

%

2.7.4. Actualizaciones y portes hacia atrás

    Existen los repositorios bullseye-updates y backports.debian.org
    que aportan paquetes actualizados para estable (bullseye).

    Para usar dichos repositorios, deben aparecer en el archivo «/etc
    /apt/sources.list» lo siguiente:

    deb http://deb.debian.org/debian/ bullseye main contrib non-free
    deb http://security.debian.org/ bullseye/updates main contrib
    deb http://deb.debian.org/debian/ bullseye-updates main contrib non-free
    deb http://deb.debian.org/debian/ bullseye-backports main contrib non-free

    No es necesario asignar un valor explícito Pin-Priority en el
    archivo «/etc/apt/preferences». Cuando hay nuevos paquetes
    disponibles, la configuración por defecto proporciona las
    actualizaciones más sensao (consulte Sección 2.5.3, “Archivos
    «Release» a nivel de archivo”).

      * Todos los paquetes viejos son actualizados a los nuevos con
        origen en bullseye-updates.
   
      * Solo los paquetes antiguios instalados de forma manual desde
        bullseye-backports son actualizados a los nuevos de
        bullseye-backports.

    Cuando ocurra que se desee instalar manualmente un paquete
    llamado «<nombre_del_paquete>» con su dependencia del repositorio
    bullseye-backports, se usa la siguiente orden mientras se cambia
    la distribución objetivo con la opción «-t».

    $ sudo apt-get install -t bullseye-backports <nombre_del_paquete>

2.7.5. Bloqueo de la instalación de paquetes recomendados
(«Recommends«)

    Si no quiere que un paquete concreto que está recomendado se
    instale, se debe crear de forma explícita en el archivo «/etc/apt
    /preferences» una relación de estos paquetes como se muestra a
    continuación:

    Package: <paquete-1>
    Pin: version *
    Pin-Priority: -1
   
    Package: <paquete-2>
    Pin: version *
    Pin-Priority: -1

%

2.7.6. Seguimiento «en pruebas» con algunos paquetes de «inestable»

    A continuación se tiene un ejemplo de como usar la técnica de 
    apt-pinning en las actualizaciones de «en pruebas» para usar una
    versión nueva de un paquete de «inestable». Se deben enumerar
    todos los repositorios necesarios en el archivo «/etc/apt/
    sources.list» como se muestra a continuación:

    deb http://deb.debian.org/debian/ testing main contrib non-free
    deb http://deb.debian.org/debian/ unstable main contrib non-free
    deb http://security.debian.org/ testing/updates main contrib

    Modifique «/etc/apt/preferences» como sigue:

    Package: *
    Pin: release a=unstable
    Pin-Priority: 100

    Cuando desee instalar un paquete llamado «<nombre_del_paquete>»
    con sus dependencias desde el respositorio «inestable» con esta
    configuración, debe ejecutar la orden siguiente que cambia la
    distribución del repositorio con la opción «-t» (Pin-Priority of
    «inestable» con el valor 990).

    $ sudo apt-get install -t unstable <nombre_del_paquete>

    Con esta configuración la actualización de paquetes «apt-get
    upgrade» y «apt-get dist-upgrade» (o «aptitude safe-upgrade» y
    «aptitude full-upgrade») se realiza de la siguiente manera: los
    paquetes que han sido instalados desde el repositorio «en
    pruebas» usan su correspondiente repositorio «en pruebas» y los
    paquetes instalados desde la distribución «inestable» usan su
    correspondiente repositorio «inestable».

    Atención

    Tenga cuidado con eliminar la entrada «testing» del archivo «/etc
    /apt/sources.list». Sin dicha entrada «testing» en él, el sistema
    APT actualizará los paquetes usando la nueva distribución
    «inestable».

    Sugerencia

    Generalmente edito el archivo «/etc/apt/sources.list» para
    comentar la entrada ««inestable»» del archivo justo después de
    realizar la operación anterior. Esto evita que el proceso de
    actualización se ralentice portener demasiadas entradas en el
    archivo «/etc/apt/sources.list» aunque esto impide que se
    actualicen los paquetes que fueron instalados desde el
    repositorio «inestable» usando dicho repositorio actual.

    Sugerencia

    Si se utiliza «Pin-Priority: 1 « en vez de «Pin-Priority: 100» en
    el archivo« / etc/apt/preferences «, los paquetes instalados con
    anterioridad que tienen un valor de Pin-Priority de 100 no se
    actualizarán del repositorio «inestable» incluso si se elimina la
    entrada ««en pruebas»» del archivo «/etc/apt/sources.list».

    Si desea mantener automáticamente algunos paquetes particulares
    de «inestable» sin la instalación inicial «-*t unstable», tiene
    que crear el archivo «/etc/apt/preferences» literal y
    explícitamente enumerar al principio todos aquellos paquetes como
    sigue:

    Package: <package-1>
    Pin: release a=unstable
    Pin-Priority: 700
   
    Package: <package-2>
    Pin: release a=unstable
    Pin-Priority: 700

    Esto realiza un ajuste del valor de «Pin-Priority« para cada
    paquete. Por ejemplo, con el fin de mantener la última versión de
    «inestable» de esta «Referencia de Debian« en inglés, usted debe
    tener la siguiente entrada en el archivo «/ etc/apt/preferences».

    Package: debian-reference-en
    Pin: release a=unstable
    Pin-Priority: 700
   
    Package: debian-reference-common
    Pin: release a=unstable
    Pin-Priority: 700

    Sugerencia

    Esta técnica de apt-pinning es válida incluso para mantener
    paquetes de la distribución stable. En mi experiencia es más
    seguro tener los paquetes de documentación de la distribución
    «inestable».

%

2.7.7. Mantener «inestable» con algunos paquetes de experimental

    Este es otro ejemplo de técnica apt-pinning para incluir nuevas
    versiónes de los paquetes en experimental mientras se mantiene
    «inestable». Enumera todos los repositorios necesarios en el
    archivo «/etc/apt/sources.list» como sigue:

    deb http://deb.debian.org/debian/ unstable main contrib non-free
    deb http://deb.debian.org/debian/ experimental main contrib non-free
    deb http://security.debian.org/ testing/updates main contrib

    El valor por defecto de «Pin-Priority« para el repositorio
    experimental es siempre 1(<<100) ya que es un repositorio «
    NotAutomatic« (see Sección 2.5.3, “Archivos «Release» a nivel de
    archivo”). No es necesario asignar de forma explícita un valor
    «Pin-Priority« en el archivo «/etc/apt/preferences» para usar el
    repositorio experimental a menos que quieras mantener
    determinados paquetes de forma automática en la siguiente
    actualización.

%

2.7.8. Descarga y actualización automática de paquetes

    El paquete apt incluye su propio archivo de órdenes cron «/etc/
    cron.daily/apt» que se encarga de la descarga automática de
    paquetes. Este archivo de órdenes puede ser mejorado para la
    actualización automática de paquetes mediante la instalación del
    paquete unattended-upgrades. Se puede personalizar mediante los
    parámetros de los archivos «/etc/apt/apt.conf.d/02backup» y «/etc
    /apt/apt.conf.d/50unattended-upgrades» según se describe en «/usr
    /share/doc/unattended-upgrades/README».

    El paquete unattended-upgrades esta pensado para realizar las
    actualizaciones de seguridad de un sistema estable. Si el riesgo
    de que se rompa un sistema estable por una actualización
    automática es menor de que el sistema se rompa por un intruso
    usando un agujero de seguridad que podría haber sido cerrado por
    una actualización automática, debería considerar usar las
    actualizaciones automáticas con una configuración de parámetros
    como la siguiente:

    APT::Periodic::Update-Package-Lists «1«;
    APT::Periodic::Download-Upgradeable-Packages «1«;
    APT::Periodic::Unattended-Upgrade «1«;

    Si esta ejecutando un sistema con la distribución «inestable», no
    querrá usar las actualizaciones automáticas ya que con toda
    seguridad el sistema se romperá en algún momento. Incluso para un
    caso como «inestable», todavía puede que quiera descargar los
    paquetes por adelantado para ahorrar tiempo en una actualización
    interactiva con la configuración de los parámetros según se
    indica:

    APT::Periodic::Update-Package-Lists «1«;
    APT::Periodic::Download-Upgradeable-Packages «1«;
    APT::Periodic::Unattended-Upgrade «0«;

%

2.7.9. Limitar el ancho de banda de descarga para APT

    Si quiere limitar el ancho de banda de descarga para APT, p. ej.
    a 800Kib/sec (=100kiB/sec), debe configurar APT con los
    siguientes parámetros:

    APT::Acquire::http::Dl-Limit «800«;

%

2.7.10. Volver al estado anterior por emergencia

    Atención

    El hecho de volver a un estado anterior no esta soportado
    oficialmente por el diseño de Debian. Debe ser hecho únicamente
    como parte de un proceso de recuperación de emergencia. Aparte de
    esta situación, es una técnica que funciona muy bien para muchos
    problemas. En sistemas críticos debe realizar una copia de
    respaldo de todos los datos del sistema antes de realizar una
    operación de recuperación y reinstalar el sistema desde el
    principio.

    Puede tener suerte en volver de una versión nueva de un
    repositorio a una vieja al recuperarse de una actualización que
    rompa el sistema manipulando la versión_candidata (see
    Sección 2.7.3, “Seleccionando la versión candidata”). Esta es una
    posibilidad lenta a realizar la tediosa acción de ejecutar muchas
    órdenes «dpkg -i <paquete_roto>_<versión_antigua>.deb» (consulte
    Sección 2.6.4, “Recuperación con la orden dpkg”).

    Busque las líneas del archivo «/etc/apt/sources.list» para
    mantener «inestable» como sigue a continuación:

    deb http://deb.debian.org/debian/ sid main contrib non-free

    Sustituyalo por lo siguiente para mantener «en pruebas».

    deb http://deb.debian.org/debian/ bookworm main contrib non-free

    Modifique «/etc/apt/preferences» como sigue:

    Package: *
    Pin: release a=testing
    Pin-Priority: 1010

    Ejecute «apt-get update; apt-get dist-upgrade» para forzar la
    vuelta al estado anterior del sistema completo.

    Elimine es fichero particular «/etc/apt/preferences» después de
    la vuelta atrás de emergencia.

    Sugerencia

    Es una buena idea eliminar (¡que no purgar!) tantos paquetes como
    sea posible para minimizar los problemas de dependencias. Puede
    necesitar eliminar de forma manual e instalar algunos paquetes
    para tener un sistema restaurado. El núcleo de Linux, bootloader,
    udev, PAM, APT y los paquetes de red y sus archivos de
    configuraciñon pueden necesitar atención especial.

%

2.7.11. ¿Quién sube los paquetes?

    Aunque el nombre del desarrollador que aparece en «/var/lib/dpkg/
    available» y «/usr/share/doc/package_name/changelog» aporta
    alguna información sobre «quién esta detrás del desarrollo del
    paquete«, la persona real que actualmente lo actualiza es algo
    oscuro. who-uploads(1) en el paquete devscripts identifica quién
    es el actualizador real en este momento del paquete fuente
    Debian.

%

2.7.12. El paquete «equivs«

    Si ha compilado un programa de su fuente para sustituir a un
    paquete Debian, la mejor forma de hacerlo es crear un paquete
    local «debianizado« (*.deb) y usar un repositorio privado.

    Si en lugar de ello elige compilar un programa desde su código
    fuente e instalarlo en «/usr/local» , puede que necesite equivs
    para la menos satisfacer las dependencias ausentes del paquete.

    Package: equivs
    Priority: optional
    Section: admin
    Description: Circumventing Debian package dependencies
     This package provides a tool to create trivial Debian packages.
     Typically these packages contain only dependency information, but they
     can also include normal installed files like other packages do.
     .
     One use for this is to create a metapackage: a package whose sole
     purpose is to declare dependencies and conflicts on other packages so
     that these will be automatically installed, upgraded, or removed.
     .
     Another use is to circumvent dependency checking: by letting dpkg
     think a particular package name and version is installed when it
     isn't, you can work around bugs in other packages' dependencies.
     (Please do still file such bugs, though.)

%

2.7.13. Portar un paquete a un sistema estable

    Para actualizaciones parciales de un sistema estable, es deseable
    reconstruir un paquete con su entorno usando el paquete fuente.
    Esto evita las actualizaciones masivas de paquetes necesarias por
    sus dependencias.

    Añada las siguientes entradas al archivo «/etc/apt/sources.list»
    de un sistema estable.

    deb-src http://deb.debian.org/debian unstable  main contrib non-free

    Instale los paquetes necesarios para la compilación y descarga
    del paquete fuente como lo que sigue:

    # apt-get update
    # apt-get dist-upgrade
    # apt-get install fakeroot devscripts build-essential
    # apt-get build-dep foo
    $ apt-get source foo
    $ cd foo*

    Actualice los paquetes de herramientas como dpkg y debhelper de
    los paquetes «backport« si son necesarios para portarlo hacia
    atrás.

    Ejecute lo siguiente:

    $ dch -i

    Cambie la versión del paquete, p. ej. concatenado con «+bp1» en
    «debian/changelog»

    Construya los paquetes e instalelos en el sistema somo sigue:

    $ debuild
    $ cd ..
    # debi foo*.changes

%

2.7.14. Servidor proxy para APT

    Ya que el sistema de copias espejo de todas las subsecciones del
    repositorio de Debian despercia espacio en disco y ancho de banda
    de red, cuando existen muchos equipos con Debian en red se debe
    considerar el despliegue de un servidor «proxy» local para APT.
    APT se puede configurar para utilizar servidores «proxy» genérico
    web (http) como squid (consulte Sección 6.10, “Servidores de
    aplicaciones en otras redes”) según se describe en apt.conf(5) y
    en «/usr/share/doc/apt/examples/configure-index.gz». La
    configuración del servidor «proxy» puede realizarse mediante la
    variable de entorno «$http_proxy» como sustituto de la
    configuración en el archivo «/etc/apt/apt.conf».

    Existen herramientas especiales proxy para repositorios Debian.
    Compruebe BTS antes de usarlos.

    Tabla 2.19. Relación de herramientas de proxy especificas para el
    repositorio Debian

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|         descripción          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |Servidor de caché proxy para  |
    |approx       |V:0, I:0   |6317  |archivos del repositorio      |
    |             |           |      |Debian (programa OCaml        |
    |             |           |      |compilado)                    |
    |-------------+-----------+------+------------------------------|
    |             |           |      |Proxy caché para archivos de  |
    |apt-cacher   |V:0, I:0   |289   |código fuente y paquetes      |
    |             |           |      |Debian (programa Perl)        |
    |-------------+-----------+------+------------------------------|
    |             |           |      |Proxy caché para la           |
    |apt-cacher-ng|V:5, I:5   |1488  |distribución de paquetes de   |
    |             |           |      |softwre (programa compilado en|
    |             |           |      |C++)                          |
    +---------------------------------------------------------------+


    Atención

    Cuando Debian reorganiza la estructura del repositorio, estas
    herramientas proxy especializadas necesitan la reescritura de su
    código por parte del desarrollador Debian y pueden no ser
    operativas durante cierto tiempo. Por otro lado, los servidores
    proxy genéricos web (http) son más robustos y es más fácil hacer
    frente a esos cambios.

%

2.7.15. Repositorio pequeño y público de paquetes

    Sugerencia

    Instalar un repositorio de paquetes de forma manual es
    complicado. Existen varias herramientas para la gestión de
    repositorios. Puede consultar una lista completa a través de
    Internet.

    Aquí esta un ejemplo de la creación manual de un repositorio
    público compatible con el sistema «secure APT« (consulte
    Sección 2.5.2, “Archivo «Release» del nivel superior y
    autenticación”). Asumamos algunas cosas:

      * Nombre de la cuenta de usuario: «foo»

      * Nombre de equipo: «www.example.com»

      * Paquetes necesarios: apt-utils, gnupg y otros paquetes

      * URL: «http://www.example.com/~foo/» ( → «/home/foo/
        public_html/index.html»)

      * Arquitectura de paquetes: «amd64»

    Cree la clave del repositorio APT de Foo en su sistema servidor
    como sigue:

    $ ssh foo@www.example.com
    $ gpg --gen-key
    ...
    $ gpg -K
    ...
    sec   1024D/3A3CB5A6 2008-08-14
    uid                  Foo (ARCHIVE KEY) <foo@www.example.com>
    ssb   2048g/6856F4A7 2008-08-14
    $ gpg --export -a 3A3CB5A6 >foo.public.key

    Publique el archivo de la clave del repositirio !foo.public.key»
    con el identificador (ID) de la clave 3A3CB5A6» para Foo

    Crear el árbol del repositorio llamado «Origin: Foo« como sigue:

    $ umask 022
    $ mkdir -p ~/public_html/debian/pool/main
    $ mkdir -p ~/public_html/debian/dists/unstable/main/binary-amd64
    $ mkdir -p ~/public_html/debian/dists/unstable/main/source
    $ cd ~/public_html/debian
    $ cat > dists/unstable/main/binary-amd64/Release << EOF
    Archive: unstable
    Version: 4.0
    Component: main
    Origin: Foo
    Label: Foo
    Architecture: amd64
    EOF
    $ cat > dists/unstable/main/source/Release << EOF
    Archive: unstable
    Version: 4.0
    Component: main
    Origin: Foo
    Label: Foo
    Architecture: source
    EOF
    $ cat >aptftp.conf <<EOF
    APT::FTPArchive::Release {
      Origin «Foo«;
      Label «Foo«;
      Suite «unstable«;
      Codename «sid«;
      Architectures «amd64«;
      Components «main«;
      Description «Public archive for Foo«;
    };
    EOF
    $ cat >aptgenerate.conf <<EOF
    Dir::ArchiveDir «.«;
    Dir::CacheDir «.«;
    TreeDefault::Directory «pool/«;
    TreeDefault::SrcDirectory «pool/«;
    Default::Packages::Extensions «.deb«;
    Default::Packages::Compress «. gzip bzip2«;
    Default::Sources::Compress «gzip bzip2«;
    Default::Contents::Compress «gzip bzip2«;

    BinDirectory «dists/unstable/main/binary-amd64« {
      Packages «dists/unstable/main/binary-amd64/Packages«;
      Contents «dists/unstable/Contents-amd64«;
      SrcPackages «dists/unstable/main/source/Sources«;
    };

    Tree «dists/unstable« {
      Sections «main«;
      Architectures «amd64 source«;
    };
    EOF

    Puede automatizar las actualizaciones repetitivas del contenido
    del repositorio APT en su sistema servidor mediante la
    configuración dupload.

    Ubique todos los archivos de paquetes en !~foo/public_html/debian
    /pool/main/» ejecutando «dupload -t foo archivo_de_cambios» en el
    cliente mientras tiene «~/.dupload.conf» con el contenido que
    sigue:

    $cfg{'foo'} = {
      fqdn => «www.example.com«,
      method => «scpb«,
      incoming => «/home/foo/public_html/debian/pool/main«,
      # The dinstall on ftp-master sends emails itself
      dinstall_runs => 1,
    };
   
    $cfg{'foo'}{postupload}{'changes'} = «
      echo 'cd public_html/debian ;
      apt-ftparchive generate -c=aptftp.conf aptgenerate.conf;
      apt-ftparchive release -c=aptftp.conf dists/unstable >dists/unstable/Release ;
      rm -f dists/unstable/Release.gpg ;
      gpg -u 3A3CB5A6 -bao dists/unstable/Release.gpg dists/unstable/Release'|
      ssh foo@www.example.com  2>/dev/null ;
      echo 'Package archive created!'«;

    El archivo de órdenes postupload iniciado por dupload(1) crea los
    archivos actualizados para cada subida.

    Puede añadir este pequeño repositorio público a las líneas apt de
    su sistema cliente como sigue:

    $ sudo bash
    # echo «deb http://www.example.com/~foo/debian/ unstable main« \
       >> /etc/apt/sources.list
    # apt-key add foo.public.key

    Sugerencia
   
    Si el repositorio se ubica en el sistema de archivos local, puede
    ver «deb file:///home/foo/debian/ …» en su lugar.

%

2.7.16. Guardando y copiando la configuración del sistema

    Puede realizar una copia local de los paquetes y el estado de
    selección de debconf con lo siguiente:

    # dpkg --get-selections '*' > selection.dpkg
    # debconf-get-selections    > selection.debconf

    Aquí, «*» hace que «selection.dpkg» incluya también las entradas
    de los paquetes eliminados.

    Puede copiar estos 2 archivos a otro equipo y realizar allí la
    instalación con lo siguiente:

    # dselect update
    # debconf-set-selections < myselection.debconf
    # dpkg --set-selections  < myselection.dpkg
    # apt-get -u dselect-upgrade    # or dselect install

    Si esta pensando en la gestión de muchos servidores en un clúster
    con practicamente la misma configuración, podría considerar usar
    un paquete especializado como fai para gestionar el sistema
    entero.

%

2.7.17. Convertir o instalar un paquete binario «alien«

    alien(1) permite la conversión de paquetes binarios en formatos
    de archivo rpm mantenido por Red Hat, slp por Stampede , tgz por
    Slackware y pkg por Solaris en paquetes Debian deb. Si quiere
    usar un paquete de otra distribución Linux en vez de la que tiene
    instalada en su sistema, puede usar alien para conertirlo desde
    su formato preferido de paquetes e instalarlo. alien también
    admite paquetes LSB packages.

    Aviso

    alien(1) no debería ser usado para sustituir los paquetes
    principales del sistema, como sysvinit, libc6, libpam-modules,
    etc. En la práctica, alien(1) debería ser usado únicamente para
    paquetes binarios non-free que cumplen con el formato LSB o están
    enlazados estáticamente. Para software libre, debería usar su
    paquete de código fuente para crear auténticos paquetes Debian.

%

2.7.18. Extrayendo paquetes sin dpkg

    El contenido de paquetes «dpkg*.deb» puede ser extraido sin usar 
    dpkg(1) en cualquier entorno tipo Unix usando los estándares ar
    (1) y tar(1).

    # ar x /path/to/dpkg_<version>_<arch>.deb
    # ls
    total 24
    -rw-r--r-- 1 bozo bozo  1320 2007-05-07 00:11 control.tar.gz
    -rw-r--r-- 1 bozo bozo 12837 2007-05-07 00:11 data.tar.gz
    -rw-r--r-- 1 bozo bozo     4 2007-05-07 00:11 debian-binary
    # mkdir control
    # mkdir data
    # tar xvzf control.tar.gz -C control
    # tar xvzf data.tar.gz -C data

    El contenido de otros paquetes «*.deb» puede ser obtenido con la
    orden dpkg-deb(1) obtenido del paquete «dpkg*.deb» como en el
    caso anterior; o usando el estándar ar(1) y los nuevos GNU tar(1)
    con el apoyo de la descomprensión xz(1) del mismo modo del
    anterior.

    También se puede navegar por el contenido de un paquete usando la
    orden mc.

%

2.7.19. Más información acerca de la gestión de paquetes

    Puede aprender más acerca de la gestión de paquetes en los
    siguientes documentos:

      * Documentación principal de la gestión de paquetes:

          + aptitude(8), dpkg(1), tasksel(8), apt(8), apt-get(8), 
            apt-config(8), apt-key(8), sources.list(5), apt.conf(5),
            and apt_preferences(5);

          + «/usr/share/doc/apt-doc/guide.html/index.html» y «/usr/
            share/doc/apt-doc/offline.html/index.html» del paquete
            apt-doc; y

          + «/usr/share/doc/aptitude/html/en/index.html» para el
            paquete aptitude-doc-en.

      * Documentación oficial y detallada del repositorio Debian:

          + «Capítulo 2 del Manual de Directrices Debian - El
            repositorio Debian«,

          + «Capítulo 4 de la Referencia del Desarrollador Debian -
            Recursos para desarrolladores Debian 4.6 El repositorio
            Debian« y

          + «Capítulo 6 de las Preguntas frecuentes de Debian GNU/
            Linux - El repositorio FTP Debian«.

      * Tutorial para la construcción de paquetes Debian por usuarios
        de Debian:

          + «Guía para nuevos desarrolladores Debian«
            (desactualizada).

          + «Guía para desarrolladors Debian».

Capítulo 3. La inicialización del sistema

    Es inteligente por su parte como administrador de sistemas
    conocer profundamente como el sistema Debian comienza y se
    configura. Aunque los detalles concretos están en el código
    fuente de los paquetes instalados y su documentación, es un poco
    abrumador para la mayoría de nosotros.

    Hice lo mejor que pude para proporcionar un resumen de los puntos
    principales del sistema Debian y su configuración en base al
    conocimiento actual y previo mio y de muchos otros. Ya que el
    sistema Debian es un elemento en movimiento, la situación del
    sistema puede haber cambiado. Antes de realizar cualquier cambio
    en el sistema, debería consultar la documentación actual de cada
    paquete.

    Sugerencia
   
    bootup(7) describe el proceso de arranque del sistema basado en
    systemd . (Debian reciente)

    Sugerencia
   
    boot(7) describeel proceso de arranque del sistema basado en UNIX
    System V Release 4. (Older Debian)

%

3.1. Un resumen del proceso de arranque

    Un sistema de ordenador pasa por diferentes fases en el proceso
    de arranque desde el encendido hasta que le ofrece al usuario la
    funcionalidad completa del sistema operativo (SO).

    Por simplicidad, limité la discusión a la de una típica
    plataforma PC con la instalación por defecto.

    El proceso normal de arranque es como un cohete de cuatro fases.
    Cada fase del cohete cede el control del sistema a la siguiente.

      * Sección 3.1.1, “Fase 1: la BIOS”

      * Sección 3.1.2, “Fase 2: el cargador de arranque”
   
      * Sección 3.1.3, “Fase 3: el sistema mini-Debian”

      * Sección 3.1.4, “Fase 4: el sistema normal Debian”

    Desde luego, esto puede ser configurado de otra manera. Por
    ejemplo, si compila su propio núcleo, puede saltar el paso del
    sistema mini-Debian. Así que, por favor, no asuma cuál es el caso
    de su sistema hasta que no lo compruebe por si mismo.

    Nota

    Para plataformas de PC antiguas como los sistemas SUN o
    Macintosh, la BIOS en ROM y la partición en el disco puede ser
    bastante diferentes (Sección 9.5.2, “Configuración del
    particionado de disco”). Por favor busque la documentación
    específica de su plataforma para cada caso en el lugar
    correspondiente.

%

3.1.1. Fase 1: la BIOS

    La BIOS es la primera fase del proceso de arranque que comienza
    con hecho del encendido. La BIOS que reside en la memoria de solo
    lectura (ROM) se ejecuta desde una dirección de memoria
    específica con la que es inicializada el contador del programa
    por el hecho del encendido.

    La BIOS realiza la inicialización básica del «hardware« (POST:
    encendido y autocomprobación (power on self test)) y pasa el
    control del sistema al siguiente paso. La BIOS es normalmente
    proporcionado con el «hardware«.

    La pantalla de inicio de la BIOS normalmente muestra que tecla(s)
    pulsar para entrar en la configuración de la BIOS para cambiar su
    comportamiento. Las teclas normalmente utilizadas son F1, F2,
    F10, Esc, Ins, and Del. Si la pantalla de inicio de la BIOS está
    oculta por alguna otra pantalla, puede pulsar algunas teclas como
    Esc para inhabilitarla. Estas teclas tienen una gran dependencia
    del «hardware«.

    La ubicación del «hardware« y la prioridad del código de comienzo
    de la BIOS se pueden seleccionar desde la pantalla de
    configuración del BIOS. Por lo general, los primeros sectores del
    primer dispositivo seleccionado (disco duro, disquete,
    CD-ROM,...) se cargan en la memoria y se ejecuta dicho código
    inicial. Este código inicial puede ser cualquiera de los
    siguientes:

      * El código del cargador de arranque

      * El código del núcleo del escalón del SO como FreeDOS

      * El código del núcleo del SO objetivo si encaja en su pequeño
        espacio

    Normalmente, el sistema se inicia desde una partición especifica
    del disco duro primario. En los PC antiguos los dos primeros
    sectores del disco duro contienen el registro maestro de arranque
    (master boot record , MBR). La información de la partición del
    disco incluye la selección de arranque que es guardada al final
    del MBR. El código de arranque que primero se ejecuta después de
    la BIOS es el que ocupa el resto del MBR.

%

3.1.2. Fase 2: el cargador de arranque

    El cargador de arranque es la segunda fase del proceso de
    arranque que comienza con la BIOS. Carga la imagen del núcleo del
    sistema y la imagen de initrd en memoria y pasa el control a
    estos. La imagen de initrd es la imagen del sistema de archivos
    raíz y su compatibilidad depende del cargador usado.

    El sistema Debian usa habitualmente el núcleo de Linux como
    núcleo del sistema por defecto. La imagen initrd del núcleo de
    Linux actual 2.6/3.x es técnicamente la imagen initramfs (sistema
    de archivos inicial RAM). La imagen básica initramfs es un
    archivo comprimido cpio en sistema de archivos raíz. El núcleo
    puede actualizar microcódigo bastante temprano durante el inicio,
    antes de cargar la imagen básica initrd. Esto se facilita por la
    combinación de la imagen initrd, que es una masa de microcódigo
    binario en formato cpio sin comprimir, seguido por la imagen
    básica initrd.

    Sugerencia

    Puede inpeccionar el contentido de la imagen initrd usando
    lsinitramfs(8) y unmkinitramfs(8) del
    paqueteinitramfs-tools-core. Vea más en https://wiki.debian.org/
    initramfs.

    La instalación por defecto del sistema Debian ubica el la primera
    fase el código del cargador de arranque GRUB en el MBR para la
    plataforma PC. Existen muchos cargadores de arranque y opciones
    de configuración disponibles.

    Tabla 3.1. Relación de cargadores de arranque

    +--------------------------------------------------------------------+
    |              |           |      |         |cargador|               |
    |   paquete    |popularidad|tamaño| initrd  |   de   |  descripción  |
    |              |           |      |         |arranque|               |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Es lo          |
    |              |           |      |         |        |suficientemente|
    |              |           |      |         |        |inteligente    |
    |              |           |      |         |        |para comprender|
    |grub-legacy   |V:0, I:2   |735   |Soporte  |Antiguo |las particiones|
    |              |           |      |         |GRUB    |de disco y los |
    |              |           |      |         |        |sistemas de    |
    |              |           |      |         |        |órdenes como   |
    |              |           |      |         |        |vfat, ext3,    |
    |              |           |      |         |        |....           |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Es lo          |
    |              |           |      |         |        |suficientemente|
    |              |           |      |         |        |inteligente    |
    |              |           |      |         |        |para entender  |
    |grub-pc       |V:28, I:774|533   |Soporte  |GRUB 2  |las particiones|
    |              |           |      |         |        |de disco y los |
    |              |           |      |         |        |sistemas de    |
    |              |           |      |         |        |archivos como  |
    |              |           |      |         |        |vfat, ext4, …. |
    |              |           |      |         |        |(por defecto)  |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Imagen de      |
    |              |           |      |         |        |rescate de     |
    |              |           |      |         |        |inicio GRUB 2  |
    |grub-rescue-pc|V:0, I:1   |6367  |Soporte  |GRUB 2  |(CD and        |
    |              |           |      |         |        |disquete)      |
    |              |           |      |         |        |(versión PC/   |
    |              |           |      |         |        |BIOS)          |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Esto depende de|
    |              |           |      |         |        |las ubicaciónes|
    |lilo          |V:0, I:2   |697   |Soporte  |Lilo    |de los sectores|
    |              |           |      |         |        |de datos en el |
    |              |           |      |         |        |disco duro     |
    |              |           |      |         |        |(Old)          |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Entiende el    |
    |              |           |      |         |        |sistema de     |
    |syslinux      |V:4, I:48  |343   |Soporte  |Isolinux|archivos       |
    |              |           |      |         |        |ISO9660. Es    |
    |              |           |      |         |        |usado por      |
    |              |           |      |         |        |arranque de CD.|
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Entiende el    |
    |              |           |      |         |        |sistema de     |
    |              |           |      |         |        |archivos MSDOS |
    |syslinux      |V:4, I:48  |343   |Soporte  |Syslinux|(FAT). Es usado|
    |              |           |      |         |        |para el        |
    |              |           |      |         |        |arranque de    |
    |              |           |      |         |        |diquete.       |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Nuevo sistema  |
    |              |           |      |         |        |para el        |
    |loadlin       |V:0, I:1   |90    |Soporte  |Loadlin |arranque del   |
    |              |           |      |         |        |sistema FreeDOS|
    |              |           |      |         |        |/MSDOS.        |
    |--------------+-----------+------+---------+--------+---------------|
    |              |           |      |         |        |Este el        |
    |              |           |      |         |        |software libre |
    |              |           |      |No       |MBR por |que sustituye  |
    |mbr           |V:0, I:7   |50    |soportado|Neil    |MBR de MSDOS.  |
    |              |           |      |         |Turton  |Solo comprende |
    |              |           |      |         |        |particiones de |
    |              |           |      |         |        |disco.         |
    +--------------------------------------------------------------------+


    Aviso

    No pruebe cargadores de inicio sin tener un medio de inicio de
    rescate (USB, CD o disquete) creado de las imagenes del paquete
    grub-rescue-pc. Ello le permite iniciar su sistema incluso sin un
    cargador de inicio operativo en el disco duro.

    En el antiguo GRUB el archivo del menú de configuración está
    ubicado en /boot/grub/menu.lst». Por ejemplo, podría tener las
    siguientes entradas:

    title           Debian GNU/Linux
    root            (hd0,2)
    kernel          /vmlinuz root=/dev/hda3 ro
    initrd          /initrd.img

    En GRUB 2, el archivo del menú de configuración está ubicado en «
    /boot/grub/grub.cfg». Se genera automáticamente por «/usr/sbin/
    update-grub» usando las plantillas de «/etc/grub.d/*» y
    configuraciones de «/etc/default/grub». Por ejemplo, puede tener
    el contenido siguiente:

    menuentry «Debian GNU/Linux« {
            set root=(hd0,3)
            linux /vmlinuz root=/dev/hda3
            initrd /initrd.img
    }

    Para estos ejemplos, los parámetros de GRUB tienen el siguiente
    significado:

    Tabla 3.2. El significado de los parámetros de GRUB

    +---------------------------------------------------------------+
    |parámetro|                     significado                     |
    |  GRUB   |                                                     |
    |---------+-----------------------------------------------------|
    |         |usa la tercera partición de disco primario           |
    |root     |configurándolo como «(hd0,2)» en el antiguo GRUB o   |
    |         |como «(hd0,3)» en GRUB 2                             |
    |---------+-----------------------------------------------------|
    |kernel   |utiliza el núcleo ubicado en «/vmlinuz» con el       |
    |         |parámetro del núcleo: «root=/dev/hda3 ro»            |
    |---------+-----------------------------------------------------|
    |initrd   |utilice la imagen initrd/initramfs ubicada en «/     |
    |         |initrd.img»                                          |
    +---------------------------------------------------------------+


    Nota

    El valor del número de la partición que utiliza el antiguo
    programa GRUB es uno menos que utilizado por el núcleo de Linux y
    las herramientas de uso común. El programa GRUB 2 soluciona este
    problema.

    Sugerencia

    UUID (consulte Sección 9.5.3, “Acceso al particionado utilizando
    UUID”) puede ser utilizado para identificar un dispositivo
    especial de bloque en vez del nombre del archivo como «/dev/
    hda3», p. ej. «root=UUID=81b289d5-4341-4003-9602-e254a17ac232
    ro».

    Sugerencia

    Si se utiliza GRUB, el parámetro del núcleo de inicio esta
    asignado en /boot/grub/grub.cfg. En el sistema Debian no se debe
    modificar directamente /boot/grub/grub.cfg. Debe editar el valor
    de GRUB_CMDLINE_LINUX_DEFAULT en /etc/default/grub y ejecutar 
    update-grub(8) para actualizar /boot/grub/grub.cfg.

    Sugerencia
   
    Puede iniciar un cargador de arranque desde otro cargados de
    arranque mediante la técnica llamada chain loading.

    Consulte «info grub» y grub-install(8).

%

3.1.3. Fase 3: el sistema mini-Debian

    El sistema mini-Debian es la fase 3 del proceso de arranque que
    comienza con el cargador de arranque. Este ejecuta el núcleo del
    sistema con el sistema de archivos raíz en memoria. Esta es una
    fase preparatoria opcional del proceso de arranque.

    Nota

    En este documento el término «el sistema mini-Debian« es como el
    autor describe la tercera fase del proceso de arranque. El
    sistema es conocido como initrd o sistema initramfs. El
    instalador de Debian usa un sistema parecido en memoria.

    El primer programa que se ejecuta en el sistema de archivo raíz
    en memoria es /init». Es un programa que inica el núcleo en el
    espacio de usuario y entrega el control para la próxima fase.
    Este sistema mini-Debian ofrece flexibilidad al módulo al proceso
    de arranque, como agregar módulos del núcleo antes de que el
    proceso principal de arranque o el montaje de un sistema de
    archivos raíz cifrado.

      * El programa /inites una secuencia de códigos si initramfs ha
        sido creado por initramfs-tools.

          + Puede interrumpir esta parte del proceso de arranque para
            obtener un intérprete de órdenes de supuerusuario dandole
            al arranque del núcleo el parámetro «break=init» etc.
            Consulte el archivo de órdenes /init» para conocer más
            formas de interacción. Este entorno del intérprete de
            órdenes es suficientemente complejo para realizar una
            reconocimiento avanzado del «hardware« de su equipo.

          + Las órdenes disponibles en este sistema mini-Debian son
            básicas y las funciones principales las aporta la
            herramienta GNU llamada busybox(1).

      * El programa /init es un programa binario systemd si initramfs
        fue crado por dracut.

          + Los comandos disponibles en este sistema mini-Debian son
            básicamente el ambiente systemd(1).

    Atención

    Necesita utilizar el parámetro «-n» en la orden mount cuando
    interaccione con el sistema de solo lectura del sistema de
    archivos raíz.

%

3.1.4. Fase 4: el sistema normal Debian

    El sistema normal Debian es la cuarta fase del proceso de
    arranque el cual comienza con el sistema mini-Debian. El núcleo
    del sistema para el sistema mini-Debian continua ejecutandose en
    este entorno. El sistema de archivos raíz cambio del que existe
    en memoria a uno real sobre el sistema de archivos en disco duro.

    El programa init es ejecutado en primer lugar con el PID=1
    preparando el proceso de arranque principal para el cominezo de
    muchos programas. La ruta de archivo por defecto para el programa
    init es «/sbin/init» pero puede ser modificado por un párametro
    de arranque del núcleo como «init=/path/to/init_program».

    El programa de inicio por defecto ha sido cambiado:

      * Antes de la versión squeeze de Debian utiliza el sencillo
        estilo SysV init.

      * La versión de Debian wheezy mejora el estilo SysV de init
        ordenando la secuencia de arranque con la cabecera LSB e
        inicia los archivos de órdenes de inicio en paralelo.

      * Debian jessie cambia su «init« por defecto a systemd para una
        inicialización en paralelo basada en eventos.

    Sugerencia
   
    Puede comprobar cual es el sistema init real que usa su equipo
    mediante la orden «ps --pid 1 -f».

    Sugerencia
   
    "/sbin/init" es un link simbolico a "/lib/systemd/systemd" desde
    Debian jessie.

    Tabla 3.3. Relación de sistemas de arranque en el sistema Debian

    +---------------------------------------------------------------+
    |      paquete      |popularidad|tamaño|      descripción       |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Demonio init(8) basado  |
    |systemd            |V:810,     |15998 |en eventos con          |
    |                   |I:916      |      |concurrencia (opción a  |
    |                   |           |      |sysvinit)               |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |redirecciona salida     |
    |systemd-sysv       |V:802,     |138   |estándar y el error     |
    |                   |I:914      |      |estándar de orden al    |
    |                   |           |      |archivo foo             |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |systemd units aporta la |
    |systemd-cron       |V:1, I:1   |143   |funcionalidad del       |
    |                   |           |      |demonio cron y de       |
    |                   |           |      |anacron                 |
    |-------------------+-----------+------+------------------------|
    |                   |V:675,     |      |herramientas de ayuda   |
    |init-system-helpers|I:930      |131   |para cambiar entre      |
    |                   |           |      |sysvinit y systemd      |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |archivos de órdenes de  |
    |initscripts        |V:91, I:323|176   |inicio y parada del     |
    |                   |           |      |sistema                 |
    |-------------------+-----------+------+------------------------|
    |sysvinit-core      |V:7, I:9   |276   |Programa estilo System-V|
    |                   |           |      |init(8)                 |
    |-------------------+-----------+------+------------------------|
    |                   |V:183,     |      |Mecanismo de cambio del |
    |sysv-rc            |I:335      |81    |nivel de ejecución      |
    |                   |           |      |estilo System-V         |
    |-------------------+-----------+------+------------------------|
    |                   |V:494,     |      |Programas estilo        |
    |sysvinit-utils     |I:999      |79    |System-V (startpar(8),  |
    |                   |           |      |bootlogd(8), …)         |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Funcionalidad de        |
    |lsb-base           |V:881,     |49    |secuencia de órdenes    |
    |                   |I:999      |      |«Linux Standard Base«   |
    |                   |           |      |init 3.2                |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |herramientas para       |
    |                   |V:210,     |      |organizar la secuencia  |
    |insserv            |I:330      |150   |de arranque usando las  |
    |                   |           |      |dependencias del archivo|
    |                   |           |      |de órdenes init.d LSB   |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |herramientas para la    |
    |uswsusp            |V:3, I:8   |714   |suspensión de software  |
    |                   |           |      |en el espacio de usuario|
    |                   |           |      |por Linux               |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Reincio (reincio        |
    |kexec-tools        |V:1, I:8   |278   |caliente) kexec(8) de la|
    |                   |           |      |herramienta kexec       |
    |-------------------+-----------+------+------------------------|
    |systemd-bootchart  |V:0, I:1   |128   |analizador de desempeño |
    |                   |           |      |del proceso de arranque |
    |-------------------+-----------+------+------------------------|
    |bootchart2         |V:0, I:0   |94    |analizador de desempeño |
    |                   |           |      |del proceso de arranque |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |analizados del desempeño|
    |pybootchartgui     |V:0, I:0   |177   |del proceso de arranque |
    |                   |           |      |(visualización)         |
    |-------------------+-----------+------+------------------------|
    |mingetty           |V:0, I:3   |38    |únicamente para consola |
    |                   |           |      |getty(8)                |
    |-------------------+-----------+------+------------------------|
    |mgetty             |V:0, I:1   |315   |sustituto de «modem«    |
    |                   |           |      |inteligente getty(8)    |
    +---------------------------------------------------------------+


    Sugerencia

    Consulte la wiki de Debian : AcelerandoElProcesodeArranque para
    los consejos actualizados para mejorar la velocidad del proceso
    de arranque.

%

3.2. Systemd init

    Esta sección describe como el programa systemd(1) inicia el
    sistema con PID=1 (i.e., proceso de inicio).

    El proceso inicial de systemd genera procesos paralelos de
    acuerdo a los archivos de configuración de unidad (consulte 
    systemd.unit(5)) que están escritos con un estilo declarativo en
    vez del estilo procedimental al estilo de SysV. Estos se cargan
    desde diferentes rutas (consulte systemd-system.conf(5)) como
    sigue:

      * «/lib/systemd/system»: archivos de configuración por defecto
        del sistema operativo

      * "/etc/systemd/system": archivos de configuración del
        administrador del sistema que anulan los archivos de
        configuración predeterminados del sistema operativo

      * "/run/systemd/system": archivos de configuración generados
        durante la ejecución que anulan los archivos de configuración
        instalados

    Las interdependencias se describen mediante directivas «Wants=»,
    «Requires=», «Before=», «After=», … (consulte "MAPPING OF UNIT
    PROPERTIES TO THEIR INVERSES" en systemd.unit(5)). El control de
    recursos esta también definido (consulte systemd.resource-control
    (5)).

    El sufijo del archivo de configuración de la unidad codifica sus
    tipos como:

      * *.service describe el proceso que está controlado y
        supervisado por systemd. Consulte systemd.service(5).

      * *.device describe el dispositivo utilizado por sysfs(5) como
        el árbol de dispositivos udev(7). Consulte systemd.device(5).

      * *.mount describe el punto de montaje del sistema de archivos
        que está controlado y supervisado por systemd. Consulte 
        systemd.mount(5).

      * *.automount describe puntos de automontaje de sistemas de
        archivos que están controlados y supervisados por systemd.
        Consulte systemd.automount(5).

      * *.swap describe dispositos o archivos de intercambio
        controlado y supervisado por systemd. Consulte systemd.swap
        (5).

      * *.path describe rutas supervisadas por systemd para la
        activación basada en la ruta. Consulte systemd.path(5).

      * *.socket describe conexiones controladas y supervisadas por
        systemd para la activación basada en conexiones. Consulte 
        systemd.socket(5).

      * *.timer describe el temporizador controlado y supervisado por
        systemd para la activación en función de temporizadores.
        Consulte systemd.timer(5).

      * *.slice gestiona recursos mediante cgroups(7). Consulte 
        systemd.slice(5).

      * *.scope se crean de forma programada utilizando los
        interfaces del bus de systemd para gestionar un conjunto de
        procesos del sistema. Consute systemd.scope(5).

      * Los grupos *.target y otros archivos de configuración de
        units se usan para crear puntos de sincronización durante el
        arranque. Consulte systemd.target(5).

    Tras el arranque del sistema (esencialmente init), el proceso
    systemd intenta iniciar /lib/systemd/system/default.target
    (normalmente enlazado simbólicamente a "graphical.target".
    Primero, algunas unidades objetivo especiales (vea 
    systemd.special(7) como "local-fs.target", "swap.target" y
    "cryptsetup.target" son llamadas a montar el sistema de archivos.
    Luego, otras unidades objetivo son llamadas por las dependencias
    de la unidad objetivo. Para más detalles, lea bootup(7).

    Systemd ofrece características de compatibilidad con versiones
    anteriores. Los archivos de órdenes de inicio de estilo SysV en «
    /etc/init.d/rc[0123456S].d/[KS]< <name>» son también analizados y
    telinit(8) se traducen a peticiones de activación de systemd.

    Atención
   
    Los niveles de inicio emulados del dos al cuatro son enlaces
    simbólicos al mismo «multi-user.target».

%

3.2.1. El nombre del equipo (hostname)

    El núcleo mantiene el nombre del equipo del sistema. El archivo
    de órdenes de init en el nivel de ejecución S, el cual es un
    enlace simbólico a «/etc/init.d/hostname.sh» asigna el nombre del
    sistema en tiempo de arranque (usando la orden hostname) al
    nombre almacenado en «/etc/hostname». Este archivo debería
    contener únicamente el nombre del sistema, no un nombre de
    dominio totalmente cualificado (FQDN).

    Para obtener el nombre del equipo actual ejecute hostname(1) sin
    ningún parámetro.

%

3.2.2. El sistema de archivos

    Las opciones de montaje de discos normales y de sistemas de
    archivos en red se configuran en «/etc/fstab». Consulte fstab(5)
    y Sección 9.5.7, “Optimización de los sistemas de archivos a
    través de las opciones de montaje”.

    Los sistemas de archivos cifrados se configuran en «/etc/
    crypttab». Consulte crypttab(5)

    La configuración de RAID mediante software con mdadm(8) está en «
    /etc/mdadm/mdadm.conf». Consulte mdadm.conf(5).

    Aviso

    Trás montar todos los sistemas de archivos , los archivos
    temporales en «/tmp», «/var/lock» y «/var/run» se borran en cada
    inicio.

%

3.2.3. Inicialización del interfaz de red

    Comunmente el interfaz lo se inicializa mediante
    «networking.service» y el resto de interfaces de un sistema de
    escritorio moderno Debian que use systemd mediante
    «NetworkManager.service».

    Para configurarlos consulte Capítulo 5, Configuración de red.

%

3.2.4. Los mensajes del núcleo

    El mensaje de error que se muestra en la consola se determina
    mediante la configuración de su nivel de umbral.

    # dmesg -n3

    Tabla 3.4. LIsta de niveles de error del núcleo

    +---------------------------------------------------------------+
    |valor del nivel |nombre del nivel |        significado         |
    |    de error    |    de error     |                            |
    |----------------+-----------------+----------------------------|
    |0               |KERN_EMERG       |sistema no usable           |
    |----------------+-----------------+----------------------------|
    |1               |KERN_ALERT       |se deben tomar medidas de   |
    |                |                 |forma inmediata             |
    |----------------+-----------------+----------------------------|
    |2               |KERN_CRIT        |estado crítico              |
    |----------------+-----------------+----------------------------|
    |3               |KERN_ERR         |estado de error             |
    |----------------+-----------------+----------------------------|
    |4               |KERN_WARNING     |estado de aviso             |
    |----------------+-----------------+----------------------------|
    |5               |KERN_NOTICE      |estado normal pero          |
    |                |                 |significativo               |
    |----------------+-----------------+----------------------------|
    |6               |KERN_INFO        |información                 |
    |----------------+-----------------+----------------------------|
    |7               |KERN_DEBUG       |mensajes de depuración      |
    +---------------------------------------------------------------+


%

3.2.5. El sistema de mensajes

    Under systemd, both kernel and system messages are logged by the
    journal service systemd-journald.service (a.k.a journald) either
    into a persistent binary data below "/var/log/journal" or into a
    volatile binary data below "/run/log/journal/". These binary log
    data are accessed by the journalctl(1) command.

    La orden de búsqueda especializada grep-dctrl(1) permite buscar
    en las copias locales de «status» y la metainformación
    «disponible».

    El sistema de mensajes puede ser personalizado tanto para el
    archivo de registro y los mensajes por pantalla mediante «/etc/
    default/rsyslog» y «/etc/rsyslog.conf». Consulte rsyslogd(8) y 
    rsyslog.conf(5). Consulte también Sección 9.2.2, “Analizador de
    registros”.

%

3.2.6. System management under systemd

    The systemd offers not only init system but also generic system
    management functionalities such as journal logging, login
    management, time management, network management. etc..

    The systemd(1) is managed by several commands:

      * the systemctl(1) command controls the systemd system and
        service manager (CLI),

      * the systemsdm(1) command controls the systemd system and
        service manager (GUI),
   
      * the journalctl(1) command queries the systemd journal,

      * the loginctl(1) command controls the systemd login manager,
        and

      * the systemd-analyze(1) analyzes system boot-up performance.

    Here are a list of typical systemd management command snippets.
    For the exact meanings, please read the pertinent manpages.

    Tabla 3.5. Registro de acciones de la orden aptitude

    +---------------------------------------------------------------+
    |        Operation         |   Type    |  nombre de la orden,   |
    |--------------------------+-----------+------------------------|
    |GUI for service manager   |GUI        |«systemadm» (paquete    |
    |                          |           |systemd-ui)             |
    |--------------------------+-----------+------------------------|
    |List all target unit      |Unit       |"systemctl list-units   |
    |configuration             |           |--type=target"          |
    |--------------------------+-----------+------------------------|
    |List all service unit     |Unit       |"systemctl list-units   |
    |configuration             |           |--type=service"         |
    |--------------------------+-----------+------------------------|
    |List all unit             |Unit       |"systemctl list-units   |
    |configuration types       |           |--type=help"            |
    |--------------------------+-----------+------------------------|
    |List all socket units in  |Unit       |"systemctl list-sockets"|
    |memory                    |           |                        |
    |--------------------------+-----------+------------------------|
    |List all timer units in   |Unit       |"systemctl list-timers" |
    |memory                    |           |                        |
    |--------------------------+-----------+------------------------|
    |Start "$unit"             |Unit       |"systemctl start $unit" |
    |--------------------------+-----------+------------------------|
    |Stop "$unit"              |Unit       |"systemctl stop $unit"  |
    |--------------------------+-----------+------------------------|
    |Reload service-specific   |Unit       |"systemctl reload $unit"|
    |configuration             |           |                        |
    |--------------------------+-----------+------------------------|
    |Stop and start all "$unit"|Unit       |"systemctl restart      |
    |                          |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Start "$unit" and stop all|Unit       |"systemctl isolate      |
    |others                    |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Switch to "graphical" (GUI|Unit       |"systemctl isolate      |
    |system)                   |           |graphical"              |
    |--------------------------+-----------+------------------------|
    |Switch to "multi-user"    |Unit       |"systemctl isolate      |
    |(CLI system)              |           |multi-user"             |
    |--------------------------+-----------+------------------------|
    |Switch to "rescue" (single|Unit       |"systemctl isolate      |
    |user CLI system)          |           |rescue"                 |
    |--------------------------+-----------+------------------------|
    |Send kill signal to       |Unit       |"systemctl kill $unit"  |
    |"$unit"                   |           |                        |
    |--------------------------+-----------+------------------------|
    |Check if "$unit" service  |Unit       |"systemctl is-active    |
    |is active                 |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Check if "$unit" service  |Unit       |"systemctl is-failed    |
    |is failed                 |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Check status of "$unit|   |Unit       |"systemctl status $unit||
    |$PID|device"              |           |$PID|$device"           |
    |--------------------------+-----------+------------------------|
    |Show properties of "$unit||Unit       |"systemctl show $unit|  |
    |$job"                     |           |$job"                   |
    |--------------------------+-----------+------------------------|
    |Reset failed "$unit"      |Unit       |"systemctl reset-failed |
    |                          |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |List dependency of all    |Unit       |"systemctl              |
    |unit services             |           |list-dependencies --all"|
    |--------------------------+-----------+------------------------|
    |List unit files installed |Unit file  |"systemctl              |
    |on the system             |           |list-unit-files"        |
    |--------------------------+-----------+------------------------|
    |Enable "$unit" (add       |Unit file  |"systemctl enable $unit"|
    |symlink)                  |           |                        |
    |--------------------------+-----------+------------------------|
    |Disable "$unit" (remove   |Unit file  |"systemctl disable      |
    |symlink)                  |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Unmask "$unit" (remove    |Unit file  |"systemctl unmask $unit"|
    |symlink to "/dev/null")   |           |                        |
    |--------------------------+-----------+------------------------|
    |Mask "$unit" (add symlink |Unit file  |"systemctl mask $unit"  |
    |to "/dev/null")           |           |                        |
    |--------------------------+-----------+------------------------|
    |Get default-target setting|Unit file  |"systemctl get-default" |
    |--------------------------+-----------+------------------------|
    |Set default-target to     |Unit file  |"systemctl set-default  |
    |"graphical" (GUI system)  |           |graphical"              |
    |--------------------------+-----------+------------------------|
    |Set default-target to     |Unit file  |"systemctl set-default  |
    |"multi-user" (CLI system) |           |multi-user"             |
    |--------------------------+-----------+------------------------|
    |Show job environment      |Environment|"systemctl              |
    |                          |           |show-environment"       |
    |--------------------------+-----------+------------------------|
    |Set job environment       |           |"systemctl              |
    |"variable" to "value"     |Environment|set-environment variable|
    |                          |           |=value"                 |
    |--------------------------+-----------+------------------------|
    |Unset job environment     |           |"systemctl              |
    |"variable"                |Environment|unset-environment       |
    |                          |           |variable"               |
    |--------------------------+-----------+------------------------|
    |Reload all unit files and |Lifecycle  |"systemctl              |
    |daemons                   |           |daemon-reload"          |
    |--------------------------+-----------+------------------------|
    |Shut down the system      |System     |"systemctl poweroff"    |
    |--------------------------+-----------+------------------------|
    |Shut down and reboot the  |System     |"systemctl reboot"      |
    |system                    |           |                        |
    |--------------------------+-----------+------------------------|
    |Suspend the system        |System     |"systemctl suspend"     |
    |--------------------------+-----------+------------------------|
    |Hibernate the system      |System     |"systemctl hibernate"   |
    |--------------------------+-----------+------------------------|
    |View job log of "$unit"   |Journal    |"journalctl -u $unit"   |
    |--------------------------+-----------+------------------------|
    |View job log of "$unit"   |Journal    |"journalctl -u $unit -f"|
    |("tail -f" style)         |           |                        |
    |--------------------------+-----------+------------------------|
    |Show time spent for each  |Analyze    |"systemd-analyze time"  |
    |initialization steps      |           |                        |
    |--------------------------+-----------+------------------------|
    |List of all units by the  |Analyze    |"systemd-analyze blame" |
    |time to initialize        |           |                        |
    |--------------------------+-----------+------------------------|
    |Load and detect errors in |Analyze    |"systemd-analyze verify |
    |"$unit" file              |           |$unit"                  |
    |--------------------------+-----------+------------------------|
    |Track boot process by the |Cgroup     |"systemd-cgls"          |
    |cgroups(7)                |           |                        |
    |--------------------------+-----------+------------------------|
    |Track boot process by the |Cgroup     |"ps xawf -eo            |
    |cgroups(7)                |           |pid,user,cgroup,args"   |
    |--------------------------+-----------+------------------------|
    |Track boot process by the |Cgroup     |Read sysfs under "/sys/ |
    |cgroups(7)                |           |fs/cgroup/systemd/"     |
    +---------------------------------------------------------------+


    Here, "$unit" in the above examples may be a single unit name
    (suffix such as .service and .target are optional) or, in many
    cases, multiple unit specifications (shell-style globs "*", "?",
    "[]" using fnmatch(3) which will be matched against the primary
    names of all units currently in memory).

    System state changing commands in the above examples are
    typically preceded by the "sudo" to attain the required
    administrative privilege.

    The output of the "systemctl status $unit|$PID|$device" uses
    color of the dot ("●") to summarize the unit state at a glance.

      * White "●" indicates an "inactive" or "deactivating" state.

      * Red "●" indicates a "failed" or "error" state.

      * Green "●" indicates an "active", "reloading" or "activating"
        state.

%

3.2.7. Customizing systemd

    With default installation, many network services (see Capítulo 6,
    Aplicaciones de red) are started as daemon processes after
    network.target at boot time by systemd. The "sshd" is no
    exception. Let's change this to on-demand start of "sshd" as a
    customization example.

    First, disable system installed service unit.

     $ sudo systemctl stop sshd.service
     $ sudo systemctl mask sshd.service

    The on-demand socket activation system of the classic Unix
    services was through the indetd superserver. Under systemd, the
    equivalent can be enabled by adding *.socket and *.service unit
    configuration files.

    sshd.socket for specifying a socket to listen on

    [Unit]
    Description=SSH Socket for Per-Connection Servers

    [Socket]
    ListenStream=22
    Accept=yes

    [Install]
    WantedBy=sockets.target

    sshd@.service as the matching service file of sshd.socket

    [Unit]
    Description=SSH Per-Connection Server
   
    [Service]
    ExecStart=-/usr/sbin/sshd -i
    StandardInput=socket

    Then reload.

     $ sudo systemctl daemon-reload

%

3.3. El sistema udev

    Desde el núcleo de Linux 2.6 en adelante, el sistema udev aporta
    mecanismos automáticos de descubrimiento e inicialización de
    «hardware« (consulte udev(7)). Después del descubrimiento de cada
    dispositivo por parte del núcleo, el sistema udev comienza un
    proceso de usuario el cual usa la información del sistema de
    archivos sysfs (consulte Sección 1.2.12, “procfs y sysfs”), carga
    los módulos necesarios para el núcleo mediante el programa 
    modprobe(8) (consulte Sección 3.3.1, “La inicialización del
    módulo del núcleo”) y crea los nodos de dispositivo
    correspondientes.

    Sugerencia

    Si por cualquier motivo «/lib/modules/<núcleo-version>/
    modules.dep» no fue generado correctamente por depmod(8) , los
    módulos no pueden ser cargados por el sistema udev como se
    debería. Para solucionarlo ejecute «depmod -a».

    El nombre de los nodos del dispositivo puede ser configurado por
    los archivos de relgas de udev en «/etc/udev/rules.d/». Las
    reglas predeterminadas actuales tienden a crear nombres generados
    dinámicamente, dando como resultado nombres de dispositivo no
    estático excepto para cd y red. Para añadir sus reglas
    personalizadas parecidas a lo que hace con los dispositivios de
    cd y red, se pueden generar nombres de dispositivo estáticos
    para, por ejemplo, llaveros de memoria, también. Consulte
    «Escribiendo reglas udev« o «/usr/share/doc/udev/
    writing_udev_rules/index.html».

    Ya que udev es un sistema en evolución, dejaré los detalles para
    otra documentación y se describirá de forma mínima aquí.

    Sugerencia

    Para las reglas de montaje de «/etc/fstab», los nodos de
    dispositivos no necesitan nombres estáticos. Se puede usar UUID
    para los dispositivos montados en lugar de los nombres de los
    dispositivos como «/dev/sda». Consulte Sección 9.5.3, “Acceso al
    particionado utilizando UUID”.

%

3.3.1. La inicialización del módulo del núcleo

    El programa modprobe(8) nos permite configurar el núcleo de Linux
    en ejecución desde el proceso de usuario añadiendo o eliminando
    módulos al núcleo. El sistema udev (see Sección 3.3, “El sistema
    udev”) automatiza su llamada para ayudar a la inicialización de
    módulos en el núcleo.

    No existen módulos que no correspondan a hardware ni módulos
    controladores de hardware especiales como los que necesitan ser
    precargados al estar enumerados en el archivo «/etc/modules»
    (consultemodules(5)).

      * Los módulos TUN/TAP aportan el dispositivo virtual de red
        punto a punto (TUN) y el dispositivo virtual de red ethernet
        (TAP),
   
      * Los módulos netfilter aportan capacidades de cortafuego (
        iptables(8), Sección 5.10, “Infraestructura Netfilter”) y

      * los móduloes del controlador watchdog timer.

    Los archivos de configuración del programa modprobe(8) están
    ubicados en el árbol bajo el directorio «/etc/modprobes.d/» como
    se detalla en modprobe.conf(5). (Si quiere evitar que algunos
    módulos del núcleo se cargen de forma automática, incluyalos en
    la lista negra que es el archivo «/etc/modprobes.d/blacklist».)

    El archivo «/lib/modules/<version>/modules.dep» creado por el
    programa depmod(8) describe las dependencias de los módulos
    usados por el programa modprobe(8).

    Nota

    Si tiene problemas en la carga de módulos cuando se inicia su
    carga de módulos o con modprobe(8), «depmod -a» puede
    solucionarlo reconstruyendo «modules.dep».

    El programa modinfo(8) muestra información acerca de los módulos
    del núcleo de Linux.

    El programa lsmod(8) da formato al contenido de «/proc/modules»,
    mostrando los módulos del núcleo que están cargados en este
    momento.

    Sugerencia
   
    Puede determinar cual es el hardware de su sistema. Consulte
    Sección 9.4.3, “Identificación del hardware”.

    Sugerencia

    Puede configurar su hardware en tiempo de arranque y activar las
    funcionalidades del hardware conocidas. Consulte Sección 9.4.4,
    “Configuración del hardware”.

    Sugerencia
   
    Seguramente pueda añadir soporte a sus dispositivos especiales
    recompilando el núcleo. Consulte Sección 9.9, “El núcleo”.

Capítulo 4. Acreditación

    Cuando una persona (o programa) necesita acceso al sistema, la
    acreditación confirma que la identidad es confiable.

    Aviso

    Una configuración erronea de PAM puede bloquearlo en su propio
    sistema. Debe tener un CD de rescate a mano o configurar una
    partición de arranque alternativa. Para recuperarlo inicie el
    sistema con uno de estos y corrija los errores cometidos.

    Aviso
   
    Este capítulo esta desactualizado ya que esta fundamentado en
    Debian 7.0 (Wheezy) publicado en 2013.

%

4.1. Acreditación normal de Unix

    La acreditación normal de Unix la proporciona el módulo pam_unix
    (8) de PAM (Módulos de acreditación conectables (Pluggable
    Authentication Modules)). Existen tres archivos de configuración
    importantes, que usan «:» como separador de entradas y son los
    siguiente:

    Tabla 4.1. los tres archivos importantes de configuración de 
    pam_unix(8)

    +---------------------------------------------------------------+
    |archivo| permisos |usuario|grupo |         descripción         |
    |-------+----------+-------+------+-----------------------------|
    |/etc/  |-rw-r--r--|root   |root  |(limpia) información de la   |
    |passwd |          |       |      |cuenta de usuario            |
    |-------+----------+-------+------+-----------------------------|
    |/etc/  |-rw-r-----|root   |shadow|información de seguridad de  |
    |shadow |          |       |      |la cuenta de usuario         |
    |-------+----------+-------+------+-----------------------------|
    |/etc/  |-rw-r--r--|root   |root  |información de grupo         |
    |group  |          |       |      |                             |
    +---------------------------------------------------------------+


    «/etc/passwd» contiene lo siguiente:

     ...
    user1:x:1000:1000:User1 Name,,,:/home/user1:/bin/bash
    user2:x:1001:1001:User2 Name,,,:/home/user2:/bin/bash
     ...

    Como se explica en passwd(5), cada campo separado por «:» tiene
    el siguiente significado:

      * Nombre de acceso

      * Entrada de especificación de contraseña

      * ID de usuario numérico

      * ID numérico de grupo

      * Nombre de usuario o comentario

      * Directorio raíz del usuario

      * Intérprete de órdenes opcional de usuario

    La segunda entrada de «/etc/passwd» era usada para guardar la
    contraseña cifrada. Después de la introducción de «/etc/shadow»,
    esta entrada se usa para especificar la entrada de la contraseña.

    Tabla 4.2. El contenido de la segunda entrada de «/etc/passwd»

    +-----------------------------------------------------+
    |contenido|                significado                |
    |---------+-------------------------------------------|
    |(vacio)  |cuenta sin contraseña                      |
    |---------+-------------------------------------------|
    |x        |la contraseña cifrada esta en «/etc/shadow»|
    |---------+-------------------------------------------|
    |*        |sin acceso a esta cuenta                   |
    |---------+-------------------------------------------|
    |!        |sin acceso a esta cuenta                   |
    +-----------------------------------------------------+


    «/etc/shadow» tiene el siguiente contenido:

     ...
    user1:$1$Xop0FYH9$IfxyQwBe9b8tiyIkt2P4F/:13262:0:99999:7:::
    user2:$1$vXGZLVbS$ElyErNf/agUDsm1DehJMS/:13261:0:99999:7:::
     ...

    Como detalla shadow(5), cada entrada del fichero esta separado
    por «:» y tiene el significado:

      * Nombre de acceso

      * Contraseña cifrada (El «$1$» inicial indica el uso del
        cifrado MD5. El carácter «*« indica sin acceso a la cuenta.)

      * Fecha del último cambio de contraseña, expresado en el número
        de días desde el 1 de Enero de 1970

      * Número de dias que el usuario tiene que esperar antes de que
        se le permita cambiar la contraseña de nuevo

      * Número de días después del cual el usuario puede cambiar su
        constraseña

      * Número de dias antes de que la contraseña deje de ser válida
        durante los cuales se avisará al usuario de ello

      * Número de dias después de que una contraseña ha dejado de ser
        válida en los cuales la contraseña todavía será aceptada

      * Fecha de expiración de la cuenta, expresada en el número de
        días desde 1 de Enero de 1970

      * …

    «/etc/group» contiene:

    group1:x:20:user1,user2

    Como se detalla en group(5), cada entrada separada por «:» tiene
    el siguiente significado:

      * Nombre del grupo

      * Contraseña cifrada (no usado)
   
      * ID numérico de grupo

      * relación de los nombres de usuario separados por «,«

    Nota
   
    «/etc/gshadow» aporta la misma funcionalidad que «/etc/shadow»
    para «/etc/group» pero no se usa en realidad.

    Nota

    La pertenencia real a un grupo por parte de un usuario puede ser
    añadido de forma dinámica si la línea «auth optional
    pam_group.so» esta añadida en «/etc/pam.d/common-auth» y activada
    en «/etc/security/group.conf». Consulte pam_group(8).

    Nota

    El paquete base-passwd contiene una relación de acreditaciones de
    usuarios y grupos: «/usr/share/doc/base-passwd/
    users-and-groups.html».

%

4.2. Gestionando información de cuentas y contraseñas

    Aquí estan algunas órdenes relevantes para la gestión de
    información de cuentas.

    Tabla 4.3. Relación de órdenes para la gestión de información de
    las cuentas

    +---------------------------------------------------------------+
    |       orden        |                 función                  |
    |--------------------+------------------------------------------|
    |getent passwd       |navega por la información de la cuenta de |
    |<nombre_de_usuario> |«<nombre_de_usuario>»                     |
    |--------------------+------------------------------------------|
    |getent shadow       |navega por la información de cuenta       |
    |<nombre_de_usuario> |«oculta« de «<nombre_de_usuario>»         |
    |--------------------+------------------------------------------|
    |getent group        |navega por la información del grupo «     |
    |<nombre_del_grupo>  |<nombre_del_grupo>»                       |
    |--------------------+------------------------------------------|
    |passwd              |gestiona la contraseña de la cuenta       |
    |--------------------+------------------------------------------|
    |passwd -e           |asigna una contraseña de un solo uso para |
    |                    |la activación de la cuenta                |
    |--------------------+------------------------------------------|
    |chage               |gestión de la información de la vejez de  |
    |                    |la contraseña                             |
    +---------------------------------------------------------------+


    Puede necesitar privilegios de superusuario para que funcionen
    alguna operación. Consulte crypt(3) sobre el cifrado de la
    contraseña y datos.

    Nota

    On the system set up with PAM and NSS as the Debian salsa
    machine, the content of local "/etc/passwd", "/etc/group" and "/
    etc/shadow" may not be actively used by the system. Above
    commands are valid even under such environment.

%

4.3. Buenas contraseñas

    Cuando se crea una cuenta durante la instalación de su sistema o
    con la orden passwd(1), puede elegir una buena contraseña la cual
    consiste al menos de 6 a 8 caracteres incluyendo uno o más
    carácteres de cada uno de los conjuntos siguientes de acuerdo a 
    passwd(1).

      * letras en minúscula

      * Dígitos de 0 hasta 9

      * Signos de puntuación

    Aviso

    No elija para la contraseña palabras fáciles de adivinar. Nombre
    de la cuenta, número de la Seguridad Social, nombre del teléfono,
    dirección, fecha de nacimiento, nombre de los miembros de su
    familia o mascotas, palabras del diccionario, secuencias simples
    de caracteres como «12345« o «qwerty«, son una mala elección para
    la contraseña.

%

4.4. Creando una contraseña cifrada

    Existen herramientas independientes para generar contraseñas
    cifradas con una semilla.

    Tabla 4.4. Relación de herramientas para generar contraseñas

    +---------------------------------------------------------------+
    |paquete|popularidad|tamaño| orden  |          función          |
    |-------+-----------+------+--------+---------------------------|
    |       |           |      |        |interfaz con múltiples     |
    |whois  |V:35, I:393|364   |mkpasswd|funcionalidades de la      |
    |       |           |      |        |biblioteca crypt(3)        |
    |-------+-----------+------+--------+---------------------------|
    |       |V:794,     |      |openssl |resumenes criptográficos de|
    |openssl|I:993      |1465  |passwd  |las contraseñas (OpenSSL). |
    |       |           |      |        |passwd(1ssl)               |
    +---------------------------------------------------------------+


%

4.5. PAM y NSS

    Los sistemas modernos tipo Unix como el sistema Debian
    proporciona los mecanismos PAM (Módulos de Acreditación
    Conectables) y NSS (Intercambiador de Servicio de Nombres (Name
    Service Switch) al administrador de sistemas local para
    configurar su sistema. El perfil de estos pueden ser resumidos
    como sigue:

      * PAM ofrece mecanismos flexibles de acreditación que son
        usados por las aplicaciones software mediante el intercambio
        de datos de contraseñas.
   
      * NSS ofrece un mecanismo de servicios de nombre flexible el
        cual es usado de forma habitual por la biblioteca C estándar
        para obtener el nombre del usuario y el grupo para programas
        como ls(1) y id(1).

    Estos sistemas PAM y NSS necesitan ser configurados de forma
    coherente.

    Los paquetes relevantes de los sistemas PAM y NSS son los
    siguientes:

    Tabla 4.5. Relación de sistemas PAM y NSS relevantes

    +---------------------------------------------------------------+
    |      paquete      |popularidad|tamaño|      descripción       |
    |-------------------+-----------+------+------------------------|
    |                   |V:807,     |      |Módulos de acreditación |
    |libpam-modules     |I:999      |1032  |conectables (servicios  |
    |                   |           |      |básicos)                |
    |-------------------+-----------+------+------------------------|
    |libpam-ldap        |I:12       |249   |PAM permite conectar con|
    |                   |           |      |servicios LDAP          |
    |-------------------+-----------+------+------------------------|
    |libpam-cracklib    |I:16       |115   |PAM para dar soporte a  |
    |                   |           |      |cracklib                |
    |-------------------+-----------+------+------------------------|
    |                   |V:474,     |      |Pluggable Authentication|
    |libpam-systemd     |I:853      |573   |Module to register user |
    |                   |           |      |sessions for logind     |
    |-------------------+-----------+------+------------------------|
    |libpam-doc         |I:1        |1044  |PAM (documentación en   |
    |                   |           |      |html y texto)           |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Biblioteca GNU C:       |
    |                   |V:935,     |      |bibliotecas compartidas |
    |libc6              |I:999      |12771 |que ofrecen también el  |
    |                   |           |      |intercambio del servicio|
    |                   |           |      |de nombres              |
    |-------------------+-----------+------+------------------------|
    |glibc-doc          |I:11       |3161  |Biblioteca GNU C:       |
    |                   |           |      |«manpages«              |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Biblioteca GNU C: Manual|
    |glibc-doc-reference|I:5        |12740 |de Referencia en info,  |
    |                   |           |      |formatos pdf y html     |
    |                   |           |      |(«non-free«)            |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Módulo NSS para         |
    |libnss-mdns        |I:526      |150   |resolución de nombres   |
    |                   |           |      |DNS sin servidor DNS    |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Módulo NSS para su      |
    |libnss-ldap        |I:11       |265   |integración con el      |
    |                   |           |      |servicio de nombres por |
    |                   |           |      |LDAP                    |
    |-------------------+-----------+------+------------------------|
    |                   |           |      |Módulo NSS para utiliza |
    |                   |           |      |LDAP como servicio de   |
    |libnss-ldapd       |I:14       |153   |nombres (nueva          |
    |                   |           |      |bifurcación de          |
    |                   |           |      |libnss-ldap)            |
    +---------------------------------------------------------------+


      * Es esencial para aprender a configurar PAM la «The Linux-PAM
        System Administrators' Guide« en libpam-doc.
   
      * El documento principal para aprender a configurar NSS es
        «System Databases and Name Service Switch« section en
        glibc-doc-reference.

    Nota

    Puede obtener una relación más completa y actualizada mediante la
    orden «aptitude search 'libpam-|libnss-'». El acrónimo NSS
    también tiene el significado de «Servicio de Seguridad de Red
    (Network Security Service) que es diferente de «Intercambio del
    Servicio de Nombres« (Name Service Switch).

    Nota

    PAM es la forma fundamental para la inicialización de las
    variables de entorno para cada programa con un valor diferente al
    que ofrece el sistema por defecto.

    Under systemd, libpam-systemd package is installed to manage user
    logins by registering user sessions in the systemd control group
    hierarchy for logind. See systemd-logind(8), logind.conf(5), and 
    pam_systemd(8).

%

4.5.1. Archivos de configuración utilizados por PAM y NSS

    Aquí estan algunos de los archivos de configuración más
    importantes usados por PAM y NSS.

    Tabla 4.6. Relación de archivos de configuración utilizados por
    PAM y NSS

    +---------------------------------------------------------------+
    |     archivo de     |                 función                  |
    |   configuración    |                                          |
    |--------------------+------------------------------------------|
    |/etc/pam.d/         |Realice la configuraciñon de PAM para el  |
    |<nombre_de_programa>|programa «<nombre_del_programa>»; consulte|
    |                    |pam(7) y pam.d(5)                         |
    |--------------------+------------------------------------------|
    |                    |Realice la configuración NSS con una      |
    |/etc/nsswitch.conf  |registro para cada servicio. Consulte     |
    |                    |nsswitch.conf(5)                          |
    |--------------------+------------------------------------------|
    |/etc/nologin        |Acote los usuario con permisos de inicio  |
    |                    |por medio del módulo pam_nologin(8)       |
    |--------------------+------------------------------------------|
    |/etc/securetty      |acote el acceso a tty para el superusuario|
    |                    |por medio del módulo pam_securetty(8)     |
    |--------------------+------------------------------------------|
    |/etc/security/      |acote los permisos de acceso mediante el  |
    |access.conf         |módulo pam_access(8)                      |
    |--------------------+------------------------------------------|
    |/etc/security/      |restrinja los grupos básicos por medio del|
    |group.conf          |módulo pam_group(8)                       |
    |--------------------+------------------------------------------|
    |/etc/security/      |asigne variables de entorno mediante el   |
    |pam_env.conf        |módulo pam_env(8)                         |
    |--------------------+------------------------------------------|
    |                    |asigne más variables de entorno mediante  |
    |/etc/environment    |el módulo pam_env(8) con el parámetro     |
    |                    |«readenv=1»                               |
    |--------------------+------------------------------------------|
    |                    |asigne la configuración regional mediante |
    |/etc/default/locale |el módulo pam_env(8) con el parámetro (de |
    |                    |Debian) «readenv=1 envfile=/etc/default/  |
    |                    |locale»                                   |
    |--------------------+------------------------------------------|
    |/etc/security/      |acote el uso de recursos (ulimit, core, …)|
    |limits.conf         |mediante el módulo pam_linits(8)          |
    |--------------------+------------------------------------------|
    |/etc/security/      |restrinja la asignación de tiempo mediante|
    |time.conf           |el módulo pam_time(8)                     |
    |--------------------+------------------------------------------|
    |/etc/systemd/       |set systemd login manager configuration   |
    |logind.conf         |(see logind.conf(5) and                   |
    |                    |systemd-logind.service(8))                |
    +---------------------------------------------------------------+


    Las normas para la selección de contraseñas se desarrolla en los
    módulos PAM, pam_unix(8) y pam_cracklib(8). Pueden ser
    configuradas por sus parámetros.

    Sugerencia
   
    Los nombres de archivos de los módulos de PAM usan el sufijo
    «.so».

%

4.5.2. La actual gestión centralizada de sistemas

    La gestión moderna de sistemas centralizados puede desplegarse
    empleando un servidor central LDAP (Protocolo Ligero de Acceso a
    Directorios) que administre los sistemas en la red, sean estos
    tipo Unix o de otro tipo. La implementación de código libre de
    este protocolo es el software OpenLDAP.

    El servidor LDAP proporciona información de la cuenta mediante
    PAM y NSS con los paquetes libpam-ldap y libnss-ldap del sistema
    Debian. Se necesitan distintas acciones para activarlo (La
    siguiente configuración no está comprobada y es información
    totalmente secundaria. Por favor léala en este contexto).

      * Puede configurar un servidor centralizado LDAP ejecutando un
        programa como el demonio LDAP centralizado, slapd(8).

      * Cambie los archivos de configuración PAM en el directorio «/
        etc/pam.d/» para usar «pam_ldap.so» en vez de la opción por
        defecto «pam_unix.so».

          + Debian utiliza los archivos «/etc/pam_ldap.conf» para la
            configuración de libpam-ldap y «/etc/pam_ldap.secret»
            para archivar la contraseña de root.

      * Cambie la configuración NSS en el archivo «/etc/
        nsswitch.conf» para suar ldap en vez de la opción por defecto
        («compat» o «file»).

          + Debian utiliza el archivo «/etc/libnss-ldap.conf» para la
            configuración de libnss-ldap.

      * Una contraseña segura necesita que libpam-ldap use conexines
        SSL (o TLS).

      * La integridad de los datos necesita que libnss-ldap utilice
        conexiones SSL (o TLS) con la sobrecarga de red de LDAP.

      * Debería ejecutar nscd(8) para que la caché almacene cualquier
        resultado de una búsqueda de LDAP con el fin de reducir el
        tráfico de red de LDAP.

    Consulte los documentos pam_ldap.conf(5) y «/usr/share/doc/
    libpam-doc/html/» que contiene el paquete libpam-doc e «info libc
    'Name Service Switch'» que contiene el paquete glibc-doc.

    De forma parecida, se pueden instalar sistemas centralizados para
    otro métodos.

      * Integración de usuarios y grupos con sistemas Windows.

          + Se accede a servicios de dominio Windows por medio de los
            paquetes winbind y libpam_winbind.

          + Consulte winbindd(8) y Integración de redes MS Windows
            con Samba.
   
      * Integración de usuarios y grupos con sistemas tipo Unix
        antiguos.

          + Acceso a NIS (originalmente llamado páginas amarillas
            (YP) o NIS+ mediante el paquete nis.

          + Consulte «The Linux NIS(YP)/NYS/NIS+ HOWTO«.

4.5.3. «Razones por las que GNU no tienen la funcionalidad del grupo
wheel«

    Esta frase famosa al final de la página antigua de «info su» de
    Richard M. Stallman. Para no preocuparse: la orden actual su en
    Debian usa PAM, así este puede limitar el uso de su al grupo root
    habilitando la línea «pam_wheel.so» en «/etc/pam.d/su».

%

4.5.4. Regla estricta para contraseñas

    La instalación del paquete libpam-cracklib le permite obligar al
    cumplimiento estricto de reglas para contraseñas, por ejemplo,
    teniendo activas las líneas en «/etc/pam.d/common-password» como
    sigue:

    En squeeze:

    password required pam_cracklib.so retry=3 minlen=9 difok=3
    password [success=1 default=ignore] pam_unix.so use_authtok nullok md5
    password requisite pam_deny.so
    password required pam_permit.so

%

4.6. Otros controles de acceso

    Nota
   
    Consulte Sección 9.3.15, “Tecla Alt-SysRq” como limitar la
    funcionalidad clave de atención segura (SAK) del núcleo.

%

4.6.1. sudo

    sudo(8) es un programa diseñado para permitir que el
    administrador de sistemas conceda ciertos privilegios de
    superusuario a los usuarios y registre su actividad. sudo
    necesita únicamente la contraseña del usuario normal. Una vez
    instalado el paquete sudo la configuración se realiza en el
    archivo «/etc/sudoers». Consulte una configuración de ejemplo en
    «/usr/share/doc/sudo/examples/sudoers» y Sección 1.1.12,
    “Configuración de sudo”.

    En un sistema monousuario, el uso que yo realizo de sudo
    (consulteSección 1.1.12, “Configuración de sudo”) pretende evitar
    mi propia estupidez. Personalmente, considero el uso de sudo como
    la mejor alternativa al uso de la cuenta de superusuario de forma
    constante. Por ejemplo, lo siguiente cambia el dueño de «
    <un_archivo>» a «<mi_nombre>».

    $ sudo chown <mi_nombre> <un_archivo>

    Desde luego si conoce la contraseña de «root« (como la conoce
    cualquier usuario que se instala Debian), cualquier orden puede
    ser ejecutada por «root« desde cualquier cuenta de usuario
    utilizando «su -c».

%

4.6.2. PolicyKit

    PolicyKit es un componente del sistema operativo con el fin de
    controlar los privilegios del sistema en toda su extensión para
    sistemas operativos tipo Unix.

    Los nuevas aplicaciones de interfaz gráfico de usuario no esan
    diseñadas para ejecutarse como procesos privilegiados. Se
    comunican con los procesos privilegiados a través de PolicyKit
    realizando de forma eficiente las operaciones administrativas.

    PolicyKit restrinje cada operación a cuentas de usuario que
    pertenecer al grupo sudo en el sistema Debian.

    Consulte polkit(8).

%

4.6.3. SELinux

    Security-Enhanced Linux (SELinux) es un marco que se ajusta a un
    modelo de privilegios más preciso que el modelo de seguridad de
    tipo Unix con las políticas de control de acceso obligatorio
    (MAC). El poder del superusuario pueden ser limitado bajo ciertas
    condiciones.

%

4.6.4. Restricción de acceso a algunos servicios del servidor

    Para la seguridad del sistema, es una buena idea deshabilitar
    tantos programas del servidor como sea posible. Esto es crítico
    en servidores en red. Tener servidores sin utilidad, ejecutándose
    como demonios o por medio de un programa super servidor, se
    considera un riesgo de seguridad.

    Muchos programas, como sshd(8), utilizan PAM como control de
    acceso. Existen muchas maneras de limitar el acceso a algunos
    servicios de servidor.

      * archivos de configuración: «/etc/default/<nombre_programa>»

      * service unit configuration for daemon

      * PAM (Módulos de Autenticación Insertables (Pluggable
        Authentication Modules))

      * «/etc/inetd.conf» para el super servidor

      * «/etc/hosts.deny» y «/etc/hosts.allow» para TCP wrapper, tcpd
        (8)

      * «/etc/rpc.conf» para Sun RPC

      * «/etc/at.allow» y «/etc/at.deny» para atd(8)

      * «/etc/cron.allow» y «/etc/cron.deny» para crontab(1)

      * Cortafuegos de red de la infraestructura netfilter

    See Sección 3.2.6, “System management under systemd”,
    Sección 4.5.1, “Archivos de configuración utilizados por PAM y
    NSS”, and Sección 5.10, “Infraestructura Netfilter”.

    Sugerencia
   
    Los servicios Sun RPC necesitan estar activos para NFS y otros
    programas basados en RPC.

    Sugerencia

    Si tiene problemas de acceso remoto en sistemas Debian recientes,
    comente las configuraciones que lo restringuen como «ALL:
    PARANOID« en «/etc/hosts.deny» si existe. (Pero debe tener
    cuidado con los riesgos de seguridad qu este tipo de acciones
    tienen.)

%

4.7. Acreditación de seguridad

    Nota
   
    La información que se facilita aquí puede no ser suficiente para
    la seguridad que necesita pero puede ser un buen comienzo.

%

4.7.1. Contraseñas seguras en Internet

    Los servicios de la capa de transporte más usados usan mensajes
    que incluyen la acreditación mediante contraseñas en texto plano.
    Es una mala idea emitir contraseñas en texto plano en una red
    descentralizada donde pueden ser interceptados. Puede ejecutar
    estos servicios sobre la «Capa de Transporte Segura« (TLS) o su
    predecesor «Secure Sockets Layer« (SSL) para asegurar por medio
    del cifrado todas las comunicaciones incluidas las contraseñas.

    Tabla 4.7. Relación de servicios y puertos seguros e inseguros

    +---------------------------------------------------------------+
    |   Nombre del servicio   |puerto|  nombre del servicio  |puerto|
    |        inseguro         |      |        seguro         |      |
    |-------------------------+------+-----------------------+------|
    |www (http)               |80    |https                  |443   |
    |-------------------------+------+-----------------------+------|
    |smtp (mail)              |25    |ssmtp (smtps)          |465   |
    |-------------------------+------+-----------------------+------|
    |ftp-data                 |20    |ftps-data              |989   |
    |-------------------------+------+-----------------------+------|
    |ftp                      |21    |ftps                   |990   |
    |-------------------------+------+-----------------------+------|
    |telnet                   |23    |telnets                |992   |
    |-------------------------+------+-----------------------+------|
    |imap2                    |143   |imaps                  |993   |
    |-------------------------+------+-----------------------+------|
    |pop3                     |110   |pop3s                  |995   |
    |-------------------------+------+-----------------------+------|
    |ldap                     |389   |ldaps                  |636   |
    +---------------------------------------------------------------+


    El coste de tiempo de CPU del cifrado. Como alternativa más
    eficiente para la CPU, se pueden mantener las comunicaciones en
    texto plano y securizando la contraseña con el protocolo de
    acreditación como «Acreditación de Oficina de Correos
    (Authenticated Post Office Protocol, APOP )« para POP y
    «Mecanismo de acreditación reto-respuesta MD5(Challenge-Response
    Authentication Mechanism MD5, CRAM-MD5)« para SMTP e IMAP. (Para
    el envio de mensajes de correo en Internet a su servidor de
    correo desde su cliente de correo, se ha vuelto usual el uso del
    puerto 587 para la recepción de mensajes en vez del tradicioal
    puerto 25 SMTP para evitar el bloqueo del puerto 25 por el
    proveedor de red mientras se acredita con CRAM-MD5.)

%

4.7.2. «Secure Shell«

    El programa Secure Shell (SSH) ofrece comunicaciones cifradas
    seguras entre dos equipos no confiables sobre una red insegura
    con acreditación segura. Consiste en el cliente OpenSSH, ssh(1) y
    el demonio OpenSSH, sshd(8). Este SSH puede ser usado para
    realizar un túnel de un protocolo de comunicación inseguro como
    es POP y securizar X sobre Internet con la funcionalidad de
    reenvio de puerto (port forwarding).

    El cliente intenta acreditarse a si mismo usando la acreditación
    basada en equipos, acreditación de clave pública, acreditación
    reto-respuesta, o acreditación por contraseña. El uso de
    acreditación por clave pública permite acceso remoto sin
    contraseña. Consulte Sección 6.9, “Servidor de acceso remoto
    (SSH) y utilidades”.

%

4.7.3. Medidas extraordinarias de seguridad en Internet

    Incluso cuando ejecute servicios seguros como servidores Secure
    Shell (SSH) y Protocolo de Túnel Punto a Punto (Point-to-point
    tunneling protocol, PPTP), todavía existen la posibilidad de
    «hackeo» mediante ataques de fuerza bruta desde Internet para
    adivinar la contraseña etc. El uso de las directrices del
    cortafuegos (consulte Sección 5.10, “Infraestructura Netfilter”)
    junto con las herramientas de seguridad que siguen pueden mejorar
    la seguridad.

    Tabla 4.8. Relación de herramientas que aportan medidas extra de
    seguridad

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|         descripción          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |pequeño demonio de golpeo de  |
    |knockd       |V:0, I:3   |102   |puertos (port-knock) knockd(1)|
    |             |           |      |y el cliente konck(1)         |
    |-------------+-----------+------+------------------------------|
    |             |V:112,     |      |prohibición de las IPs con    |
    |fail2ban     |I:123      |2092  |múltiples errores de          |
    |             |           |      |acreditación                  |
    |-------------+-----------+------+------------------------------|
    |libpam-shield|V:0, I:0   |115   |bloquea atacantes remotos que |
    |             |           |      |intentan adivinar contraseñas |
    +---------------------------------------------------------------+


%

4.7.4. Asegurando la contraseña de root

    Para evitar que la gente acceda a su equipo con privilegios de
    root, necesita realizar las siguientes acciones:

      * Impide el acceso físico al disco duro

      * Bloquea la BIOS y evita el arranque de un medio externo
   
      * Asigne una contraseña a las sesiones interactivas de GRUB

      * Bloquee la edición del menú de GRUB

    Con acceso físico al disco duro, resetear la contraseña es
    relativamente fácil siguiendo los pasos:

     1. Mueva el disco duro a un PC con una BIOS capaz de arrancar
        desde CD.

     2. Arranque el sistema con un medio de rescate (disco de
        arranque Debiam. Knoppix CD, GRUB CD, ...).

     3. Monte la partición raíz con permisos de lectura/escritura.

     4. Edite «/etc/passwd» en la partición raíz y cree un segundo
        registro para la cuenta de root vacía.

    Si tiene acceso edite el registro del menú GRUB (consulte
    Sección 3.1.2, “Fase 2: el cargador de arranque”) para
    grub-rescue-pc en el arranque, es incluso más fácil siguiendo los
    pasos:

     1. Arranque el sistema con el argumento del núcleo cambiado a
        algo como «root=/dev/hda6 rw init=/bin/sh».

     2. Edite «/etc/passwd» y cree una segundo registro para una
        cuenta de root vacia.

     3. Reinicie el sistema.

    El intérprete de órdenes del superusuario del sistema es
    accesible sin contraseña.

    Nota

    Una vez que tiene acceso al intérprete de órdenes del
    superusuario, tiene acceso a todo en el sistema y puede cambiar
    cualquier contraseña del sistema. Incluso, se pueden comprometer
    las contraseñas de todos los usuarios por medio de herramientas
    de «cracking« de fuerza bruta como los paquetes john y crack
    packages (see Sección 9.4.11, “Sistema de seguridad y de
    comprobación de la integridad”). Estas contraseñas pirateadas
    pueden servir para comprometer otros sistemas.

    La única solución software razonable es evitar lo anterior con la
    utilización de software que cifra la partición raíz (o la
    partición «/etc») usando dm-crypt e initramfs (consulte
    Sección 9.8, “Trucos para cifrar información”). Sin embargo,
    siempre necesitará la contraseña para arrancar el sistema.

Capítulo 5. Configuración de red

    Sugerencia
   
    Como referencia general de red de GNU/Linux, le la Guía de
    Administración de Red.

    Sugerencia
   
    Como guía de especifica de red moderna de Debian, lea Manual del
    Administrador de Debian - Configuración de red.

    Aviso

    En vez de usar el esquema de nombre de interfaces tradicional
    («eth0», «eth1», «wlan0», …), el nuevo systemd utiliza « Nombres
    de Interfaz de Red Predecibles« como es «enp0s25».

    Aviso
   
    Este capítulo esta desactualizado ya que esta fundamentado en
    Debian 7.0 (Wheezy) publicado en 2013.

    Sugerencia

    Aunque este documetno todavía usa el antiguo ifconfig(8) con IPv4
    para los ejemplos de configuración de red, Debian se dirige a ip
    (8) con IPv4+IPv6 en la distribución wheezy. Parches para
    actualizar este documento son bienvenidos.

    Sugerencia
   
    Con systemd, networkd se puede usar para la gestión de redes.
    Consulte systemd-networkd(8).

%

5.1. La infraestructura de red básica

    Revisemos la infraestructura de red básica de un sistema moderno
    Debian.

    Tabla 5.1. Relación de herramientas de configuración de red

    +---------------------------------------------------------------------------+
    |      paquetes       |popularidad|tamaño|      tipo       |  descripción   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |herramienta     |
    |                     |V:587,     |      |                 |estándar para   |
    |ifupdown             |I:991      |217   |config::ifupdown |subir o bajar la|
    |                     |           |      |                 |red (específico |
    |                     |           |      |                 |de Debian)      |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestiona la red |
    |ifplugd              |V:3, I:18  |217   |, ,              |cableada        |
    |                     |           |      |                 |automáticamente |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |archivo de      |
    |                     |           |      |                 |órdenes de      |
    |ifupdown-extra       |V:0, I:1   |106   |, ,              |prueba de red   |
    |                     |           |      |                 |para mejorar el |
    |                     |           |      |                 |paquete         |
    |                     |           |      |                 |«ifupdown»      |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |asigna métricas |
    |                     |           |      |                 |de              |
    |ifmetric             |V:0, I:1   |37    |, ,              |encaminamiento  |
    |                     |           |      |                 |para el interfaz|
    |                     |           |      |                 |de red          |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |archivo de      |
    |                     |           |      |                 |órdenes de mapeo|
    |                     |           |      |                 |para mejorar el |
    |                     |           |      |                 |paquete         |
    |guessnet             |V:0, I:0   |422   |, ,              |«ifupdown» por  |
    |                     |           |      |                 |medio del       |
    |                     |           |      |                 |archivo «/etc/  |
    |                     |           |      |                 |network/        |
    |                     |           |      |                 |interfaces»     |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |archivo de      |
    |                     |           |      |                 |órdenes de mapeo|
    |ifscheme             |V:0, I:0   |59    |, ,              |para mejorar el |
    |                     |           |      |                 |paquete         |
    |                     |           |      |                 |«ifupdown»      |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |NetworkManager  |
    |network-manager      |V:358,     |14957 |config::NM       |(demonio):      |
    |                     |I:440      |      |                 |gestión de red  |
    |                     |           |      |                 |automatizada    |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |V:132,     |      |                 |NetworkManager  |
    |network-manager-gnome|I:372      |5540  |, ,              |(interfaz de    |
    |                     |           |      |                 |usuario GNOME)  |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestor de red   |
    |                     |           |      |                 |para redes      |
    |wicd                 |I:24       |36(*) |config::wicd     |inalámbricas y  |
    |                     |           |      |                 |cableadas       |
    |                     |           |      |                 |(metapaquete)   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestor de red   |
    |                     |           |      |                 |para redes      |
    |                     |           |      |                 |inalámbricas y  |
    |wicd-cli             |V:0, I:1   |60(*) |, ,              |cableadas       |
    |                     |           |      |                 |(cliente por    |
    |                     |           |      |                 |línea de        |
    |                     |           |      |                 |órdenes)        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestor de red   |
    |                     |           |      |                 |para redes      |
    |wicd-curses          |V:0, I:3   |176(*)|, ,              |inalámbricas y  |
    |                     |           |      |                 |cableadas       |
    |                     |           |      |                 |(cliente de     |
    |                     |           |      |                 |curses)         |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestor de red   |
    |                     |           |      |                 |para redes      |
    |wicd-daemon          |V:19, I:26 |992(*)|, ,              |inalámbriacas y |
    |                     |           |      |                 |cableadas       |
    |                     |           |      |                 |(demonio)       |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |gestor de red   |
    |                     |           |      |                 |para redes      |
    |wicd-gtk             |V:15, I:25 |576(*)|, ,              |inalámbricas y  |
    |                     |           |      |                 |cableadas       |
    |                     |           |      |                 |(cliente GTK+)  |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |herramientas de |
    |                     |V:300,     |      |                 |administración  |
    |iptables             |I:993      |2520  |config::Netfilter|para el filtrado|
    |                     |           |      |                 |de paquetes y   |
    |                     |           |      |                 |NAT (Netfilter) |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |iproute2, IPv6 y|
    |                     |           |      |                 |otras           |
    |iproute2             |V:672,     |2867  |config::iproute2 |configuraciones |
    |                     |I:926      |      |                 |de red          |
    |                     |           |      |                 |avanzadas: ip(8)|
    |                     |           |      |                 |, tc(8), etc    |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |renombrado de   |
    |                     |           |      |                 |interfaces de   |
    |ifrename             |V:0, I:3   |125   |, ,              |red basado en   |
    |                     |           |      |                 |varios criterios|
    |                     |           |      |                 |estáticos:      |
    |                     |           |      |                 |ifrename(8)     |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |muestra o cambia|
    |ethtool              |V:102,     |597   |, ,              |la configuración|
    |                     |I:261      |      |                 |de dispositivos |
    |                     |           |      |                 |Ethernet        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |prueba la       |
    |                     |           |      |                 |accesibilidad a |
    |                     |           |      |                 |un equipo remoto|
    |iputils-ping         |V:234,     |113   |test::iproute2   |a través de la  |
    |                     |I:997      |      |                 |red por su      |
    |                     |           |      |                 |nombre de equipo|
    |                     |           |      |                 |o dirección IP  |
    |                     |           |      |                 |(iproute2)      |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |prueba la       |
    |                     |           |      |                 |accesibilidad   |
    |                     |           |      |                 |por red de un   |
    |iputils-arping       |V:8, I:127 |55    |, ,              |equipo remoto   |
    |                     |           |      |                 |específico      |
    |                     |           |      |                 |mediante la     |
    |                     |           |      |                 |dirección ARP   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |determina la    |
    |iputils-tracepath    |V:4, I:60  |72    |, ,              |ruta de red a un|
    |                     |           |      |                 |equipo remoto   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |conjunto de     |
    |                     |           |      |                 |herramientas de |
    |                     |V:234,     |      |                 |red NET-3       |
    |net-tools            |I:634      |991   |config::net-tools|(net-tools,     |
    |                     |           |      |                 |configuración de|
    |                     |           |      |                 |red IPv4):      |
    |                     |           |      |                 |ifconfig(8) etc.|
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |comprueba la    |
    |                     |           |      |                 |accesibilidad de|
    |                     |           |      |                 |la red a un     |
    |inetutils-ping       |V:0, I:1   |359   |test::net-tools  |equipo remoto   |
    |                     |           |      |                 |por su nombre de|
    |                     |           |      |                 |equipo o        |
    |                     |           |      |                 |dirección IP    |
    |                     |           |      |                 |(antiguo GNU)   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |comprueba la    |
    |                     |           |      |                 |accesiblidad de |
    |                     |           |      |                 |red a un equipo |
    |arping               |V:2, I:29  |77    |, ,              |remoto          |
    |                     |           |      |                 |específico      |
    |                     |           |      |                 |mediante la     |
    |                     |           |      |                 |dirección ARP   |
    |                     |           |      |                 |(histórico)     |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |determina la    |
    |                     |           |      |                 |ruta de red a un|
    |traceroute           |V:63, I:936|159   |, ,              |equipo remoto   |
    |                     |           |      |                 |(histórico,     |
    |                     |           |      |                 |consola)        |
    |---------------------+-----------+------+-----------------+----------------|
    |isc-dhcp-client      |V:231,     |686   |config::low-level|cliente DHCP    |
    |                     |I:979      |      |                 |                |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |cliente que     |
    |wpasupplicant        |V:332,     |3436  |, ,              |soporta WPA y   |
    |                     |I:507      |      |                 |WPA2 (IEEE      |
    |                     |           |      |                 |802.11i)        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |cliente Qt de   |
    |wpagui               |V:0, I:2   |781   |, ,              |interfaz de     |
    |                     |           |      |                 |usuario para    |
    |                     |           |      |                 |«wpa_supplicant«|
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |herramientas    |
    |                     |           |      |                 |para manejar las|
    |                     |V:188,     |      |                 |Extensiones     |
    |wireless-tools       |I:254      |297   |, ,              |Inalámbricas    |
    |                     |           |      |                 |Linux («Linux   |
    |                     |           |      |                 |Wireless        |
    |                     |           |      |                 |Extensions«)    |
    |---------------------+-----------+------+-----------------+----------------|
    |ppp                  |V:206,     |1054  |, ,              |conexión PPP/   |
    |                     |I:474      |      |                 |PPPoE con chat  |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |ayudante de     |
    |pppoeconf            |V:0, I:8   |192   |config::helper   |configuración   |
    |                     |           |      |                 |para conexiones |
    |                     |           |      |                 |PPPoE           |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |ayudante de     |
    |pppconfig            |V:1, I:2   |801   |, ,              |configuración   |
    |                     |           |      |                 |para conexiones |
    |                     |           |      |                 |PPP con chat    |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |ayudante de     |
    |                     |           |      |                 |configuración   |
    |wvdial               |V:0, I:5   |249   |, ,              |para conexiones |
    |                     |           |      |                 |PPP con wvdial y|
    |                     |           |      |                 |ppp             |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |determina la    |
    |mtr-tiny             |V:6, I:54  |161   |test::low-level  |ruta de red a un|
    |                     |           |      |                 |equipo remoto   |
    |                     |           |      |                 |(curses)        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |determina la    |
    |mtr                  |V:4, I:43  |214   |, ,              |ruta de red a un|
    |                     |           |      |                 |equipo remoto   |
    |                     |           |      |                 |(curses y GTK+) |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |herramientas    |
    |                     |           |      |                 |para operaciones|
    |gnome-nettool        |V:2, I:45  |2105  |, ,              |de información  |
    |                     |           |      |                 |de red comunes  |
    |                     |           |      |                 |(GNOME)         |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |descubridor de  |
    |nmap                 |V:31, I:253|4452  |, ,              |red / escáner de|
    |                     |           |      |                 |puertos (Nmap,  |
    |                     |           |      |                 |consola)        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |descubridor de  |
    |zenmap               |V:2, I:9   |2939  |, ,              |red / escaneador|
    |                     |           |      |                 |de puertso      |
    |                     |           |      |                 |(GTK+)          |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |analizador de   |
    |tcpdump              |V:19, I:204|1329  |, ,              |tráfico de red  |
    |                     |           |      |                 |(Tcpdump,       |
    |                     |           |      |                 |consola)        |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |analizador de   |
    |wireshark            |I:55       |64    |, ,              |tráfico de red  |
    |                     |           |      |                 |(Wireshark,     |
    |                     |           |      |                 |GTK+)           |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |analizador de   |
    |tshark               |V:3, I:34  |407   |, ,              |tráfico de red  |
    |                     |           |      |                 |(consola)       |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |produce un      |
    |                     |           |      |                 |resumen de las  |
    |tcptrace             |V:0, I:3   |401   |, ,              |conexiones de   |
    |                     |           |      |                 |salida con      |
    |                     |           |      |                 |tcpdump         |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |sistema flexible|
    |snort                |V:0, I:1   |2206  |, ,              |de detección de |
    |                     |           |      |                 |intrusos en red |
    |                     |           |      |                 |(Snort)         |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |muestra el uso  |
    |ntopng               |V:1, I:2   |969   |, ,              |de red en un    |
    |                     |           |      |                 |navegador web   |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |clientes de red |
    |                     |           |      |                 |proporcionado   |
    |dnsutils             |V:64, I:517|256   |, ,              |con BIND:       |
    |                     |           |      |                 |nslookup(8),    |
    |                     |           |      |                 |nsupdate(8), dig|
    |                     |           |      |                 |(8)             |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |comprueba la    |
    |                     |           |      |                 |información de  |
    |                     |           |      |                 |zona DNS        |
    |dlint                |V:0, I:7   |53    |, ,              |mediante        |
    |                     |           |      |                 |consultas al    |
    |                     |           |      |                 |servidor de     |
    |                     |           |      |                 |nombres         |
    |---------------------+-----------+------+-----------------+----------------|
    |                     |           |      |                 |determina una   |
    |dnstracer            |V:0, I:2   |61    |, ,              |cadena de       |
    |                     |           |      |                 |servidores DNS a|
    |                     |           |      |                 |la fuente       |
    +---------------------------------------------------------------------------+


%

5.1.1. La resolución del nombre del equipo

    La resolución del nombre del equipo esta sustentada por el
    mecanismo NSS (Name Service Switch) también. El flujo de esta
    resolución es el siguiente:

     1. El archivo «/etc/nsswitch.conf» con la entrada como «hosts:
        files dns» determina el orden de la resolución del nombre de
        equipos. (Esto sustituye la vieja funcionalidad del «orden»
        de la entrada en «/etc/host.conf».)

     2. El método files se llama en primer lugar. Si el nombre del
        equipo se encuentra en el archivo «/etc/hosts», devuelve
        todas las direcciones válidas de esta y finaliza. (El archivo
        «/etc/host.conf» contiene «múltiples posibilidades».)

     3. El método dns es llamado. Si el nombre del equipo se
        encuentra por la pregunta al Sistema de Internet de Nombres
        de Dominio (DNS) que se identifican por el archivo «/etc/
        resolv.conf», devuelve todas las direcciones correctas para
        él si existen.

    Por ejemplo, «/etc/hosts» tiene el siguiente aspecto:

    127.0.0.1 localhost
    127.0.1.1 <host_name>

    # las líneas siguientes son deseables para la funcionalidad IPv6 de los equipos
    ::1     ip6-localhost ip6-loopback
    fe00::0 ip6-localnet
    ff00::0 ip6-mcastprefix
    ff02::1 ip6-allnodes
    ff02::2 ip6-allrouters
    ff02::3 ip6-allhosts

    Cada línea comienza con una dirección IP y es seguido por su
    nombre de equipo asociada.

    La dirección IP 127.0.1.1 de la segunda línea del ejemplo puede
    no aparecer en otros sistemas tipo Unix. El Instalador Debian
    crea esta entrada para un sistemas sin una dirección IP
    permanente como una solución temporal para algunos software (p.
    ej. GNOME) como se documetna en el error #719621.

    El <nombre_del_equipo> encaja con el nombre del equipo definida
    en «/etc/hostname».

    En sistemas que tienen un dirección IP permanente, la dirección
    permanente podría ser usada aquí en vez de 127.01.1.

    En sistemas con una IP permanente y un nombre cualificado
    completo de dominio (FQDN) provisto por el Sistema de Nombre de
    Dominio (DNS), ese canónico <nombre_del_equipo>.
    <nombre_del_dominio>podría ser usado en vez de solo el
    <nombre_del_equipo>.

    «/etc/resolv.conf» es un archivo estático si el paquete
    resolvconf no está instalado. Si esta instalado, es un enlace
    simbólico. De cualquier manera, contiene información que inicia
    las rutinas del resolutor. Si el DNS se encontrara con IP=
    «192.168.11.1», contiene lo siguiente:

    nameserver 192.168.11.1

    El paquete resolvconf hace que «/etc/resolv.conf» sea un enlace
    simbólico y gestiona su contenido por su archivo de órdenes
    «hook« automáticamente.

    En las estaciones de trabajo PC del típico entorno LAN, el nombre
    del equipo puede ser resuelto mediante DNS en «multicast« (mDNS
    Zeroconf) además de los archivos básicos y los métodos dns.

      * Avahi ofrece un marco para el Servicio de Descubrimiento DNS
        «Multicast« en Debian.

      * Es similar a Apple Bonjour / Apple Rendezvous.

      * El paquete conector libnss-mdns aporta la resolución de
        nombres de equipo por medio de mDNS para la funcionalidad del
        Intercambio del Servicio de Nombres GNU (NSS) de la
        biblioteca GNU C (glibc).
   
      * El archivo «/etc/nsswitch.conf» podrái tener un registro como
        «hosts: files mdns4_minimal [NOTFOUND=return] dns mdns4».

      * Los nombres de equipo que terminan con «.local« pseudo
        dominio de alto nivel (TLD) se resuelven.

      * La dirección «multicast« de enlace local mDNS IPv4
        «224.0.0.251» o su equivalente IPv6 «FF02::FB» son usados
        para realizar consultas DNS para un nombre que términa en
        «.local».

    La resolución de nombres de equipo por el método antiguo NETBios
    sobre TCP/IP utilizado por los viejos sistemas Windows puede ser
    proporcionado por el paquete winbind. El archivo «/etc/
    nsswitch.conf» podría tener una entrada como «hosts: files
    mdns4_minimal [NOTFOUND=return] dns mdns4 wins» para permitir esa
    funcionalidad. (Los sistemas Windows modernos normalmente usan el
    método dns para la resolución de nombres de equipo.)

    Nota

    La expansión de los dominios genérico de alto nivel (gTLD) en el
    Sistema de Nombres de Dominio está en desarrollo. Tenga cuidado
    con la colisión de nombres cuando elige un nombre de dominio
    utilizado únicamente en la LAN.

%

5.1.2. El nombre del interfaz de red

    El nombre de las interfaces de red, p. ej. eth0, se asigna para
    cada hardware del núcleo de Linux cuando se descubre por medio
    del mecanismo de configuración del espacio de usuario, udev
    (consulte Sección 3.3, “El sistema udev”). El nombre de las
    interfaces de red es llamado interfaz físico en ifup(8) y 
    interfaces(5).

    Para asegurar que cada interfaz de red recibe siempre el mismo
    nombre en todos los reinicios se usa la dirección MAC etc.,
    existiendo un archivo de reglas «/etc/udev/rules.d/
    70-persistent-net.rules». Este archivo se genera de forma
    automática por el programa «/lib/udev/write_net_rules»,
    posiblemente ejecutado por el archivo de reglas
    «persistent-net-generator.rules». Puede modificarlo para cambiar
    las reglas de nombrado.

    Atención

    Cuendo modifique el archivo de reglas «/etc/udev/rules.d/
    70-persistent-net.rules», debe poner cada regla en una línea y la
    dirección MAC en minúsculas. Por ejemplo, Por ejemplo, si en este
    fichero encuentra «FireWire device« y «PCI device«, probablemente
    querrá nombrar el «PCI device« como eth0 y configurarlo como el
    interfaz de red primario.

%

5.1.3. EL rango de direcciones de red para una LAN

    Permitanos recordarnos que los rangos de direcciones de IPv4 de
    32 bits reservadas para cada clase de las redes de áreas locales
    (LANs) del rfc1918. Estas direcciones garantizan que no existan
    conflictos con las direcciones propias de Internet.

    Tabla 5.2. Relación de rangos de direcciones de red

    +---------------------------------------------------------------+
    |Clase| direcciones de  | máscara de  |  bits de la   |  nº de  |
    |     |       red       |     red     |máscara de red |subredes |
    |-----+-----------------+-------------+---------------+---------|
    |A    |10.x.x.x         |255.0.0.0    |/8             |1        |
    |-----+-----------------+-------------+---------------+---------|
    |B    |172.16.x.x —     |255.255.0.0  |/16            |16       |
    |     |172.31.x.x       |             |               |         |
    |-----+-----------------+-------------+---------------+---------|
    |C    |192.168.0.x —    |255.255.255.0|/24            |256      |
    |     |192.168.255.x    |             |               |         |
    +---------------------------------------------------------------+


    Nota

    Si una de estas direcciones se asigna a un equipo, entonces ese
    equipo no puede acceder a Internet de forma directa si no a
    través de una pasarela que actua como «proxy« para servicios
    individuales o realiza Traducción de Direcciones de Red (NAT). El
    encaminador de banda ancha normalmente realiza NAT para los
    entornos LAN del cliente.

%

5.1.4. El mantenimiento de los dispositivos de red

    Aunque la mayoría de los dispositivos «hardware« son admitidos
    por el sistema Debian, existen algunos dispositivos de red que
    necesitan DFSG firmware propietario para su uso. Por favor
    consulte Sección 9.9.6, “Controladores y firware del hardware”.

%

5.2. La configuración moderna de red en el escritorio

    Comunmente el interfaz lo se inicializa mediante
    «networking.service» y el resto de interfaces de un sistema de
    escritorio moderno Debian que use systemd mediante
    «NetworkManager.service».

    Debian squeeze y las nuevas versiones pueden gestionar las
    conexiones de red mediante programas que actuan como demonios
    como NetworkManager (NM) (network-manager y paquetes
    relacionados) o Wicd (wicd y paquetes relacionados).

      * Ellos tienen sus propios interfaz gráfico de usuarios y
        programas de línea de órdenes como interfaces de usuario.

      * Tienen su propio demonio así como su motor de sistema.

      * Permiten la conexión sencilla entre su sistema e Internet.

      * Permiten la gestión sencilla de la configuración inalámbrica
        y cableada.

      * Nos permiten configurar la red de forma independiente del
        histórico paquete ifupdown.

    Nota

    No use las herramientas de configuración de red automática para
    servidores. Estos están pensados para escritorios móviles y
    portátiles.

    Estas herramientas modernas de red necesitan ser configuradas
    adecuadamente para evitar conflictos con el histórico paquete
    ifupdown y su archivo de configuración «/etc/network/interfaces».

    Nota

    Algunas funcionalidades de estas herramientas de red automáticas
    pueden sufrir retrocesos. No son tan robustos como el histórico
    paquete ifupdown. Compruebe BTS de network-manager y BTS of wicd
    para determinar sus problemas actuales y limitaciones.

5.2.1. Herramientas de interfaz gráfico de usuario para la
configuración de red

    La documentación oficial de NM y Wicd en Debian esta en «/usr/
    share/doc/network-manager/README.Debian» y «/usr/share/doc/wicd/
    README.Debian» respectivamente.

    Basicamente, la configuración de red para escritorios esta hecha
    como sigue a continuación.

     1. Haga que el usuario de escritorio, p. ej. foo, pertenezca al
        grupo «netdev» como sigue (de otra forma, se puede hacer de
        forma automática mediante D-bus en entornos de escritorio
        modernos como GNOME y KDE).

        $ sudo adduser foo netdev

     2. Mantenga la configuración de «/etc/network/interfaces» tan
        simple como sigue.
   
        auto lo
        iface lo inet loopback

     3. Reinicie NM o Wicd como sigue:

        $ sudo /etc/init.d/network-manager restart

        $ sudo /etc/init.d/wicd restart

     4. Configure al red por medio del interfaz gráfico de usuario.

    Nota

    Solo los interfaces que no estan enumerados en «/etc/network/
    interfaces» son gestionados por NM o Wicd para evitar conflictos
    con ifupdown.

    Sugerencia

    Si quiere aumentar las capacidades de configuración de red de NM,
    por favor busque los módulos conectables y paquetes
    suplementarios como network-manager-openconnect,
    network-manager-openvpn-gnome, network-manager-pptp-gnome,
    mobile-broadband-provider-info, gnome-bluetooth, etc. Lo mismo
    ocurre con Wicd.

    Atención

    Estas herramientas de configuración automática pueden no ser
    compatibles con configuraciones esotéricas del histórico ifupdown
    en «/etc/network/interfaces» como las de Sección 5.6, “La
    configuración básica de red con ifupdown (histórico)” y
    Sección 5.7, “Configuración avanzada de red con ifupdown
    (histórico)”. Compruebe BTS de network-manager y BTS de wicd para
    determinar sus limitaciones y problemas.

%

5.3. The modern network configuration without GUI

    Con systemd, la red puede configurarse en su lugar en /etc/
    systemd/network/. Consulte systemd-resolved(8), resolved.conf(5)
    y systemd-networkd(8).

    This allows the modern network configuration without GUI.

    A DHCP client configuration can be set up by creating "/etc/
    systemd/network/dhcp.network". E.g.:

    [Match]
    Name=en*
   
    [Network]
    DHCP=yes

    A static network configuration can be set up by creating "/etc/
    systemd/network/static.network". E.g.:

    [Match]
    Name=en*
   
    [Network]
    Address=192.168.0.15/24
    Gateway=192.168.0.1

%

5.4. La configuración y conexión de red históricos

    Cuando el método que se describe en Sección 5.2, “La
    configuración moderna de red en el escritorio” no cubre sus
    necesidades, podría utilizar los métodos de configuración y
    conexión históricos que combina muchas herramientas sencillas.

    La conexión de red histórica es particular de cada método
    (consulte Sección 5.5, “Método de conexión de red (histórico)”).

    Existen dos tipos de programas de bajo nivel para la
    configuración de red en Linux (consulte Sección 5.8.1, “Órdenes
    iproute2”).

      * Los antiguos programas net-tools(ifconfig(8), …) existen
        desde el sistema de red NET-3 de Linux. La mayor parte de
        ellos estan obsoletos actualmente.

      * Los nuevos programas Linux iproute2 (ip(8), …) son el sistema
        actual de red en Linux.

    Aunque estos programas de red de bajo nivel son poderosos, son
    difíciles de usar. Así los sistemas de configuración de red de
    alto nivel se crearon.

    El paquete ifupdown es el estándar de facto de esos sistemas de
    configuración de red en Debian. Permite activar la red ejecutando
    simplemente , p. ej., «ifup eth0». Su archivo de configuración es
    «/etc/network/interfaces» y su contenido normal es el siguiente:

    auto lo
    iface lo inet loopback
   
    auto eth0
    iface eth0 inet dhcp

    El paquete resolvconf fue creado para completar el sistema
    ifupdown para aportar una reconfiguración suave de la resolución
    de direcciones de red mediante la reescritura automática del
    archivo de configuración del resolutor «/etc/resolv.conf». Hoy en
    día, la major parte de los paquetes de configuración de red en
    Debian se han modificado para utilizar el paquete resolvconf
    (consulte «/usr/share/doc/resolvconf/README.Debian»).

    Los archivos de órdenes de ayuda al paquete ifupdown como son
    ifplugd, guessnet, ifscheme, etc. han sido creados para
    automatizar la configuración dinámica de un entorno de red como
    puede ser un PC obicuo o LAN cableada. Estos son hasta cierto
    punto difíciles de utilizar pero cohexisten bien con el sistema
    ifupdown.

    Existen explicaciones detalladas con ejemplos (consulte
    Sección 5.6, “La configuración básica de red con ifupdown
    (histórico)” y Sección 5.7, “Configuración avanzada de red con
    ifupdown (histórico)”).

%

5.5. Método de conexión de red (histórico)

    Atención

    Los métodos de prueba de conexión que se describen en esta
    sección deben ser usados con finalidad de realizar pruebas. No
    deben ser utilizados para forma habitual para las conexiones de
    red. Le recomendamos que utilice en su lugar NM, Wicd, o el
    paquete ifupdown (consulte Sección 5.2, “La configuración moderna
    de red en el escritorio” y Sección 5.6, “La configuración básica
    de red con ifupdown (histórico)”).

    El método de conexión de red estándar y encaminamiento de la
    conexión para un PC puede ser resumido en lo siguiente:

    Tabla 5.3. Relación de métodos de conexión a red y ruta de la
    conexión

    +---------------------------------------------------------------+
    |    PC     |método de |          ruta de la conexión           |
    |           | conexión |                                        |
    |-----------+----------+----------------------------------------|
    |Puerto     |          |⇔ modem ⇔ POTS ⇔ punto de acceso        |
    |serie      |PPP       |telefónico ⇔ ISP                        |
    |(ppp0)     |          |                                        |
    |-----------+----------+----------------------------------------|
    |Puerto     |PPPoE/DHCP|⇔ BB-modem ⇔ servicio BB ⇔ punto de     |
    |Ethernet   |/Estático |acceso BB ⇔ ISP                         |
    |(eth0)     |          |                                        |
    |-----------+----------+----------------------------------------|
    |Puerto     |DHCP/     |⇔ LAN ⇔ encaminador BB con traducción de|
    |Ethernet   |Estático  |direcciones de red (NAT) (⇔ BB-modem …) |
    |(eth0)     |          |                                        |
    +---------------------------------------------------------------+


    Aquí esta un resumen de los archivos de órdenes de configuración
    para cada método de conexión.

    Tabla 5.4. Relación de configuraciones de conexiones de red

    +---------------------------------------------------------------+
    |  método de  |        configuración         | paquete(s) motor |
    |  conexión   |                              |                  |
    |-------------+------------------------------+------------------|
    |PPP          |pppconfig para crear una      |pppconfig, ppp    |
    |             |conversación determinista     |                  |
    |-------------+------------------------------+------------------|
    |PPP          |wvdialconf para crear una     |ppp, wvdial       |
    |(alternativo)|conversación heurística       |                  |
    |-------------+------------------------------+------------------|
    |PPPoE        |pppoeconf para crear una      |pppoeconf, ppp    |
    |             |conversación determinista     |                  |
    |-------------+------------------------------+------------------|
    |DHCP         |descrito en «/etc/dhcp/       |isc-dhcp-client   |
    |             |dhclient.conf»                |                  |
    |-------------+------------------------------+------------------|
    |IP estática  |descrito en «/etc/network/    |iproute o         |
    |IP (IPv4)    |interfaces»                   |net-tools         |
    |             |                              |(obsoleto)        |
    |-------------+------------------------------+------------------|
    |IP estática  |descrito en «/etc/network/    |iproute           |
    |(IPv6)       |interfaces»                   |                  |
    +---------------------------------------------------------------+


    Los acrónimos de conexión de red tienen los significados.

    Tabla 5.5. Relación de acrónimos de conexiones de red

    +---------------------------------------------------------------+
    |acrónimo|                     significado                      |
    |--------+------------------------------------------------------|
    |POTS    |servicio telefónico antiguo plano (plain old telephone|
    |        |service)                                              |
    |--------+------------------------------------------------------|
    |BB      |banda ancha                                           |
    |--------+------------------------------------------------------|
    |servicio|p. ej., línea de abonado digital (DSL), cable de      |
    |BB      |televisión, fibra hasta la instalación (FTTP, fiber to|
    |        |the premises)                                         |
    |--------+------------------------------------------------------|
    |modem-BB|p. ej., modem DSL, cable modem, o terminación de red  |
    |        |óptica (the optical network terminal, ONT)            |
    |--------+------------------------------------------------------|
    |LAN     |red de área local                                     |
    |--------+------------------------------------------------------|
    |WAN     |red de área extensa                                   |
    |--------+------------------------------------------------------|
    |DHCP    |protocolo de configuración de equipo dinámica         |
    |--------+------------------------------------------------------|
    |PPP     |protocolo punto a punto                               |
    |--------+------------------------------------------------------|
    |PPPoE   |protocolo punto a punto sobre Ethernet                |
    |--------+------------------------------------------------------|
    |ISP     |proveedor de servicio de Internet                     |
    +---------------------------------------------------------------+


    Nota

    Los servicios de conexión WAN por medio de cable de TV son
    generalmente dispensados por DHCP o PPPoE. Los de ADSL y FTTP por
    PPPoE. Usted tiene que consultar a su ISP para saber los
    requisitos de configuración exactos de su conexión WAN.

    Nota

    Cuando un encaminador-BB se usa para crear un entorno de LAN
    casera, los PCs de la LAN se conectan a la WAn a través del
    encaminador-BB con traducción de direcciones de red (NAT). Para
    ese caso, los interfaces de red de los PCs en la LAN son
    configurados mediante IP estática o mediante el DHCP del
    encaminador-BB. El encaminador-BB debe ser configurado para
    conectar la WAN de acuerdo a las instrucciones de su ISP.

%

5.5.1. La conexión DHCP con Ethernet

    La típica red de hoy en dia en una casa o una pequeña empresa, a
    saber LAN, se conecta a la WAN (Internet) por medio de algún
    encaminador de banda ancha de gran consumo. La LAN detrás del
    encaminador utiliza protocolo de configuración de equipos
    dinámico (DHCP) ejecutándose en el encaminador.

    Únicamante es necesario instalar el paquete isc-dhcp-client para
    tener Ethernet usando protocolo de configuración de equipo
    dinámico (DHCP).

    Consulte dhclient.conf(5).

%

5.5.2. Conexión Ethernet con IP estática

    No se necesita ninguna acción especial si asignados una IP
    estática a nuestra conexión Ethernet.

%

5.5.3. Conexión PPP con pppconfig

    El archivo de órdenes de configuración pppconfig configura la
    conexión PPP de forma interactiva con solo seleccionar lo
    siguiente:

      * El número de teléfono

      * El nombre de usuario del ISP

      * La contraseña del ISP
   
      * La velocidad del puerto

      * El puerto de comunicación del modem

      * El método de acreditación

    Tabla 5.6. Relación de archivo de configuracion para la conexión
    PPP con pppconfig

    +---------------------------------------------------------------+
    |     archivo     |                   función                   |
    |-----------------+---------------------------------------------|
    |/etc/ppp/peers/  |pppconfig genera el archivo de configuración |
    |<nombre_del_isp> |especifico del <nombre_del_isp> para pppd    |
    |-----------------+---------------------------------------------|
    |/etc/chatscripts/|pppconfig genera el archivo de configuración |
    |<nombre_del_isp> |específico del <nombre_del_isp> para chat    |
    |-----------------+---------------------------------------------|
    |/etc/ppp/options |Parámetros generales de ejecución de pppd    |
    |-----------------+---------------------------------------------|
    |/etc/ppp/        |Datos de acreditación para PAP (riesgo de    |
    |pap-secret       |seguridad)                                   |
    |-----------------+---------------------------------------------|
    |/etc/ppp/        |Datos de acreditación para CHAP (más seguro) |
    |chap-secret      |                                             |
    +---------------------------------------------------------------+


    Atención
   
    El valor de «<nombre_del_isp>« del «proveedor» se asume cuando
    las órdenes pon y poff se llaman sin parámetros.

    Puede comprobar la configuración utilizando las herramientas de
    configuración de bajo nivel como sigue:

    $ sudo pon <nombre_del_isp>
    ...
    $ sudo poff <nombre_del_isp>

    Consulte «/usr/share/doc/ppp/README.Debian.gz».

%

5.5.4. Conexión PPP alternativa con wvdialconf

    Una aproximación distinta para utilizar pppd(8) es ejecutarlo con
    wvdial(1) el cual está en el paquete wvdial. En vez de pppd
    ejecutando chat(8) para marcar en la negociación de la conexión,
    wvdial realiza el marcado e inicia la negociación y entonces
    inicia pppd para que realice el resto.

    El archivo de ordenes de configuración wvdialconf configura la
    conexión PPP de forma interactiva solamente al seleccionar lo
    siguiente:

      * El número de teléfono

      * El nombre de usuario del ISP

      * La contraseña del ISP

    wvdial tiene éxito al realizar la conexión en la mayoría de los
    casos y mantiene de forma automática la relación de datos de
    acreditación.

    Tabla 5.7. Relación de archivos de configuración de una conexión
    PPP con wvdialconf

    +---------------------------------------------------------------+
    |   archivo   |                     función                     |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |wvdialconf genera los archivos de configuración  |
    |peers/wvdial |de pppd específicos de wvdial                    |
    |-------------+-------------------------------------------------|
    |/etc/        |wvdialconf genera los archivos de configuración  |
    |wvdial.conf  |                                                 |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Parámetros generales de ejecución de pppd        |
    |options      |                                                 |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Datos de acreditación para PAP (riesgo de        |
    |pap-secret   |seguridad)                                       |
    |-------------+-------------------------------------------------|
    |/etc/ppp/    |Datos de acreditación para CHAP (más seguro)     |
    |chap-secret  |                                                 |
    +---------------------------------------------------------------+


    Puede comprobar la configuración utilizando las herramientas de
    configuración de bajo nivel como sigue:

    $ sudo wvdial
    ...
    $ sudo killall wvdial

    Consulte wvdial(1) and wvdial.conf(5).

%

5.5.5. La conexión PPPoE con pppoeconf

    Cuando su ISP ofrece la conexión con PPPoE y usted decide
    conectar su PC directamente a la WAN, la red de su PC debe
    configurarse con PPPoE. El significado de PPPoE es PPP sobre
    Ethernet. El archivo de órdenes pppoeconf configura la conexión
    PPPoE de forma interactiva.

    Los archivos de configuración son los siguientes:

    Tabla 5.8. Relación de archivos de configuración para la conexión
    de PPPoW con pppoeconf

    +---------------------------------------------------------------+
    |    archivo     |                   función                    |
    |----------------+----------------------------------------------|
    |/etc/ppp/peers/ |The pppoeconf genera archivos de configuración|
    |dsl-provider    |para pppd especificos de pppoe                |
    |----------------+----------------------------------------------|
    |/etc/ppp/options|Parámetros generales de ejecución de pppd     |
    |----------------+----------------------------------------------|
    |/etc/ppp/       |Datos de acreditación para PAP (riesgo de     |
    |pap-secret      |seguridad)                                    |
    |----------------+----------------------------------------------|
    |/etc/ppp/       |Datos de acreditación para CHAP (más seguro)  |
    |chap-secret     |                                              |
    +---------------------------------------------------------------+


    Puede comprobar la configuración utilizando las herramientas de
    configuración de bajo nivel como sigue:

    $ sudo /sbin/ifconfig eth0 up
    $ sudo pon dsl-provider
    ...
    $ sudo poff dsl-provider
    $ sudo /sbin/ifconfig eth0 down

    Consulte «/usr/share/doc/pppoeconf/README.Debian».

%

5.6. La configuración básica de red con ifupdown (histórico)

    La configuración tradicional la red TCP/IP en un sistema Debian
    utiliza ifupdown como herramienta de alto nivel. Existen dos
    casos típicos.

      * Para sistemas con IP dinámica como Pcs ubicuos, debería
        configurar la red TCP/IP network con el paquete resolvconf y
        le permite cambiar su configuración de red de forma fácil
        (consulte Sección 5.6.4, “Interfaz de red configurado
        mediante DHCP”).

      * Para sistemas con IP estática como servidores, debería
        configurar la red TCP/IPsin el paquete resolvconf y mantener
        su sistema simple (consulte Sección 5.6.5, “El interfaz de
        red con IP estática”).

    Estos métodos tradicionales de configuración son bastante útiles
    si desea configuraciones avanzadas; comentaremos ahora los
    detalles.

    El paquete ifupdown aporta un marco estándar para configuraciones
    de red de alto nivel en sistemas Debian. En esta sección,
    aprenderemos la configuración básica de red con ifupdown con una
    introducción simplificada y varios ejemplos paradigmáticos.

%

5.6.1. La sintáxis simplificada de órdenes

    El paquete ifupdown contiene dos órdenes: ifup(8) y ifdown(8).
    Ofrecer configuraciones de red de alto nivel prescrito por el
    archivo de configuración /etc/network/interfaces«.

    Tabla 5.9. Relación de órdenes de configuraciones de red básicas
    con ifupdown

    +---------------------------------------------------------------+
    | orden |                        acción                         |
    |-------+-------------------------------------------------------|
    |ifup   |levanta el interfaz de red eth0 con la configuración   |
    |eth0   |eth0 si la entrada «iface eth0» existe                 |
    |-------+-------------------------------------------------------|
    |ifdown |apaga el interfaz de red eth0 con la configuración eth0|
    |eth0   |si la entrada «iface eth0» existe                      |
    +---------------------------------------------------------------+


    Aviso

    No use las herramientas de configuración de bajo nivel como las
    órdenes ifconfig(8) y ip(8) para configurar un interfaz hacia el
    estado de activado (up).

    Nota
   
    No existe la orden ifupdown.

%

5.6.2. Sintáxis básica de «/etc/network/interfaces«

    Se puede resumir la sintáxis más importante de /etc/network/
    interfaces» como se explica en interfaces(5) en lo siguiente:

    Tabla 5.10. Relación de entradas en «/etc/network/interfaces»

    +---------------------------------------------------------------+
    |          entrada           |           significado            |
    |----------------------------+----------------------------------|
    |                            |inicia el interfaz                |
    |«auto <nombre_del_intefaz>» |<nombre_del_interfaz> al inicio   |
    |                            |del sistema                       |
    |----------------------------+----------------------------------|
    |«allow-auto                 |, ,                               |
    |<nombre_del_interfaz>»      |                                  |
    |----------------------------+----------------------------------|
    |                            |inicia el interfaz                |
    |«allow-hotplug              |<nombre_del_interfaz> cuando el   |
    |<nombre_del_interfaz>»      |núcleo detecta un evento de       |
    |                            |conexión en caliente del interfaz |
    |----------------------------+----------------------------------|
    |Líneas que comienzan por    |define la configuración de red    |
    |«iface <nombre_config> ...» |<nombre_config>                   |
    |----------------------------+----------------------------------|
    |Líneas que comienzan con    |define los valores                |
    |«mapping                    |correspondientes a <nombre_config>|
    |<nombre_global_del_interfaz>|para lo que encaje con >          |
    |»                           |nombre_interfaz>                  |
    |----------------------------+----------------------------------|
    |Una línea que comienza con  |se ignora por ser un comentario ( |
    |un almohadilla «#»          |sin funcionalidad de comentarios  |
    |                            |de final de línea)                |
    |----------------------------+----------------------------------|
    |Una línea finaliza con una  |extiende la línea actual y la     |
    |barra invertida «\»         |siguiente como una sola           |
    +---------------------------------------------------------------+


    Las línas que comienzan con iface tienen la siguiente sintáxis:

    iface <nombre_config> <familia_de_dirección> <nombre_del_método>
     <opción1> <valor1>
     <opción2> <valor2>
     ...

    En las configuraciones básicas la entrada mapping no son
    utilizadas y se usa el nombre del interfaz de red como el nombre
    de configuración de red (Consulte Sección 5.7.5, “La entrada
    mapping”).

    Aviso
   
    No declare de forma duplicada entradas «iface» para un interfaz
    de red en «/etc/network/interfaces».

%

5.6.3. El interfaz de red interno («loopback«)

    La entrada auto de la configuración del archivo «/etc/network/
    interfaces» levanta el interfaz de red interno («loopback«) lo al
    inicio del sistema.

    auto lo
    iface lo inet loopback

    Esta siempre existe en el archivo «/etc/network/interfaces».

%

5.6.4. Interfaz de red configurado mediante DHCP

    Tras preparar el sistema Sección 5.5.1, “La conexión DHCP con
    Ethernet”, el interfaz de red que va a ser configurado mediante
    DHCP debe ser configurado mediante una entrada en el archivo«/etc
    /network/interfaces» como se muestra.

    allow-hotplug eth0
    iface eth0 inet dhcp

    Cuando el núcleo de Linux detecta el interfaz físico eth0, la
    entrada allow-hotplug hace que ifup levante el interfaz y la
    entrada iface hace ifup que se utilice DHCP para configurar el
    interfaz.

%

5.6.5. El interfaz de red con IP estática

    El interfaz de red configurado por medio de un IP estática se
    configura mediante una entrada en el archivo «/etc/network/
    interfaces» como es muestra.

    allow-hotplug eth0
    iface eth0 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     dns-domain example.com
     dns-nameservers 192.168.11.1

    Cuando el núcleo de Linux detecta la interfaz física eth0, la
    entrada allow-hotplug provoca que ifup active la interfaz y la
    entrada iface provoca que ifup la configure con la IP estática.

    Aquí, supongo lo siguiente.

      * Rango de direcciones IP de la red local: 192.168.11.0 -
        192.168.11.255

      * Dirección IP de la puerta de enlace: 192.168.11.1

      * Dirección IP del PC: 192.168.11.100

      * Paquete resolvconf: instalado

      * Nombre de dominio: «example.com»

      * Dirección IP del servidor DNS: 192.168.11.1

    Cuando no se instala el paquete resolvconf, es necesario
    configurar manualmente el DNS mediante el fichero /etc/
    resolv.conf como se muestra.

    nameserver 192.168.11.1
    domain example.com

    Atención

    No tiene que copiar literalmente las direcciones IP usadas en el
    ejemplo anterior. Debe usar las direcciones IP que se ajusten a
    su red local real.

%

5.6.6. Fundamentos de la interfaz de red inalámbrica

    La interfaz de red local inalámbrica (WLAN, Wireless LAN)
    proporciona una rápida conexión inalámbrica a través del espectro
    de frecuencias de radio que no necesitan licencia y está basada
    en un conjunto de estándares denominado IEEE 802.11.

    La interfaz WLAN es casi como una interfaz Ethernet normal pero
    requiere una ID de red y una clave cifrada cuando se inicializa.
    Sus herramientas de alto nivel de red son exactamente las mismas
    excepto los nombres de la interfaz que son algo diferentes como
    eth1, wlan0, ath0, wifi0, ... según qué controladores use el
    núcleo.

    Sugerencia
   
    El dispositivo wmaster0es el dispositivo maestro interno usado
    solo por SoftMAC con la nueva mac80211 API de Linux.

    Estas son algunos conceptos clave para recordar sobre la WLAN.

    Tabla 5.11. Relación de acrónimos para WLAN

    +---------------------------------------------------------------+
    |acrónimo|palabra completa |            significado             |
    |--------+-----------------+------------------------------------|
    |        |                 |ID de red de 16 bits usado por las  |
    |NWID    |ID de red        |redes WaveLAN anteriores a la norma |
    |        |                 |802.11 (muy obsoleto)               |
    |--------+-----------------+------------------------------------|
    |        |(Extendido)      |nombre de red del Punto de acceso   |
    |(E)SSID |Identificador del|inalámbrico (APs) interconectado    |
    |        |conjunto de      |para formar una LAN inalámbrica     |
    |        |servicios        |802.11 integrada, ID del dominio    |
    |--------+-----------------+------------------------------------|
    |        |Privacidad       |Estándar de cifrado inalámbrico de  |
    |WEP,    |equivalente a la |primera generación de 64 bits (128  |
    |(WEP2)  |del cable        |bits) con clave de 40 bits          |
    |        |                 |(obsoleto)                          |
    |--------+-----------------+------------------------------------|
    |        |Acceso Wi-Fi     |Estándar de cifrado inalámbrico de  |
    |WPA     |protegido        |segunda generación (la mayoría del  |
    |        |                 |802.11i), compatible con WEP        |
    |--------+-----------------+------------------------------------|
    |        |Acceso Wi-Fi     |Estándar de cifrado inalámbrico de  |
    |WPA2    |protegido 2      |tercera generación (802.11i         |
    |        |                 |completo), no compatible con WEP    |
    +---------------------------------------------------------------+


    La elección definitiva del protocolo real está habitualmente
    limitada por el encaminador inalámbrico que se emplee.

%

5.6.7. Interfaz de red local inalámbrica con WPA/WPA2

    Para que WLAN admita los nuevos protocolos WAP/WPA2 necesita
    instalar el paquete wpasupplicant.

    En caso de que la IP provenga de un servidor DHCP de la WLAN, el
    archivo «/etc/network/interfaces» debería ser como se muestra.

    allow-hotplug ath0
    iface ath0 inet dhcp
     wpa-ssid homezone
     # El valor hexadecimal psk se codifica a partir de una clave en texto plano
     wpa-psk 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f

    Consulte «/usr/share/doc/wpasupplicant/README.modes.gz».

%

5.6.8. La interfaz de LAN inalámbrica con WEP

    Necesita instalar el paquete wireless-tools para que la WLAN
    admita el antiguo protocolo WEP. (Los encaminadores económicos de
    nivel de usuario puede que aún empleen este protocolo inseguro,
    pero es mejor eso que nada.)

    Atención
   
    Tenga en cuanta que con WEP el tráfico de su red WLAN puede ser
    espiado.

    En caso de que la IP provenga de un servidor DHCP de la WLAN, el
    archivo «/etc/network/interfaces» debería ser como se muestra.

    allow-hotplug eth0
    iface eth0 inet dhcp
     wireless-essid Home
     wireless-key1 0123-4567-89ab-cdef
     wireless-key2 12345678
     wireless-key3 s:password
     wireless-defaultkey 2
     wireless-keymode open

    Consulte «/usr/share/doc/wireless-tools/README.Debian».

%

5.6.9. La conexión PPP

    Primero es necesario configurar la conexión PPP como se ha
    descrito (ver Sección 5.5.3, “Conexión PPP con pppconfig”). A
    continuación añada la entrada para el dispositivo primario PPP
    ppp0 en el archivo /etc/network/interfaces como se muestra.

    iface ppp0 inet ppp
     provider <inombre_del_isp>

%

5.6.10. La conexión PPP alternativa

    Primero es necesario configurar la conexión alternativa PPP
    wvdial como se ha descrito (ver Sección 5.5.4, “Conexión PPP
    alternativa con wvdialconf”). A continuación añada la entrada
    para el dispositivo primario PPP ppp0 en el archivo /etc/network/
    interfaces como se muestra.

    iface ppp0 inet wvdial

%

5.6.11. Conexión PPPoE

    Para la conexión de un PC directamente a WAN mediante PPPoE, se
    requiere la configurar el sistema con una conexión PPPoE como se
    ha descrito anteriormente (consulte Sección 5.5.5, “La conexión
    PPPoE con pppoeconf”). Entonces, añada la entrada del dispositivo
    primario PPPoE eth0 al archivo /etc/network/interfaces» según se
    describe a continuación.

    allow-hotplug eth0
    iface eth0 inet manual
     pre-up /sbin/ifconfig eth0 up
     up ifup ppp0=dsl
     down ifdown ppp0=dsl
     post-down /sbin/ifconfig eth0 down
    # The following is used internally only
    iface dsl inet ppp
     provider dsl-provider

%

5.6.12. Estado de configuración de la red «ifupdown«

    El archivo «/etc/network/run/ifstate» almacena el estado de la
    configuración de red intentados para todos los interfaces de red
    gestionados mediante el paquete ifupdown. Desgraciadamente,
    incluso si el sistema ifupdown yerrá al levantar el interfaz en
    el intento, el archivo «/etc/network/run/ifstate» lo enumerará
    como activo.

    A menos que la salida de la orden ifconfig(8) para un interfaz no
    tenga una línea como la del siguiente ejemplo, no puede ser usado
    como parte de una red IPV4.

      inet addr:192.168.11.2  Bcast:192.168.11.255  Mask:255.255.255.0

    Nota

    Para un dispositivo Ethernet conectado a PPPoE, en la salida de
    la orden ifconfig(8) no debe tener una línea como la que
    mostramos en el ejemplo anterior.

%

5.6.13. Reconfiguración básica de red

    Cuando intente reconfigurar un interfaz, p. ej. eth0, debe
    deshabilitarlo primero con la orden «sudo ifdown eth0«. Su efecto
    es eliminar la entrada de eth0 del archivo «/etc/network/run/
    ifstate». (Esto puede devolver algún mensaje de error si eth0 no
    está activo o no está configurado de la forma correcta. Hasta
    cierto punto, es seguro hacerlo así en cualquier momento para una
    estación de trabajo monousuario.)

    Sientase libre ahora de editar el contenido de !/etc/network/
    interfaces» según sus necesidades para reconfigurar el interfaz
    de red, eth0.

    Después, pude reactiva eth0 con la orden sudo ifup eth0«.

    Sugerencia
   
    Puede (re)inicializar el interfaz de red simplemente con «sudo
    ifdown eth0;sudo ifup eth0«.

%

5.6.14. El paquete ifupdown-extra

    El paquete ifupdown-extra aporta pruebas de conexión de red con
    el paquete ifupdown.

      * La orden network-test(1) puede ser utilizada desde el
        intérprete de órdenes.
   
      * Los archivos de órdenes son ejecutados para cada ejecución de
        la orden ifup.

    La orden network-test evita que tenga que ejecutar engorrosas
    órdenes de bajo nivel para analizar el problema de red.

    Los archivos de órdenes son instalados en «/etc/network/*/» y
    realiza lo siguiente.

      * Comprueba la conexión de cable de red

      * Comprueba el uso de direcciones IP duplicadas

      * Configura rutas estáticas del sistema en la definición «/etc/
        network/routes»

      * Comprueba si la pasarela de red es alcanzable

      * Guarda los resultados en el archivo «/var/log/syslog»

    Este registro de syslog es bastante útil para la adminstración de
    los problemas de red en un sistema remoto.

    Sugerencia

    El comportamiento automático del paquete ifupdown-extra es
    configurable con «/etc/default/network-test». Algunas de estas
    comprobaciones automáticas ralentiza el inicio del sistema un
    poco ya que necesita tiempo para escuchas las contestaciones ARP.

%

5.7. Configuración avanzada de red con ifupdown (histórico)

    La funcionalidad del paquete ifupdown puede ser mejorada según se
    describe en Sección 5.6, “La configuración básica de red con
    ifupdown (histórico)” con el conocimiento adecuado.

    Las funcionalidades que se describen aquí son totalmente
    opcionales. Yo, que soy perezoso y minimarelación, las uso de
    forma muy casual.

    Atención

    Si no puede activar la conexión de red con la información de
    Sección 5.6, “La configuración básica de red con ifupdown
    (histórico)”, se encontrará en una situación peor con la
    información que le ofrecemos a continuación.

%

5.7.1. El paquete ifplugd

    El paquete ifplugd es una herramienta antigua de configuración
    automática de red que solo gestiona conexiones Ethernet. Esto
    soluciona la conexión/desconexión del cable Ethernet de PC en
    ubicuidad etc. Si tiene instalados NetworkManager o Wicd
    (consulte Sección 5.2, “La configuración moderna de red en el
    escritorio”), no necesita este paquete.

    Este paquete ejecuta un demonio y sustituye las funcionalidades 
    auto o allow-hotplug (consulte Tabla 5.10, “Relación de entradas
    en «/etc/network/interfaces»”) y activa los interfaces sobre sus
    conexiones de red.

    Aquí esta como se usa el paquete ifplugd para un puerto interno
    Ethernet, p. ej. eth0.

     1. Elimine las entradas en «/etc/network/interfaces»: «auto
        eth0» o allow-hotplug eth0».

     2. Mantenga las entradas en «/etc/network/interfaces»: «iface
        eth0 inet …» y mapping …».
   
     3. Instale el paquete ifplugd.

     4. Ejecute «sudo dpkg-reconfigure ifplugd».

     5. Configure eth0 como un «interfaz estático para ser
        monitorizado por ifplugd«.

    Ahora, la reconfiguración de red funciona tal como quiere.

      * Bien por el encendido o bien por el descubrimiento de
        «hardware«, el interfaz no es activado por si mismo.

          + Proceso de inicio sin tiempo de expiración DHCP largo.

          + Una interfaz sin la adecuada dirección IPv4 no es
            divertida (consulte Sección 5.6.12, “Estado de
            configuración de la red «ifupdown«”).
   
      * Cuando se descubre el cable Ethernet, el interfaz es
        activado.

      * Después de cierto tiempo cuando el cable Ethernet se
        desconecta, el interfaz se desactiva automáticamente.

      * Después de que se conecta otro cable Ethernet, el interfaz se
        activa con el nuevo entorno de red.

    Sugerencia

    Los parámetros de la orden ifplugd(8) determinan el
    comportamiento como es la espera para la reconfiguración de los
    interfaces.

%

5.7.2. El paquete ifmetric

    El paquete ifmetric nos permite trabajar con las métricas de las
    rutas a posteriori incluso con DHCP.

    Lo siguiente asigna el interfazeth0 como el preferido sobre el
    interfaz wlan0.

     1. Instale el paquete ifmetric.

     2. Añada un línea con la opción «metric 0» justo debajo de la
        línea «iface eth0 inet dhcp» en «/etc/network/interfaces».

     3. Añada la línea con la opción «metric 1» justo debajo de la
        línea «iface wlan0 inet dhcp» en «/etc/network/interfaces».

    La métrica 0 es la prioridad de ruta más alta y es el valor por
    defecto. A mayor valor de métrica menor prioridad de la ruta. La
    dirección IP del interfaz activo con el valor de ruta más bajo
    será el utilizado. Consulte ifmetric(8).

%

5.7.3. Interfaz virtual

    Un único interfaz físico Ethernet puede ser configurado como
    varios interfaces virtuales con diferentes direcciones IP. Se usa
    de esta manera de forma habitual prara conectar un interfaz a un
    conjunto de subredes IP. Por ejemplo, uno de esos usos sería una
    dirección IP por cada servidor web virtual con un único intefaz
    de red.

    Por ejemplo, supongamos lo siguiente:

      * Un único interfaz Ethernet en su equipo esta conectado a un
        concentrador Ethernet (no a un encaminador de banda ancha).

      * El concentrador Ethernet esta conectado tanto a Internet como
        a la red LAN.

      * La red de área local utiliza la subred 192.168.0.x/24.

      * Su equipo usa un servidor DHCP para obtener la dirección IP
        de su intefaz físico eth0 para conectarse a Internet.

      * Su equipo utiliza 192.168.0.1 en el interfaz virtual eth0:0
        para la LAN.

    Las siguientes entradas en «/etc/network/interfaces» configuran
    su red.

    iface eth0 inet dhcp
     metric 0
    iface eth0:0 inet static
     address 192.168.0.1
     netmask 255.255.255.0
     network 192.168.0.0
     metric 1

    Atención

    Aunque este ejemplo de configuración con traducción de
    direcciones de red (NAT) utilizando netfilter/iptables (consulte
    Sección 5.10, “Infraestructura Netfilter”) puede aportar un
    encaminador barato para la LAN con un único interfaz, no existe
    capacidad real de cortafuegos con esta configuración. Debería
    utilizar dos interfaces físicas con NAT para asegura la red local
    de Internet.

%

5.7.4. Sintáxis avanzada de órdenes

    El paquete ifupdown aporta la configuración avanzada de red
    utilizando el nombre de la configuración de red y el nombre del 
    interfaz de red. He utilizado una terminología un poco diferente
    de la utilizada en ifup(8) y interfaces(5).

    Tabla 5.12. Relación de terminología para dispositivos de red

    +-------------------------------------------------------------------+
    |terminología|     mi      |    ejemplos en el texto    |           |
    |   de las   |terminología |         siguiente          |descripción|
    |páginas man |             |                            |           |
    |------------+-------------+----------------------------+-----------|
    |            |             |                            |nombre dado|
    |            |             |                            |por el     |
    |nombre de   |nombre del   |                            |núcleo de  |
    |interfaz    |interfaz de  |lo, eth0,                   |Linux      |
    |físico      |red          |<nombre_del_interfaz>       |(utilizando|
    |            |             |                            |el         |
    |            |             |                            |mecanismo  |
    |            |             |                            |udev)      |
    |------------+-------------+----------------------------+-----------|
    |            |             |                            |nombre del |
    |            |             |                            |elemento   |
    |nombre del  |nombre de la |config1, config2,           |siguiente a|
    |interfaz    |configuración|<nombre_de_la_configuración>|iface en «/|
    |lógico      |de red       |                            |etc/network|
    |            |             |                            |/          |
    |            |             |                            |interfaces»|
    +-------------------------------------------------------------------+


    Las órdenes de configuración de red básica Sección 5.6.1, “La
    sintáxis simplificada de órdenes” necesita el elemento del nombre
    de configuración de red de la entrada iface para encajar el
    nombre de interfaz de red en «/etc/network/interfaces».

    Las órdenes de configuración de red avanzadas permite las
    separación del nombre de la configuración de red y el nombre del 
    interfaz de red en el «/etc/network/interfaces» como se muestra a
    continuación.

    Tabla 5.13. Relación de órdenes de configuración avanzadas con
    ifupdown

    +---------------------------------------------------------------+
    |   orden   |                      acción                       |
    |-----------+---------------------------------------------------|
    |ifup eth0= |activa el interfaz de red eth0 con la configuración|
    |config1    |config1                                            |
    |-----------+---------------------------------------------------|
    |ifdown eth0|desactiva el interfaz de red eth0 con la           |
    |=config1   |configuración config1                              |
    |-----------+---------------------------------------------------|
    |ifup eth0  |activa el interfaz de red eth0 con la configuración|
    |           |seleccionada por la entrada mapping                |
    |-----------+---------------------------------------------------|
    |ifdown eth0|descativa el interfaz de red eth0 con la           |
    |           |configuración seleccionada por la entrada mapping  |
    +---------------------------------------------------------------+


%

5.7.5. La entrada mapping

    Dejamos de lado los detalles de la entrada mapping en /etc/
    network/interfaces en Sección 5.6.2, “Sintáxis básica de «/etc/
    network/interfaces«” para evitar complicaciones. Detallamos la su
    sintáxis a continuación.

    mapping <patrón_del_nombre_del_interfaz>
     script <nombre_del_script>
     map <script_de_entrada1>
     map <script_de_entrada2>
     map ...

    Esto aporta funcionalidades avanzadas al archivo «/etc/network/
    interfaces» por medio de la elección automática de la
    configuración con los archivos de órdenes que se detallan en
    mapping por medio de <nombre_del_script>.

    Sigamos la ejecución de lo sigiuente:

    $ sudo ifup eth0

    Cuando el «<patrón_del_nombre_del_interfaz>» encaja «eth0», esta
    ejecución produce la ejecución automática de la siguiente orden
    configurada para eth0.

    $ sudo ifup eth0=$(echo -e '<script_de_entrada1> \n <script_de_entrada2> \n ...' | <nombre_del_script> eth0)

    Aquí las lineas de archivo de órdenes de entrada con «map» son
    opcionales y pueden estar repetidas.

    Nota

    El tipo de patrón de la entrada mapping funciona como el nombre
    de los archivos en el intérprete de órdenes (consulte
    Sección 1.5.6, “Expansión de un patrón en el intérprete de
    órdenes”).

%

5.7.6. Cambio manual de configuración de red

    Aquí se muetra como se cambia de forma manual entre diferentes
    configuraciones de red sin modificar el archivo «/etc/network/
    interfaces» como en Sección 5.6.13, “Reconfiguración básica de
    red”.

    Para todas las configuraciones de red que necesite, cree un
    entrada separada en el archivo «/etc/network/interfaces» como la
    que se muestra.

    auto lo
    iface lo inet loopback

    iface config1 inet dhcp

    iface config2 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     dns-domain example.com
     dns-nameservers 192.168.11.1
   
    iface pppoe inet manual
     pre-up /sbin/ifconfig eth0 up
     up ifup ppp0=dsl
     down ifdown ppp0=dsl
     post-down /sbin/ifconfig eth0 down

    # The following is used internally only
    iface dsl inet ppp
     provider dsl-provider

    iface pots inet ppp
     provider provider

    Tenga en cuenta que el nombre de la configuración de red que es
    el elemento posterior a iface no se utiliza para el nombre de
    interfaz de red. Ni siquiera existen las entradas auto o 
    allow-hotplug para iniciar el interfaz de red eth0 de forma
    automática tras los eventos.

    Ahora ya esta preparado para cambiar la configuración de red.

    Cambiemos su PC a una LAN configurada mediante DHCP. Active el 
    interfaz de red (el interfaz físico) eth0 asignandole el nombre
    de la configuración de red (el nombre lógico del interfaz)
    config1 como se muestra a continuación.

    $ sudo ifup eth0=config1
    Password:
    ...

    La interfaz eth0 esta activa, configurada por DHCP y conectada a
    la LAN.

    $ sudo ifdown eth0=config1
    ...

    El interfaz eth0 esta inactivo y desconectado de la LAN.

    Cambiemos la configuración de su PC a una LAN con IP estática.
    Active el interfaz de red eth0 asignandole el nombre de la 
    configuración de red config2 como se muestra a continuación.

    $ sudo ifup eth0=config2
    ...

    El interfaz eth0 esta activo, configurado con una IP estática y
    conectado a la LAN. Los argumentos adicionales dados como dns-*
    configuran el contenido de «/etc/resolv.conf». El archivo «/etc/
    resolv.conf» será mejor gestionado si el paquete resolvconf esta
    instalado.

    $ sudo ifdown eth0=config2
    ...

    De nuevo el interfaz eth0 esta desactivado y desconectado de la
    LAN.

    Cambiemos la conexión de nuestro PC a u puerto modem-BB que se
    conecta a un servicio PPPoE. Active el interfaz de red etho
    asignado el nombre de la configuración de red pppoe como se
    muestra.

    $ sudo ifup eth0=pppoe
    ...

    El interfaz eth0 esta activo, configurado con PPPoE y conectado
    directamente al ISP.

    $ sudo ifdown eth0=pppoe
    ...

    De nuevo el intefaz eth0 esta desactivado y desconetado.

    Cambiemos la configuración de su PC, sin LAN ni modem-BB pero con
    POTS y modem. Active el interfaz de red ppp0 asignando el nombre
    deconfiguración de red pots como se muestra.

    $ sudo ifup ppp0=pots
    ...

    El interfaz ppp0 esta activo y conectado a internet mediante PPP.

    $ sudo ifdown ppp0=pots
    ...

    El interfaz ppp0 esta desactivado y desconectado de Internet.

    Debería comprobar el archivo «/etc/network/run/ifstate» para
    determinar el estado de la configuración de red del sistema
    ifupdown.

    Aviso
   
    Si dispone de varios interfaces de red debería modificar el
    número al final de eth*, ppp*, etc.

%

5.7.7. Archivos de órdenes en el sistema ifupdown

    El sistema ifupdown automáticamente ejecuta los archivos de
    órdenes instalados en «/etc/network/*/» al tiempo que exporta las
    variables de entorno a los archivos de órdenes.

    Tabla 5.14. Relación de variables de entorno pasadas por el
    sistema ifupdown

    +---------------------------------------------------------------+
    |variable de |                   valor pasado                   |
    |  entorno   |                                                  |
    |------------+--------------------------------------------------|
    |«$IFACE»    |nombre físico (nombre del interfaz) del interfaz  |
    |            |que empieza a ser procesado                       |
    |------------+--------------------------------------------------|
    |«$LOGICAL»  |nombre lógico(nombre de la configuración) del     |
    |            |interfaz que empieza a ser procesado              |
    |------------+--------------------------------------------------|
    |«$ADDRFAM»  |<familia de direcciones> del interfaz             |
    |------------+--------------------------------------------------|
    |«$METHOD»   |<nombre_del_método> del interfaz(p. ej., «static«)|
    |------------+--------------------------------------------------|
    |«$MODE»     |«start« si se consulta desde ifup, «stop« si se   |
    |            |consulta desde ifdown                             |
    |------------+--------------------------------------------------|
    |            |de acuerdo con «$MODE», pero con una granularidad |
    |«$PHASE»    |menor, se distinguen las fases pre-up, post-up,   |
    |            |pre-down y post-down                              |
    |------------+--------------------------------------------------|
    |«$VERBOSITY»|indica si fue usado el parámetro«--verbose» ; 1 si|
    |            |así fues, 0 si no                                 |
    |------------+--------------------------------------------------|
    |«$PATH»     |ruta para la búsqueda de órdenes: «/usr/local/    |
    |            |sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin»|
    |------------+--------------------------------------------------|
    |«$IF_       |valor que se corresponde con la opción de la      |
    |<OPCIÓN>»   |entrada iface                                     |
    +---------------------------------------------------------------+


    Aquí, cada variable de entorno , «$IF_<OPCIÓN>», se crea desde el
    nombre de la opción correspondiente como en <option1> and
    <option2> al añadirle al principio «$IF_», convirtiendolo a
    mayúsculas, cambiando los guiones por guiones bajos y eliminando
    cualquier carácter no alfanumérico.

    Sugerencia

    Consulte Sección 5.6.2, “Sintáxis básica de «/etc/network/
    interfaces«” para <familia_de_direcciones>, <nombre_del_método>,
    <opción1> y <opción2>.

    El paquete ifupdown-extra (consulte Sección 5.6.14, “El paquete
    ifupdown-extra”) usa estas variables de entorno para ampliar las
    funcionalidades del paquete ifupdown. El paquete ifmetric
    (consulte Sección 5.7.2, “El paquete ifmetric”) instala los
    archivos de órdenes «/etc/network/if-up.d/ifmetric» los cuales
    asignan métricas por medio de la variable «$IF_METRIC». El
    paquete guessnet (consulte Sección 5.7.8, “Mapping con guessnet”
    ), el cual proporciona un marco simple y podereoso para la
    autoselección de la configuración de red por medio del mecanismo
    «mapping«, también las utiliza.

    Nota

    Para ejemplos más especificos de archivos de órdenes de
    configuración de red que usan estas variables de entorno, puede
    comprobar los archivos de órdenes de ejemplos que se incluyen en
    «/usr/share/doc/ifupdown/examples/*» y los archivos de órdenes
    que usan los paquetes ifscheme y ifupdown-scripts-zg2. Estos
    archivos de órdenes adicionales tienen algunas funciones
    superpuestas con los paquetes básicos ifupdown-extra y 9guessnet.
    Si instala estos archivos de órdenes adicionales, debe
    personalizar estos archivos de órdenes para evitar
    interferencias.

%

5.7.8. Mapping con guessnet

    En vez de elegir la configuración de forma manual según se
    describe en Sección 5.7.6, “Cambio manual de configuración de
    red”, puede usar el mecanismo de mapping descrito en
    Sección 5.7.5, “La entrada mapping” para seleccionar de forma
    automática la configuración de red con archivos de órdenes
    personalizados.

    La orden guessnet-ifupdown(8) facilitada por el paquete guessnet
    esta diseñado para ser utilizado por los archivos de órdenes de
    mapping y proporciona un marco poderoso para mejorar el sistema
    ifupdown.

      * Enumerará las condicones de pruebas como los valores de las
        opciones de guessnet para cada configuración de red de las
        entradas iface.

      * Mapping eligirá iface con el primer resultado correcto como
        la configuración de red.

    Este uso a dos bandas del archivo «/etc/network/interfaces» por
    el archivo de órdenes de mapping, guessnet-ifupdown y la
    infraestructura de configuración de red original, ifupdown, no es
    causa de impactos negativos ya que las opciones de guessnet solo
    exportan variables de entorno a los archivos de órdenes
    ejecutados por el sistema ifupdown. Consulte los detalles en 
    guessnet-ifupdown(8).

    Nota

    Cuando varias líneas de opciones deguessnet son necesarias en «/
    etc/network/interfaces», utilice las líneas de opcion que
    comienzan por guessnet1, guessnet2 y así sucesivamente, ya que el
    paquete ifupdown no permite que el comienzo de las cadenas de
    caracteres de las líneas de opciones se repitan.

5.8. La configuración de red de bajo nivel

%

5.8.1. Órdenes iproute2

    Las órdenes Iproute2 proporcionan un conjunto completo de
    funcionalidades de configuración de red a nivel bajo. Aquí hay
    una tabla de correspondencia entre las órdenes en desuso de
    net-tools y las nuevas órdenes de iproute2 etc.

    Tabla 5.15. Tabla de correspondencia entre las órdenes en desuso
    de net-tools y las nuevas órdenes de iproute2 commands

    +---------------------------------------------------------------+
    |net-tools en |   nuevas    |              empleo               |
    |   desuso    |iproute2 etc.|                                   |
    |-------------+-------------+-----------------------------------|
    |ifconfig(8)  |ip addr      |dispositivo con un dirección de    |
    |             |             |protocolo (IP o IPv6)              |
    |-------------+-------------+-----------------------------------|
    |route(8)     |ip route     |entrada de tabla de rutas          |
    |-------------+-------------+-----------------------------------|
    |arp(8)       |ip neigh     |entrada cache de ARP o NDISC       |
    |-------------+-------------+-----------------------------------|
    |ipmaddr      |ip maddr     |dirección multicast                |
    |-------------+-------------+-----------------------------------|
    |iptunnel     |ip tunnel    |túnel sobre IP                     |
    |-------------+-------------+-----------------------------------|
    |nameif(8)    |ifrename(8)  |nombre de interfaz de red basado en|
    |             |             |la dirección MAC                   |
    |-------------+-------------+-----------------------------------|
    |mii-tool(8)  |ethtool(8)   |configuración de dispositivo       |
    |             |             |Ethernet                           |
    +---------------------------------------------------------------+


    Consulte ip(8) y Manual Como del Conjunto de Utilidades IPROUTE2.

%

5.8.2. Operaciones seguras de red a nivel bajo

    Puede usar las órdenes de red de nivel bajo de forma segura de la
    forma siguiente ya que no cambian la configuración de red.

    Tabla 5.16. Relación de órdenes de red de bajo nivel

    +---------------------------------------------------------------+
    |       orden        |               descripción                |
    |--------------------+------------------------------------------|
    |ifconfig            |muestra el enlace y el estado de la       |
    |                    |dirección de los interfaces activos       |
    |--------------------+------------------------------------------|
    |ip addr show        |muestra el enlace y el estado de la       |
    |                    |dirección de los interfaces activos       |
    |--------------------+------------------------------------------|
    |route -n            |muestra la tabla de encaminamiento al     |
    |                    |completo en direcciones numéricas         |
    |--------------------+------------------------------------------|
    |ip route show       |muestra la tabla de encaminamiento al     |
    |                    |completo en direcciones numéricas         |
    |--------------------+------------------------------------------|
    |arp                 |muestra el contenido actual de la tabla de|
    |                    |caché ARP                                 |
    |--------------------+------------------------------------------|
    |ip neigh            |muestra el contenido actual de la tabla de|
    |                    |caché ARP                                 |
    |--------------------+------------------------------------------|
    |plog                |display ppp daemon log                    |
    |--------------------+------------------------------------------|
    |ping yahoo.com      |comprueba la conexión de Internet con     |
    |                    |«yahoo.com»                               |
    |--------------------+------------------------------------------|
    |whois yahoo.com     |comprueba quién registro «yahoo.com» en la|
    |                    |base de datos de dominios                 |
    |--------------------+------------------------------------------|
    |traceroute yahoo.com|sigue la conexión a Internet hasta        |
    |                    |«yahoo.com»                               |
    |--------------------+------------------------------------------|
    |tracepath yahoo.com |sigue la conexión a Internet hasta        |
    |                    |«yahoo.com»                               |
    |--------------------+------------------------------------------|
    |mtr yahoo.com       |sigue la conexión a Internet hasta        |
    |                    |«yahoo.com» (de forma repetida)           |
    |--------------------+------------------------------------------|
    |dig                 |comprueba lso registros DNS de            |
    |[@dns-server.com]   |«example.com» por «dns-server.com» para   |
    |example.com [{a|mx| |los registros «a», «mx», u «any»          |
    |any}]               |                                          |
    |--------------------+------------------------------------------|
    |iptables -L -n      |comprueba el filtrado de paquetes         |
    |--------------------+------------------------------------------|
    |netstat -a          |encuentra todos los puertos abiertos      |
    |--------------------+------------------------------------------|
    |netstat -l --inet   |encuentra los puertos que están escuchando|
    |--------------------+------------------------------------------|
    |netstat -ln --tcp   |encuentra los puertos (numéricos) TCP que |
    |                    |están escuchando                          |
    |--------------------+------------------------------------------|
    |dlint example.com   |comprueba la información DNS de la zona   |
    |                    |«example.com»                             |
    +---------------------------------------------------------------+


    Sugerencia

    Algunas de estas herramienas de configuración de red a nivel bajo
    están ubicadas en «/sbin/». Puede que necesite indicar la ruta
    absoluta como «/sbin/ifconfig» o añadir «/sbin» a la relación de
    «$PATH» en su «~/.bashrc».

%

5.9. Optimización de la red

    La optimización genérica de la red está fuera del alcance de este
    documento. Pasaré por encima de las materias pertinentes para una
    conexión casera.

    Tabla 5.17. Relación de herramientas de optimización de red

    +---------------------------------------------------------------+
    |paquetes |popularidad|tamaño|           descripción            |
    |---------+-----------+------+----------------------------------|
    |iftop    |V:7, I:115 |97    |muestra información del ancho de  |
    |         |           |      |banda usado por un interfaz de red|
    |---------+-----------+------+----------------------------------|
    |iperf    |V:4, I:55  |263   |herramienta para medir el ancho de|
    |         |           |      |banda del Protocolo IP            |
    |---------+-----------+------+----------------------------------|
    |ifstat   |V:0, I:8   |60    |Monitor de estadísticas del       |
    |         |           |      |interfaz                          |
    |---------+-----------+------+----------------------------------|
    |bmon     |V:1, I:17  |146   |monitor de ancho de banda portable|
    |         |           |      |y estimador de velocidad          |
    |---------+-----------+------+----------------------------------|
    |         |           |      |archivo de órdenes que rapidamente|
    |ethstatus|V:0, I:5   |40    |mide rendimiento del dispositivo  |
    |         |           |      |de red                            |
    |---------+-----------+------+----------------------------------|
    |bing     |V:0, I:1   |80    |comprobador del ancho de banda    |
    |         |           |      |estocástico empírico              |
    |---------+-----------+------+----------------------------------|
    |         |           |      |pequeño y sencillo monitor de     |
    |bwm-ng   |V:2, I:17  |90    |ancho de banda basado en la       |
    |         |           |      |consola                           |
    |---------+-----------+------+----------------------------------|
    |ethstats |V:0, I:0   |23    |monitor de estadísticas Ethernet  |
    |         |           |      |basado en la consola              |
    |---------+-----------+------+----------------------------------|
    |ipfm     |V:0, I:0   |78    |herramienta de análisis de ancho  |
    |         |           |      |de banda                          |
    +---------------------------------------------------------------+


%

5.9.1. Encontrando la MTU óptima

    El valor de la Unidad de Transmisión Máxima (Maximum Transmission
    Unit, MTU) puede ser determinado de forma empírica mediante ping
    (8) con la opción «-M do» la cual envia paquetes ICMP variando el
    tamaño del paquete de datos empezando en 1500 (con un
    desplazamiento de 28 bytes para las cabeceras IP+ICMP) y
    encontrando el tamaño máximo sin fragmentación IP.

    Por ejemplo, intente lo siguiente

    $ ping -c 1 -s $((1500-28)) -M do www.debian.org
    PING www.debian.org (194.109.137.218) 1472(1500) bytes of data.
    From 192.168.11.2 icmp_seq=1 Frag needed and DF set (mtu = 1454)

    --- www.debian.org ping statistics ---
    0 packets transmitted, 0 received, +1 errors

    Intente 1454 en vez de 1500

    Verá los que sucede con ping(8) con 1454.

    Esto proceso puede ser automatizado por descubrimiento de la ruta
    MtU (Path MTU, PMTU) (RFC1191) y la orden tracepath(8).

    Sugerencia

    El ejemplo anterior con el valor 1454 en el PMTU es para mi
    proveedor anterior de FTTP el cual usa Modo de Transferencia
    Asíncrono (Asynchronous Transfer Mode) (ATM) en su red troncal y
    atiende a sus clientes mediante PPPoE. El valor real de PMTU
    depende de su entorno, p. ej. 1500 para mi nuevo proveedor de
    FTTP.

    Tabla 5.18. Guía básica para una MTU óptima

    +---------------------------------------------------------------+
    |  entorno de red  |     MTU     |         razonamiento         |
    |------------------+-------------+------------------------------|
    |Enlace por red    |             |                              |
    |telefónica        |576          |estándar                      |
    |conmutada (IP:    |             |                              |
    |PPP)              |             |                              |
    |------------------+-------------+------------------------------|
    |Enlace Ethernet   |1500         |estándar y por defecto        |
    |(IP: DHCp o fijo) |             |                              |
    |------------------+-------------+------------------------------|
    |Enlace Ethernet   |1492 (=      |2 bytes de la cabecera PPP y 6|
    |(IP: PPPoE)       |1500-8)      |bytes de la cabecera PPPoE    |
    |------------------+-------------+------------------------------|
    |Enlace Ethernet   |             |especulación propia: 18 bytes |
    |(red troncal del  |1462 (=      |de la cabecera Ethernet, 8    |
    |ISP: ATM, IP: DHCP|48*31-18-8)  |bytes para la fragmentación   |
    |o fijo)           |             |del medio de transporte       |
    |------------------+-------------+------------------------------|
    |Enlace Ethernet   |             |consulte «Configuración óptima|
    |(red troncal ISP: |1454 (=      |de la MTU para conexiones ADSL|
    |ATM, IP: PPPoE)   |48*31-8-18-8)|o PPPoE« para determinar su   |
    |                  |             |lógica                        |
    +---------------------------------------------------------------+


    Además de estos comentario básicos, debería saber lo siguiente.

      * El uso de cualquier método de «tunneling« (VPN etc.) puede
        reducir más la MTU óptima por la sobrecarga.

      * El valor de la MTU no debería ser mayor que el valor PMTU
        determinado de forma empírica.

      * El valor de MTU mayor es generalmente mejor cuando se cumplen
        las otras limitaciones.

%

5.9.2. Configurando el valor de MTU

    Aquí mostramos ejemplos como se cambia el valor de la MTU de 1500
    a 1454.

    Para DCHP (see Sección 5.6.4, “Interfaz de red configurado
    mediante DHCP”), puede sustituir las líneas de la entrada iface
    que correspondan en «/etc/network/interfaces» con lo siguiente:

    iface eth0 inet dhcp
     pre-up /sbin/ifconfig $IFACE mtu 1454

    En el caso de una IP estática (see Sección 5.6.5, “El interfaz de
    red con IP estática”), puede sustituir las líneas que
    correspondan de la entrada iface en «/etc/network/interfaces» con
    lo siguiente:

    iface eth0 inet static
     address 192.168.11.100
     netmask 255.255.255.0
     gateway 192.168.11.1
     mtu 1454
     dns-domain example.com
     dns-nameservers 192.168.11.1

    Para PPPoE directo (consulte Sección 5.5.5, “La conexión PPPoE
    con pppoeconf”), puede cambiar línea de la «mtu· que corresponda
    en «/etc/ppp/peers/dsl-provider» con lo siguiente:

    mtu 1454

    El tamaño máximo del segment (maximum segment size) (MSS) se
    utiliza como una medida alternatica de la medida del tamaño del
    paquete. La relación entre MSS y MTU es la siguiente:

      * MSS = MTU - 40 en el caso de IPv4
   
      * MSS = MTU - 60 en el caso de IPv6

    Nota

    La optimización basada en iptables(8) (consulte Sección 5.10,
    “Infraestructura Netfilter”) puede fijar el tamaño del paquete
    por el MSS y puede ser útil para el encaminador. Consulte
    «TCPMSS« en iptables(8).

%

5.9.3. Optimización TCP en redes WAN

    El rendimiento TCP puede ser maximizado ajustando los parámetros
    del tamaño del buffer TCP según se describe en «TCP Tuning Guide«
    y «TCP tuning« para una red moderna WAN de banda ancha y de alta
    latencia. Hasta cierto punto, la configuración por defecto de
    Debian es correcta para mi LAN conectada al veloz servicio FTTP
    de 1G bps.

%

5.10. Infraestructura Netfilter

    Netfilter aporta la infraestructura de uncortafuegos con estado y
    traducción de direcciones de red (NAT) por medio de módulos del
    núcleo de Linux (consulte Sección 3.3.1, “La inicialización del
    módulo del núcleo”).

    Tabla 5.19. Relación de herramientas de cortafuegos

    +---------------------------------------------------------------+
    |   paquetes    |popularidad|tamaño|        descripción         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas de             |
    |iptables       |V:300,     |2520  |administración de netfilter |
    |               |I:993      |      |(iptables(8) para IPv4,     |
    |               |           |      |ip6tables(8) para IPv6)     |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas de             |
    |arptables      |V:0, I:2   |96    |administración de netfilter |
    |               |           |      |(arptables(8) para ARP)     |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas de             |
    |               |           |      |administración de netfilter |
    |ebtables       |V:15, I:39 |265   |(ebtables(8) para           |
    |               |           |      |conmutación Ethernet        |
    |               |           |      |(Ethernet bridging)         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Control continuo del estado |
    |iptstate       |V:0, I:3   |116   |de netfilter (parecido a top|
    |               |           |      |(1))                        |
    |---------------+-----------+------+----------------------------|
    |shorewall-init |V:0, I:0   |68    |inicialización de Shoreline |
    |               |           |      |Firewall                    |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Shoreline Firewall,creador  |
    |shorewall      |V:5, I:13  |2458  |del archivo de configuración|
    |               |           |      |de netfilter                |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Shoreline Firewall, creador |
    |shorewall-lite |V:0, I:0   |65    |del archivo de configuración|
    |               |           |      |de netfilter (versión       |
    |               |           |      |simplificada)               |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Shoreline Firewall, creador |
    |shorewall6     |V:1, I:2   |779   |del archivo de configuración|
    |               |           |      |de netfilter (versión IPv6) |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Shoreline Firewall, creador |
    |shorewall6-lite|V:0, I:0   |64    |del archivo de configuración|
    |               |           |      |de netfilter (versión       |
    |               |           |      |simplificada para IPv6)     |
    +---------------------------------------------------------------+


    El programa principal para usuarios de netfilter es iptables(8).
    Puede configurar de forma manual netfilter de forma interactiva
    desde el intérprete de órdenes , guardando su estado con 
    iptables-save(8) y restaurandolo por medio de archivo de órdenes
    init iptables-restore(8) después del reinicio del sistema.

    Shorewall es una herramienta que facilita la configuración de los
    archivos de órdenes facilitando este proceso.

    Consulte la documentación en http://www.netfilter.org/
    documentation/ (o en «/usr/share/doc/iptables/html/»).

      * CÓMO de conceptos de red en Linux

      * CÓMO Filtrar Paquetes en Linux 2.4

      * CÓMO Linux 2.4 NAT

    Sugerencia

    Aunque han sido escritor para la Linux 2.4, ambos, la orden 
    iptables(8) y la función principal de netfilter se usan en los
    núcleos de Linux 2.6 y 3.x.

Capítulo 6. Aplicaciones de red

    Puede ejecutar varias aplicaciones de red una vez establecida la
    conectividad de red (consulte Capítulo 5, Configuración de red).

    Sugerencia

    Puede leer una guía concreta y moderna sobre la infraestrucura de
    red de Debian en El Manual de Administración de Debian —
    Infraestructura de red.

    Sugerencia

    If you enabled "2-Step Verification" with some ISP, you need to
    obtain an application password to access POP and SMTP services
    from your program. You may need to approve your host IP in
    advance.

%

6.1. Navegadores web

    Existen muchos paquetes de navegadores web para acceder al
    contenido remoto por medio del Protocolo de Transferencia de
    Hipertexto (Hypertext Transfer Protocol) (HTTP).

    Tabla 6.1. Relación de navegadores web

    +---------------------------------------------------------------+
    |    paquete     |popularidad|tamaño|  tipo  | Descripción del  |
    |                |           |      |        |  navegador web   |
    |----------------+-----------+------+--------+------------------|
    |                |           |      |        |Chromium,         |
    |chromium        |V:51, I:141|180040|X       |(Navegador de     |
    |                |           |      |        |código abierto de |
    |                |           |      |        |Google)           |
    |----------------+-----------+------+--------+------------------|
    |                |           |      |        |Firefox (navegador|
    |                |           |      |        |de código abierto |
    |firefox         |V:13, I:20 |205631|, ,     |de Mozilla que    |
    |                |           |      |        |está disponible en|
    |                |           |      |        |Debian            |
    |                |           |      |        |«inestable»)      |
    |----------------+-----------+------+--------+------------------|
    |                |           |      |        |Firefox ESR,      |
    |firefox-esr     |V:217,     |198436|, ,     |(Versión de       |
    |                |I:437      |      |        |Firefox con       |
    |                |           |      |        |soporte extendido)|
    |----------------+-----------+------+--------+------------------|
    |epiphany-browser|V:4, I:24  |3730  |, ,     |conforme a GNOME, |
    |                |           |      |        |HIG , Epiphany    |
    |----------------+-----------+------+--------+------------------|
    |konqueror       |V:18, I:100|20763 |, ,     |KDE, Konqueror    |
    |----------------+-----------+------+--------+------------------|
    |                |           |      |        |Dillo, (navegador |
    |dillo           |V:1, I:7   |1536  |, ,     |ligero basado en  |
    |                |           |      |        |FLTK)             |
    |----------------+-----------+------+--------+------------------|
    |w3m             |V:31, I:284|2289  |texto   |w3m               |
    |----------------+-----------+------+--------+------------------|
    |lynx            |V:13, I:98 |1948  |, ,     |Lynx              |
    |----------------+-----------+------+--------+------------------|
    |elinks          |V:6, I:28  |1767  |, ,     |ELinks            |
    |----------------+-----------+------+--------+------------------|
    |links           |V:6, I:39  |2249  |, ,     |Links (solo texto)|
    |----------------+-----------+------+--------+------------------|
    |links2          |V:1, I:15  |5417  |gráficos|Links (gráficos de|
    |                |           |      |        |consola sin X)    |
    +---------------------------------------------------------------+


%

6.1.1. Configuración del navegador

    En algunos navegadores puede usar una URL determinada para
    realizar su configuración.

      * «about:»

      * «about:config»

      * «about:plugins»

    Debian en su área «main« ofrece diferentes «plugin« enpaquetados
    libres que se encargan no solo de ofrecer Java (software
    platform) y Flash si no también los archivos del tipo MPEG,
    MPEG2, MPEG4, DivX, Windows Media Video (.wmv), QuickTime (.mov),
    MP3 (.mp3), Ogg/Vorbis, DVDs, VCDs, etc. Debian también se
    encarga de ofrecer programas de ayuda para la instalación de
    paquetes plugins de las áreas «contrib« y «non-free«.

    Tabla 6.2. Relación de paquetes que son «plugins« de navegadores

    +------------------------------------------------------------------------------+
    |               paquete                |popularidad|tamaño| área  |descripción |
    |--------------------------------------+-----------+------+-------+------------|
    |                                      |           |      |       |Pepper Flash|
    |pepperflashplugin-nonfree             |V:1, I:21  |29    |contrib|Player -    |
    |                                      |           |      |       |browser     |
    |                                      |           |      |       |plugin      |
    |--------------------------------------+-----------+------+-------+------------|
    |                                      |           |      |       |PPAPI-host  |
    |browser-plugin-freshplayer-pepperflash|I:9        |1135  |contrib|NPAPI-plugin|
    |                                      |           |      |       |adapter for |
    |                                      |           |      |       |pepperflash |
    +------------------------------------------------------------------------------+


    Sugerencia

    Aunque el uso de paquetes Debian es mucho más sencillo, los
    plugin del navegador aun pueden activarse mediante la
    instalaciñon de «*.so« en el directorio de «plugins« (p. ej. «/
    usr/lib/iceweasel/plugins/») y reiniciar el navegador.

    Algunos sitios web no permiten la conexión para determinados
    valores del agente de usuario (user-agent) de su navegador. Se
    puede evitar este hecho mediante la suplantación de la cadena del
    agente de usuario. Por ejemplo, puede hacerlo añadiendo la
    siguiente línea en los archivos de configuración del usuario como
    «~/.gnome2/epiphany/mozilla/epiphany/user.js» o «~/.mozilla/
    firefox/*.default/user.js».

    user_pref{«general.useragent.override«,«Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)«};

    También puede aladir y reinciar esta variable escribiendo
    «about:config» en la URL y pulsando el botón derecho del ratón
    para mostrar su contenido.

    Atención
   
    La suplantación de la cadena del agente de usuario puede causar
    efectos colaterales con Java.

%

6.2. El sistema de correo

    Atención
   
    Si quiere tener un servidor de correo en Internet, debería leer
    la siguiente información básica al respecto.

    The mail system involves many server programs and many client
    programs running on multiple hosts. From the functionality, there
    are 3 types of mail agent programs:

      * El agente de transporte de correo (mail transport agent)
        (MTA, consulte Sección 6.3, “Agente de transporte de correo
        (Mail transport agent, MTA)”) es el programa que se encarga
        de transferir correos entre diferentes equipos.

      * El agente de entrega de correo (mail delivery agent) (MDA,
        consulte Sección 6.6, “Agente de entrega de correo (MDA) con
        filtro”) es un programa que se encarga de entregar los
        mensajes a los buzones de los usuarios en el equipo.

      * El agente de usuario de correo (mail user agent) (MUA,
        también conocido como cliente de correo, consulte
        Sección 6.4, “Agente de usuario de correo (MUA)”) es el
        programa que permite escribir mensajes y acceder a los
        mensajes recibidos.

    Nota

    Los siguientes ejemplos de configuración son correctos para la
    típica estación de trabajo ubícua en conexiones a Internet para
    consumidores domésticos.

%

6.2.1. Fundamentos de correo

    Un mensaje de correo electrónico consta de tres componentes, el
    sobre del mensaje, la cabecera del mensaje y el cuerpo del
    mensaje.

    SMTP utiliza la información del sobre de «destino (To)« y «origen
    (From)« para entregar el correo electrónico. (La información del
    «origen(From)« también se denomina como dirección de retorno
    (bounce address), Origen_, etc.).

    La información de la cabecera sobre el «origen(From)« y el
    «destine(To)« es la que muestra por parte del cliente de correo.
    (Generalmente será la misma que conste en el sobre del mensaje,
    pero no siempre es el caso.)

    El cliente de correo (MUA) necesita interpretar la cabecera del
    mensaje y los datos del cuerpo que usan Extensiones de Correo de
    Internet Multipropósito (Multipurpose Internet Mail Extensions,
    MIME) con el fin de acordar el tipo de datos del contenido y la
    codificación.

%

6.2.2. Fundamentos del servicio moderno de correo

    Con en fin de minimizar el problema del correo no deseado (spam)
    , muchos ISPs que ofrecen conexiones de internet a usuarios
    finales han implementado contramedidas.

      * El servicio inteligente para sus cliente usa el puerto de
        envio (587) para el envio de mensajes según especifica el
        rfc4409 con la contraseña (SMTP AUTH service) especificada en
        el rfc4954.

      * Usan el puerto SMTP port (25) para su red interna de equipos
        (excepto aquellos el servidor de correo externo del propio
        ISP) y hacia Internet está bloqueado.

      * El puerto SMTP (25) del servidor de correo entrante del ISP
        bloquea los equipos sospechosos externos. (Las conexiónes de
        equipos que poseen IPs que pertenecer a un rango dinámico que
        son usadas por usuarios domésticos son las primeras en ser
        bloqueadas.)

      * Anti-spam techniques such as DomainKeys Identified Mail
        (DKIM), Sender_Policy_Framework (SPF), and Domain-based
        Message Authentication, Reporting and Conformance (DMARC) are
        widely used for the email filtering.

      * El servicio de Correo identificado por llaves de dominio
        puede ser implantado mediante el envio de su correo a través
        de un «equipo inteligente« (smarthost).

      * The smarthost may rewrite the source mail address to your
        mail account on the smarthost.

    Cuando configure su sistema de correo o resuelva problemas de
    entrega de correo, debe tener en cuenta estas limitaciones.

    Atención
   
    It is not realistic to run SMTP server on consumer grade network
    to send mail directly to the remote host reliably.

    Atención
   
    It is not realistic to expect a single smarthost to send mails of
    unrelated source mail addresses to the remote host reliably.

    Atención

    A mail may be rejected by any host en route to the destination
    quietly. Making your mail to appear as authentic as possible is
    the only way to send a mail to the remote host reliably.

    Para aliviar esta situación de hostilidad y limitaciones las
    limitaciones de Internet, algunos ISP independientes como
    Yahoo.com y Gmail.com ofrecen un servicio de correo seguro al
    cual se puede conectar desde cualquier punto de Internet mediante
    el uso de Seguridad de Capa de Transporte (TLS) y su predecesor ,
    Capa de Conexión Segura (SSL).

      * El servicio de equipos inteligentes sobre en puerto 465 con
        SMTP sobre SSL en desuso (protocolo SMTPS).

      * El servicio de equipo inteligente en el puerto 587 con
        STARTTLS.

      * El correo entrante se accede mediante el puerto TLS/POP3
        (995) con POP3.

    Por sencillez en adelante, asumiré que el equipo inteligente esta
    ubicado en «smtp.hostname.dom», necesita autenticación SMTP y usa
    el puerto de envio (587) mediante STARTTLS.

6.2.3. La estrategia de configuración de correo en una estación de
trabajo

    La configuración más sencilla es que el correo se envie al
    «equipo inteligente« de ISP y se reciban por medio del servidor
    POP3 del ISP mediante el propio MUA (see Sección 6.4, “Agente de
    usuario de correo (MUA)”). Este tipo de configuración es común en
    los MUA con interfaz grafica de usuario completa como icedove(1),
    evolution(1), etc. Si usted necesita filtrar los correos
    dependiendo de su tipo, use la función de filtrado del MUA. En
    este caso, el MTA local (see Sección 6.3, “Agente de transporte
    de correo (Mail transport agent, MTA)”) solo realizará la entrega
    local (cuando el remitente y el destinatario están en el mismo
    equipo).

    Tenga en cuenta que el sistema Debian es un sistema multiusuario.
    Incluso si usted es el único usuario, existen multitud de
    programas en ejecución como superusuario que le enviarán correos.

    La configuración de correo alternativa es que el correo se envia
    por medio del MTA local al equipo inteligente del ISP y se recibe
    del POP3 del ISP por el recuperador de correo (see Sección 6.5,
    “Utilidad de recuperación y reenvio de correo remoto”) al buzón
    local. Si necesita el filtrado de correo dependiendo de sus
    tipos, usará el MDA con filtrado (see Sección 6.6, “Agente de
    entrega de correo (MDA) con filtro”) para separar el correo en
    diferentes buzones. Este tipo de configuración es común en MUA
    sencillos de consola como mutt(1), mew(1), etc., aunque es
    posible con cualquier MUAs (see Sección 6.4, “Agente de usuario
    de correo (MUA)”). Para este caso , el MTA local (see
    Sección 6.3, “Agente de transporte de correo (Mail transport
    agent, MTA)”) necesita realizar la entrega al equipo inteligente
    y entrega local. Ya que las estaciones de trabajo ubicuas no
    tienen un FQDN correcto, debe configurar su MTA local para que
    oculte y trampee el nombre real de correo en los correo de salida
    para evitar errores en la entrega (see Sección 6.3.3, “La
    configuración de la dirección de correo”).

    Sugerencia

    Usted querrá configurar el MUA/MDA para utilizar Maildir para el
    almacenamiento de los mensajes de correo en algún lugar de su
    directorio personal.

%

6.3. Agente de transporte de correo (Mail transport agent, MTA)

    En una estación de trabajo, la elección más común epara el agente
    de transporte de correo (MTA) está entre los paquetes exim4-* o
    postfix. La elección depende de usted.

    Tabla 6.3. Relación fundamental de paquetes relacionados con el
    agente de transporte de correo para una estación de trabajo

    +---------------------------------------------------------------+
    |     paquete      |popularidad|tamaño|       descripción       |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |Exim4 agente de          |
    |exim4-daemon-light|V:342,     |1493  |transporte de correo     |
    |                  |I:367      |      |(MTA: por defecto en     |
    |                  |           |      |Debian)                  |
    |------------------+-----------+------+-------------------------|
    |                  |V:349,     |      |Documentación de Exim4 en|
    |exim4-base        |I:377      |1704  |formato texto y archivos |
    |                  |           |      |comunes                  |
    |------------------+-----------+------+-------------------------|
    |exim4-doc-html    |I:1        |3662  |Documentacióon de Exim4  |
    |                  |           |      |en formato html          |
    |------------------+-----------+------+-------------------------|
    |exim4-doc-info    |I:1        |624   |Documentación de Exim4 en|
    |                  |           |      |formato info             |
    |------------------+-----------+------+-------------------------|
    |                  |V:145,     |      |Agente de transporte de  |
    |postfix           |I:160      |4182  |correo Postfix (MTA:     |
    |                  |           |      |otro)                    |
    |------------------+-----------+------+-------------------------|
    |postfix-doc       |I:9        |4444  |Documentación de Postfix |
    |                  |           |      |en formato texto y html  |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |Implementación de la API |
    |sasl2-bin         |V:5, I:19  |428   |Cyrus SASL (complemento a|
    |                  |           |      |postfix para SMTP AUTH)  |
    |------------------+-----------+------+-------------------------|
    |cyrus-sasl2-doc   |I:1        |575   |Documentación Cyrus SASL |
    +---------------------------------------------------------------+


    Aunque la contabilidad del sistema de votación popcon de exim4-*
    parece más utilizado que postfix, eso no significa que postfix no
    sea común entre los desarrolladores de Debian. El sistema
    servidor de Debian usa ambos, exim4 y postfix. El análisis de la
    cabecera de correo de los envios a las listas de correo de
    desarrolladores importantes indica que ambos MTAs son comunes.

    Los paquetes exim4-* son reconocidos por su mínimo consumo de
    memoria y una configuración muy flexible. El paquete postfix es
    reconocido por ser compacto, rápido, simple y seguro. Ambos
    poseen una documentación amplia y son igual de buenos en cuanto a
    calidad y licencias.

    Existen muchas elecciones de paquetes como agente de transporte
    de correo (MTA) especializados y con diferentes capacidades en el
    repositorio Debian.

    Tabla 6.4. Relación de paquetes candidatos como agente de
    transporte de correo (MTA) en el repositorio Debian

    +---------------------------------------------------------------+
    |     paquete      |popularidad|tamaño|      Capacidades y      |
    |                  |           |      |     especialización     |
    |------------------+-----------+------+-------------------------|
    |exim4-daemon-light|V:342,     |1493  |completo                 |
    |                  |I:367      |      |                         |
    |------------------+-----------+------+-------------------------|
    |postfix           |V:145,     |4182  |completo (seguridad)     |
    |                  |I:160      |      |                         |
    |------------------+-----------+------+-------------------------|
    |exim4-daemon-heavy|V:7, I:8   |1643  |completo (flexible)      |
    |------------------+-----------+------+-------------------------|
    |sendmail-bin      |V:14, I:15 |1854  |completo (únicamente si  |
    |                  |           |      |ya le es familiar)       |
    |------------------+-----------+------+-------------------------|
    |nullmailer        |V:7, I:10  |479   |esencial, sin correo     |
    |                  |           |      |local                    |
    |------------------+-----------+------+-------------------------|
    |ssmtp             |V:8, I:11  |2     |esencial, sin correo     |
    |                  |           |      |local                    |
    |------------------+-----------+------+-------------------------|
    |courier-mta       |V:0, I:0   |2416  |muy completo (interfaz   |
    |                  |           |      |web etc.)                |
    |------------------+-----------+------+-------------------------|
    |masqmail          |V:0, I:0   |337   |ligero                   |
    |------------------+-----------+------+-------------------------|
    |esmtp             |V:0, I:0   |128   |ligero                   |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |ligero (extensión de     |
    |esmtp-run         |V:0, I:0   |32    |compatibilidad sendmail a|
    |                  |           |      |esmtp)                   |
    |------------------+-----------+------+-------------------------|
    |msmtp             |V:5, I:10  |547   |ligero                   |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |ligero (extensión de     |
    |msmtp-mta         |V:3, I:4   |86    |compatibilidad senmail a |
    |                  |           |      |msmtp)                   |
    +---------------------------------------------------------------+


%

6.3.1. Configuración de exim4

    Atención

    Configuring exim4 to send the Internet mail via multiple
    corresponding smarthosts for multiple source email addresses is
    non-trivial. Please set up exim4 only for a single email address
    for the system programs such as popcon and cron and set up msmtp
    for multiple source email addresses for the user programs such as
    mutt.

    Para configurar el correo de Internet por medio de un equipo
    inteligente, (re)configure el paquete exim4-* como se muetra a
    continuación.

    $ sudo /etc/init.d/exim4 stop
    $ sudo dpkg-reconfigure exim4-config

    En «Tipo general de configuración de correo« seleccione «correo
    enviado por equipo inteligente; recibido por SMTP o fetchmail«.

    Asigne a «Nombre del sistema de correo:« a su valor por defecto
    como FQDN (consulte Sección 5.1.1, “La resolución del nombre del
    equipo”).

    Asigne «Direcciones IP escuchan en las conexiones SMTP de
    entrada:« a sus valores por defecto como «127.0.0.1 ; ::1«.

    Borre el contenido de «Otros destinos desde los cuales se acepta
    correo:«.

    Borre el contenido de «Máquinas para el reenvio de correo:«.

    Asigne «Direcciones de IP o nombre de equipos para correo
    inteligente de salida:« a «smtp.hostname.dom:587«.

    Asigne «<No>« a «Ocultar el nombre de correo local en el correo
    de salida?«. (Utilice en su lugar «/etc/email-addresses» como en
    Sección 6.3.3, “La configuración de la dirección de correo”.)

    Conteste a «Mantener el número de peticiones DNS a mínimo
    (Marcado bajo demanda) como sigue.

      * «No« si el sistema esta conectado a Internet en el arranque.
   
      * «Sí» si el sistema no esta conectado a Internet en el
        arranque.

    Asigne «Método de entrega para correo local:« a «mbox format in /
    var/mail«.

    Selecciones «<Si>« a «Dividir la configuración en archivos
    pequeños?:«.

    Crear las entradas de contraseñas para el equipo inteligente
    editando «/etc/exim4/passwd.client».

    $ sudo vim /etc/exim4/passwd.client
     ...
    $ cat /etc/exim4/passwd.client
    ^smtp.*\.hostname\.dom:username@hostname.dom:password

    Inicie exim4 como se muestra.

    $ sudo /etc/init.d/exim4 start

    El nombre del equipo en «/etc/exim4/passwd.client» no debería ser
    un alias. Compruebe el nombre real del equipo como sigue.

    $ host smtp.hostname.dom
    smtp.hostname.dom is an alias for smtp99.hostname.dom.
    smtp99.hostname.dom has address 123.234.123.89

    Yo utilizo las expresiones regulares en «/etc/exim4/
    passwd.client» para trabajar sobre el tema de los alias. SMTP
    AUTH probablemente funciones incluso si el ISP redirige el equipo
    señalado por medio de alias.

    Puede actualiza su confiugración de exim4 de forma manual como
    sigue:

      * Actualice los archivos de configuración de exim4 en «/etc/
        exim4/».

          + Creando «/etc/exim4/exim4.conf.localmacros» para asignar
            MACROS y editando «/etc/exim4/exim4.conf.template». (no
            dividir la configuración)

          + creando nuevos archivos y editando los existente en los
            subdirectorios en «/etc/exim4/exim4.conf.d». (dividir la
            configuración)

      * Ejecute «invoke-rc.d exim4 reload».

    Por favor, lea la guía oficial en: «/usr/share/doc/exim4-base/
    README.Debian.gz» y update-exim4.conf(8).

    Atención

    Iniciar exim4 tarda mucho tiempo si (valor por defecto) «No« fue
    elegido a la pregunta de denconf «Mantener el número de preguntas
    DNS al mínimo (Marcar bajo demanda)?« y el sistema no esta
    conectado a Intenet cuando se inicia.

    Aviso
   
    Es inseguro utilizar contraseñas en texto plano sin ciftrado
    incluso cuando el ISP lo permite.

    Sugerencia

    Incluso si se usa SMTP con STARTTLS en el puerto 587 que se
    recomienda, algunso ISP todavía usan el puerto en desuso de SMTPS
    (SSL en el puerto 465). Exim4 tras la versión 4.77 tiene
    protocolo SMTPS en desuso tanto para el cliente como para el
    servidor.

    Sugerencia

    Si esta buscando un MTA ligero que respete «/etc/aliases» para su
    equipo portátil, podría considerar exim4(8) con «QUEUERUNNER=
    'queueonly'», «QUEUERUNNER='nodaemon'», etc. en «/etc/default/
    exim4».

%

6.3.2. Configuración de postfix con SASL

    Para el correo de Internet por medio de un equipo inteligente,
    podría leer primero postfix documentation y las páginas de manual
    importantes.

    Tabla 6.5. Relación de páginas de manual importantes en postfix

    +------------------------------------------------------------+
    |   orden    |                    función                    |
    |------------+-----------------------------------------------|
    |postfix(1)  |Programa de control postfix                    |
    |------------+-----------------------------------------------|
    |postconf(1) |Utilidad de configuración postfix              |
    |------------+-----------------------------------------------|
    |postconf(5) |Parámetros de configuración de Postfix         |
    |------------+-----------------------------------------------|
    |postmap(1)  |Tabla de mantenimiento adelantada Postfix      |
    |------------+-----------------------------------------------|
    |postalias(1)|Mantenimiento de base de datos de alias Postfix|
    +------------------------------------------------------------+


    (Re)configure los paquetes postfix y sasl2-bin según se explica a
    continuación.

    $ sudo /etc/init.d/postfix stop
    $ sudo dpkg-reconfigure postfix

    Elija «Internet con equipo inteligente«.

    Asigne «equipo de reenvio SMTP (el blanco para no elegir
    ninguno):« a «[smtp.hostname.dom]:587» y configúrelo según sigue.

    $ sudo postconf -e 'smtp_sender_dependent_authentication = yes'
    $ sudo postconf -e 'smtp_sasl_auth_enable = yes'
    $ sudo postconf -e 'smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd'
    $ sudo postconf -e 'smtp_sasl_type = cyrus'
    $ sudo vim /etc/postfix/sasl_passwd

    Cree las entradas de las contraseñas para el equipo inteligente.

    $ cat /etc/postfix/sasl_passwd
    [smtp.hostname.dom]:587     username:contraseña
    $ sudo postmap hush:/etc/postfix/sasl_passwd

    Inicie postfix con lo siguiente.

    $ sudo /etc/init.d/postfix start

    Aquí la utilización de «[» y «]» en el diálogo dpkg-reconfigure y
    «/etc/postfix/sasl_passwd» asegura que no se marque la entrada MX
    pero que se utilice directamente el nombre del equipo
    especificado. Consulte «Enabling SASL authentication in the
    Postfix SMTP client« en «/usr/share/doc/postfix/html/
    SASL_README.html».

%

6.3.3. La configuración de la dirección de correo

    Existen algunos archivos de configuraciñon de la dirección de
    correo para el transporte de correo, su entrega y los agentes de
    usuario.

    Tabla 6.6. Relación de los archivos relacionados con la
    configuración de la dirección de correo

    +---------------------------------------------------------------+
    |    archivo    |      función      |        aplicación         |
    |---------------+-------------------+---------------------------|
    |               |nombre del equipo  |Propio de Debian, mailname |
    |/etc/mailname  |por defecto para el|(5)                        |
    |               |correo (saliente)  |                           |
    |---------------+-------------------+---------------------------|
    |/etc/          |nombre del equipo  |propio de exim(8) ,        |
    |email-addresses|falso para correo  |exim4-config_files(5)      |
    |               |de salida          |                           |
    |---------------+-------------------+---------------------------|
    |               |nombre del equipo  |propio de postfix(1), se   |
    |/etc/postfix/  |falso para correo  |activa después de la       |
    |generic        |de salida          |ejecución de la orden      |
    |               |                   |postmap(1).                |
    |---------------+-------------------+---------------------------|
    |               |alias del nombre de|general, activado después  |
    |/etc/aliases   |la cuenta para el  |de la ejecución de la orden|
    |               |correo entrante    |newaliases(1).             |
    +---------------------------------------------------------------+


    El nombre del correo en el archivo «/etc/mailname» normalmente es
    un nombre de dominio totalmente cualificado (FQDN) que
    corresponderá a una dirección IP del equipo. Para un equipo
    ubicuo la cual no tiene un nombre asociado a una dirección IP,
    asigne este nombre de correo al valor de «hostname -f». (Esta es
    una elección segura que funciona tanto con exim4-* como con
    postfix.)

    Sugerencia

    El contenido de «/etc/mailname» se usa por muchos programas que
    no son MTA para determinar su comportamiento por defecto. En
    mutt, se asignan las variables «hostname» y «from» en el archivo
    ~/muttrc y sobreescribe el valor de mailname. Para los programas
    en el paquete devscripts, como bts(1) y dch(1), exporta las
    variables de entorno «$DEBFULLNAME» y «$DEBEMAIL» para
    sobreescribirlo.

    Sugerencia

    El paquete popularity-contest de forma habitual envia el correo
    desde la cuenta de superusuario con FQDN. Necesita asignar
    MAILFROM en /etc/popularity-contest.conf como se describe en el
    archivo /usr/share/popularity-contest/default.conf. De otra
    forma, su correo será rechazado por el servidor SMTP del equipo
    inteligente. Aunque es aburrido, esta aproximación es más segura
    que reescribir la dirección remitente de todos los correos por el
    MTA y podría ser usado por otros demonios y archivos de órdenes
    cron.

    Cuando se asigna mailname a «hostname -f», la simulación de la
    dirección de correo remitente por medio de MTA puede ser
    realizado por lo siguiente.

      * El archivo «/etc/email-addresses» para exim4(8) se explica en
        exim4-config_files(5)
   
      * El archivo «/etc/postfix/generic» para postfix(1) se explica
        en el general(5)

    Los siguientes pasos añadidos son necesarios para postfix.

    # postmap hash:/etc/postfix/generic
    # postconf -e 'smtp_generic_maps = hash:/etc/postfix/generic'
    # postfix reload

    Puede probar la configuarción de la dirección de correo usando lo
    siguiente.

      * exim(8) con las opciones -brw, -bf, -bF, -bV, …
   
      * postmap(1) con la opción -q.

    Sugerencia

    Exim proporciona varias herramientas como exiqgrep(8) y exipick
    (8). Consulte «dpkg -L exim4-base|grep man8/» para las órdenes
    disponibles.

%

6.3.4. Operaciones fundamentales MTA

    Existen varias operaciones MTA fundamentales. Algunas se pueden
    realizar por medio de interfaz compatible de sendmail(1).

    Tabla 6.7. Relación de operaciones MTA fundamentales

    +---------------------------------------------------------------+
    |orden exim|  orden postfix  |           descripción            |
    |----------+-----------------+----------------------------------|
    |          |                 |lee los correos de la entrada     |
    |sendmail  |sendmail         |estándar y los organiza para la   |
    |          |                 |entrega (-bm)                     |
    |----------+-----------------+----------------------------------|
    |          |                 |enumera los correos en la cola,   |
    |mailq     |mailq            |con su estatus e identificador en |
    |          |                 |la cola (-bp)                     |
    |----------+-----------------+----------------------------------|
    |newaliases|newaliases       |inicializa la base de datos de    |
    |          |                 |alias (-l)                        |
    |----------+-----------------+----------------------------------|
    |exim4 -q  |postqueue -f     |descarga los correos en espera    |
    |          |                 |(-q)                              |
    |----------+-----------------+----------------------------------|
    |          |postsuper -r ALL |                                  |
    |exim4 -qf |deferred;        |descarga todos los correos        |
    |          |postqueue -f     |                                  |
    |----------+-----------------+----------------------------------|
    |exim4 -qff|postsuper -r ALL;|descarga incluso los correos      |
    |          |postqueue -f     |congelados                        |
    |----------+-----------------+----------------------------------|
    |exim4 -Mg |postsuper -h     |congela un mensaje por su         |
    |queue_id  |queue_id         |identificador en la cola          |
    |----------+-----------------+----------------------------------|
    |exim4 -Mrm|postsuper -d     |elimina un mensaje por su         |
    |queue_id  |queue_id         |identificador en la cola          |
    |----------+-----------------+----------------------------------|
    |N/A       |postsuper -d ALL |elimina todos los mensajes        |
    +---------------------------------------------------------------+


    Sugerencia
   
    puede ser una buena idea descargar todos los correos mediante un
    archivo de órdenes «/etc/ppp/ip-up.d/*».

%

6.4. Agente de usuario de correo (MUA)

    Si esta suscrito al alguna lista de correo de Debian, puede ser
    una buena idea utilizar como MUA mutt y mew el cual es el
    estándar de facto para los participantes y su comportamiento es
    el esperado.

    Tabla 6.8. Relación de agentes de usuario de correo (MUA)

    +---------------------------------------------------------------+
    |  paquete  |popularidad|tamaño|              tipo              |
    |-----------+-----------+------+--------------------------------|
    |evolution  |V:31, I:229|475   |X GUI program (GNOME3, suite de |
    |           |           |      |trabajo en grupo)               |
    |-----------+-----------+------+--------------------------------|
    |           |           |      |programa de interfaz gráfico de |
    |thunderbird|V:57, I:138|165180|usuario X (GNOME2, marca blanca |
    |           |           |      |Mozilla Thunderbird)            |
    |-----------+-----------+------+--------------------------------|
    |kmail      |V:34, I:88 |18011 |programa de interfaz gráfico de |
    |           |           |      |usuario X (KDE)                 |
    |-----------+-----------+------+--------------------------------|
    |           |           |      |programa de terminales de       |
    |mutt       |V:37, I:313|7056  |caracteres probablemente        |
    |           |           |      |utilizado con vim               |
    |-----------+-----------+------+--------------------------------|
    |mew        |V:0, I:0   |2325  |programa de terminales de       |
    |           |           |      |caracteres en (x)emacs          |
    +---------------------------------------------------------------+


%

6.4.1. MUA fundamental — Mutt

    Personalice «~/.muttrc» como sigue para utilizar mutt como agente
    de correo de usuario (MUA) en combinación con vim.

    #
    # Fichero de configuración de usuario que sustituye /etc/Muttrc
    #
    # dirección de remitente de correo falsa
    set use_from
    set hostname=example.dom
    set from=«Name Surname <username@example.dom>«
    set signature=«~/.signature«

    # vim: «gq« para reconiigurar parámetros
    set editor=«vim -c 'set tw=72 et ft=mail'«

    # «mutt« va al  Inbox, mientras «mutt -y« enumera los buzones
    set mbox_type=Maildir           # utiliza el formato gmail para el formato Maildir para crear mbox
    set mbox=~/Mail                 # ubica los buzones en $HOME/Mail/
    set spoolfile=+Inbox            # correo se entrega en $HOME/Mail/Inbox
    set record=+Outbox              # guarda correos fcc en HOME/Mail/Outbox
    set postponed=+Postponed        # mantiene los pospuestos en $HOME/Mail/postponed
    set move=no                     # no mueve los elementos Inbox a mbox
    set quit=ask-yes                # no usa solo «q« para cerrar
    set delete=yes                  # borra siempre preguntado en la salida
    set fcc_clear                   # almacena fcc no cifrados
    # buzones en Maildir (actualiza automáticamente)
    mailboxes `cd ~/Mail; /bin/ls -1|sed -e 's/^/+/' | tr «\n« « «`
    unmailboxes Maillog *.ev-summary

    ## Por defecto
    #set index_format=«%4C %Z %{%b %d} %-15.15L (%4l) %s«
    ## Índices de conversaciones con remitentes (collapse)
    set index_format=«%4C %Z %{%b %d} %-15.15n %?M?(#%03M)&(%4l)? %s«

    ## Por defecto
    #set folder_format=«%2C %t %N %F %2l %-8.8u %-8.8g %8s %d %f«
    ## nombres de carpetas unicamente
    set folder_format=«%2C %t %N %f«

    Añada lo siguiente a «/etc/mailcap» o «~/.mailcap» para mostrar
    los correos HTML y adjuntos MS Word incrustados.

    text/html; lynx -force_html %s; needsterminal;
    application/msword; /usr/bin/antiword '%s'; copiousoutput; description=«Microsoft Word Text«; nametemplate=%s.doc

    Sugerencia

    Mutt puede ser utilizado como cliente IMAP y conversor de
    formatos de buzón. Puede etiquetar mensajes con «t», «T», etc.
    Esos mensajes etiquetados pueden ser copiados entre diferentes
    buzones con «;C» y borrados con «;d» en una única acción.

%

6.4.2. Advanced MUA — Mutt + msmtp

    Mutt can be configured to use multiple source email addresses
    with multiple corresponding smarthosts using msmtp.

    Sugerencia

    Msmtp is a sendmail emulator which allows to be installed along
    another sendmail emulator which provides the /usr/sbin/sendmail
    command. So you can leave your system mail to be exim4 or
    postfix.

    Let's think about supporting 3 email addresses as an example:

      * "My Name1 <myaccount1@gmail.com>"

      * "My Name2 <myaccount2@gmail.com>"

      * "My Name3 <myaccount3@example.org>"

    Here is an example of ~/.muttrc customization supporting 3
    smarthosts for 3 different source email addresses.

    set use_from
    set from="My Name3 <myaccount3@example.org>"
    set reverse_name
    alternates myaccount1@gmail\.com|myaccount1@gmail\.com|myaccount3@example\.org

    # ...

    # MACRO
    macro compose "1" "<edit-from>^UMy Name1 \<myaccount1@gmail.com\>\n"
    macro compose "2" "<edit-from>^UMy Name2 \<myaccount2@gmail.com\>\n"
    macro compose "3" "<edit-from>^UMy Name3 \<myaccount3@example.org\>\n"

    send2-hook '~f myaccount1@gmail.com' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"
    send2-hook '~f myaccount2@gmail.com' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"
    send2-hook '~f myaccount3@example.org' "set sendmail = '/usr/bin/msmtp --read-envelope-from'"

    # ...

    Let's install msmtp-gnome and set ~/.msmtprc as follows.

    defaults
    logfile ~/.msmtp.log
    domain myhostname.example.org
    tls on
    tls_starttls on
    tls_certcheck on
    tls_trust_file /etc/ssl/certs/ca-certificates.crt
    auth on
    port 587
    auto_from

    account myaccount1@gmail.com
    host smtp.gmail.com
    from  myaccount1@gmail.com
    user  myaccount1@gmail.com

    account myaccount2@gmail.com
    host smtp.gmail.com
    from  myaccount2@gmail.com
    user  myaccount2@gmail.com

    account myaccount3@example.org
    host mail.example.org
    from  myaccount3@example.org
    user  myaccount3@example.org

    account default : myaccount3@example.org

    Then, add password data into the Gnome key ring. For example:

     $ secret-tool store --label=msmtp \
         host smtp.gmail.com \
         service smtp \
         user myaccount1@gmail.com
     ...

    Sugerencia

    If you don't wish to use the Gnome key ring, you can install
    msmtp package instead and add an entry such as "password
    secret123" to each account in ~/.msmtprc. See memtp documentation
    for more.

%

6.5. Utilidad de recuperación y reenvio de correo remoto

    En lugar de ejecutar un MUA para acceder a los correos en remoto
    y procesarlos manualmente, puede desear automatizarlo para tener
    todos los correos entregados al equipo local. La utilidad de
    reenvio y recogida de correo remoto es la herramienta para usted.

    Aunque fetchmail(1) ha sido el estándar de facto en GNU/Linux
    para la recogida de correo remoto, al autor le gusta ahora 
    getmail(1). Si quiere rechazar correo antes de descargarlo para
    optimizar el ancho de banda, mailfilter o mpop puede ser útil.
    Cualquiera que sea la utilidad usada para recuperar el correo, es
    una buena idea configurar el sistema para entregar el correo
    recuperado al MDA, como es maildrop, por medio de una tubería.

    Tabla 6.9. Relación de utilidades de recuperación y envio de
    correo remoto

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|           descripción           |
    |----------+-----------+------+---------------------------------|
    |fetchmail |V:5, I:17  |814   |recuperador de correo (POP3,     |
    |          |           |      |APOP, IMAP) (viejo)              |
    |----------+-----------+------+---------------------------------|
    |          |           |      |recuperador de correo (POP3,     |
    |getmail   |V:1, I:6   |30    |IMAP4, y SDPS) (simple, seguro y |
    |          |           |      |fiable)                          |
    |----------+-----------+------+---------------------------------|
    |          |           |      |recuperador de correo (POP3) con |
    |mailfilter|V:0, I:0   |291   |capacidad de filtrado con        |
    |          |           |      |expresiones regulares            |
    |----------+-----------+------+---------------------------------|
    |mpop      |V:0, I:0   |400   |recuperador de correo (POP3) y   |
    |          |           |      |MDA con capacidad de filtrado    |
    +---------------------------------------------------------------+


%

6.5.1. configuración de getmail

    La configuración de getmail(1) se describe en la documentación de
    getmail. Aquí esta mi configuración para acceder a varias cuentas
    POP3 como usuarios.

    Cree «/usr/local/bin/getmails» como sigue.

    #!/bin/sh
    set -e
    if [ -f $HOME/.getmail/running ]; then
      echo «getmail is already running ... (if not, remove $HOME/.getmail/running)« >&2
      pgrep -l «getmai[l]«
      exit 1
    else
      echo «getmail has not been running ... « >&2
    fi
    if [ -f $HOME/.getmail/stop ]; then
      echo «do not run getmail ... (if not, remove $HOME/.getmail/stop)« >&2
      exit
    fi
    if [ «x$1« = «x-l« ]; then
      exit
    fi
    rcfiles=«/usr/bin/getmail«
    for file in $HOME/.getmail/config/* ; do
      rcfiles=«$rcfiles --rcfile $file«
    done
    date -u > $HOME/.getmail/running
    eval «$rcfiles $@«
    rm $HOME/.getmail/running

    Configurelo como sigue.

    $ sudo chmod 755 /usr/local/bin/getmails
    $ mkdir -m 0700 $HOME/.getmail
    $ mkdir -m 0700 $HOME/.getmail/config
    $ mkdir -m 0700 $HOME/.getmail/log

    Cree el archivo de configuración «$HOME/.getmail/config/
    pop3_name» para cada cuenta POP3 como sigue.

    [retriever]
    type = SimplePOP3SSLRetriever
    server = pop.example.com
    username =  pop3_name@example.com
    password = <your-password>

    [destination]
    type = MDA_external
    path = /usr/bin/maildrop
    unixfrom = True

    [options]
    verbose = 0
    delete = True
    delivered_to = False
    message_log = ~/.getmail/log/pop3_name.log

    Configurelo como sigue.

    $ chmod 0600 $HOME/.getmail/config/*

    Configure «/usr/local/bin/getmails» con cron(8)para que se
    ejecute cada 15 minutos ejecutando «sudo crontab -e -u
    <user_name>» y añadiendo lo siguiente a la entrada del usuario
    cron.

    5,20,35,50 * * * * /usr/local/bin/getmails --quiet

    Sugerencia

    Los problemas de acceso con POP3 pueden no venir de getmail.
    Algunos servicios gratuitos POP3 pueden no seguir el protocolo
    POP3 y su filtro de SPAM puede no ser perfecto. Por ejemplo,
    pueden borrar los mensajes tras recibir la orden RETR antes de
    recibir la orden DELE y puede poner en cuarentena en el buzón de
    Spam. Podría minimizar los daños configurándolos y archivar los
    mensajes accedidos y no borrándolos. Consulte también «No se
    descargan algunos correos«.

%

6.5.2. configuración de fetchmail

    La configuración de fetchmail(1) se realiza en «/etc/default/
    fetchmail», «/etc/fetchmailrc» y «$HOME/.fetchmailrc». Consulte
    sus ejemplos en «/usr/share/doc/fetchmail/example/
    fetchmailrc.example».

%

6.6. Agente de entrega de correo (MDA) con filtro

    La mayor parte de los MTA, como postfix y exim4, funcionan como
    MDA (agente de entrega de correo). Existen MDA especializados con
    capacidades de filtrado.

    Aunque procmail(1) ha sido el estándar de facto en GNU/Linux como
    MDA con filtrado, al autor le gusta ahora maildrop(1).
    Independientemente de las utilidades de filtrado que se utilicen,
    es una buena idea para configurar el sistema para la entrega de
    correo filtrado al estilo de directorio de correo qmail Maildir.

    Tabla 6.10. Relación de MDA con filtro

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño|           descripción            |
    |---------+-----------+------+----------------------------------|
    |procmail |V:40, I:277|300   |MDA con filtro (antiguo)          |
    |---------+-----------+------+----------------------------------|
    |mailagent|V:0, I:5   |1356  |MDA con filtro Perl               |
    |---------+-----------+------+----------------------------------|
    |maildrop |V:0, I:2   |1141  |MDA con lenguaje de filtrado      |
    |         |           |      |estructurado                      |
    +---------------------------------------------------------------+


%

6.6.1. configuración de maildrop

    La configuración de maildrop(1) se decribe en la documentación de
    maildropfilter. Aquí esta un ejemplo de configuración para «$HOME
    /.mailfilter».

    # Configuración local
    MAILROOT=«$HOME/Mail«
    # set this to /etc/mailname contents
    MAILHOST=«example.dom«
    logfile $HOME/.maildroplog

    # las reglas son hechas para escribir el valor inicial por otro

    # correo de la listas de correos ?
    if (     /^Precedence:.*list/:h || /^Precedence:.*bulk/:h )
    {
        # reglas de correos de listas de correos
        # buzón por defecto para correos  de una lista
        MAILBOX=«Inbox-list«
        # buzon por defecto para correos de debian.org
        if ( /^(Sender|Resent-From|Resent-Sender): .*debian.org/:h )
        {
            MAILBOX=«service.debian.org«
        }
        # buzón por defecto para correos de bugs.debian.org (BTS)
        if ( /^(Sender|Resent-From|Resent-sender): .*@bugs.debian.org/:h )
        {
            MAILBOX=«bugs.debian.org«
        }
        # buzón para cada lista de correo mantenida correctamente con «List-Id: foo« or «List-Id: ...<foo.bar>«
        if ( /^List-Id: ([^<]*<)?([^<>]*)>?/:h )
        {
            MAILBOX=«$MATCH2«
        }
    }
    else
    {
        # reglas para correos que no son de la lista de correos
        # buzón de entrada por defecto
        MAILBOX=«Inbox-unusual«
        # correos locales
        if ( /Envelope-to: .*@$MAILHOST/:h )
        {
            MAILBOX=«Inbox-local«
        }
        # correos html (99% spams)
        if ( /DOCTYPE html/:b ||\
             /^Content-Type: text\/html/ )
        {
            MAILBOX=«Inbox-html«
        }
        # reglas de lista negra para spams
        if ( /^X-Advertisement/:h ||\
             /^Subject:.*BUSINESS PROPOSAL/:h ||\
             /^Subject:.*URGENT.*ASISSTANCE/:h ||\
             /^Subject: *I NEED YOUR ASSISTANCE/:h )
        {
            MAILBOX=«Inbox-trash«
        }
        # reglas de lista negra para correos normales
        if ( /^From: .*@debian.org/:h ||\
             /^(Sender|Resent-From|Resent-Sender): .*debian.org/:h ||\
             /^Subject: .*(debian|bug|PATCH)/:h )
        {
            MAILBOX=«Inbox«
        }
        # reglas de lista blanca para correos de BTS
        if ( /^Subject: .*Bug#.*/:h ||\
             /^(To|Cc): .*@bugs.debian.org/:h )
        {
            MAILBOX=«bugs.debian.org«
        }
        # reglas de lista blanca para correos con de getmails
        if ( /^Subject: Cron .*getmails/:h )
        {
            MAILBOX=«Inbox-getmails«
        }
    }

    # comprueba la existencia de $MAILBOX
    `test -d $MAILROOT/$MAILBOX`
    if ( $RETURNCODE == 1 )
    {
        # crea el directorio de correo para el  buzón para $MAILBOX
        `maildirmake $MAILROOT/$MAILBOX`
    }
    # entrega al directorio de correo $MAILBOX
    to «$MAILROOT/$MAILBOX/«
    exit

    Aviso

    No como procmail, maildrop no crea los directorios de correo que
    faltan de forma automática. Debe crearlos por adelantado de forma
    manual utilizando maildirmake(1) como en el ejemplo «$HOME
    /.mailfilter».

%

6.6.2. Configuración de procmail

    Aquí esta una configuración parecida con «$HOME/.procmailrc» para
    procmail(1).

    MAILDIR=$HOME/Maildir
    DEFAULT=$MAILDIR/Inbox/
    LOGFILE=$MAILDIR/Maillog
    # limpieza de correos sospechosos: enviados a la papelera y finaliza
    :0
    * 1^0 ^X-Advertisement
    * 1^0 ^Subject:.*BUSINESS PROPOSAL
    * 1^0 ^Subject:.*URGENT.*ASISSTANCE
    * 1^0 ^Subject: *I NEED YOUR ASSISTANCE
    X-trash/

    # Entrega de mensajes de listas de correo
    :0
    * 1^0 ^Precedence:.*list
    * 1^0 ^Precedence:.*bulk
    * 1^0 ^List-
    * 1^0 ^X-Distribution:.*bulk
    {
    :0
    * 1^0 ^Return-path:.*debian-devel-admin@debian.or.jp
    jp-debian-devel/

    :0
    * ^Resent-Sender.*debian-user-request@lists.debian.org
    debian-user/

    :0
    * ^Resent-Sender.*debian-devel-request@lists.debian.org
    debian-devel/

    :0
    * ^Resent-Sender.*debian-announce-request@lists.debian.org
    debian-announce

    :0
    mailing-list/
    }

    :0
    Inbox/

%

6.6.3. Reentrega del contenido de mbox

    Si su directorio personal se llenara y procmail(1) fallara
    necesitará realizar la entrega de forma manual a los buzones de
    correo en su directorio personal desde «/var/mail/
    <nombre_del_usuario>». Tras conseguir espacio libre de
    almacenamiento en su directorio personal, ejecute lo que se
    muestra a continuación.

    # /etc/init.d/${MAILDAEMON} stop
    # formail -s procmail </var/mail/<nombre_del_usuario>
    # /etc/init.d/${MAILDAEMON} start

%

6.7. Servidor POP3/IMAP4

    Si tiene un servidor privado en su red LAN, puede considerar
    ejectuar un servidor POP3 / IMAP4 para la entrega de correo a los
    clientes de la LAN.

    Tabla 6.11. Relación de servidores POP3/IMAP4

    +---------------------------------------------------------------+
    |  paquete   |popularidad|tamaño|tipo|       descripción        |
    |------------+-----------+------+----+--------------------------|
    |            |           |      |    |Servidor de correo Courier|
    |courier-pop |V:2, I:2   |308   |POP3|- servidor POP3 (solo el  |
    |            |           |      |    |formato de directorios de |
    |            |           |      |    |correo)                   |
    |------------+-----------+------+----+--------------------------|
    |cyrus-pop3d |V:0, I:0   |160   |POP3|Sistema de correo Cyrus   |
    |            |           |      |    |(soporta POP3)            |
    |------------+-----------+------+----+--------------------------|
    |            |           |      |    |Servidor de correo Courier|
    |courier-imap|V:3, I:4   |589   |IMAP|- servidor IMAP (solo     |
    |            |           |      |    |formato de directorio de  |
    |            |           |      |    |correo)                   |
    |------------+-----------+------+----+--------------------------|
    |cyrus-imapd |V:1, I:1   |484   |IMAP|Sistema de correo Cyrus   |
    |            |           |      |    |(soporte IMAP)            |
    +---------------------------------------------------------------+


%

6.8. Servidor de impresión y utilidades

    In the old Unix-like system, the BSD Line printer daemon (lpd)
    was the standard and the standard print out format of the classic
    free software was PostScript (PS). Some filter system was used
    along with Ghostscript to enable printing to the non-PostScript
    printer. See Sección 11.4.1, “Ghostscript”.

    In the modern Debian system, the Common UNIX Printing System
    (CUPS) is the de facto standard and the standard print out format
    of the modern free software is Portable Document Format (PDF).

    The CUPS uses Internet Printing Protocol (IPP). The IPP is now
    supported by other OSs such as Windows XP and Mac OS X and has
    became new cross-platform de facto standard for remote printing
    with bi-directional communication capability.

    Gracias a la funcionalidad de autoconversión dependiente del
    formato del archivo del sistema CUPS, simplemente ofrecer
    cualquier dato a la orden lpr debería generar la salida de
    impresión esperada. (En CUPS, lpr se puede activar mediante la
    instalación del paquete cups-bsd).

    El sistema Debian tiene paquetes importantes de utilidades y
    servidores de impresión.

    Tabla 6.12. Relación de las utilidades y servidores de impresión

    +--------------------------------------------------------------------+
    |         paquete         |popularidad|tamaño| puerto  | descripción |
    |-------------------------+-----------+------+---------+-------------|
    |                         |           |      |         |BSD lpr/lpd  |
    |lpr                      |V:3, I:4   |362   |printer  |(demonio de  |
    |                         |           |      |(515)    |impresión en |
    |                         |           |      |         |línea)       |
    |-------------------------+-----------+------+---------+-------------|
    |lprng                    |V:1, I:1   |3064  |, ,      |, ,          |
    |                         |           |      |         |(Mejorado)   |
    |-------------------------+-----------+------+---------+-------------|
    |                         |V:140,     |      |         |Servidor CUPS|
    |cups                     |I:395      |1141  |IPP (631)|de Impresión |
    |                         |           |      |         |en Internet  |
    |-------------------------+-----------+------+---------+-------------|
    |                         |           |      |         |Órdenes de   |
    |                         |           |      |         |impresión    |
    |                         |           |      |         |System V para|
    |                         |           |      |         |CUPS: lp(1), |
    |cups-client              |V:56, I:454|493   |, ,      |lpstat(1),   |
    |                         |           |      |         |lpoptions(1),|
    |                         |           |      |         |cancel(1),   |
    |                         |           |      |         |lpmove(8),   |
    |                         |           |      |         |lpinfo(8),   |
    |                         |           |      |         |lpadmin(8), …|
    |-------------------------+-----------+------+---------+-------------|
    |                         |           |      |         |Órdenes de   |
    |                         |           |      |         |impresión BSD|
    |cups-bsd                 |V:36, I:385|122   |, ,      |para CUPS:   |
    |                         |           |      |         |lpr(1), lpq  |
    |                         |           |      |         |(1), lprm(1),|
    |                         |           |      |         |lpc(8)       |
    |-------------------------+-----------+------+---------+-------------|
    |                         |V:100,     |      |No       |controladores|
    |printer-driver-gutenprint|I:372      |937   |aplicable|de impresión |
    |                         |           |      |         |para CUPS    |
    +--------------------------------------------------------------------+


    Sugerencia
   
    Puede configurar su sistema CUPS accediendo mediante su navegador
    a «http://localhost:631/« .

%

6.9. Servidor de acceso remoto (SSH) y utilidades

    Secure SHell (SSH) es la manera segura de conectarse a través de
    Internet. Una versión libre de SSH es OpenSSH y esta disponible
    en Debian mediante los paquetes openssh-client y openssh-server.

    Tabla 6.13. Relación de servidores de acceso remoto y utilidades

    +----------------------------------------------------------------------------+
    |       paquete        |popularidad|tamaño|     herramienta      |descripción|
    |----------------------+-----------+------+----------------------+-----------|
    |                      |V:803,     |      |                      |Cliente de |
    |openssh-client        |I:996      |4298  |ssh(1)                |«Secure    |
    |                      |           |      |                      |shell«     |
    |----------------------+-----------+------+----------------------+-----------|
    |                      |V:690,     |      |                      |Servidor   |
    |openssh-server        |I:834      |1567  |sshd(8)               |Secure     |
    |                      |           |      |                      |shell      |
    |----------------------+-----------+------+----------------------+-----------|
    |                      |           |      |                      |pregunta al|
    |                      |           |      |                      |usuario por|
    |ssh-askpass-fullscreen|V:0, I:0   |42    |ssh-askpass-fullscreen|la frase de|
    |                      |           |      |(1)                   |paso para  |
    |                      |           |      |                      |ssh-add    |
    |                      |           |      |                      |(GNOME2)   |
    |----------------------+-----------+------+----------------------+-----------|
    |                      |           |      |                      |pregunta al|
    |                      |           |      |                      |usuario por|
    |ssh-askpass           |V:3, I:34  |106   |ssh-askpass(1)        |la frase de|
    |                      |           |      |                      |paso para  |
    |                      |           |      |                      |ssh-add (X |
    |                      |           |      |                      |plano)     |
    +----------------------------------------------------------------------------+


    Atención
   
    Consulte Sección 4.7.3, “Medidas extraordinarias de seguridad en
    Internet” si su SSH es accesible desde Internet.

    Sugerencia

    Por favor utilice el programa screen(1) para permitir que los
    procesos del intérprete de órdenes remotos sobrevivan a las
    caidas de la conexión (consulte Sección 9.1, “El programa screen”
    ).

%

6.9.1. Fundamentos de SSH

    Aviso
   
    «/etc/ssh/sshd_no_debe_ser_ejecutado» no debe estar presente si
    se quiere ejecutar el servidor OpenSSH.

    SSH tiene dos protocolos de acreditación.

    Tabla 6.14. Relación de los protocolos y métodos de acreditación
    de SSH

    +---------------------------------------------------------------+
    |Protocolo|           Método SSH            |    descripción    |
    |   SSH   |                                 |                   |
    |---------+---------------------------------+-------------------|
    |         |                                 |Acreditación de    |
    |SSH-1    |«RSAAuthentication»              |usuario basada en  |
    |         |                                 |la clave de        |
    |         |                                 |identidad RSA      |
    |---------+---------------------------------+-------------------|
    |         |                                 |«.rhosts»          |
    |         |                                 |acreditación basada|
    |, ,      |«RhostsAuthentication»           |en el equipo       |
    |         |                                 |(insegura,         |
    |         |                                 |deshabilitada)     |
    |---------+---------------------------------+-------------------|
    |         |                                 |«.rhosts»          |
    |         |                                 |acreditación basada|
    |, ,      |«RhostsRSAAuthentication»        |en el equipo       |
    |         |                                 |combinada con la   |
    |         |                                 |clave del equipo   |
    |         |                                 |RSA (deshabilitada)|
    |---------+---------------------------------+-------------------|
    |, ,      |«ChallengeResponseAuthentication»|Acreditación       |
    |         |                                 |reto-respuesta RSA |
    |---------+---------------------------------+-------------------|
    |, ,      |«PasswordAuthentication»         |acreditación basada|
    |         |                                 |en contraseña      |
    |---------+---------------------------------+-------------------|
    |         |                                 |acreditación de    |
    |SSH-2    |«PubkeyAuthentication»           |usuario basada en  |
    |         |                                 |clave pública      |
    |---------+---------------------------------+-------------------|
    |         |                                 |«~/.rhosts» or «/  |
    |         |                                 |etc/hosts.equiv»   |
    |         |                                 |acreditación basada|
    |         |                                 |en equipo combinado|
    |, ,      |«HostbasedAuthentication»        |con acreditación   |
    |         |                                 |del equipo cliente |
    |         |                                 |mediante clave     |
    |         |                                 |pública            |
    |         |                                 |(deshabilitada)    |
    |---------+---------------------------------+-------------------|
    |, ,      |«ChallengeResponseAuthentication»|acreditación       |
    |         |                                 |reto-respuesta     |
    |---------+---------------------------------+-------------------|
    |, ,      |«PasswordAuthentication»         |acreditación basada|
    |         |                                 |en contraseña      |
    +---------------------------------------------------------------+


    Atención
   
    Tenga cuidado sobre estas diferencias si esta usando un sistema
    diferente de Debian.

    Consulte los detalles en «/usr/share/doc/ssh/README.Debian.gz», 
    ssh(1), sshd(8), ssh-agent(1) y ssh-keygen(1).

    Los archivos de configuración claves son los siguientes:

    Tabla 6.15. Relación de los archivos de configuración de SSH

    +---------------------------------------------------------------+
    |  archivo de   | descripción de los archivos de configuración  |
    | configuración |                                               |
    |---------------+-----------------------------------------------|
    |/etc/ssh/      |Valores por defecto del cliente SSH, consulte  |
    |ssh_config     |ssh_config(5)                                  |
    |---------------+-----------------------------------------------|
    |/etc/ssh/      |Valores por defecto del servidor SSH, consulte |
    |sshd_config    |sshd_config(5)                                 |
    |---------------+-----------------------------------------------|
    |~/.ssh/        |claves ssh públicas por defecto que usan los   |
    |authorized_keys|clientes que usan para conectarse a su cuenta  |
    |               |en este servidor SSH                           |
    |---------------+-----------------------------------------------|
    |~/.ssh/identity|clave SSH-1 RSA del usuario privada            |
    |---------------+-----------------------------------------------|
    |~/.ssh/id_rsa  |clave SSH-2 RSA privada del usuario            |
    |---------------+-----------------------------------------------|
    |~/.ssh/id_dsa  |clave SSH-2 DSA privada del usuario            |
    +---------------------------------------------------------------+


    Sugerencia
   
    Consulte ssh-keygen(1), ssh-add(1) and ssh-agent(1) para aprender
    a utilizar las claves público y privada SSH..

    Sugerencia
   
    Asegurese y compruebe la configuración realizando pruebas de
    conectividad. En caso de cualquier problema, utilice «ssh -v».

    Sugerencia
   
    Con «ssh-keygen -p» puede cambiar la frase de paso para cifrar la
    clave SSH local privada.

    Sugerencia

    Puede añadir opciones a las entradas en «~/.ssh/authorized_keys»
    para limitar los equipos y ejecutar las órdenes concretas. Los
    detalles los puede consultar sshd(8).

    Lo siguiente inicia una conexión ssh(1) desde el cliente.

    Tabla 6.16. Relación de ejemplos de inicio del clientes ssh

    +---------------------------------------------------------------+
    |                     orden                      | descripción  |
    |------------------------------------------------+--------------|
    |ssh                                             |conecta en el |
    |nombre_de_usuario@nombre_de_equipo.dominio.ext  |modo por      |
    |                                                |defecto       |
    |------------------------------------------------+--------------|
    |                                                |conecta en el |
    |ssh -v                                          |modo por      |
    |nombre_de_usuario@nombre_de_equipo.dominio.ext  |defecto con   |
    |                                                |los mensajes  |
    |                                                |de depuración |
    |------------------------------------------------+--------------|
    |                                                |obliga a      |
    |ssh -1                                          |conectar      |
    |nombre_del_usuario@nombre_del_equipo.dominio.ext|utilizando SSH|
    |                                                |versión 1     |
    |------------------------------------------------+--------------|
    |                                                |obliga el uso |
    |ssh -1 -o RSAAuthentication=no -l               |de una        |
    |nombre_del_usuario nombre_del_equipo.dominio.ext|contraseña con|
    |                                                |SSH versión 1 |
    |------------------------------------------------+--------------|
    |                                                |obliga la     |
    |ssh -o PreferredAuthentications=password -l     |utilización de|
    |nombre_de_usuario nombre_de_equipo.dominio.ext  |la contraseña |
    |                                                |con SSH       |
    |                                                |versión 2     |
    +---------------------------------------------------------------+


    If you use the same user name on the local and the remote host,
    you can eliminate typing "username@". Even if you use different
    user name on the local and the remote host, you can eliminate it
    using "~/.ssh/config". For Debian Salsa service with account name
    "foo-guest", you set "~/.ssh/config" to contain the following.

    Host salsa.debian.org people.debian.org
        User foo-guest

    Para el usuario, ssh(1) funciona de una forma más inteligente y
    segura que telnet(1). No como la orden telnet, la orden ssh no
    para con el carácter de escape telnet (inicio por defecto
    CTRL-]).

%

6.9.2. Puerto de reenvio para túnel SMTP/POP3

    Para crear un tubería que conecte al puerto 25 del servidor
    remoto desde el puerto 4025 del equipo local y al puerto 110 de
    servidor remoto desde el puerto 4110 del equipo local a través de
    ssh, ejecute en el equipo local lo que sigue.

    # ssh -q -L 4025:servidor_remoto:25 4110:servidor_remoto:110 nombre_de_usuario@servidor_remoto

    Esta es la forma segura de crear conexiones a un servidor SMTP/
    POP3 a través de Internet. Asigne a la entrada
    «AllowTcpForwarding» con «yes» en «/etc/ssh/sshd_config» del
    equipo remoto.

%

6.9.3. Conectarse sin contraseñas del equipo remoto

    Se puedo no tener que recordar contraseñas del sistema remoto
    usando «RSAAuthentication» (protocolo SSH-1) o «
    PubkeyAuthentication» (protocolo SSH-2).

    En el sistema remoto cree las entradas respectivas,
    «RSAAuthentication yes» o «PubkeyAuthentication yes», en «/etc/
    ssh/sshd_config».

    Genere las claves de acreditación locales e instale las claves
    públicas en el sistema remoto según se muestra.

      * «RSAAuthentication»: clave RSA para SSH-1 (en desuso ya que
        ha sido sustituido.)

    $ ssh-keygen
    $ cat .ssh/identity.pub | ssh usuario1@remoto «cat - >>.ssh/authorized_keys«

      * «PubkeyAuthentication»: clave RSA para SSH-2

    $ ssh-keygen -t rsa
    $ cat .ssh/id_rsa.pub | ssh usuario1@remoto «cat - >>.ssh/authorized_keys«

      * «PubkeyAuthentication»: clave DSA para SSH-2 (en desuso por
        ser lento.)

    $ ssh-keygen -t dsa
    $ cat .ssh/id_dsa.pub | ssh usuario1@remoto «cat - >>.ssh/authorized_keys«

    Sugerencia

    El uso de la clave DSA para SSH-2 esta en desuso ya que la clave
    es pequeña y lento. No existen más razones para evitar el uso de
    RSA y usar DSA ya que su pantente ha expirado. DSA es el acrónimo
    de Digital Signature Algorithm (Algoritmo de Firma Digital) y es
    lento. Consulte además DSA-1571-1.

    Nota

    Para que «HostbasedAuthentication» trabaje con SSH-2, usted debe
    ajustar la configuración de «HostbasedAuthentication» a «yes»
    tanto en «/etc/ssh/sshd_config» en el equipo servidor y «/etc/ssh
    /ssh_config» o «~/.ssh/config» en el equipo cliente.

%

6.9.4. Tratando con clientes SSH extraños

    Existen algunos clientes SSH libres disponibles para otras
    plataformas.

    Tabla 6.17. Relación de clientes SSH libres en otras plataformas

    +---------------------------------------------------------------+
    |   entorno   |               programa SSH libre                |
    |-------------+-------------------------------------------------|
    |Windows      |puTTY (http://www.chiark.greenend.org.uk/        |
    |             |~sgtatham/putty/) (GPL)                          |
    |-------------+-------------------------------------------------|
    |Windows      |SSH con cygwin (http://www.cygwin.com/) (GPL)    |
    |(cygwin)     |                                                 |
    |-------------+-------------------------------------------------|
    |Macintosh    |macSSH (http://www.macssh.com/) (GPL)            |
    |Clásico      |                                                 |
    |-------------+-------------------------------------------------|
    |Mac OS X     |OpenSSH; utiliza ssh en una aplicación de        |
    |             |terminal (GPL)                                   |
    +---------------------------------------------------------------+


%

6.9.5. Configuración ssh-agent

    Es seguro proteger su clave pública de acreditación con una frase
    de paso. Si no se ha asignado una frase de paso, utilice
    «ssh-keygen -p» para asignarla.

    Ubique su clave pública SSH (e.g. «~/.ssh/id_rsa.pub») en «~/.ssh
    /authorized_keys» en el equipo remoto utilizando una conexión al
    equipo remoto basada en la contraseña como se describe a
    continuación.

    $ ssh-agent bash
    $ ssh-add ~/.ssh/id_rsa
    Enter passphrase for /home/<username>/.ssh/id_rsa:
    Identity added: /home/<username>/.ssh/id_rsa (/home/<username>/.ssh/id_rsa)

    No se necesita contraseña remota desde aquí para el próximo
    orden.

    $ scp foo <nombre_de_usuario>@equipo.remoto:foo

    Pulse ^D para finalizar su sesión de agente ssh.

    Para el servidor X, el archivo de órdenes de inicio de Debian
    ejecuta el agente ssh como el proceso padre. Así solo necesita
    ejecutar ssh-add una vez. Para mayor información , lea ssh-agent
    (1) y ssh-add(1).

%

6.9.6. Apagar un sistemas remoto utilizando SSH

    Se necesita proteger el proceso que ejecuta «shutdown -h now»
    (consulte Sección 1.1.8, “Cómo apagar el sistema”) de la
    finalización de ssh utilizando la orden at(1) (consulte
    Sección 9.3.13, “Planificación una vez de las tareas”) como se
    muestra.

    # echo «shutdown -h now« | at now

    Otra forma de obtener el mismo resultado es ejecutar «shutdown -h
    now» en una sesión de screen(1) (consulte Sección 9.1, “El
    programa screen”).

%

6.9.7. Resolución de problemas de SSH

    Si tiene problemas, compruebe la configuración de los permisos de
    los archivos y ejecute ssh con la opción «-v».

    Si es usted superusuario y tiene problemas con el cortafuegos
    utilice la opción «-p» ; esto evita la utilización de los puertos
    del servidor entre 1 — 1023.

    Si las conexiones ssh a un sitio remoto de reprente deja de
    funcionar, puede ser que tenga que ser solucionado por el
    administrador de sistemas, comunmente un cambio de la
    «clave_de_equipo» durante el mantenimiento del sistema. Tras
    estar seguro de que nadie intenta suplantar al equipo remoto de
    algún modo inteligente, uno puede recuperar la conexión
    eliminando la entrada «clave_de_equipo» en «~/.ssh/known_hosts»
    del equipo local.

%

6.10. Servidores de aplicaciones en otras redes

    Aquí hay otros servidores de aplicaciones de red.

    Tabla 6.18. Relación de los servidores de aplicaciones de red

    +---------------------------------------------------------------+
    |     paquete     |popularidad|tamaño|protocolo|  descripción   |
    |-----------------+-----------+------+---------+----------------|
    |telnetd          |V:1, I:3   |115   |TELNET   |servidor TELNET |
    |-----------------+-----------+------+---------+----------------|
    |telnetd-ssl      |V:0, I:0   |170   |, ,      |, , (soporte    |
    |                 |           |      |         |SSL)            |
    |-----------------+-----------+------+---------+----------------|
    |nfs-kernel-server|V:38, I:79 |342   |NFS      |Compatición de  |
    |                 |           |      |         |archivos Unix   |
    |-----------------+-----------+------+---------+----------------|
    |                 |           |      |         |Compartición de |
    |samba            |V:102,     |16629 |SMB      |archivos e      |
    |                 |I:159      |      |         |impresoras en   |
    |                 |           |      |         |Windows         |
    |-----------------+-----------+------+---------+----------------|
    |                 |           |      |         |Compartición de |
    |                 |           |      |         |archivos e      |
    |netatalk         |V:2, I:3   |2077  |ATP      |impresoras de   |
    |                 |           |      |         |Apple/Mac       |
    |                 |           |      |         |(AppleTalk)     |
    |-----------------+-----------+------+---------+----------------|
    |proftpd-basic    |V:24, I:32 |488   |FTP      |Descarga de     |
    |                 |           |      |         |archivo general |
    |-----------------+-----------+------+---------+----------------|
    |apache2          |V:246,     |610   |HTTP     |Servidor web    |
    |                 |I:315      |      |         |general         |
    |-----------------+-----------+------+---------+----------------|
    |squid            |V:13, I:15 |8385  |, ,      |Servidor proxy  |
    |                 |           |      |         |web general     |
    |-----------------+-----------+------+---------+----------------|
    |squid3           |V:4, I:10  |240   |, ,      |, ,             |
    |-----------------+-----------+------+---------+----------------|
    |                 |           |      |         |Direcciones IP  |
    |bind9            |V:52, I:65 |1063  |DNS      |para otros      |
    |                 |           |      |         |equipos         |
    |-----------------+-----------+------+---------+----------------|
    |isc-dhcp-server  |V:18, I:54 |1471  |DHCP     |Dirección IP de |
    |                 |           |      |         |el cliente mismo|
    +---------------------------------------------------------------+


    El Protocolo de Sistema de Archivo Común de Internet (Common
    Internet File System Protocol, CIFS) es el mismo protocolo que
    Servidor de Mensajes de Bloque (Server Message Block, SMB) y se
    utiliza de forma generalizada en Microsoft Windows.

    Sugerencia
   
    Consulte Sección 4.5.2, “La actual gestión centralizada de
    sistemas” para la integración de los servidores de sistema.

    Sugerencia

    La resolución del nombre del equipo normalmente se realiza por
    medio del servidor de DNS. Para las direcciones IP del equipo
    asignadas de forma dinámica por DHCP, un DNS Dinámico puede ser
    configurado para la resolución de nombres utilizando bind9 y
    isc-dhcp-server como se describe en lapágina wiki de Debian sobre
    DDNS.

    Sugerencia

    La utilización de un servidor proxy como squid es muy eficiente
    para ahorrar ancho de banda ya que utiliza un servidor espejo
    local con todo el contenido del archivo Debian.

%

6.11. Otros clientes de aplicaciones de red

    Aquí están otro clientes de aplicaciones de red.

    Tabla 6.19. Relación de clientes de aplicaciones de red

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|protocolo|   descripción    |
    |---------------+-----------+------+---------+------------------|
    |netcat         |I:41       |16    |TCP/IP   |navaja suiza para |
    |               |           |      |         |TCP/IP            |
    |---------------+-----------+------+---------+------------------|
    |               |           |      |         |Binarios de la    |
    |               |           |      |         |capa de conexión  |
    |openssl        |V:794,     |1465  |SSL      |segura(SSL) y     |
    |               |I:993      |      |         |herramientas de   |
    |               |           |      |         |criptografía      |
    |               |           |      |         |asociadas         |
    |---------------+-----------+------+---------+------------------|
    |stunnel4       |V:5, I:17  |507   |, ,      |recubrimiento     |
    |               |           |      |         |universal SSL     |
    |---------------+-----------+------+---------+------------------|
    |telnet         |V:65, I:904|163   |TELNET   |cliente TELNET    |
    |---------------+-----------+------+---------+------------------|
    |telnet-ssl     |V:0, I:3   |210   |, ,      |, , (soporte SSL) |
    |---------------+-----------+------+---------+------------------|
    |nfs-common     |V:181,     |768   |NFS      |Compatición de    |
    |               |I:343      |      |         |archivos Unix     |
    |---------------+-----------+------+---------+------------------|
    |               |           |      |         |Cliente para la   |
    |               |           |      |         |compartición de   |
    |smbclient      |V:16, I:174|2016  |SMB      |archivos e        |
    |               |           |      |         |impresoras con MS |
    |               |           |      |         |Windows           |
    |---------------+-----------+------+---------+------------------|
    |               |           |      |         |Órdenes de montado|
    |cifs-utils     |V:32, I:123|299   |, ,      |y desmontado de   |
    |               |           |      |         |archivos remotos  |
    |               |           |      |         |MS Windows        |
    |---------------+-----------+------+---------+------------------|
    |ftp            |V:18, I:282|137   |FTP      |cliente FTP       |
    |---------------+-----------+------+---------+------------------|
    |lftp           |V:6, I:39  |2255  |, ,      |, ,               |
    |---------------+-----------+------+---------+------------------|
    |ncftp          |V:3, I:22  |1339  |, ,      |cliente FTP a     |
    |               |           |      |         |pantalla completa |
    |---------------+-----------+------+---------+------------------|
    |wget           |V:288,     |3477  |HTTP y   |descargas web     |
    |               |I:988      |      |FTP      |                  |
    |---------------+-----------+------+---------+------------------|
    |curl           |V:151,     |426   |, ,      |, ,               |
    |               |I:548      |      |         |                  |
    |---------------+-----------+------+---------+------------------|
    |axel           |V:0, I:4   |216   |, ,      |acelerador de     |
    |               |           |      |         |descargas         |
    |---------------+-----------+------+---------+------------------|
    |               |           |      |         |acelerador de     |
    |               |           |      |         |descargas con     |
    |aria2          |V:2, I:19  |1854  |, ,      |soporte para      |
    |               |           |      |         |BitTorrent y      |
    |               |           |      |         |Metalink          |
    |---------------+-----------+------+---------+------------------|
    |               |V:382,     |      |         |host(1) para      |
    |bind9-host     |I:948      |365   |DNS      |bind9, «Prioridad:|
    |               |           |      |         |estándar»         |
    |---------------+-----------+------+---------+------------------|
    |               |           |      |         |dig(1) para bind, |
    |dnsutils       |V:64, I:517|256   |, ,      |«Prioridad:       |
    |               |           |      |         |estándar»         |
    |---------------+-----------+------+---------+------------------|
    |isc-dhcp-client|V:231,     |686   |DHCP     |obtiene la        |
    |               |I:979      |      |         |dirección IP      |
    |---------------+-----------+------+---------+------------------|
    |ldap-utils     |V:14, I:75 |718   |LDAP     |obtiene datos del |
    |               |           |      |         |servidor LDAP     |
    +---------------------------------------------------------------+


%

6.12. Diagnóstico de los demonios del sistema

    El programa telnet permite la conexión manual a los demonios del
    sistema para evaluarlos.

    Para probar un servicio POP3 sencillo, intente lo siguiente

    $ telnet mail.ispname.net pop3

    Para la prueba del servicio POP3 con TLS/SSL activado por parte
    de algún ISP, necesitará activar TLS/SSL en el cliente de telnet
    mediante los paquetes telnet-ssl o openssl.

    $ telnet -z ssl pop.gmail.com 995

    $ openssl s_client -connect pop.gmail.com:995

    Los siguientes RFCs aportan el conocimiento necesario sobre cada
    uno de los demonios del sistema.

    Tabla 6.20. Relación de RFCs comúnes

    +---------------------------------------------------------------+
    |      RFC      |                  descripción                  |
    |---------------+-----------------------------------------------|
    |rfc1939 y      |servicio POP3                                  |
    |rfc2449        |                                               |
    |---------------+-----------------------------------------------|
    |rfc3501        |servicio IMAP4                                 |
    |---------------+-----------------------------------------------|
    |rfc2821        |servicio SMTP                                  |
    |(rfc821)       |                                               |
    |---------------+-----------------------------------------------|
    |rfc2822        |Formato de archivo de correo                   |
    |(rfc822)       |                                               |
    |---------------+-----------------------------------------------|
    |rfc2045        |Extensión de Correo de Internet Multipropósito |
    |               |(MIME)                                         |
    |---------------+-----------------------------------------------|
    |rfc819         |servicio DNS                                   |
    |---------------+-----------------------------------------------|
    |rfc2616        |servicio HTTP                                  |
    |---------------+-----------------------------------------------|
    |rfc2396        |definición de URI                              |
    +---------------------------------------------------------------+


    La utilización de los puertos esta recogida en «/etc/services».

Capítulo 7. El Sistema de ventanas X

    Aviso
   
    Este capítulo esta desactualizado ya que esta fundamentado en
    Debian 7.0 (Wheezy) publicado en 2013.

    El sistema de ventanas X en un sistema Debian está basado en el
    código de X.Org.

%

7.1. Paquetes importantes

    Existen unos pocos meta-paquetes, que se crean para facilitar la
    instalación.

    Tabla 7.1. Relación de meta-paquetes importantes del sistema de
    ventanas X

    +---------------------------------------------------------------+
    |   meta-paquete   |popularidad|tamaño|       descripción       |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |Bibiliotecas X, un       |
    |                  |           |      |servidor de X, un        |
    |xorg              |I:457      |52    |conjunto de tipos de     |
    |                  |           |      |letras y un grupo de     |
    |                  |           |      |clientes básicos de X y  |
    |                  |           |      |utilidades (metapaquete) |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |completo conjunto de     |
    |xserver-xorg      |V:66, I:492|238   |herramientas para el     |
    |                  |           |      |servidor de X y su       |
    |                  |           |      |configuración            |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |variado surtido de       |
    |xbase-clients     |I:26       |46    |clientes para X          |
    |                  |           |      |(meta-paquete)           |
    |------------------+-----------+------+-------------------------|
    |                  |V:372,     |      |estructura del sistema de|
    |x11-common        |I:755      |308   |archivos para el sistemas|
    |                  |           |      |de ventanas X            |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |documentación variada    |
    |xorg-docs         |I:6        |2036  |para el conjunto de      |
    |                  |           |      |programas de X.Org       |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |genera el menú de Debian |
    |menu              |V:54, I:197|1509  |para todas las           |
    |                  |           |      |aplicaciones que lo      |
    |                  |           |      |requieran                |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |convierte la estructura  |
    |menu-xdg          |V:31, I:109|27    |del menú Debian a la     |
    |                  |           |      |estructura del menú xdgde|
    |                  |           |      |freedesktop.org          |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |utilidades para integrar |
    |xdg-utils         |V:229,     |327   |el entorno de escritorio |
    |                  |I:521      |      |aportado por             |
    |                  |           |      |freedesktop.org          |
    |------------------+-----------+------+-------------------------|
    |                  |           |      |Entorno de escritorio    |
    |task-gnome-desktop|I:175      |9     |GNOME estándar           |
    |                  |           |      |(meta-paquete)           |
    |------------------+-----------+------+-------------------------|
    |task-kde-desktop  |I:66       |6     |Entorno de escritorio KDE|
    |                  |           |      |base (meta-paquete)      |
    |------------------+-----------+------+-------------------------|
    |task-xfce-desktop |I:106      |9     |Entorno de escritorio    |
    |                  |           |      |ligero Xfce(meta-paquete)|
    |------------------+-----------+------+-------------------------|
    |task-lxde-desktop |I:35       |9     |Entorno de escritorio    |
    |                  |           |      |ligero LXDE(meta-paquete)|
    |------------------+-----------+------+-------------------------|
    |                  |           |      |Fluxbox: paquete         |
    |fluxbox           |V:2, I:9   |3860  |altamente configurable y |
    |                  |           |      |gestor de ventanas X     |
    |                  |           |      |ligero de nivel bajo     |
    +---------------------------------------------------------------+


    Para aspectos básicos sobre el sistema X, consulte X(7) y the LDP
    XWindow-User-HOWTO.

%

7.2. Configurando el entorno de escritorio

    Un entorno de escritorio generalmente es una combinación de un
    gestor de ventanas X, un administrador de archivos y un conjunto
    de programas de utilidades.

    Usted puede configurar un entorno de escritorio completo como
    GNOME, KDE,Xfce, o LXDE, desde aptitude bajo el menú de tareas.

    Sugerencia

    El menú de tareas puede estar desincronizado con el último estado
    de transición de paquete en Debian en los entornos «inestable»/
    «en pruebas». En tal situación, usted necesita deseleccionar
    algunos meta-paquetes enumerados bajo el meú de tareas de 
    aptitude(8) para evitar conflictos entre paquetes. Cuando se
    encuentre deseleccionando los meta-paquetes, debe seleccionar
    ciertos paquetes que cumplen sus dependencias manualmente para
    evitar que sean borrados en forma automática.

    De forma alternativa, usted puede configurar un entorno de
    escritorio sencillo sólo con un gestor de ventanas X como
    Fluxbox.

    Para una relación de los gestores de ventanas y escritorios
    disponibles para el sistema X puede visitar la guía de gestores
    de ventanas para X..

%

7.2.1. Menú de Debian

    El sistema de menú de Debian aporta una interfaz general tanto
    para programas en modo texto como con interfaz gráfica mediante
    la orden update-menus(1) del paquete menu. Cada paquete instala
    la información de su menú en el directorio /usr/share/menu.
    Consulte «/usr/share/menu/README».

%

7.2.2. Menú de Freedesktop.org

    Cada paquete que cumpla con el sistema de menú de Freedesktop.org
    instala la información de sus menús según los archivos
    «*.desktop» en el directorio «/usr/share/applications». Los
    entornos de escritorio modernos que cumplen el estándar de
    Freedesktop.org utilizan esta información para generar sus menús
    usando el paquete xdg-utils. Consulte «/usr/share/doc/xdg-utils/
    README».

%

7.2.3. Menú de Freedesktop.org para el menú de Debian

    Para acceder al menú tradicional de Debian desde el menú de
    Freedesktop.org de acuerdo con el entorno de los gestores de
    ventanas como GNOME y KDE, debe instalar el paquete menu-xdg.

%

7.3. La relación servidor/cliente

    El sistema de ventanas X se activa como una combinación de un
    servidor y un cliente. El significado para los términos servidor
    y cliente con respecto a los términos local y remoto requiere una
    aclaración aquí.

    Tabla 7.2. Relación de la terminología para servidor/cliente

    +---------------------------------------------------------------+
    |   tipo   |                    descripción                     |
    |----------+----------------------------------------------------|
    |          |un programa que se ejecuta sobre un equipo local que|
    |Servidor X|se encuentra conectada a la pantalla del usuario y a|
    |          |dispositivos de entrada.                            |
    |----------+----------------------------------------------------|
    |Cliente X |un programa que se ejecuta en un equipo remota que  |
    |          |procesa los datos y llamadas al servidor X.         |
    |----------+----------------------------------------------------|
    |servidor  |un programa que se ejecuta en un equipo remoto que  |
    |de        |procesa los datos y las llamadas a los clientes.    |
    |aplicación|                                                    |
    |----------+----------------------------------------------------|
    |aplicación|un programa que se ejecuta sobre un equipo local que|
    |cliente   |se encuentra conectada a la pantalla del usuario y a|
    |          |dispositivos de entrada.                            |
    +---------------------------------------------------------------+


    Los servidores X modernos tienen la Extensión de Memoria
    Compartida del MIT y se comunican con los clientes locales X
    utilizando memoria local compartida. Esto circunda el canal de
    comunicación entre procesos de red transparente de Xlib y mejora
    el desempeño para imagenes grandes.

%

7.4. El servidor X

    Consulte xorg(1) para información sobre el servidor X.

%

7.4.1. La (re)configuración del servidor X

    Lo siguiente (re)configura un servidor X.

    # dpkg-reconfigure --priority=low x11-common

    Nota

    Los núcleos recientes de Linux tienen un soporte de dispositivos
    de entreada y gráficos bueno con DRM, KMS y udev. El servidor X
    se ha reescrito para utilizalos. Así /etc/X11/xorg.conf no está
    en su sistema. Estos parámetros son configurados por el núcleo.
    Consulte fb/modedb.txt» en la documentación del núcleo de Linux.

    Para la más alta resolución en un monitor CRT, es una buena idea
    configurar la tasa de refresco al valor más alto que su monitor
    puede gestionar (85 Hz es lo ideal, 75 Hz está bien) con el
    objetivo de reducir el parpadeo. Para un monitor LCD, la taza de
    refresco estándar más baja (60 Hz) de forma general es la
    adecuada dada su baja respuesta.

    Nota
   
    Sea cuidadoso en no usar tasas de refresco demasiado altas que
    puedan causar errores graves a nivel del hardware en su monitor.

%

7.4.2. Métodos de conexión al servidor X

    Existen muchas maneras de obtener una instancia del «Servidor X«
    (del lado de la visualización) para aceptar conexiones de un
    «cliente de X« (del lado de la aplicación).

    Tabla 7.3. Relación de los métodos de conexión al servidor X

    +----------------------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|usuario |cifrado|   método    |utilización|
    |              |           |      |        |       |             | correcta  |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |xbase-clients |I:26       |46    |sin     |no     |orden xhost  |obsoleto   |
    |              |           |      |revisar |       |             |           |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |             |conexión   |
    |xbase-clients |I:26       |46    |revisado|no     |orden xauth  |local por  |
    |              |           |      |        |       |             |medio de   |
    |              |           |      |        |       |             |tuberías   |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |V:803,     |      |        |       |             |conexión   |
    |openssh-client|I:996      |4298  |revisado|sí     |orden ssh -X |remota por |
    |              |           |      |        |       |             |red        |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |Gestor de    |conexión   |
    |gdm3          |V:165,     |5101  |revisado|no     |visualización|local por  |
    |              |I:229      |      |        |(XDMCP)|de GNOME     |medio de   |
    |              |           |      |        |       |             |tuberías   |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |Gestor de    |conexión   |
    |sddm          |V:53, I:95 |1742  |revisado|no     |visualización|local por  |
    |              |           |      |        |(XDMCP)|de KDE       |medio de   |
    |              |           |      |        |       |             |tuberías   |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |Gestor de    |conexión   |
    |xdm           |V:3, I:6   |686   |revisado|no     |visualización|local por  |
    |              |           |      |        |(XDMCP)|de X         |medio de   |
    |              |           |      |        |       |             |tuberías   |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |Gestor de    |conexión   |
    |wdm           |V:31, I:284|2289  |revisado|no     |visualización|local por  |
    |              |           |      |        |(XDMCP)|de           |medio de   |
    |              |           |      |        |       |WindowMaker  |tuberías   |
    |--------------+-----------+------+--------+-------+-------------+-----------|
    |              |           |      |        |       |             |conexión   |
    |              |           |      |        |       |Gestor de    |SSH remota |
    |ldm           |V:0, I:0   |436   |revisado|sí     |visualización|por red    |
    |              |           |      |        |       |de LTSP      |(cliente   |
    |              |           |      |        |       |             |ligero)    |
    +----------------------------------------------------------------------------+


    Aviso

    No use conexiones TCP/IP remotas en redes inseguras para
    conectarse a un servidor X a menos que tenga una muy buena razón
    a menos que utilice cifrado. Un «socket« TCP/IP remoto sin cifrar
    es propenso a un ataque de tipo eavesdropping y se encuentra
    deshabilitado por omisión en el sistema Debian. Utilice «ssh -X».

    Aviso

    No use conexiones XDMCP en una red insegura. Envían los datos por
    medio de UDP/IP sin cifrar, siendo propenso a un ataque de tipo 
    eavesdropping.

    Sugerencia
   
    LTSP significa Linux Terminal Server Project.

%

7.5. Inicio del Sistema de Ventanas X

    El Sistema de Ventanas X habitualmente empieza como una sesión X
    la cual es una combinación de un servidor X y los clientes X
    conectados. Para un sistema de escritorio normal, ambos se
    ejecutan en la propia estación de trabajo.

    La sesión X se inicia de una de las siguientes maneras.

      * orden de inicio startx desde la línea de órdenes
   
      * One of the X display manager daemon programs *dm started by
        systemd based on the dependency of "graphical.target".

    Sugerencia

    El archivo de órdenes de inicio del demonio de gestión de
    visualización comprueba el contenido del archivo «/etc/X11/
    default-display-manager»antes de ejecutarse realmente a si
    mismos. Esto asegura que solo un programa de demonio gestor de
    visualización X esta activo.

    Sugerencia

    Consulte Sección 8.4.5, “Especificación de la configuración
    regional en las Ventanas X” sobre las variables del entorno
    inicial del gestor de visualización X.

    Fundamentalmente, todos estos programas ejecutan el archivo de
    órdenes «/etc/X11/Xsession». Entonces el archivo de órdenes «/etc
    /X11/Xsession» lleva a cabo la acción de run-parts(8) para
    ejecutar los archivos de órdenes en el directorio «/etc/X11/
    Xsession.d/». Esto es fundamentalemte una ejecución del primer
    programa el cual se encuentra en la orden siguiente por la orden
    interna exec.

     1. Si está definido, el archivo de órdenes tiene como parámetro
        de «/etc/X11/Xsession por el gestor de visualización X.

     2. Si está definido el archivo de órdenes «~/.xsession» o «~
        /.Xsession».
   
     3. Si está definido, la orden «/usr/bin/x-session-manager».

     4. Si está definido la orden «/usr/bin/x-window-manager».

     5. Si está definido, la orden «/usr/bin/x-terminal-emulator».

    Este proceso tiene en cuenta el contenido de «/etc/X11/
    Xsession.options». El programa exacto al que apuntan estas
    órdenes «/usr/bin/x-*», se determina por el sistema de
    alternativas de Debian y se cambia por medio de
    «update-alternatives --config x-session-manager», etc.

    Para más detalles consulte Xsession(5).

%

7.5.1. Inicio de sesión con gdm3

    gdm3(1) le permite seleccionar desde su menú el tipo de sesión (o
    entorno de escritorio: Sección 7.2, “Configurando el entorno de
    escritorio”) y lenguaje (o configuración regional: Sección 8.4,
    “Configuración regional”). Mantiene el valor seleccionado por
    defecto en «~/.dmrc» como el siguiente.

    [Desktop]
    Session=default
    Language=ja_JP.UTF-8

%

7.5.2. Configuración de la sesión X (método clásico)

    En un sistema donde «/etc/X11/Xsession.options» contiene una
    línea «allow-user-xsession» sin estar precedida de caracteres «#
    », cualquier usuario que define «~/.xsession» o «~/.Xsession» es
    capaz de configurar la acción de «/etc/X11/Xsession» por la
    sobreescritura completa del código del sistema. La última orden
    en el archivo«~/.xsession» podría usar la llamada «exec
    some-window/session-manager» para iniciar su gestor de sesión/
    ventanas X favorito.

    Si esta funcionalidad es usada, la selección del gestor (DM) de
    visualización (o acceso), gestor de sesión o gestor de ventanas
    (WM) del sistema será ignorada.

%

7.5.3. Configuración de la sesión X (método nuevo)

    Aquí están los nuevos métodos para la configuración de la sesión
    X sin sobreescribir completamente el código del sistema como se
    vió anteriormente.

      * El gestor de visualización gdm3 puede seleccionar una sesión
        especifica y asignarla como parámetro de «/etc/X11/Xsession».

          + Los archivos «/etc/profile», «~/.profile», «/etc/
            xprofile» y «~/.xprofile» son ejecutador como parte del
            proceso de inicio de gdm3.

      * El archivo «~/.xsessionrc» se ejecuta como parte del proceso
        de inicio (independientemente del escritorio).

          + «#allow-user-xsession» en «/etc/X11/Xsession.options» no
            restringe la ejecución del archivo «~/.xsessionrc».

      * El archivo «~/.gnomerc» se ejecuta como parte del proceso de
        inicio (únicamente en el escritorio GNOME).

    La selección del gestor (DM) de visualización (o acceso), el
    gestor de sesión o el gestor de ventanas (VM) por la utilidad del
    sistema se respeta.

    Estos archivos de configuración podrían no contener en ellos
    «exec ...» o exit».

%

7.5.4. Conexión de un cliente X remoto por medio de SSH

    El uso de «ssh -X» permite una conexión segura desde un servidor
    X local a un servidor de aplicaciones remoto.

    Si quiere no usar la opción de la línea de órdenes «-X», asigne
    «yes» a la entrada «X11Forwarding» en «/etc/ssh/sshd_config» del
    equipo remoto.

    Inicio del servidor X en el equipo local.

    Abra una xterm en el equipo local.

    Ejecute ssh(1) para establecer una conexión con el sitio remoto
    como se muestra.

    localname @ localhost $ ssh -q -X nombre_de_acceso@equipo_remoto.dominio
    Password:

    Ejecute una orden de aplicación X, p. ej. «gimp», en el sitio
    remoto como se muestra.

    nombre_de_acceso @ equipo_remoto $ gimp &

    Este método puede mostrar la salida de un cliente remoto X como
    si se estuviera conectado localmente conectado a través de un
    «socket« de dominio UNIX local.

%

7.5.5. Seguridad de un terminal X a través de Internet

    La securización de un terminal X a través de Internet, el cual
    muestra remotamente la ejecución de un entorno de escritorio X,
    puede ser alcanzado facilmente utilizando un paquete
    especializado como ldm. Su equipo local se convierte en un
    cliente ligero del servidor de aplicación remoto conectado a
    través de SSH.

%

7.6. Tipos de letras en las ventanas X

    Fontconfig 2.0 fue creado en 2002 para proporcionar una
    biblioteca independiente de la distribución para la configuración
    y la personalización del acceso a los tipos de letras. Debian
    tras squeeze utiliza Fontconfig 2.0 para la configuración de sus
    tipos de letras.

    Los tipos de letras que soporta el Sistema de Ventanas X puede
    resumirse como sigue.

      * Sistema históricos de soporte de tipos de letras del lado de
        servidor X

          + El núcleo del sistema de tipos de letras X11 original
            aporta compatibilidad hacia atras para versiones antiguas
            aplicaciones cliente X.

          + El núcleo de tipos de letras X11 original son instalados
            con el servidor X.

      * Sistema de soporte de tipos de letras del lado del cliente X
        moderno

          + El sistema moderno X opera con todos los tipos de letras
            que se enumeran a continuación (Sección 7.6.1, “Tipos de
            letras fundamentales”, Sección 7.6.2, “Tipos de letra
            adicionales” y Sección 7.6.3, “Tipos de letra CJK”) con
            características avanzadas como «anti-aliasing«.

          + Xft 2.0 conecta las aplicaciones modernas X como las de
            GNOME, KDE y LibreOffice con la biblioteca FreeType 2.0.

          + FreeType 2.0 aporta bibliotecas que permiten agrandar los
            tipos de letras.

          + Fontconfig aporta la resolución de la especificación del
            tipo de letra para Xft 2.0. Consulte para su
            configuración fonts.conf(5).

          + Todas las aplicaciones modernas X que utilizan Xft 2.0
            pueden comunicarse con el servidor X moderno utilizando
            la Extensión de Representación X (X Rendering Extension).

          + La Extensión de Representación X mueve el acceso al tipo
            de letra y glifo de la generación de la imagen desde el
            servidor X al cliente X.

    Tabla 7.4. Tabla de paquetes de soporte a los sistemas de tipos
    de letras de ventanas X

    +---------------------------------------------------------------+
    |     paquete     |popularidad|tamaño|       descripción        |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |Utilidades de Programas   |
    |xfonts-utils     |V:66, I:542|415   |para tipos de letras de   |
    |                 |           |      |Sistema de Ventanas X     |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |Xft, una biblioteca que   |
    |libxft2          |V:143,     |122   |conecta aplicaciones X con|
    |                 |I:662      |      |la biblioteca de agrandar |
    |                 |           |      |tipos de letras FreeType  |
    |-----------------+-----------+------+--------------------------|
    |                 |V:426,     |      |Biblioteca de agrandar    |
    |libfreetype6     |I:994      |896   |tipos de letras FreeType  |
    |                 |           |      |2.0                       |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |Fontconfig, biblioteca de |
    |fontconfig       |V:354,     |583   |configuración de tipos de |
    |                 |I:776      |      |letras genéricos — soporte|
    |                 |           |      |binarios                  |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |Fontconfig, biblioteca de |
    |fontconfig-config|V:367,     |442   |configuración de tipos de |
    |                 |I:871      |      |letras genéricos — datos  |
    |                 |           |      |de configuración          |
    +---------------------------------------------------------------+


    Puede comprobar la configuración de los tipos de letras como se
    muestra.

      * ruta al núcleo X11 de los tipos de letras «xset q»

      * «fc-match» tipos de letras por defecto para fontconfig

      * «fc-list» para los tipos de letras disponibles de fontconfig

    Sugerencia

    «The Penguin and Unicode« es un buen resumen del Sistema de
    Ventanas X moderno. Otra documentación en http://unifont.org/
    puede aportar información interesante sobre los tipo de letra
    Unicode, software que habilita Unicode, internacionalización y
    aspectos de usabilidad de Unicode en sistemas operativos free/
    libres/fuentes abiertas (FLOSS).

%

7.6.1. Tipos de letras fundamentales

    Existen dos familias fundamentales de tipos de letra para
    equipos.

      * Tipos de letra de mapas de bit (buenos para bajas
        resoluciones)
   
      * Tipos de letra de contorno/trazos (buenos para altas
        resoluciones)

    Mientras que el escalado de tipos de letra de mapas de bit
    produce una imagen desenfocada, el escalado de tipos de letra de
    trazo produce imágenes suaves.

    Los tipos de letra de mapas de caracteres de un sistema Debian
    normalmente son aportados por los comprimidos archivos de tipos
    de letra X11 pcf teniendo como extensión del archivo «.pcf.gz».

    Los tipo de letra de trazo en el sistema Debian son aportados por
    como se muestra.

      * Archivos de tipos de letra Tipo 1 PostScript teniendo como
        extensión del archivo «.pfb» (archivo binario del tipo de
        letra) y «.afm» (archivo de métricas del tipo de letra).

      * Los archivos del tipos de letra TrueType (o OpenType)
        normalmente tienen una extension «.ttf».

    Sugerencia
   
    OpenType es un intento de sustituir tanto TrueType como Tipo
    1PostScript.

    Tabla 7.5. Tabla de correspondencia de los tipos de letra Tipo 1
    PostScript

    +----------------------------------------------------------------------------+
    |paquete del|           |      | tipo de  |tipo de |tipo de letra|fuente del |
    |  tipo de  |popularidad|tamaño|  letra   | letra  |  monospace  |  tipo de  |
    |   letra   |           |      |sans-serif| serif  |             |   letra   |
    |-----------+-----------+------+----------+--------+-------------+-----------|
    |PostScript |N/A        |N/A   |Helvetica |Times   |Courier      |Adobe      |
    |-----------+-----------+------+----------+--------+-------------+-----------|
    |           |           |      |Nimbus    |Nimbus  |             |URW (tamaño|
    |gsfonts    |I:599      |4439  |Sans L    |Roman   |Nimbus Mono L|compatible |
    |           |           |      |          |No9 L   |             |con Adobe) |
    |-----------+-----------+------+----------+--------+-------------+-----------|
    |           |           |      |          |        |             |Tipo de    |
    |           |           |      |          |        |             |letra X con|
    |           |           |      |Nimbus    |Nimbus  |             |soporte al |
    |gsfonts-x11|I:82       |95    |Sans L    |Roman   |Nimbus Mono L|tipo de    |
    |           |           |      |          |No9 L   |             |letra Tipo |
    |           |           |      |          |        |             |1          |
    |           |           |      |          |        |             |PostScript.|
    |-----------+-----------+------+----------+--------+-------------+-----------|
    |           |           |      |          |        |             |URW        |
    |           |           |      |Free      |Free    |             |extendido  |
    |t1-cyrillic|I:19       |4878  |Helvetian |Times   |Free Courier |(tamaño    |
    |           |           |      |          |        |             |compatible |
    |           |           |      |          |        |             |con Adobe) |
    |-----------+-----------+------+----------+--------+-------------+-----------|
    |           |           |      |          |        |             |tipos de   |
    |           |           |      |          |        |             |letra      |
    |           |           |      |          |        |             |escalable  |
    |           |           |      |          |        |             |PostScript |
    |lmodern    |V:13, I:113|33270 |LMSans*   |LMRoman*|LMTypewriter*|y OpenType |
    |           |           |      |          |        |             |basados en |
    |           |           |      |          |        |             |equipos    |
    |           |           |      |          |        |             |modernos   |
    |           |           |      |          |        |             |(desde TeX)|
    +----------------------------------------------------------------------------+


    Tabla 7.6. Tabla de correspondencia de los tipos de letra TrueType

    +-------------------------------------------------------------------------------------------+
    |                         |           |      | tipo de  | tipo de  | tipo de  | fuente del  |
    |paquete del tipo de letra|popularidad|tamaño|  letra   |  letra   |  letra   |tipo de letra|
    |                         |           |      |sans-serif|  serif   |monospace |             |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |Microsoft    |
    |                         |           |      |          |          |          |(tamaño      |
    |                         |           |      |          |Times New |Courier   |compatible   |
    |ttf-mscorefonts-installer|V:1, I:64  |92    |Arial     |Roman     |New       |con Adobe)   |
    |                         |           |      |          |          |          |(Instala     |
    |                         |           |      |          |          |          |datos no     |
    |                         |           |      |          |          |          |libre)       |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |proyecto de  |
    |                         |           |      |          |          |          |Tipos de     |
    |                         |           |      |          |          |          |Letra        |
    |fonts-liberation         |I:469      |2093  |Liberation|Liberation|Liberation|Liberation   |
    |                         |           |      |Sans      |Serif     |Mono      |(tamaño      |
    |                         |           |      |          |          |          |compatible   |
    |                         |           |      |          |          |          |con          |
    |                         |           |      |          |          |          |Microsoft)   |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |GNU freefont |
    |                         |           |      |          |          |          |(tamaño      |
    |fonts-freefont-ttf       |V:50, I:276|6656  |FreeSans  |FreeSerif |FreeMono  |compatible   |
    |                         |           |      |          |          |          |con          |
    |                         |           |      |          |          |          |Microsoft)   |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |DejaVu,      |
    |                         |           |      |          |          |          |Bitstream    |
    |fonts-dejavu             |I:478      |39    |DejaVu    |DejaVu    |DejaVu    |Vera con     |
    |                         |           |      |Sans      |Serif     |Sans Mono |cobertura de |
    |                         |           |      |          |          |          |Unicode      |
    |                         |           |      |          |          |          |coverage     |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |DejaVu,      |
    |                         |           |      |          |          |          |Bitstream    |
    |                         |           |      |          |          |          |Vera con     |
    |                         |           |      |          |          |          |cobertura de |
    |                         |V:220,     |      |DejaVu    |DejaVu    |DejaVu    |Unicode      |
    |fonts-dejavu-core        |I:809      |2954  |Sans      |Serif     |Sans Mono |(sans,       |
    |                         |           |      |          |          |          |sans-bold,   |
    |                         |           |      |          |          |          |serif,       |
    |                         |           |      |          |          |          |serif-bold,  |
    |                         |           |      |          |          |          |mono,        |
    |                         |           |      |          |          |          |mono-bold)   |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |DejaVu,      |
    |                         |           |      |          |          |          |Bitstream    |
    |                         |           |      |          |          |          |Vera con     |
    |                         |           |      |          |          |          |cobertura de |
    |fonts-dejavu-extra       |I:516      |7493  |N/A       |N/A       |N/A       |Unicode      |
    |                         |           |      |          |          |          |(oblique,    |
    |                         |           |      |          |          |          |italic,      |
    |                         |           |      |          |          |          |bold-oblique,|
    |                         |           |      |          |          |          |bold-italic, |
    |                         |           |      |          |          |          |condensed)   |
    |-------------------------+-----------+------+----------+----------+----------+-------------|
    |                         |           |      |          |          |          |GNU Unifont, |
    |                         |           |      |          |          |          |con todos los|
    |                         |           |      |          |          |          |códigos de   |
    |                         |           |      |          |          |          |caracteres   |
    |                         |           |      |          |          |          |imprimibles  |
    |ttf-unifont              |I:21       |21    |N/A       |N/A       |unifont   |en Unicode   |
    |                         |           |      |          |          |          |5.1 Básico   |
    |                         |           |      |          |          |          |Plano        |
    |                         |           |      |          |          |          |Multilingue  |
    |                         |           |      |          |          |          |(Basic       |
    |                         |           |      |          |          |          |Multilingual |
    |                         |           |      |          |          |          |Plane, BMP)  |
    +-------------------------------------------------------------------------------------------+


    Sugerencia
   
    Tipos de letra DejaVu basados en el superconjunto de tipos de
    letra Bitstream Vera.

%

7.6.2. Tipos de letra adicionales

    aptitude(8) le ayudará a encontrar fácilmente tipos de letra
    adicionales.

      * La relación de paquetes ordenada se encuentra en «Tareas« →
        «Ubicación«

      * La relación de paquetes de tipos de letra puede ser filtrada
        con expresiones regulares en debtag: «~Gmade-of::data:font»

      * La relación de paquetes de los tipos de letra BDF (mapas de
        bits) puede ser filtrada por el nombre del paquete:
        «~nxfonts-»

      * La relación de paquetes de tipos de letra TrueType (de tipo
        trazo) puede ser filtrada por la expresión regular del nombre
        del paquete: «~nttf-|~nfonts-»

    Ya que los tipos de letra Libres algunas veces ofrecen
    limitaciones, instalar o compartir tipos de letra TrueType
    comerciales puede ser una opción para los usuarios de Debian.
    Para que este proceso sea más fácil para el usuario se han creado
    los paquetes correspondientes.

      * mathematica-fonts
   
      * fonts-mscorefonts-installer

    Dispone de un conjunto importante de tipos de letra TrueType al
    precio de contaminar su sistema Libre con tipos de letra no
    libres.

%

7.6.3. Tipos de letra CJK

    Aquí están algunos conceptos clave de los tipos de letra de
    caracteres CJK.

    Tabla 7.7. Tabla de palabras clave de los nombes de los tipos de
    letra CJK para indicar el tipo del tipo de letra

    +---------------------------------------------------------------+
    | tipo del  | Nombre del tipo |Nombre del tipo| Nombre del tipo |
    |  tipo de  |de letra japonés |de letra chino |de letra coreano |
    |   letra   |                 |               |                 |
    |-----------+-----------------+---------------+-----------------|
    |sans-serif |gothic, ゴチック |hei, gothic    |dodum, gulim,    |
    |           |                 |               |gothic           |
    |-----------+-----------------+---------------+-----------------|
    |serif      |mincho, 明朝     |song, ming     |batang           |
    +---------------------------------------------------------------+


    El nombre de los tipos de letras como «VL PGothic« con la «P« es
    un tipo de letra proporcional el cual corresponde al tipo de
    letra ««VL Gothic« con la anchura modificada.

    Por ejemplo, la tabla de códigos Shift_JIS incluye 7070
    caracteres. Pueden ser agrupados como se muestra.

      * JIS X 0201 caracteres de un único byte (191 caracteres,
        conocidos por el alias de caracteres de la mitad de anchura)
   
      * JIS X 0208 caracteres de doble byte (6879 caracteres,
        conocidos como caracteres de anchura completa)

    Los caracteres de doble byte ocupan el doble de ancho en las
    terminales de consola los cuales utilizan tipos de letra de ancho
    modificado CJK. Para evitar este tipo de situaciones los tipos de
    letra de mapas de bits Hanzi (HBF) File con la extensión del
    archivo «.hbf» puede ser desplegados para los tipos de letras que
    contienen caracteres de un único byte y de doble byte.

    Con el fin de ahorrar el espacio de los archivos de los tipos de
    letra TrueType, se pueden utilizar los archivos de colección de
    tipos de letras TrueType con la extensión de archivo «.ttc».

    Para cubrir el complicado espacio de codificación de caracteres,
    el tipo de letra Tipo 1 CID clave PostScript es utilizado con los
    archivos CMAP empezando los mismos con «%!PS-Adobe-3.0
    Resource-CMap». Raramente se utiliza pa la visualización normal
    de X pero si para visualizar PDS. (consulte Sección 7.7.2,
    “aplicaciones de utilidades X”).

    Sugerencia

    Debido a la unificación Han unification los múltiples glifos se
    esperan para algunos puntos de codificación Unicode. Unos de los
    más molestos son «U+3001 IDEOGRAPHIC COMMA« y «U+3002 IDEOGRAPHIC
    FULL STOP« cuya posición del carácter cambia entre paises CJK.
    Configurando la prioridad al tipo de letra centrado japones sobre
    el chino utilizando «~/.fonts.conf» puede dejar de ser molesto
    para los japoneses.

7.7. Aplicaciones X

%

7.7.1. Aplicaciones de oficna X

    Aquí esta una relación de las aplicaciones fundamentales de
    oficina (LO se refiere a LibreOffice).

    Tabla 7.8. Relación de las aplicaciones X fundamentales de
    oficina

    +---------------------------------------------------------------+
    |                   |           |tamaño |     |                 |
    |      paquete      |popularidad|  del  |tipo |   descripción   |
    |                   |           |paquete|     |                 |
    |-------------------+-----------+-------+-----+-----------------|
    |libreoffice-writer |V:188,     |39333  |LO   |procesador de    |
    |                   |I:441      |       |     |textos           |
    |-------------------+-----------+-------+-----+-----------------|
    |libreoffice-calc   |V:188,     |32973  |LO   |hoja de cálculo  |
    |                   |I:436      |       |     |                 |
    |-------------------+-----------+-------+-----+-----------------|
    |libreoffice-impress|V:176,     |9934   |LO   |presentación     |
    |                   |I:433      |       |     |                 |
    |-------------------+-----------+-------+-----+-----------------|
    |libreoffice-base   |V:145,     |7473   |LO   |gestión de bases |
    |                   |I:325      |       |     |de datos         |
    |-------------------+-----------+-------+-----+-----------------|
    |                   |           |       |     |editor de        |
    |libreoffice-draw   |V:177,     |14600  |LO   |gráficos         |
    |                   |I:434      |       |     |vectoriales      |
    |                   |           |       |     |(dibujo)         |
    |-------------------+-----------+-------+-----+-----------------|
    |                   |V:174,     |       |     |editor matemático|
    |libreoffice-math   |I:437      |1963   |LO   |de fórmulas/     |
    |                   |           |       |     |ecuaciones       |
    |-------------------+-----------+-------+-----+-----------------|
    |abiword            |V:1, I:12  |5141   |GNOME|procesador de    |
    |                   |           |       |     |textos           |
    |-------------------+-----------+-------+-----+-----------------|
    |gnumeric           |V:6, I:21  |9933   |GNOME|hoja de cálculo  |
    |-------------------+-----------+-------+-----+-----------------|
    |                   |           |       |     |editor de        |
    |gimp               |V:68, I:341|22313  |GTK  |gráficos de mapas|
    |                   |           |       |     |de bits (Pintura)|
    |-------------------+-----------+-------+-----+-----------------|
    |                   |           |       |     |editor de        |
    |inkscape           |V:55, I:209|84823  |GNOME|gráficos         |
    |                   |           |       |     |vectoriales      |
    |                   |           |       |     |(dibujo)         |
    |-------------------+-----------+-------+-----+-----------------|
    |                   |           |       |     |editor de        |
    |dia                |V:5, I:31  |3727   |GTK  |diagramas de     |
    |                   |           |       |     |flujos y otros   |
    |                   |           |       |     |diagramas        |
    |-------------------+-----------+-------+-----+-----------------|
    |planner            |V:0, I:5   |1146   |GNOME|gestión de       |
    |                   |           |       |     |proyectos        |
    |-------------------+-----------+-------+-----+-----------------|
    |calligrawords      |V:0, I:7   |5717   |KDE  |procesador de    |
    |                   |           |       |     |textos           |
    |-------------------+-----------+-------+-----+-----------------|
    |calligrasheets     |V:0, I:6   |10890  |KDE  |hoja de cálculo  |
    |-------------------+-----------+-------+-----+-----------------|
    |calligrastage      |V:0, I:5   |5102   |KDE  |presentación     |
    |-------------------+-----------+-------+-----+-----------------|
    |calligraplan       |V:0, I:2   |15342  |KDE  |gestión de       |
    |                   |           |       |     |proyectos        |
    |-------------------+-----------+-------+-----+-----------------|
    |kexi               |V:0, I:2   |7576   |KDE  |gestión de bases |
    |                   |           |       |     |de datos         |
    |-------------------+-----------+-------+-----+-----------------|
    |                   |           |       |     |editor de        |
    |karbon             |V:0, I:7   |3473   |KDE  |gráficos         |
    |                   |           |       |     |vectoriales      |
    |                   |           |       |     |(dibujo)         |
    +---------------------------------------------------------------+


%

7.7.2. aplicaciones de utilidades X

    Aqui esta la relación de aplicaciones de utilidades fundamentales
    que conozco.

    Tabla 7.9. Relación de aplicaciones de utilidades X fundamentales

    +---------------------------------------------------------------+
    |         |           |tamaño |     |                           |
    | paquete |popularidad|  del  |tipo |        descripción        |
    |         |           |paquete|     |                           |
    |---------+-----------+-------+-----+---------------------------|
    |evince   |V:116,     |954    |GNOME|visor de documentos (pdf)  |
    |         |I:329      |       |     |                           |
    |---------+-----------+-------+-----+---------------------------|
    |okular   |V:46, I:118|14646  |KDE  |visor de documentos (pdf)  |
    |---------+-----------+-------+-----+---------------------------|
    |         |           |       |     |gestión de bibliotecas y   |
    |calibre  |V:9, I:36  |54876  |KDE  |conversor de libros        |
    |         |           |       |     |electrónicos               |
    |---------+-----------+-------+-----+---------------------------|
    |fbreader |V:2, I:15  |3074   |GTK  |lector de libros           |
    |         |           |       |     |electrónicos               |
    |---------+-----------+-------+-----+---------------------------|
    |         |           |       |     |Gestor de información      |
    |evolution|V:31, I:229|475    |GNOME|personal (trabajo en grupo |
    |         |           |       |     |y correo electrónico)      |
    |---------+-----------+-------+-----+---------------------------|
    |         |           |       |     |Gestor de información      |
    |kontact  |V:1, I:16  |2152   |KDE  |personal (trabajo en grupo |
    |         |           |       |     |y correo electrónico)      |
    |---------+-----------+-------+-----+---------------------------|
    |scribus  |V:2, I:23  |30375  |KDE  |editor de diseño de páginas|
    |         |           |       |     |de escritorio              |
    |---------+-----------+-------+-----+---------------------------|
    |glabels  |V:0, I:4   |1326   |GNOME|editor de etiquetas        |
    |---------+-----------+-------+-----+---------------------------|
    |gnucash  |V:3, I:12  |32304  |GNOME|finanzas personales        |
    |---------+-----------+-------+-----+---------------------------|
    |homebank |V:0, I:3   |1044   |GTK  |finanzas personales        |
    |---------+-----------+-------+-----+---------------------------|
    |kmymoney |V:0, I:2   |12036  |KDE  |finanzas personales        |
    |---------+-----------+-------+-----+---------------------------|
    |shotwell |V:19, I:223|6451   |GTK  |organizador de fotos       |
    |         |           |       |     |digitales                  |
    |---------+-----------+-------+-----+---------------------------|
    |xsane    |V:17, I:173|2346   |GTK  |interfaz de usuario de     |
    |         |           |       |     |escáner                    |
    +---------------------------------------------------------------+


    Atención

    El paquete poppler-data (que anteriormente no era libre, consulte
    Sección 11.4.1, “Ghostscript”) requiere ser instalado para los
    programas evince y okular que permiten visualizar documentos PDF
    CJK utilizando datos Cmap (Sección 7.6.3, “Tipos de letra CJK”).

    Nota

    La instalación de software como scribus (KDE) en el entorno de
    escritorio GNOME es correcta ya que la funcionalidad
    correspondiente no esta disponible en el entorno de escritorio
    GNOME. Pero la instalación de demaniados paquetes con
    funcionalidades solapadas desordenará su menú.

7.8. La trivialidad X

%

7.8.1. Portapapeles

    La selección de un ratón de tres botones es una funcionalidad
    intrinseca del portapapeles en las X (consulte Sección 1.4.4,
    “Operaciones con el ratón al estilo Unix”).

    Sugerencia
   
    La combinación «Shift-Insert« puede funcionar como un equivalente
    de la pulsación del botón del medio del ratón.

    Tabla 7.10. Relación de los programas fundamentales X de
    selección

    +---------------------------------------------------------------+
    |paquete|popularidad|tamaño del|tipo|        descripción        |
    |       |           | paquete  |    |                           |
    |-------+-----------+----------+----+---------------------------|
    |xsel   |V:10, I:44 |59        |X   |interfaz de orden en línea |
    |       |           |          |    |para las selecciones X     |
    |-------+-----------+----------+----+---------------------------|
    |xclip  |V:9, I:49  |64        |X   |interfaz de orden en línea |
    |       |           |          |    |para las selecciones X     |
    +---------------------------------------------------------------+


    Los entornos de escritorio modernos (GNOME, KDE, …) tienen
    diferentes sistemas portapapeles para cortar, copiar y pegar
    utilizando el botón izquierda del botón y diferentes teclas
    (CTRL-X, CRTL-C, and CTRL-V).

%

7.8.2. Mapa de teclas y punteros asignados en X

    xmodmap(1) es una utilidad para cambiar el mapa del teclado y los
    punteros en el sistema de ventanas X. Para obtener el código de
    la tecla ejecute xev(1) en un interfaz X y pulse las teclas. Para
    tener el significado de keysym, mire en el interior de la
    definición de la MACRO en el archivo «/usr/include/X11/
    keysymdef.h» (paquete x11proto-core-dev). Todas las entradas «#
    define» en este archivo se llaman como «XK_» anteponiendo a los
    nombres keysym.

%

7.8.3. Clientes X clásicos

    Los clientes de programas X más tradicionales, como xterm(1),
    pueden iniciarse con una seríe de parámetros desde la línea de
    órdenes para configurar su geometría, tipo de letra y pantalla.

    También utilizan la base de datos de recursos X con el fin de
    configurar su apariencia. Los valores por defecto del ancho del
    sistema de los recursos X son almacenados en «/etc/X11/Xresources
    /*» y los valores por defecto de sus aplicaciones en «/etc/X11/
    app-defaults/*». Utilice estas configuraciones como línea base.

    El archivo «~/.Xresources» se utiliza para guardar las
    configuraciones de usuario de los recursos. Este archivo se
    mezcla automáticamente con los valores por defecto de los
    recursos X después del acreditarse. Para realizar cambios en
    estas configuraciones y hacerlo efectivo de forma inmediata,
    mézclelos en la base de datos utilizando la siguiente orden.

    $ xrdb -merge ~/.Xresources

    Consulte x(7) y xrdb(1).

%

7.8.4. El emulador de terminal X — xterm

    Aprenda todo sobre xterm(1) en http://dickey.his.com/xterm/
    xterm.faq.html.

%

7.8.5. Ejecutando clientes X como superusuario

    Aviso

    Nunca comience un gestor de ventanas/sesión con la cuenta de
    superusuario escribiendo root en el gestor de sesión como gdm3 ya
    que se considera inseguro, incluso si piensa realizar tareas
    administrativas. La arquitectura entera de X se considera
    insegura si es ejecutada por el superusuario. Usted debe de
    utilizar el menor nivel de privilegios posible, como una cuenta
    de usuario corriente.

    La manera fácil del ejecutar un cliente concreto de X, p. ej.
    «foo» como superusuario es utilizar sudo(8) etc. como se muestra
    a continuación.

    $ sudo foo &

    $ sudo -s
    # foo &

    $ ssh -X root@localhost
    # foo &

    Atención
   
    Utilizar ssh(1) solo para este el propósito anterior es un
    auténtico desperdicio de recursos.

    Para conectar un cliente X a un servidor X, tenga en cuenta lo
    siguiente.

      * Los valores de las variables de entorno de los usuarios
        antiguos «$XAUTHORITY» y «$DISPLAY» deben ser copiados a los
        nuevos..

      * El archivo que apunta al valor de la variable de entorno
        «$XAUTHORITY» debe ser leible por el nuevo usuario.

Capítulo 8. I18N y L10N

    El Multilenguaje (M17N) o Soporte del Lenguaje Propio para el
    software de aplicaciones se realiza en dos pasos.

      * Internacionalización (I18N): para hacer que el software sea
        capaz de gestionar múltiples configuraciones dependiendo de
        la configuración regional.

      * Localización (L10N): para hacer que el software sea capaz de
        gestionar la configuración regional.

    Sugerencia

    Hay 17, 18, o 10 letras entre «m« y «n«, «i« y «n«, o «l« and «n«
    en multilenguaje, internacionalización y la localización que se
    corresponden M17N, I18N, y L10N.

    El software moderno como GNOME y KDE son multilenguaje. Están
    internacionalizados haciendo que gestionen los datos en UTF-8 y
    localizados aportando la traducción de sus mensajes a través de
    la infraestructura gettext(1). Los mensajes traducidos pueden ser
    aportados por paquetes especificos de localización. Estos pueden
    ser seleccionados dandole el valor correcto a las variables de
    entorno correspondientes con la configuración regional apropiada.

    La representación más sencilla de información en formato texto es
    en ASCII la cual es suficiente para el inglés y utiliza menos de
    127 caracteres (códificados por 7 bits). Para poder representar
    muchos más caracteres para la funcionalidad de
    internacionalización, se crearon muchos sistemas de codificación
    de caracteres. El sistema de codificación moderno y razonable es 
    UTF-8 el cual puede gestionar practicamente cualquier carácter
    conocido por los humanos (consulte Sección 8.4.1, “Fundamentos de
    codificación”).

    Para más detalles consulte Introducción a i18n.

    El soporte hardware a la internacionalización se realiza mediante
    la información de configuración del hardware de localización.

    Aviso
   
    Este capítulo esta desactualizado ya que esta fundamentado en
    Debian 7.0 (Wheezy) publicado en 2013.

%

8.1. La entrada por teclado

    El sistema Debian peude ser configurado para trabajar con muchas
    disposiciones internacionales del teclado utilizando los paquetes
    keyboard-configuration y console-setup.

    # dpkg-reconfigure keyboard-configuration
    # dpkg-reconfigure console-setup

    Esto configura el teclado para la consola de Linux y la ventana X
    actualiza los parámetros de configuración en «/etc/default/
    keyboard» y «/etc/default/console-setup». Esto también configura
    el tipo de letra de la consola Linux.

    Muchos caracteres no ASCII incluyen caracteres acentuados
    utilizados en muchos lenguajes europeos los cuales se pueden
    conseguir con la tecla inerte, la tecla AltGr y la tecla de
    composición.

    Para los lenguajes asiáticos, necesitará utilizar métodos de
    entrada más complicados que aportan lo que discutiremos a
    continuación como IBus.

%

8.1.1. El soporte al método de entrada con lBus

    La entrada multilenguaje a una aplicación se procesa como:

    Keyboard                               Application
       |                                                 ^
       |                                                  |
       +-> núcleo Linux -> Método de entrada -> Gtk, Qt, o X

    Configurar la entrada multilenguaje en el sistema Debian se
    simplifica por la utilización de la familia de paquetes IBus con
    el paquete im-config. La relación de paquetes IBus es la
    siguiente.

    Tabla 8.1. Relación de soporte de métodos de entrada con lBus

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|soporte de la configuración |
    |               |           |      |          regional          |
    |---------------+-----------+------+----------------------------|
    |ibus           |V:70, I:87 |1581  |infraestructura de método de|
    |               |           |      |entrada utilizando dbus     |
    |---------------+-----------+------+----------------------------|
    |ibus-mozc      |V:1, I:2   |999   |Japonés                     |
    |---------------+-----------+------+----------------------------|
    |ibus-anthy     |V:0, I:1   |8723  |, ,                         |
    |---------------+-----------+------+----------------------------|
    |ibus-kkc       |V:0, I:0   |214   |, ,                         |
    |---------------+-----------+------+----------------------------|
    |ibus-skk       |V:0, I:0   |244   |, ,                         |
    |---------------+-----------+------+----------------------------|
    |ibus-pinyin    |V:0, I:1   |1434  |Chino (para zh_CN)          |
    |---------------+-----------+------+----------------------------|
    |ibus-chewing   |V:0, I:0   |415   |, , (para zh_TW)            |
    |---------------+-----------+------+----------------------------|
    |ibus-hangul    |V:0, I:1   |288   |Coreano                     |
    |---------------+-----------+------+----------------------------|
    |ibus-table     |V:0, I:1   |1801  |tabla del motor de lBus     |
    |---------------+-----------+------+----------------------------|
    |ibus-table-thai|I:0        |47    |Tailandés                   |
    |---------------+-----------+------+----------------------------|
    |ibus-unikey    |V:0, I:0   |318   |Vitnamita                   |
    |---------------+-----------+------+----------------------------|
    |ibus-m17n      |V:0, I:1   |187   |Multilenguaje: Indo, Árabe y|
    |               |           |      |otros                       |
    +---------------------------------------------------------------+


    El método kinput2 y otras configuración regional clásicas
    asiáticas para los métodos de entrada todavía existen pero no son
    recomendables en un entorno X moderno UTF-8. Las cadenas de
    herramientas SCIM y uim son una aproximación un poco antiguas
    para la internacionalización de los métodos de entrada para un
    entorno X moderno UTF-8 .

%

8.1.2. Ejemplo para el japonés

    Para el método de entrada japonés un punto de comienzo muy útil
    es el entorno en inglés («en_US.UTF-8»). Aquí esta como lo hoce
    con IBus para GNOME3:

     1. Instale el paquete de herramientas de entrada para el japonés
        ibus-anthy con sus paquetes recomendados como im-config.

     2. Ejecute «im-config» desde el intérprete de órdenes y
        seleccioné «ibus» como método de entrada.

     3. Seleccioné «Configuración« → «Teclado« → «Método de entrada«
        → pulsé «+» en «Métodos de entrada« → «Japonés« → «Japonés
        (anthy)« y pulsé «Añadir«.

     4. Seleccioné «japonés« y pulse «Añadir« para el soporte de
        teclado japonés sin conversión de caracteres. (Usted puede
        elegir tantas formas de entrada como desee.)

     5. Vuelvase a acreditar con su cuenta de usuario.

     6. Compruebe la configuración con «im-config».

     7. Configure la fuente de entrada pulsado el botón derecho en el
        icono de la barra de herramientas del interfaz gráfico de
        usuario.

     8. Cambie entre fuentes de entrada con el SUPER-ESPACIO
        (habitualmente la tecla de Windows).

    Tenga en cuenta:

      * im-config(8) se comporta de forma diferente si la orden se
        ejecuta como superusuario o no.

      * im-config(8) activa el mejor método de entrada en el sistema
        por defecto sin la intervención del usuario.

      * La entrada del menú del interfaz gráfico de usuario de 
        im-config(8) está desactivada por defecto para evitar
        desastres.

%

8.1.3. Desactivación del método de entrada

    Si quiere utilizar la entrada sin XIM (mécanismo utilizado por
    las X), asigne a «$XMODIFIERS» el valor de cuando inicie un
    programa. Este es el caso de utilizar el japonés con el método de
    entrada egg en emacs(1) ya que desactiva ibus. Desde el
    intérprete de órdenes ejecute lo siguiente.

    $ XMODIFIERS=none emacs

    Para que se ejecute la orden por el menú de Debian, debe
    introducir la configuración adecuada en «/etc/menu/» siguiendo el
    método que se describe en «/usr/share/doc/menu/html».

%

8.2. La salida por pantalla

    La consola de Linux solo puede mostrar un número limitado de
    caracteres. (Necesitará un programa de terminal especial como 
    ifbterm(1) para visualizar lenguajes no europeos en una consola
    que no sea X).

    Las Ventanas X pueden mostrar cualquier carácter UTF-8 como
    necesitan los datos de los tipos de letra que existen (el Sistema
    de Ventanas X se encarga de la codificación de los datos de tipos
    de letra originales, siendo transparente para el usuario).

%

8.3. Ancho de los caracteres ambiguos de Asia oriental

    En las configuraciones regionales de Asia oriental, el área de
    dibujo de los caracteres griegos y cirílicos puede ser ampliada
    más allá de lo deseado causando que no se muestren alineados en
    la salida (consulte Anexo Estándar de Unicode #11).

    Puede solucionar este problema:

      * gnome-terminal: Editar → Preferencias → Perfiles → Editar →
        Compatibilidad → Caracters de ancho ambiguo → Estrechar

      * ncurses: asigne en el entorno export NCURSES_NO_UTF8_ACS=0.

%

8.4. Configuración regional

    La configuración regional de las aplicaciones que se ejecutan en
    un entorno de ventanas X comienza en gdm3(1).

%

8.4.1. Fundamentos de codificación

    La variable de entorno «LANG=xx_YY.ZZZZ» asigna a la
    configuración regional el código del lenguaje «xx», código del
    país «yy», y la codificación «ZZZZ» (consulte Sección 1.5.2, “La
    variable «$LANG»”).

    La última versión estable del sistemas Debian asigna
    habitualmente la configuración regional como LANG=xx_YY.UTF-8».
    Así se usa la codificación UTF-8 con el juego de caracteres
    Unicode. Este sistema de codificación UTF-8 es un sistema que
    utiliza un sistema de codificación de varios bytes y utiliza los
    puntos del código de forma inteligente. Los datos ASCII, que
    consisten unicamente en 7 bits por código, son siempre datos
    UTF-8 correctos y consisten únicamente en un byte por carácter.

    El sistema Debian anterior usaba la asignación de la
    configuración regional como «LANG=C» o «LANG=xx_YY» (sin
    «.UTF-8»).

      * El juego de caracteres ASCII es utilizado en «LANG=C» o «LANG
        =POSIX».
   
      * El sistema de codificación tradicional en Unix es «LANG=
        xx_YY».

    Los sistemas de codificación tradicionales reales que se utilizan
    ahora como «LANG=xx_YY» pueden ser identificados comprobando «/
    usr/share/i18n/SUPPORTED». Por ejemplo, «en_US» utiliza la
    codificación «ISO-8859-1» y «fr_FR@euro» utiliza la codificación
    «ISO-8859-15».

    Sugerencia
   
    Para el significado de los valores de los códigos, consulte
    Tabla 11.2, “Relación de valores de codificación y su uso”.

%

8.4.2. Razón de ser de la configuración regional UTF-8

    EL conjunto de caracteres Unicode puede representar virtualmente
    todos los caracteres conocidos por el hombre con códigos que
    tienen el rango en notación hexadecimal desde 0 hasta 10FFFF. Su
    almacenamiento necesita al menos 21 bits.

    El sistema de codificación de texto UTF-8 encaja en el código
    Unicode con una representación adecuada de flujos de 8 bits que
    la hace compatible con los sistemas de procesamiento de datos
    ASCII. UTF significa Formato de Transformación Unicode (Unicode
    Transformation Format).

    Recomendaría la utilización de la configuración regional UTF-8
    para el escritorio, p. ej. «LANG=en_US.UTF-8». La primera parte
    de la configuración regional determina el lenguaje en que las
    aplicaciones presentan los mensajes. Por ejemplo, gedit(1)
    (editor de texto del escritorio GNOME) con «LANG=fr_FR.UTF-8» la
    configuración regional puede mostrar y editar información en
    formato texto con caracteres chinos mientras visualiza los
    mensajes en francés, como lo determinan los métodos de entrada y
    tipos de letra instalados.

    También recomendaria configurar la localización configurando
    unicamente la variable de entorno «$LANG». La configuración de la
    combinación de las variables «LC_*» (consulte locale(1)) en la
    configuración regional UTF-8 no aporta demasiadas ventajas.

    Incluso texto plano en inglés puede contener caracteres que no
    perteneces a ASCII, p. ej. las comillas ligeramente inclinadas a
    izquierda y derecha no están incluidas en ASCII.

    “comillas dobles de este texto” no son las  «comillas dobles ASCII«
    ‘comillas simples de este texto’ no son las 'comillas simples ASCII'

    Cuando la información en formato de texto plano ASCII se
    convierte a UTF-8, tiene exactamente el mismo contenido y tamaño
    que el original ASCII. Así que no se pierde nada por configurar
    la configuración regional con UTF-8.

    Algunos programas utilizan más memoria después de configurarlos
    con l18N. Esto es debido que han sido escritos para utilizar
    UTF-32(UCS4) internamente para utilizar Unicode con el fin de
    optimizar la velocidad y utilizan 4 bytes por cada carácter ASCII
    con independencia de la configuración regional seleccionada.
    Nuevamente, no se pierde nada por utilizar como configuración
    regional UTF-8.

    Los sistemas de codificación no UTF-8 especificos de un producto
    tienden a tener menores pero molestas diferencias en algunos
    caracteres como los caracteres gráficos para muchos paises. La
    implantación del sistema UTF-8 de los modernos sistemas
    operativos generalmente solucionan estos conflictos de
    codificación.

%

8.4.3. Reconfiguración de la configuración regional

    Para que el sistema tenga acceso a una configuración regional
    particular, los datos de la configuración regional deben ser
    compilades desde la base de datos de las configuraciónes
    regionales. (El sistema Debian no ofrece todas las localizaciones
    precompiladas a menos que instale el paquete locales-all
    package.) La relación completa de configuraciónes regionales
    disponibles para la compilación está en «/usr/share/i18n/
    SUPPORTED». Esto enumera todos los nombres correctos de las
    configuraciónes regionales . La relación siguiente enumera las
    configuraciónes regionales UTF-8 compiladas en forma de binario.

    $ locale -a | grep utf8

    La ejecución de la orden siguiente reconfigura el paquete
    locales.

    # dpkg-reconfigure locales

    Este proceso consta de 3 pasos.

     1. Actualiza la relación de las configuraciones regionales
        disponibles

     2. Compilar estos para obtener el formato binario

     3. Configure el valor de la configuración regional por defecto
        en «/etc/default/locale» que será utilizado por PAM (consulte
        Sección 4.5, “PAM y NSS”).

    La relación de configuraciónes regionales disponibles debería
    incluir «en_US.UTF-8» y todos los lenguajes que encuentre
    interesantes con «UTF-8».

    La preferencia para la configuración regional por defecto es
    «en_US.UTF-8» para el inglés US. Para otras lenguas, por favor,
    aseguresé de elegir una configuración regional con «UTF-8».
    Cualquiera de estas configuraciones puede gestionar cualquier
    carácter internacional.

    Nota
   
    Aunque la configuración regional a «C» utiliza mensajes en inglés
    US, solo gestiona los caracteres de ASCII.

%

8.4.4. Valor de la variable de entorno «$LANG»

    Muchas aplicaciones modifican el valor de la variable de entorno
    «$LANG».

      * Para los programas de consola locales de Linux se inicializa
        mediante el mecanismo de PAM login(1)

      * Para los programas X se inicializa por el mecanismo PAM de
        visualización

      * Para los programas de consola remotos se inicializa por el
        mecanismo PAM ssh(1)
   
      * Para todos los programas X puede ser cambiado por algunos
        gestores de sesión como gdm3(1)

      * Para todos los programas X se modifica por el código de
        inicio de sesión X en «~/.xsessionrc»

      * Para todos los programas de consola se mdifica por el código
        de inicio del intérprete de órdenes «~/.bashrc»

    Sugerencia

    Es una buena práctica, para obtener la máximo compatibilidad,
    configurar la configuración regional como «en_US.UTF-8» en todo
    el sistema.

%

8.4.5. Especificación de la configuración regional en las Ventanas X

    Puede elegir una configuración regional especifica solo para
    entornos X independientemente de la configuración completa de su
    sistema de la configuración regional utiizando la personalización
    mediante PAM (consulte Sección 4.5, “PAM y NSS”) de la forma que
    se describe a continuación.

    Este entorno puede ofrecerle la mejor estabilidad y experiencia
    de usuario. Tiene acceso a las características de caracteres en
    el terminal con mensajes comprensible incluso cuando el Sistema
    de Ventanas X no funcione. Esto es fundamental para los lenguajes
    que utilizan caracteres no romanos como el japonés, el chino y el
    coreano.

    Nota

    Puede existir otra manera de configurar la configuración regional
    como una mejora del paquete de gestión de sesiones X pero lea lo
    siguiente como el método genérico y básico. Para gdm3(1), se que
    puede seleccionar la configuración regional de la sesión X por
    medio de su menú.

    La siguiente línea define la ubicación del archivo del entorno
    del lenguaje en el archivo de configuración PAM, como «/etc/pam.d
    /gdm3».

    auth    required        pam_env.so read_env=1 envfile=/etc/default/locale

    Cambie esto por lo siguiente.

    auth    required        pam_env.so read_env=1 envfile=/etc/default/locale-x

    Para el japonés cree un archivo «/etc/default/locale-x» con los
    permisos «-rw-r--r-- 1 root root» que contiene lo siguiente.

    LANG=«ja_JP.UTF-8«

    Mantenga el archivo por defecto «/etc/default/locale» para otros
    programas como sigue.

    LANG=«en_US.UTF-8«

    Esta es la técnica más genérica para personalizar la
    configuración regional y hacer del diálogo de selección de menú
    de gdm3(1) ser configurado regionalmente el mismo.

    Para este caso de forma alternativa puede simplemente cambiar la
    configuración regional en el archivo «~/.xsessionrc».

%

8.4.6. Códificación del nombre del archivo

    Para el intercambio de datos entre plataformas (consulte
    Sección 10.1.7, “Dispositivos de almacenamiento extraibles”),
    puede necesitar montar un sistema de archivos con una
    codificación adecuada. Por ejemplo, mount(8) para el sistemas de
    archivos vfat da por sentado CP437 si se utiliza sin opciones.
    Necesitará proporcionar al montar una opción explícita para
    utilizar UTF-8 o CP932 para los nombres de archivos.

    Nota

    Cuanto el automontaje o la conexión en caliente de dispositivos
    de memoria USB en los entornos de escritorio modernos como GNOME,
    puede introducir esa opción de montaje pulsando el botón derecho
    del ratón en el icono del escritorio, pulse en la pestaña
    «Unidad», pulse para expandir «Configurar» e introduzca «utf8» en
    las «Opciones de montaje:». La próxima vez que el dispositivo de
    memoria se monte UTF-8 estará activado.

    Nota

    Si esta actualizando su sistema o modificando los discos duros
    desde un sistema antiguo que no soporta UTF-8, los nombres de los
    archivos con caracteres que no son ASCII pueden ser códificados
    con la histórica y obsoleta ISO-8859-1 o eucJP. Por favor busque
    ayuda entre las herramientas de conversión de texto para
    convertirlas a UTF-8. Consulte Sección 11.1, “Herramientas para
    la conversión de información en formato texto”.

    Samba, por defecto, utiliza Unicode para los clientes nuevos
    (Windows NT, 200x, XP) pero utiliza CP850 para los viejos (DOS
    and Windows 9x/Me). El valor por defecto de los clientes viejos
    se puede cambiar modificando la entrada«dos charset» en el
    archivo «/etc/samba/smb.conf», p. ej. a CP932 para el japonés.

8.4.7. Configuración regional de los mensajes y documentación
traducida

    Existen traducciones para muchos de los mensajes de texto y
    documentos que el sistema Debian muestra, como los mensajes de
    error, salida estándar de los programas, menús y páginas de
    manual. El conjunto de herramientas de la orden GNU gettext(1) se
    utiliza como motor para la mayoría de las actividades
    relacionadas con las traducciones.

    En «Tareas« → «Configuración regional« aptitude(8) tiene una
    relación muy completa de paquetes binarios útiles los cuales
    proporcionan mensajes según la configuración regional de las
    aplicaciones y documentación traducida.

    Por ejemplo, puede tener los mensajes según su configuración
    regional instalando el paquete manpages-<LANG>. Para leer la
    página de man en italiano de <nombre_del_programa>desde «/usr/
    share/man/it/», ejecute lo siguiente.

    LANG=it_IT.UTF-8 man <nombre_del_programa>

%

8.4.8. Efectos de la configuración regional

    La órdenación lexicográfica de sort(1) depende de la elección de
    la configuración regional. La configuración regional en español y
    el inglés realizan la ordenación de forma diferente.

    El formato de la fecha de ls(1) cambia de acuerdo a la
    configuración regional. El formato de la fecha parav«LANG=C ls
    -l» y «LANG=en_US.UTF-8» son diferentes (consulte Sección 9.2.5,
    “Personalización de la visualización de la fecha y hora”).

    La puntuación de los números es diferente según la configuración
    regional. Por ejemplo, en la configuración regional en inglés,
    mil uno es 1,000.1» mientras que con la configuración regional
    alemán, se visualizaría como «1.000,1». Puede comprobar esta
    diferencia en una hoja de cálculo.

Capítulo 9. Trucos del sistema

    Aquí, describo los trucos fundamentales para configurar y
    gestionar sistemas, principalmente desde la consola.

%

9.1. El programa screen

    Screen(1) es una herramienta muy útil para el acceso remoto a
    sitio con conexiones no confiables o intermitentes ya que permite
    conexiones con redes cuya conectividad es intermitente.

    Tabla 9.1. Relación de programas que permiten conexiones de red
    intermitentes

    +---------------------------------------------------------------+
    |paquete|popularidad|tamaño|            descripción             |
    |-------+-----------+------+------------------------------------|
    |screen |V:127,     |1013  |Multiplexador de terminal con       |
    |       |I:281      |      |emulación de terminal VT100/ANSI    |
    |-------+-----------+------+------------------------------------|
    |tmux   |V:34, I:136|830   |terminal multiplexer alternative    |
    |       |           |      |(Use "Control-B" instead)           |
    +---------------------------------------------------------------+


%

9.1.1. Escenario de uso de screen(1)

    Screen(1) no solo permite trabajar con múltiples procesos en un
    único terminal, si no que también que el proceso del intérprete
    de órdenes remoto sobreviva a la interrupción de las conexiones.
    Aquí está un escenario típico de utilización de screen(1).

     1. Usted acceda a un equipo remoto.

     2. Inici screen en una única consola.

     3. Ejecute múlitples programas en la ventana de screen con ^A c
        («Control-A« seguido por «c«).

     4. Puede cambiar entre las múltiples ventanas de screen con ^A n
        («Control-A« seguido de «n«).

     5. Si repentinamente necesita dejar su terminal, pero no quiere
        perder su trabajo activo por la mantener la conexión.

     6. Se puede separar la sesión screen por cualquier método.

          + Desconexión forzada de su conexión de red

          + Pulse ^A d («Control-A« seguido de «d«) y cierre
            manualmente la conexión remota

          + Pulse ^A DD («Control-A« seguido de «DD«) para que screen
            separe y cierre su sesión

     7. Si inicia la sesión otra vez al mismo equipo remoto (incluso
        desde un terminal diferente).

     8. Inicie screen con «screen -r».

     9. Screen magicamente reconecta con todas las ventanas
        anteriores de screen con todos los programas activos
        ejecutandose.

    Sugerencia

    Puede guardar la entrada de la conexión con screen para la
    conexión de red amedida como de marcado y de paquete, ya que
    puede dejar el proceso activo mientras esta desconectado, y
    entonces recuperarlo más tarde cuando se conecte de nuevo.

%

9.1.2. Atajos de teclado para la orden screen

    En una sesión de screen, todas las entradas de teclado son
    enviadas a la ventana actual excepto las que son combinaciones de
    teclado de órdenes. Todas las combinaciones de teclas de órdenes
    screen se inician pulsando ^A («Control-A«) más otra tecla [más
    algunos parámetros]. Aquí estan algunos importantes a recordar.

    Tabla 9.2. Relación de los atajos de teclado para screen

    +---------------------------------------------------------------+
    |función|                      significado                      |
    |-------+-------------------------------------------------------|
    |^A ?   |muestra la ayuda de screen (muestra los atajos de      |
    |       |teclado)                                               |
    |-------+-------------------------------------------------------|
    |^A c   |crea una nueva ventana y cambia a ella                 |
    |-------+-------------------------------------------------------|
    |^A n   |ir a la siguiente ventana                              |
    |-------+-------------------------------------------------------|
    |^A p   |ir a la ventana anterior                               |
    |-------+-------------------------------------------------------|
    |^A 0   |va a la ventana 0                                      |
    |-------+-------------------------------------------------------|
    |^A 1   |va a la ventana número 1                               |
    |-------+-------------------------------------------------------|
    |^A w   |muestra una relación de las ventanas                   |
    |-------+-------------------------------------------------------|
    |^A a   |envia un Ctrl-A a la ventana actual como entrada de    |
    |       |teclado                                                |
    |-------+-------------------------------------------------------|
    |^A h   |escribe una copia de la ventana actual a un archivo    |
    |-------+-------------------------------------------------------|
    |^A H   |inicia/finaliza la grabación de la ventana actual a un |
    |       |archivo                                                |
    |-------+-------------------------------------------------------|
    |^A ^X  |bloquea la terminal (protegido por contraseña)         |
    |-------+-------------------------------------------------------|
    |^A d   |separa la sesión de screen de la terminal              |
    |-------+-------------------------------------------------------|
    |^A DD  |separa la sesión de screen y sale                      |
    +---------------------------------------------------------------+


    Para más detalles consulte screen(1).

9.2. Registro de datos y presentación

%

9.2.1. El demonio de registro

    Muchos programas registran sus actividades en el directorio «/var
    /log/».

      * El demonio de registro del sistema: rsyslogd(8)

    Consulte Sección 3.2.5, “El sistema de mensajes” y Sección 3.2.4,
    “Los mensajes del núcleo”.

%

9.2.2. Analizador de registros

    Aquí estan los analizadores de trazas más importantes
    («~Gsecurity::log-analyzer» en aptitude(8)).

    Tabla 9.3. Relación de analizadores de trazas del sistema

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|         descripción         |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |analizador de trazas con una |
    |logwatch      |V:16, I:18 |2265  |buena generación de salida   |
    |              |           |      |escrito en Perl              |
    |--------------+-----------+------+-----------------------------|
    |              |V:112,     |      |prohibición de las IPs con   |
    |fail2ban      |I:123      |2092  |múltiples errores de         |
    |              |           |      |acreditación                 |
    |--------------+-----------+------+-----------------------------|
    |analog        |V:4, I:109 |3534  |analizador de trazas para    |
    |              |           |      |servidores web               |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |analizador de trazas para    |
    |awstats       |V:9, I:15  |6910  |servidores web potente y con |
    |              |           |      |diversas funcionalidades     |
    |--------------+-----------+------+-----------------------------|
    |sarg          |V:3, I:3   |843   |generador de informes de     |
    |              |           |      |análisis de squid            |
    |--------------+-----------+------+-----------------------------|
    |pflogsumm     |V:1, I:4   |111   |generador de resumenes de las|
    |              |           |      |trazas de postfix            |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |generador de resumenes del   |
    |syslog-summary|V:0, I:2   |30    |contenido del archivo de     |
    |              |           |      |trazas de syslog             |
    |--------------+-----------+------+-----------------------------|
    |fwlogwatch    |V:0, I:0   |479   |analizador de trazas de      |
    |              |           |      |cortafuegos                  |
    |--------------+-----------+------+-----------------------------|
    |squidview     |V:0, I:1   |189   |controla y analiza los       |
    |              |           |      |archivos access.log de squid |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |visor de archivos de trazas  |
    |swatch        |V:0, I:0   |101   |con encaje de expresiones    |
    |              |           |      |regulares, eventos relevantes|
    |              |           |      |y reglas                     |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Filtro de spam y filtro      |
    |crm114        |V:0, I:0   |1119  |mediante expresiones         |
    |              |           |      |regulares programables       |
    |              |           |      |(CRM114)                     |
    |--------------+-----------+------+-----------------------------|
    |icmpinfo      |V:0, I:0   |44    |intérprete de mensajes ICMP  |
    +---------------------------------------------------------------+


    Nota

    CRM114 tiene un lenguaje que permite escribir borrosos filtros
    con la biblioteca de expresines regulares TRE . Su uso más común
    es como filtro de correos no deseados pero puede ser utilizado
    también como analizador de trazas.

%

9.2.3. Registro correcto de las actividades del intérprete de órdenes

    La utilización para el registro de la actividad del intérprete de
    órdenes, sin más, de script(1) (see Sección 1.4.9, “Grabación de
    las actividades del intérprete de órdenes”) produce un archivo
    con caracteres de control. Esto se puede evitar con la
    utilización de col(1) como se muestra.

    $ script
    Script started, file is typescript

    Haga lo que quiera ... y pulse Ctrl-D para finalizar script.

    $ col -bx <typescript >archivo_filtrado
    $ vim cleanedfile

    Si no utiliza script (por ejemplo, durante el proceso de arranque
    en initramfs), puede utilizar lo siguiente.

    $ sh -i 2>&1 | tee typescript

    Sugerencia

    Algunos emuladores de terminales x como gnome-terminal tienen la
    capacidad de regsitro de la actividad. Puede que quiera extender
    el buffer de la línea para mejorar la capacidad de ir hacia
    atrás.

    Sugerencia

    Puede utilizar screen(1) con «^A H» (consulte Sección 9.1.2,
    “Atajos de teclado para la orden screen”) para personalizar como
    se guarda la información de la consola.

    Sugerencia

    Puede usar emacs(1) con «M-x shell», «M-x shell», o «M-x term»
    para personalizar el registro de la consola. Más tarde puede
    utilizar «C-x C-w» para guardar el buffer a un archivo.

%

9.2.4. Personalizar la visualización de información en formato texto

    Aunque las herramientas de paginación como more(1) y less(1)
    (consulte Sección 1.4.5, “El paginador”) y herramientas
    personalizadas para marcar y dar formato (see Sección 11.1.8,
    “Resaltando y dándole formato a información en texto plano”)
    pueden visualizar la información en formato texto de la forma
    correcta, los editores de propósito general (consulte
    Sección 1.4.6, “El editor de texto”) son más versátiles y
    personalizables.

    Sugerencia
   
    En vim(1) y su modo de paginación conocido como view(1), «:set
    hls» permite la búsqueda de textos resaltados.

%

9.2.5. Personalización de la visualización de la fecha y hora

    El formato de visualización del tiempo y la fecha de la orden «ls
    -l» depende de la configuración regional (consulte sus valores en
    Sección 1.2.6, “Marcas de tiempo”). La variable «$LANG» se tiene
    en cuenta primero y puede ser sobreescrita por el valor de la
    variable «$LC_TIME».

    El formato de visualización por defecto real para cada
    configuración regional depende de la versión de la biblioteca
    estándar C (el paquete utilizado libc6). Esto es, diferentes
    distribuciones de Debian tienen diferentes valores por defecto.

    Si de verdad quiere personalizar el formato de visualización de
    la hora y la fecha independientemente de la configuración
    regional, debería asignar el valor de estilo de tiempo por el
    parámetro «--time-style» o por el valor de «$TIME_STYLE»
    (consulte ls(1), date(1), «info coreutils 'ls invocation'»).

    Tabla 9.4. Son ejemplos de hora y fecha para la orden «ls -l» en
    wheezy

    +---------------------------------------------------------------+
    |valor del estilo de | configuración  |visualización de la hora |
    |      la hora       |    regional    |       y la fecha        |
    |--------------------+----------------+-------------------------|
    |iso                 |cualquiera      |01-19 00:15              |
    |--------------------+----------------+-------------------------|
    |long-iso            |cualquiera      |2009-01-19 00:15         |
    |--------------------+----------------+-------------------------|
    |full-iso            |cualquiera      |2009-01-19               |
    |                    |                |00:15:16.000000000 +0900 |
    |--------------------+----------------+-------------------------|
    |configuración       |C               |Jan 19 00:15             |
    |regional            |                |                         |
    |--------------------+----------------+-------------------------|
    |configuración       |en_US.UTF-8     |Jan 19 00:15             |
    |regional            |                |                         |
    |--------------------+----------------+-------------------------|
    |configuración       |es_ES.UTF-8     |ene 19 00:15             |
    |regional            |                |                         |
    |--------------------+----------------+-------------------------|
    |+%d.%m.%y %H:%M     |cualquiera      |19.01.09 00:15           |
    |--------------------+----------------+-------------------------|
    |+%d.%b.%y %H:%M     |C o en_US.UTF-8 |19.Jan.09 00:15          |
    |--------------------+----------------+-------------------------|
    |+%d.%b.%y %H:%M     |es_ES.UTF-8     |19.ene.09 00:15          |
    +---------------------------------------------------------------+


    Sugerencia

    Puede evitar escribir largas opciones en las líneas de órdenes
    utilizando alias de órdenes , p. ej. «alias ls='ls --time-style=
    +%d.%m.%y\ %H:%M'» (consulte Sección 1.5.9, “Alias de órdenes”).

    Sugerencia
   
    ISO 8601 se sigue los siguientes formatos iso.

%

9.2.6. Intérprete de órdenes en color

    En los terminales más modernos se pueden utilizar colores
    utilizando secuencias de escape ANSI (consulte «/usr/share/doc/
    xterm/ctlseqs.txt.gz»).

    Por ejemplo, intente lo siguiente

    $ RED=$(printf «\x1b[31m«)
    $ NORMAL=$(printf «\x1b[0m«)
    $ REVERSE=$(printf «\x1b[7m«)
    $ echo «${RED}RED-TEXT${NORMAL} ${REVERSE}REVERSE-TEXT${NORMAL}«

%

9.2.7. Órdenes coloreadas

    Órdenes de colores son útiles para la comprobación visual de la
    salida en entornos interactivos. Yo añado lo siguiente en mi «~
    /.bashrc».

    if [ «$TERM« != «dumb« ]; then
        eval «`dircolors -b`«
        alias ls='ls --color=always'
        alias ll='ls --color=always -l'
        alias la='ls --color=always -A'
        alias less='less -R'
        alias ls='ls --color=always'
        alias grep='grep --color=always'
        alias egrep='egrep --color=always'
        alias fgrep='fgrep --color=always'
        alias zgrep='zgrep --color=always'
    else
        alias ll='ls -l'
        alias la='ls -A'
    fi

    La utilización de alias limita los efectos del color en el uso de
    órdenes interactivas. Tiene ventajas sobre las variables de
    entorno exportadas «export GREP_OPTIONS='--color=auto'» ya que el
    color pueder verse en los programas de paginación como less(1).
    Si quiere eliminar el color cuando usa tuberías con otros
    programas, utilice «--color=auto» en su lugar en los ejemplos
    anteriores «~/.bashrc».

    Sugerencia
   
    Puede deshabilitar los alias de color en un entorno interactivo
    llamando al intérprete de órdenes con «TERM=dumb bash».

9.2.8. Grabación de las actividades del editor con repeticiones
complejas

    Puede guardar las actividades del editor con repeticones
    complejas.

    Para Vim, como sigue.

      * «qa»: comienza a grabar los caracteres escritos en un
        registro llamado «a».

      * … actividades del editor

      * «q»: finaliza la grabación de los caracteres escritos.

      * «@a»: ejecuta el contenido del registro «a».

    Para Emacs, como sigue.

      * «C-x (»: comienza a definir una macro de teclado.

      * … actividades del editor
   
      * «C-x )»: termina definir una macro de teclado.

      * «C-x e»: ejecuta una macro de teclado.

%

9.2.9. Captura una imagen gráfica en un aplicación X

    Existen varias maneras de grabar una imagen gráfica de una
    aplicación X, incluida una pantalla de xterm.

    Tabla 9.5. Relación de herramientas de manipulación de imágenes

    +------------------------------------------+
    |   paquete   |popularidad|tamaño|  orden  |
    |-------------+-----------+------+---------|
    |xbase-clients|I:26       |46    |xwd(1)   |
    |-------------+-----------+------+---------|
    |gimp         |V:68, I:341|22313 |menú GUI |
    |-------------+-----------+------+---------|
    |imagemagick  |I:400      |218   |import(1)|
    |-------------+-----------+------+---------|
    |scrot        |V:8, I:80  |70    |scrot(1) |
    +------------------------------------------+


%

9.2.10. Guardando cambios en los archivos de configuración

    Existen herramientas especializadas para guardar los cambios de
    los archivos de configuración con la ayuda de sistemas como DVCS.

    Tabla 9.6. Relación de paquetes para guardar el histórico de
    configuraciones en VCS

    +---------------------------------------------------------------+
    |  paquete  |popularidad|tamaño|          descripción           |
    |-----------+-----------+------+--------------------------------|
    |           |           |      |almacena los archivos de        |
    |etckeeper  |V:27, I:32 |162   |configuración y sus metadatos   |
    |           |           |      |con Git (por defecto),          |
    |           |           |      |Mercurial, o Bazaar (nuevo)     |
    |-----------+-----------+------+--------------------------------|
    |changetrack|V:0, I:0   |71    |almacena los archivos de        |
    |           |           |      |configuración con RCS (antiguo) |
    +---------------------------------------------------------------+


    Recomiendo la utilización del paquete etckeeper congit(1) que
    incluye entero el directorio «/etc» bajo control CVS. Su guía de
    instalación y tutorial se puede encontrar en «/usr/share/doc/
    etckeeper/README.gz».

    Fundamentalmente, ejecutando «sudo etckeeper init» inicia el
    repositorio git de «/etc» tal como se explica enSección 10.6.5,
    “Git para guardar el histórico de configuraciones” pero con
    algunos archivos de órdenes para una configuración más minuciosa.

    Cuando cambie su configuración, puede utilizar git(1) de forma
    habitual para guardarla. También y de forma automática guarda los
    cambios cada vez que ejecuta órdenes de gestión de paquetes .

    Sugerencia

    Puede navegar por el historial de cambios de «/etc» ejecutando
    «sudo GIT_DIR=/etc/.git gitk» con una forma clara de visualizar
    los nuevos paquetes instalados, los borrados y los cambios de
    versión de los paquetes.

%

9.3. Monitoreando, controlando e iniciando lo que hacer los programas

    Las actividades de los programas pueden ser monitoreados y
    controlados utilizando herramientas especializadas.

    Tabla 9.7. Relación de las herramientas de monitorización y
    control de las actividades de los programas

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño|           descripción            |
    |---------+-----------+------+----------------------------------|
    |         |V:891,     |      |nice(1): ejecuta un programa      |
    |coreutils|I:999      |17478 |modificando su prioridad de       |
    |         |           |      |planificación                     |
    |---------+-----------+------+----------------------------------|
    |         |V:673,     |      |renice(1): cambia la prioridad de |
    |bsdutils |I:999      |393   |planificación de un proceso en    |
    |         |           |      |ejecución                         |
    |---------+-----------+------+----------------------------------|
    |         |V:739,     |      |«/proc» utilidades del sistema de |
    |procps   |I:999      |792   |archivos: ps(1), top(1), kill(1), |
    |         |           |      |watch(1), …                       |
    |---------+-----------+------+----------------------------------|
    |         |V:427,     |      |«/proc» utilidades del sistema de |
    |psmisc   |I:845      |679   |archivos: killall(1), fuser(1),   |
    |         |           |      |peekfd(1), pstree(1)              |
    |---------+-----------+------+----------------------------------|
    |         |           |      |time(1): ejecuta un programa para |
    |time     |V:15, I:279|82    |crear un informe de los recursos  |
    |         |           |      |del sistema utilizados a lo largo |
    |         |           |      |del tiempo                        |
    |---------+-----------+------+----------------------------------|
    |         |V:161,     |      |sar(1), iostat(1), mpstat(1), …:  |
    |sysstat  |I:183      |1918  |herramientas de optimización del  |
    |         |           |      |sistema en Linux                  |
    |---------+-----------+------+----------------------------------|
    |isag     |V:0, I:3   |116   |Graficador Interactivo de la      |
    |         |           |      |Actividad del Sistema para sysstat|
    |---------+-----------+------+----------------------------------|
    |         |           |      |lsof(8): enumera la relación de   |
    |lsof     |V:391,     |451   |archivos abiertos por un proceso  |
    |         |I:946      |      |en ejecución utilizando la opción |
    |         |           |      |«-p»                              |
    |---------+-----------+------+----------------------------------|
    |strace   |V:16, I:153|2367  |strace(1): registro de las        |
    |         |           |      |llamadas del sistema y señales    |
    |---------+-----------+------+----------------------------------|
    |ltrace   |V:1, I:21  |363   |ltrace(1): registro a las         |
    |         |           |      |bibliotecas invocadas             |
    |---------+-----------+------+----------------------------------|
    |         |           |      |xtrace(1): registra las           |
    |xtrace   |V:0, I:0   |353   |comunicaciones entre el cliente y |
    |         |           |      |el servidor en X11                |
    |---------+-----------+------+----------------------------------|
    |         |           |      |powertop(1): información sobre el |
    |powertop |V:9, I:217 |662   |uso de la potencia por parte del  |
    |         |           |      |sistema                           |
    |---------+-----------+------+----------------------------------|
    |         |V:805,     |      |ejecuta procesos en segundo plano |
    |cron     |I:997      |263   |de acuerdo a su planificación     |
    |         |           |      |desde el dominio cron(8)          |
    |---------+-----------+------+----------------------------------|
    |         |V:409,     |      |planficador de tareas similar a   |
    |anacron  |I:482      |99    |cron para los sistemas que no     |
    |         |           |      |están activos 24 horas al dia     |
    |---------+-----------+------+----------------------------------|
    |         |           |      |at(1) or batch(1): ejecuta un     |
    |at       |V:162,     |161   |trabajo at en un momento          |
    |         |I:310      |      |determinado o por debajo de cierto|
    |         |           |      |nivel de carga                    |
    +---------------------------------------------------------------+


    Sugerencia

    El paquete procps provee lo fundamental para la monitorización,
    control e inicio de las actividades de los programas. Usted
    podría aprender acerca de todo ello.

%

9.3.1. Temporización de un proceso

    Muestra el tiempo utilizado por un proceso invocado por la orden.

    # time alguna_órden >/dev/null
    real    0m0.035s       # timepo de reloj (tiempo real transcurrido)
    user    0m0.000s       # tiempo en modo usuario
    sys     0m0.020s       # tiempo en modo núcleo

%

9.3.2. La prioridad de planificación

    Un valor de «nice« se utiliza para determinar la prioridad de
    planificación de los procesos.

    Tabla 9.8. Relación de valores de nice para la prioridad de
    planificación

    +---------------------------------------------------------------+
    |  Valor de  |            prioridad de planificación            |
    |    nice    |                                                  |
    |------------+--------------------------------------------------|
    |19          |proceso de menor prioridad (nice)                 |
    |------------+--------------------------------------------------|
    |0           |proceso de muy alta prioridad para el usuario     |
    |------------+--------------------------------------------------|
    |-20         |proceso de superusuario (no nice) de muy alta     |
    |            |prioridad                                         |
    +---------------------------------------------------------------+


    # nice  -19 top                                      # muy nice
    # nice --20 wodim -v -eject speed=2 dev=0,0 disk.img # muy rápido

    Algunas veces un valor extremo de nice produce más mal que bien
    al sistema. Utilice esta orden con cuidado.

%

9.3.3. La orden ps

    La orden ps(1) en un sistema Debian aportan tanto las
    funcionalidades de SystemV y BSD y ayuda a identificar la
    actividad estática del proceso.

    Tabla 9.9. Lista de estilo de la orden ps

    +---------------------------------------+
    | estilo |orden típica|  funcionalidad  |
    |--------+------------+-----------------|
    |BSD     |ps aux      |muestra %CPU %MEM|
    |--------+------------+-----------------|
    |System V|ps -efH     |visualiza PPID   |
    +---------------------------------------+


    Para los procesos hijos zombies (muertos) , los puede eliminar
    mediante el identificador del proceso padre que corresponde al
    campo «PPID».

    La orden pstree(1) muestra el árbol de procesos.

%

9.3.4. La orden top

    top(1) en el sistema Debian es rico desde el punto de vista
    funcional y ayuda a identificar que procesos actuan de forma
    extraña puntualmente.

    It is an interactive full screen program. You can get its usage
    help press by pressing the "h"-key and terminate it by pressing
    the "q"-key.

%

9.3.5. Relación de los archivos abiertos por un proceso

    Puede enumerar los archivos abiertos por un proceso con el
    identificador de proceso (PID), p. ej. 1, con lo siguiente.

    $ sudo lsof -p 1

    PID=1 generalmente es del programa init.

%

9.3.6. Trazando la actividad de un programa

    Puede trazar la actividad de un programa, invocaciones al
    sistema, señales, invocaciones a bibliotecas o comunicaciones
    entre el cliente y servidor X11, con strace(1), ltrace(1), o 
    xtrace(1).

    Puede seguir las invocaciones del sistema de la orden ls con se
    muestra.

    $ sudo strace ls

9.3.7. Identificación de procesos utlizando archivos o conexiones
(sockets)

    También puede identificar procesos utilizando archivos mediante 
    fuser(1), p. ej. para «/var/log/mail.log» como se muestra.

    $ sudo fuser -v /var/log/mail.log
                         USER        PID ACCESS COMMAND
    /var/log/mail.log:   root       2946 F.... rsyslogd

    Puede ver que el archivo «/var/log/mail.log» esta abierto en
    escritura por la orden rsyslogd(8).

    También puede identificar un proceso por la utilización de sus
    conexiones (sockets) mediante fuser(1), p. ej. para «smtp/tcp»
    como se muestra.

    $ sudo fuser -v smtp/tcp
                         USER        PID ACCESS COMMAND
    smtp/tcp:            Debian-exim   3379 F.... exim4

    Ahora sabe que su sistema ejecuta exim4(8) con el fin de
    gestionar las conexiones TCP del puerto SMTP (25).

%

9.3.8. Repetición de una orden a intervalos constantes

    watch(1) ejecuta un programa de forma reiterada a un intervalo
    constante mientras muestra la salida del programa a pantalla
    completa.

    $ watch w

    Esto muestra quién está acreditado en el sistema y lo actualiza
    cada 2 segundos.

%

9.3.9. Repetición de una orden sobre archivos

    Existen varias formas de repetir una orden sobre los archivos que
    cumplan una condición, p. ej, encajan en un patrón «*.ext».

      * Método del bucle for del intérprete de órdenes (consulte
        Sección 12.1.4, “Bucles del intérprete de órdenes”):

    for x in *.ext; do if [ -f «$x«]; then orden «$x« ; fi; done

      * Combinación de find(1) y xargs(1):

    find . -type f -maxdepth 1 -name '*.ext' -print0 | xargs -0 -n 1 orden

      * find(1) con la opción «-exec» y una orden:

    find . -type f -maxdepth 1 -name '*.ext' -exec orden '{}' \;

      * find(1) con la opción «-exec» con un archivo de órdenes
        pequeño:

    find . -type f -maxdepth 1 -name '*.ext' -exec sh -c «orden '{}' && echo 'successful'« \;

    Los ejemplos anteriores están escritos para asegurar el correcto
    tratamiento de los nombres de archivos que contienen caracteres
    raros como los espacios. Para usos avanzados de find(1) consulte
    Sección 10.1.5, “Formas de selección de archivos”.

%

9.3.10. Iniciar un programa desde el interfaz gráfico de usuario

    Para el interfaz de órdenes en línea (CLI), el programa ejecutado
    será el primero que encaja el nombre en el directorio especificdo
    por la variable de entorno $PATH. Consulte Sección 1.5.3, “La
    variable «$PATH»”.

    Para el interfaz gráfico de usuario (GUI) que cumple con el
    estándar de freedesktop.org, los archivos *.desktop en el
    directorio /usr/share/applications/ proporciona los atributos
    necesarios para la visualización de cada programa en el menú del
    interfaz gráfico de usuario. Consulte Sección 7.2.2, “Menú de
    Freedesktop.org”.

    Por ejemplo, el archivo chromium.desktop define los atributos
    para el «Navegador Web Chromium« como «Name« para el nombre del
    programa, «Exec« para la ruta de ejecución del programa y
    parámetros, «Icon« para el icono utilizado, etc. (consulte la
    Especificación de Entradas del Escritorio (Desktop Entry
    Specification)) como sigue:

    [Desktop Entry]
    Version=1.0
    Name=Chromium Web Browser
    GenericName=Web Browser
    Comment=Access the Internet
    Comment[fr]=Explorer le Web
    Exec=/usr/bin/chromium %U
    Terminal=false
    X-MultipleArgs=false
    Type=Application
    Icon=chromium
    Categories=Network;WebBrowser;
    MimeType=text/html;text/xml;application/xhtml_xml;x-scheme-handler/http;x-scheme-handler/https;
    StartupWMClass=Chromium
    StartupNotify=true

    Esta es una descripción muy simplificadao. Los archivos *.desktop
    son revisados como sigue.

    El entorno de escritorio asigna las variables del entorno
    $XDG_DATA_HOME and $XDG_DATA_DIR. Por ejemplo, en GNOME 3:

      * $XDG_DATA_HOME esta sin asignar. (El valor por defecto que se
        utiliza es $HOME/.local/share.)
   
      * $XDG_DATA_DIRS se le asigna el valor /usr/share/gnome:/usr/
        local/share/:/usr/share/.

    Así los directorios base (consulte XDG Base Directory
    Specification) y los directorios de aplicaciones quedan como
    sigue.

      * $HOME/.local/share/ → $HOME/.local/share/applications/

      * /usr/share/gnome/ → /usr/share/gnome/applications/
   
      * /usr/local/share/ → /usr/local/share/applications/

      * /usr/share/ → /usr/share/applications/

    Los archivos *.desktop se comprueban en estos directorios de
    aplicaciones siguiendo este orden.

    Sugerencia

    Se puede crear una entrada personalizada al menú del interfaz
    gráfico de usuario (GUI) añadiendo un archivo *.desktop al
    directorio $HOME/.local/share/applications/.

    Sugerencia

    Igualmente, si se crea un archivo *.desktop en el directorio
    autostart por debajo de estos directorios base, el programa que
    se especifique en el archivo *.desktop se ejecuta automáticamente
    cuando el entorno de escritorio se inicia. Consulte
    Especificación de Inicio Automático de Aplicaciones de
    Escritorio.

    Sugerencia

    De igual manera, si un archivo *.desktop se crea en el directorio
    $HOME/Desktop y se ha configurado el entorno de escritorio con la
    funcionalidad del lanzador del icono, el programa especificado en
    el se ejecutará cuando se pulse sobre el icono. Tenga en cuenta
    que el nombre real del directorio $HOME/Desktop depende de la
    configuración regional. Consulte xdg-user-dirs-update(1).

%

9.3.11. Personalizando el inicio de un programa

    Algunos programas inician otros programa de forma automática.
    Aquí estan los puntos a compribar para la personalización de este
    proceso.

      * Menú de configuración de aplicaciones:

          + Escritorio GNOME3: «Configuración« → «Sistema« →
            «Detalles« → «Aplicaciones por defecto«

          + Escritorio KDE: «K« → «Centro de Control« → «Componenetes
            KDE« → «Selección de componentes«

          + Navegador Iceweasel: «Editar→ «Preferencias« →
            «Aplicaciones«

          + mc(1): «/etc/mc/mc.ext»

      * Variables de entorno como «$BROWSER», «$EDITOR», «$VISUAL» y
        «$PAGER» (consulte eviron(7))

      * El sistema update-alternatives(1) para los programas como
        «editor», «view», «x-www-browser», «gnome-www-browser», and
        «www-browser» (consulte Sección 1.4.7, “Configuración del
        editor de texto por defecto”)

      * El contenido de los archivos «~/.mailcap» y «/etc/mailcap»
        que asocia los tiposMIME con los programas (consulte mailcap
        (5))

      * El contenido de los archivos «~/.mime.types» y «/etc/
        mime.types» el cual se asocia con la extensión del nombre del
        archivo con los tipos MIME (consulte run-mailcap(1))

    Sugerencia
   
    update-mime(8) actualiza el archivo «/etc/mailcap» utilizando el
    archivo «/etc/mailcap.order» (consulte mailcap.order(5)).

    Sugerencia

    El paquete debianutils aporta sensible-browser(1), 
    sensible-editor(1) y sensible-pager(1) que elige de forma sensata
    el editor, paginador y navegador web que se lanzará,
    respectivamente. Le recomiendo leer estos archivos de órdenes.

    Sugerencia

    Con el fin de ejecutar una aplicación de consola como mutt como
    la preferida en X, podría crear una aplicación X de la forma
    siguiente y asignar «/usr/local/bin/mutt-term» como su aplicación
    preferida al inicio como se describe.

    # cat /usr/local/bin/mutt-term <<EOF
    #!/bin/sh
    gnome-terminal -e «mutt \$@«
    EOF
    chmod 755 /usr/local/bin/mutt-term

%

9.3.12. Matando un proceso

    Utilice kill(1) para matar (o enviar una señal a) un proceso
    mediante su identificador de proceso.

    Utilice killall(1) o pkill(1) para hacer lo mismo mediante otros
    atributos como el nombre de la orden del proceso.

    Tabla 9.10. Relación de las señales más usadas con la orden kill

    +----------------------------------------------------------+
    |valor de la señal|nombre de la señal|       función       |
    |-----------------+------------------+---------------------|
    |1                |HUP               |reinicio del demonio |
    |-----------------+------------------+---------------------|
    |15               |TERM              |finalización normal  |
    |-----------------+------------------+---------------------|
    |9                |KILL              |finalización obligada|
    +----------------------------------------------------------+


%

9.3.13. Planificación una vez de las tareas

    Ejecute al orden at(1) para planificar una única ejecución de un
    trabajo mediente lo siguiente.

    $ echo 'command -args'| at 3:40 monday

%

9.3.14. Planificación regular de tareas

    Utilice cron(8) para planificar las tareas de forma regular.
    Consulte crontab(1) y crontab(5).

    Puede planificar la ejecución de procesos como un usuario normal,
    p. ej. foo creando un archivo crontab(5) como «/var/spool/cron/
    crontabs/foo» con la orden «crontab -e».

    Aquí esta un ejemplo de un archivo crontab(5).

    # utilice /bin/sh para ejecutar órdenes ,sin importar lo que diga /etc/passwd
    SHELL=/bin/sh
    # enviar la salida por correo a paul, sin importar a quién pertenece el crontab
    MAILTO=paul
    # Min Hora DiaDelMes Mes DiaDeLaSemana orden (Dia... es ordenado)
    # se ejecuta a las 00:05, cada dia
    5 0  *  * *   $HOME/bin/daily.job >> $HOME/tmp/out 2>&1
    # se ejecuta a las 14:15 el primer día de cada mes -- salida se envía por correo a paul
    15 14 1  * *   $HOME/bin/monthly
    # ejecuta a las 22:00 en días entre semana(1-5), avisando a  Joe. % para nueva línea, el último % para copiar en el correo:
    0 22 *   * 1-5 mail -s «It's 10pm« joe%Joe,%%WDonde están los niños?%.%%
    23 */2 1 2 *   echo «Se ejecuta en el minuto 23 en las horas pares el 1 de Febrero«
    5  4 *   * sun echo «ejecuta a las 04:05 cada domingo«
    # se ejecuta a las 03:40 el primer Lunes de cada mes
    40 3 1-7 * *   [ «$(date +%a)« == «Mon« ] && orden -args

    Sugerencia

    En los sistemas que no están en funcionamiento ininterrumpido,
    instale el paquete anacron para planificar órdenes periódicas en
    los intervales deseados tan pronto como el equipo activo lo
    permita. Consulte anacron(8) y anacrontab(5).

    Sugerencia

    Para los archivos de órdenes de mantenimiento del sistema, puede
    ejecutarlos de forma periódica desde la cuenta de superusuario
    ubicando esos archivos de órdenes en «/etc/cron.hourly/», «/etc/
    cron.daily/», «/etc/cron.weekly/», o «/etc/cron.monthly/». La
    temporización de la ejecución de los archivos de órdenes puede
    personalizarse mediante «/etc/crontab» y «/etc/anacrontab».

%

9.3.15. Tecla Alt-SysRq

    La cobertura del riesgo frente al mal funcionamiento del sistema
    se aporta por la opción de compilación del núcleoon «Magic SysRq
    key« (tecla SAK key) el cual está por defecto en el núcleo que
    proporciona Debian. Pulsando Alt-SysRq seguido por una de las
    siguientes teclas rescata mágicamente el control del sistema.

    Tabla 9.11. Relación de las órdenes de las teclas SAK

    +---------------------------------------------------------------+
    | tecla seguida |           descripción de la acción            |
    | de Alt-SysRq  |                                               |
    |---------------+-----------------------------------------------|
    |r              |recupera el teclado del modo crudo después de  |
    |               |que las X fallen                               |
    |---------------+-----------------------------------------------|
    |0              |cambia el nivel de registro de la consola a0   |
    |               |para reducdir los mensajes de error            |
    |---------------+-----------------------------------------------|
    |k              |k mata todos los procesos de la consola virtual|
    |               |actual                                         |
    |---------------+-----------------------------------------------|
    |e              |envia una señal SIGTERM a todos los procesos,  |
    |               |excepto init(8)                                |
    |---------------+-----------------------------------------------|
    |i              |envia una señal SIGKILL a todos los procesos,  |
    |               |excepto a init(8)                              |
    |---------------+-----------------------------------------------|
    |s              |sincroniza todos los sistemas de archivos      |
    |               |montados para evitar la corrupción de datos    |
    |---------------+-----------------------------------------------|
    |u              |remonta todos los sistemas de archivos montados|
    |               |como de solo lectura (desmonta)                |
    |---------------+-----------------------------------------------|
    |b              |reinicia el sistema sin sincronizar ni         |
    |               |desmontar                                      |
    +---------------------------------------------------------------+


    Sugerencia
   
    Lee las páginas de manual de signal(7), kill(1) y sync(1) para
    entender la descripción anterior.

    La combinación de «Alt-SysRq s«, «Alt-SysRq u«,y «Alt-SysRq r« es
    bueno para salir de una situación desagradable y recuperar acceso
    a un teclado utilizable sin para el sistema.

    Consulte «/usr/share/doc/linux-doc-3.*/Documentation/
    sysrq.txt.gz».

    Atención

    La funcionalidad Alt-SysRq puede considerarse un riesgo de
    seguridad al permitir acceso a los usuarios a funciones de
    superusuarios. Ubicando «echo 0 >/proc/sys/kernel/sysrq» en «/etc
    /rc.local» o «kernel.sysrq = 0» en «/etc/sysctl.conf» desactiva
    la funcionalidad de Alt-SysRq.

    Sugerencia

    Desde terminales SSH etc., puede utilizar la funcionalidad
    Alt-SysRq resribiendo «/proc/sysrq-trigger». Por ejemplo, «echo s
    > /proc/sysrq-trigger; echo u > /proc/sysrq-trigger» desde el
    cursor del intérprete de órdenes del superusuario sincroniza y 
    monta todos los sistemas de archivos.

9.4. Trucos para el mantenimiento del sistema

%

9.4.1. ¿Quién está en el sistema?

    Puede comprobar quién esta en el sistema como se muestra.

      * who(1) muestra quién está acreditado.

      * w(1) muestra quién esta acreditado y que está haciendo.

      * last(1) muestra una relación de las últimas sesiones de
        usuario.

      * lastb(1) muestra una relación de los últimos intentos
        fallidos de acceso a una sesión.

    Sugerencia
   
    «/var/run/utmp» y «/var/log/wtmp» mantiene esa información de
    usuario. Consulte login(1) y utmp(5).

%

9.4.2. Avisos para todos

    Puede enviar mensajes a cualquiera que esté acreditado en el
    sistema con wall(1) como se muestra.

    $ echo «Apagaremos el equipo en una hora« | wall

%

9.4.3. Identificación del hardware

    El punto de inicio para la identificación de los dispositivos
    tipo PCI (AGP, PCI-Express, CardBus, ExpressCard, etc.) es la
    orden lspci(8) (preferentemente con la opción «-nn»).

    Otra forma en la que puede identificar el hardware es leyendo el
    contenido de «/proc/bus/pci/devices» o navegando por el árbol de
    directorios que cuelga de «/sys/bus/pci» (consulte
    Sección 1.2.12, “procfs y sysfs”).

    Tabla 9.12. Relación de las herramientas para la identificación
    de hardware

    +---------------------------------------------------------------+
    |  paquete  |popularidad|tamaño|          descripción           |
    |-----------+-----------+------+--------------------------------|
    |pciutils   |V:195,     |196   |Utilidades de Linux para PCI:   |
    |           |I:992      |      |lspci(8)                        |
    |-----------+-----------+------+--------------------------------|
    |usbutils   |V:84, I:862|324   |Utilidades de Linux para USB:   |
    |           |           |      |lsusb(8)                        |
    |-----------+-----------+------+--------------------------------|
    |pcmciautils|V:13, I:21 |97    |Utilidades Linux para PCMCIA:   |
    |           |           |      |pccardctl(8)                    |
    |-----------+-----------+------+--------------------------------|
    |           |           |      |colección de herramientas para  |
    |scsitools  |V:0, I:3   |390   |la gestión de hardware SCSI:    |
    |           |           |      |lsscsi(8)                       |
    |-----------+-----------+------+--------------------------------|
    |procinfo   |V:0, I:13  |135   |información del sistema obtenida|
    |           |           |      |de «/proc»: lsdev(8)            |
    |-----------+-----------+------+--------------------------------|
    |lshw       |V:12, I:94 |842   |información sobre la            |
    |           |           |      |configuración hardware: lshw(1) |
    |-----------+-----------+------+--------------------------------|
    |discover   |V:41, I:947|90    |sistema de identificación       |
    |           |           |      |hardware: discover(8)           |
    +---------------------------------------------------------------+


%

9.4.4. Configuración del hardware

    Aunque la mayor parte de la configuración del hardware en los
    sistemas de escritorio con interfaz gráfico de usuario como GNOME
    y KDE se puede realizar mediante herramientas de configuración
    con interfaz gráfico de usuario, es una buena idea conocer
    algunos métodos básicos para su configuración.

    Tabla 9.13. Relación de herramientas de configuración hardware

    +---------------------------------------------------------------+
    |     paquete     |popularidad|tamaño|       descripción        |
    |-----------------+-----------+------+--------------------------|
    |                 |V:137,     |      |Utilidades de teclado y   |
    |console-setup    |I:959      |411   |tipos de letra para       |
    |                 |           |      |consolas                  |
    |-----------------+-----------+------+--------------------------|
    |x11-xserver-utils|V:282,     |511   |Utilidades de servidor X: |
    |                 |I:534      |      |xset(1), xmodmap(1)       |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |demonio que gestiona los  |
    |                 |           |      |eventos que llegan del    |
    |acpid            |V:145,     |176   |Interfaz de Fuerza y      |
    |                 |I:318      |      |Configuración Avanzada    |
    |                 |           |      |(Advanced Configuration   |
    |                 |           |      |and Power Interface, ACPI)|
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |utilidad para visualizar  |
    |acpi             |V:17, I:302|45    |información de            |
    |                 |           |      |dispositivos ACPI         |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |demonio que «duerme« el   |
    |sleepd           |V:0, I:0   |86    |portátil si deja de tener |
    |                 |           |      |actividad                 |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |optimización de acceso al |
    |                 |V:408,     |      |disco duro (consulte      |
    |hdparm           |I:718      |256   |Sección 9.5.9,            |
    |                 |           |      |“Optimización del disco   |
    |                 |           |      |duro”)                    |
    |-----------------+-----------+------+--------------------------|
    |                 |V:134,     |      |control y monitoreo de    |
    |smartmontools    |I:197      |2117  |sistemas de almacenamiento|
    |                 |           |      |utilizando S.M.A.R.T.     |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |colección de herramientas |
    |setserial        |V:5, I:9   |117   |para la gestión del puerto|
    |                 |           |      |serie                     |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |colección de herramientas |
    |memtest86+       |V:1, I:29  |2391  |para la gestión de la     |
    |                 |           |      |memoria hardware          |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |colección de herramientas |
    |scsitools        |V:0, I:3   |390   |para la gestión de        |
    |                 |           |      |hardware SCSI             |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |optimización de acceso a  |
    |setcd            |V:0, I:1   |35    |la unidad de discos       |
    |                 |           |      |compactos                 |
    |-----------------+-----------+------+--------------------------|
    |big-cursor       |I:1        |27    |cursores grandes del ratón|
    |                 |           |      |para X                    |
    +---------------------------------------------------------------+


    Aquí, ACPI es un marco más nuevo para el sistema de gestión de
    fuerza que APM.

    Sugerencia

    La frecuencia de funcionamiento de la CPU de los sistemas
    modernos esta gestionada por módulos en el núcleo como
    acpi_cpufreq.

%

9.4.5. Hora del sistema y del hardware

    Lo siguiente asigna al sistema y hardware la hora y fecha a MM/DD
    hh:mm CCYY.

    # date MMDDhhmmCCYY
    # hwclock --utc --systohc
    # hwclock --show

    La hora habitualmente se visualiza en la hora local en el sistema
    Debian pero el hardware y el sistema usa generalmente la hora en
    UTC(GMT).

    Si la hora del hardware (BIOS) esta asiganda en UTC, cambie la
    configuración a «UTC=yes» en «/etc/default/rcS».

    Lo siguiente reconfigura la zona horaria utilizada por el sistema
    Debian.

    # dpkg-reconfigure tzdata

    Si desea actualizar el tiempo del sistema a través de la red,
    piense en utilizar el servicio NTP con paquetes como ntp, ntpdate
    y chrony.

    Sugerencia
   
    En systemd para la sincronización de la hora a través de la red
    utilice systemd-timesyncd. Consulte systemd-timesyncd(8).

    Consulte lo siguiente.

      * Manual Cómo Gestionar la Precisión de la Fecha y Hora

      * Proyecto de Servicio NTP Público (NTP Public Services
        Project)

      * El paquete ntp-doc

    Sugerencia
   
    ntptrace(8) del paquete ntp puede trazar una cadena de vuelta de
    los servidores NTP a la fuente primigenia.

%

9.4.6. La configuración del terminal

    Existen diferentes componentes para configura la consola de
    caracteres y las funcionalidades del sistema ncurses(3) system
    features.

      * El archivo «/etc/terminfo/*/*» (terminfo(5))

      * La variable de entorno «$TERM» (term(7))

      * setterm(1), stty(1), tic(1) y toe(1)

    Si la entrada terminfo de xterm no funciona con una xterm que no
    es de Debian, cambie el tipo de terminal cambiando «$TERM» de
    «xterm» a una versión con funcionalidades limitadas como
    «xterm-r6» al autenticarse en el sistema Debian de forma remota.
    Para mayor información consulte «/usr/share/doc/libncurses5/FAQ».
    «dumb» es el mínimo común denominador para «$TERM».

%

9.4.7. La infraestructura de sonido

    La Arquitectura Avanzada de Sonido para Linux (Advanced Linux
    Sound Architecture, ALSA) proporciona los controladores de
    dispositivos de tarjetas de sonido en el actual Linux. ALSA tiene
    un modo de emulación para ser compatible con el anterior Open
    Sound System (OSS).

    Sugerencia
   
    Para comprobar el altavoz (speaker) utilice «cat /dev/urandom > /
    dev/audio» o speaker-test(1) (^C para finalizar).

    Sugerencia

    Si no obtiene sonido, su altavoz puede estar conectado a una
    salida en silencio. Alsamixer(1) en el paquete alsa-utils le será
    útil para la configuración del volumen y el silencio.

    E software de aplicación puede ser configurado no solo para
    acceder directamente a los dispositivos de sonido si no también
    para acceder a estos a través de un sistema servidor de sonido.

    Tabla 9.14. Relación de paquetes de sonido

    +---------------------------------------------------------------+
    |     paquete     |popularidad|tamaño|       descripción        |
    |-----------------+-----------+------+--------------------------|
    |alsa-utils       |V:341,     |2283  |utilidades para configurar|
    |                 |I:476      |      |y usar ALSA               |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |La compatibilidad de ALSA |
    |oss-compat       |V:2, I:29  |20    |con OSS evita errores como|
    |                 |           |      |«/dev/dsp no se encuentra»|
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |servidor Conjunto de      |
    |jackd            |V:4, I:27  |9     |Conexiones de Audio JACK  |
    |                 |           |      |(JACK Audio Connection    |
    |                 |           |      |Kit, JACK) (baja latencia)|
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |biblioteca del Conjunto de|
    |libjack0         |V:1, I:13  |338   |Conexión de Audio JACK    |
    |                 |           |      |(JACK Audio Connection    |
    |                 |           |      |Kit, JACK) (baja latencia)|
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |servidor delSistema de    |
    |nas              |V:0, I:0   |243   |Audio en Red (Network     |
    |                 |           |      |Audio System, NAS)        |
    |-----------------+-----------+------+--------------------------|
    |                 |           |      |biblioteca del Sistema de |
    |libaudio2        |V:60, I:488|165   |Audio de Red (Network     |
    |                 |           |      |Audio System, NAS)        |
    |-----------------+-----------+------+--------------------------|
    |pulseaudio       |V:350,     |6398  |servidor PulseAudio,      |
    |                 |I:471      |      |reemplazo de ESD          |
    |-----------------+-----------+------+--------------------------|
    |                 |V:289,     |      |biblioteca del cliente    |
    |libpulse0        |I:604      |969   |PulseAudio, reemplazo de  |
    |                 |           |      |ESD                       |
    |-----------------+-----------+------+--------------------------|
    |libgstreamer1.0-0|V:372,     |5280  |GStreamer: motor de sonido|
    |                 |I:574      |      |GNOME                     |
    |-----------------+-----------+------+--------------------------|
    |libphonon4       |I:121      |680   |Phonon: motor de sonido   |
    |                 |           |      |KDE                       |
    +---------------------------------------------------------------+


    Generalmente existe un motot de sonido común para los entorno de
    escritorio más populares. Cada motor de sonido utilizado por la
    aplicación puede elegir conectarse a diferentes servidores de
    sonido.

%

9.4.8. Deshabilitar el salvapantallas

    Para deshabilitar el salvapantallas, utilice las siguientes
    órdenes.

    Tabla 9.15. Relación de las órdenes para deshabilitar el
    salvapantallas

    +---------------------------------------------------------------+
    |                 entorno                  |       orden        |
    |------------------------------------------+--------------------|
    |La consola de Linux                       |setterm -powersave  |
    |                                          |off                 |
    |------------------------------------------+--------------------|
    |Las Ventanas X (deshabilitando el         |xset s off          |
    |salvapantallas)                           |                    |
    |------------------------------------------+--------------------|
    |Las Ventanas X (deshabilitando dpms)      |xset -dpms          |
    |------------------------------------------+--------------------|
    |Las Ventanas X (configuración por GUI del |xscreensaver-command|
    |salvapantallas)                           |-prefs              |
    +---------------------------------------------------------------+


%

9.4.9. Deshabilitando los pitidos

    Siempre puede desenchufar el altavoz del PC para deshabilitar los
    pitidos. Eliminando el módulo del núcleo pcspkr realiza ese
    trabajo por usted.

    Lo siguiente impide que el programa readline(3) utilizado por 
    bash(1) pite cuando encuentre un carácter de alerta (ASCII=7).

    $ echo «set bell-style none«>> ~/.inputrc

%

9.4.10. Utilización de memoria

    Existen dos recursos disponibles para determinar el uso de la
    memoria.

      * El mensaje de arranque del núcleo en «/var/log/dmesg»
        contiene el tamaño exacto de memoria disponible.
   
      * free(1) y top(1) visualiza la información de los recursos de
        memoria en el sistema en ejecución.

    Aquí hay un ejemplo.

    # grep '\] Memory' /var/log/dmesg
    [    0.004000] Memory: 990528k/1016784k available (1975k kernel code, 25868k reserved, 931k data, 296k init)
    $ free -k
                 total       used       free     shared    buffers     cached
    Mem:        997184     976928      20256          0     129592     171932
    -/+ buffers/cache:     675404     321780
    Swap:      4545576          4    4545572

    Se puede sorprender que «dmesg le diga que existen 990 MB libres
    y free -k dice que solo hay 320 MB libres. Más de 600 MB de
    diferencia …«.

    No se preocupe por el gran tamaño de memoria «utilizada» y el
    pequeño tamaño de memoria «libre» en la línea «Mem:», pero leea
    lo que hay debajo (675404 y 321780 en el ejemplo anterior) y
    relajese.

    Para mi MacBook con 1GB=1048576k DRAM (el sistema de video usa
    algo de esto), tengo lo siguiente.

    Tabla 9.16. Relación de informes de tamaño de la memoria

    +---------------------------------------------------------------+
    |          informe           |              tamaño              |
    |----------------------------+----------------------------------|
    |Tamaño total en dmesg       |1016784k = 1GB - 31792k           |
    |----------------------------+----------------------------------|
    |Memoria libre en dmesg      |990528k                           |
    |----------------------------+----------------------------------|
    |Total en el intérprete de   |997184k                           |
    |órdenes                     |                                  |
    |----------------------------+----------------------------------|
    |Libre en el intérprete de   |20256k (pero de forma efectiva    |
    |órdenes                     |321780k)                          |
    +---------------------------------------------------------------+


%

9.4.11. Sistema de seguridad y de comprobación de la integridad

    Un mantenimiento inadecuado de su sistema puede exponerlo a ser
    atacado desde el exterior.

    Para la seguridad y las comprobaciones de intergridad, debe
    comenzar con lo que se muestra.

      * Para el paquete debsums, consulte debsums(1) y Sección 2.5.2,
        “Archivo «Release» del nivel superior y autenticación”.

      * Para el paquete chkrootkit consulte chkrootkit(1).

      * Para la familia de paquetes clamav consulte clamscan(1) y 
        freshclam(1).

      * FAQ de Seguridad Debian.

      * Manual de Seguridad Debian.

    Tabla 9.17. Relación de las herramientas de seguridad del sistema
    y comprobación de la integridad

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|           descripción           |
    |----------+-----------+------+---------------------------------|
    |          |           |      |demonio que envía por correo     |
    |logcheck  |V:8, I:10  |102   |anomalías en los registros del   |
    |          |           |      |sistema al administrador         |
    |----------+-----------+------+---------------------------------|
    |          |           |      |utilidad para verificar los      |
    |debsums   |V:5, I:42  |107   |archivos de los paquetes         |
    |          |           |      |instalado mediante sumas MD5     |
    |----------+-----------+------+---------------------------------|
    |chkrootkit|V:5, I:24  |970   |detector de rootkit              |
    |----------+-----------+------+---------------------------------|
    |clamav    |V:13, I:58 |774   |utilidad anti-virus para Unix -  |
    |          |           |      |interfaz de línea de órdenes     |
    |----------+-----------+------+---------------------------------|
    |tiger     |V:2, I:3   |7822  |informa de vulnerabilidades de   |
    |          |           |      |seguridad del sistema            |
    |----------+-----------+------+---------------------------------|
    |tripwire  |V:2, I:3   |11521 |comprobador de integridad de     |
    |          |           |      |archivos y directorios           |
    |----------+-----------+------+---------------------------------|
    |john      |V:2, I:12  |452   |herramienta para descifrar       |
    |          |           |      |contraseñas                      |
    |----------+-----------+------+---------------------------------|
    |aide      |V:1, I:2   |2063  |Entorno de Detección Avanzado de |
    |          |           |      |Intrusión - binario estático     |
    |----------+-----------+------+---------------------------------|
    |integrit  |V:0, I:0   |329   |programa de verificación de la   |
    |          |           |      |integridad del archivo           |
    |----------+-----------+------+---------------------------------|
    |crack     |V:0, I:1   |149   |programa que adivina contraseñas |
    +---------------------------------------------------------------+


    Aquí esta un archivo de órdenes para comprobar el permiso de
    escritura incorrecto para todos.

    # find / -perm 777 -a \! -type s -a \! -type l -a \! \( -type d -a -perm 1777 \)

    Atención

    Ya que el paquete debsums utliza la comprobación mediante MD5
    almacenados en local, no debe usarse como una herramienta de
    auditoria del sistema para ataques maliciosos.

%

9.5. Trucos del almacenamiento de datos

    El arranque de su sistema Linux con «live CDs« o CDs de
    instalación de debian en modo rescate hace que sea fácil
    reconfigurar la información de almacenamiento en su dispositivo
    de arranque.

%

9.5.1. Uso de espacio de disco

    El uso de espacio en disco puede ser evaluado por los programas
    proporcionados por los paquetes mount, coreutils y xdu:

      * mount(8) muestra todos los sistemas de archivos (=discos)
        montados.

      * df(1) muestra el espacio de disco utilizado por el sistema de
        archivos.

      * du(1) informa del espacio de disco utilizado por el árbol de
        un directorio.

    Sugerencia

    Puede utilizar la salida de du(8) como entrada de xdu(1x) para
    tener una presentación gráfica e interactiva con «du -k . |xdu»,
    «sudo du -k -x / |xdu», etc.

%

9.5.2. Configuración del particionado de disco

    Para la configuración de la partición del disco , a pesar de que 
    fdisk(8) fue considerado en el pasado el estándar, parted(8)
    merece nuestra atención. Las expresiones «datos del particionado
    del disco«, «tabla de partición«, «mapa de particiones« y
    «marcado del disco« son todas ellas sinónimos.

    La mayor parte de los PCs utilizan el esquema clásico Registro de
    Arranque Primario (Master Boot Record, MBR) para guardar los
    datos del particionado del disco en el primer sector, a saber,
    LBA sector 0 (512 bytes).

    Nota

    Algunos PCs nuevos con Interfaz Firmware Extensible (Extensible
    Firmware Interface, EFI), includios los Macs basados en Intel,
    utilizan el esquema Tabla de Particiones GUID(GPT) para mantener
    la informaciñon del particionado del disco en otro sector
    diferente del primero.

    Aunque fdisk(8) fue la herramienta estándar para el particionado
    del disco, ha sido sustituida por parted(8).

    Tabla 9.18. Relación de paquetes para la gestión del particionado
    del disco

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|   GPT   |      descripción      |
    |----------+-----------+------+---------+-----------------------|
    |          |V:891,     |      |No       |las utilidades varias  |
    |util-linux|I:999      |4598  |soportado|del sistema incluyen   |
    |          |           |      |         |fdisk(8) y cfdisk(8)   |
    |----------+-----------+------+---------+-----------------------|
    |          |           |      |         |Programa de            |
    |parted    |V:363,     |304   |Soporte  |modificación del tamaño|
    |          |I:561      |      |         |de las particiones de  |
    |          |           |      |         |disco GNU Parted       |
    |----------+-----------+------+---------+-----------------------|
    |          |           |      |         |Editor GNOME del       |
    |gparted   |V:19, I:132|2046  |Soporte  |particionado basado en |
    |          |           |      |         |libparted              |
    |----------+-----------+------+---------+-----------------------|
    |gdisk     |V:278,     |852   |Soporte  |editor del particionado|
    |          |I:513      |      |         |para discos GPT        |
    |----------+-----------+------+---------+-----------------------|
    |          |           |      |         |programa para crear    |
    |kpartx    |V:16, I:29 |87    |Soporte  |mapeos entre           |
    |          |           |      |         |dispositivos y         |
    |          |           |      |         |particiones            |
    +---------------------------------------------------------------+


    Atención

    Aunque parted(8) afirma que crea y también modifica el tamaño de
    los sistemas de archivos, es más seguro realizar estas tareas con
    herramientas especializadas de mantenimiento como mkfs(8) (
    mkfs.msdos(8), mkfs.ext2(8), mkfs.ext3(8), mkfs.ext4(8), …) y 
    resize2fs(8).

    Nota

    Para realizar el cambio entre GPT y MBR, necesita eliminar el
    contenido de unos cuantos bloques ubicados al principio (consulte
    Sección 9.7.6, “Limpieza del contenido de los archivos”) y
    utilice «parted /dev/sdx mklabel gpt» o «parted /dev/sdx mklabel
    msdos» para asignarlo. Tenga en cuenta que «msdos» se utiliza
    para MBR.

%

9.5.3. Acceso al particionado utilizando UUID

    A pesar de que la reconfiguración de su partición u orden de
    activación de los medios de almacenamiento no permanentes sus
    particiones pueden tener diferentes nombres, puede acceder a
    ellos de forma consistente. Esto es de ayuda, incluso, varios
    discos y su BIOS no le asigna nombres consistentes.

      * Mount(8) con la opción «-U» permite montar dispositivos de
        bloque utilizando UUID, en lugar de sus nombres de archivo
        como «/dev/sda3».
   
      * «/etc/fstab» (consulte fstab(5)) puede utilizar UUID.

      * Los gestores de arranque (Sección 3.1.2, “Fase 2: el cargador
        de arranque”) pueden utilizar también UUID.

    Sugerencia
   
    Puede determinar el UUID de un dispositivo especial de bloque con
    blkid(8).

    Sugerencia

    Los nodos de los dispositivos como de los medios de
    almacenamiento no permanentes pueden hacerse estáticos con la
    utilización de las reglas udev, si es necesario. Consulte
    Sección 3.3, “El sistema udev”.

%

9.5.4. LVM2

    LVM2 es un gestor de volumenes lógicos del núcleo de Linux. Con
    LVM2 las particiones de disco se pueden crear en volumenes
    lógicos en vez de discos duros físicos.

    LVM necesita lo siguiente.

      * soporte de device-mapper en el núcleo Linux (por defecto en
        los núcleos de Debian)

      * el soporte de la biblioteca device-mapper en el espacio de
        usuario (paquete libdevmaper*)

      * herramientas LVM2 del espacio de usuario (paquete lvm2)

    Por favor, para comenzar a aprender LVM2 lea las siguiente
    páginas de manual.

      * lvm(8): Fundamentos del mecanismo LVM2 (relación de todas las
        órdenes LVM2)

      * lvm.conf(5): archivo de configuración de LVM2
   
      * lvs(8): crea un informe sobre los volúmenes lógicos

      * vgs(8): crea un informe sobre los grupos de volúmentes

      * pvs(8): crea un informe sobre los volúmenes físicos

%

9.5.5. Configuración del sistema de archivos

    Para el sistema de archivos ext4, el paquete e2fsprogs aporta lo
    siguiente.

      * mkfs.ext4(8) para crear un nuevo de sistema de archivos ext4

      * fsck.ext4(8) para comprobar y reparar un sistema de archivos
        ext4 preexistente
   
      * tune2fs(8) para configurar el superbloque de ext4 filesystem

      * debugfs(8) para depurar en modo interactivo el sistema de
        archivos ext4. (Existe la orden undel para recuperar los
        archivos borrados.)

    Las órdenes mkfs(8) y fsck(8) esta en el paquete e2fsprogs como
    interfaz de varios programas especificos del sistema de archivos
    (mkfs.fstype y fsck.fstype). Para el sistema de archivos ext4
    existen mkfs.ext4(8) y fsck.ext4(8) (esta enlazado a mke2fs(8) y 
    e2fsck(8)).

    Las siguientes órdenes están disponibles para cada sistema de
    archivos que soporta Linux.

    Tabla 9.19. Relación de paquetes para la gestión del sistema de
    archivos

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|         descripción          |
    |-------------+-----------+------+------------------------------|
    |e2fsprogs    |V:576,     |1449  |utilidades para el sistema de |
    |             |I:999      |      |archivos ext2/ext3/ext4       |
    |-------------+-----------+------+------------------------------|
    |reiserfsprogs|V:11, I:29 |1132  |utilidades para el sistema de |
    |             |           |      |archivos Reiserfs             |
    |-------------+-----------+------+------------------------------|
    |             |V:128,     |      |utilidades para el sistema de |
    |dosfstools   |I:524      |235   |archivos FAT. (Microsoft:     |
    |             |           |      |MS-DOS, Windows)              |
    |-------------+-----------+------+------------------------------|
    |xfsprogs     |V:21, I:98 |3191  |utilidades para el sistema de |
    |             |           |      |archivos XFS. (SGI: IRIX)     |
    |-------------+-----------+------+------------------------------|
    |             |V:186,     |      |utilidades para el sistema de |
    |ntfs-3g      |I:512      |1479  |archivos NTFS. (Microsoft:    |
    |             |           |      |Windows NT, …)                |
    |-------------+-----------+------+------------------------------|
    |jfsutils     |V:1, I:12  |1577  |utilidades para el sistema de |
    |             |           |      |archivos JFS. (IBM: AIX, OS/2)|
    |-------------+-----------+------+------------------------------|
    |reiser4progs |V:0, I:4   |1373  |utilidades para el sistema de |
    |             |           |      |archivos Reiser4              |
    |-------------+-----------+------+------------------------------|
    |             |           |      |utilidades para el sistema de |
    |hfsprogs     |V:0, I:8   |356   |archivos HFS y HFS Plus.      |
    |             |           |      |(Apple: Mac OS)               |
    |-------------+-----------+------+------------------------------|
    |btrfs-progs  |V:38, I:64 |4027  |utilidades para el sistema de |
    |             |           |      |archivos Btrfs                |
    |-------------+-----------+------+------------------------------|
    |             |           |      |programa de cero bloques      |
    |zerofree     |V:3, I:94  |25    |libres para sistemas de       |
    |             |           |      |archivos ext2/3/4             |
    +---------------------------------------------------------------+


    Sugerencia

    Ext4 es el sistema de archivos por defecto para el sistema Linux
    y es muy recomendable su uso a menos que tenga una razón concreta
    para no hacerlo.

    Sugerencia

    El sistema de archivos Btrfs filesystem esta disponible desde el
    núcleo de Linux 3.2 (Debian wheezy). Se espera que sea el próximo
    sistema de archivos por defecto después del sistema de archivos
    ext4.

    Aviso

    No debería utilizar el sistema de archivos Btrfs para sus datos
    críticos hasta que fsck(8) no tenga las funcionalidad de espacio
    de nñucleo vivo y soporte del gestor de arranque.

    Sugerencia

    Algunas herramientas permiten el acceso al sistema de archivos
    sin soporte del núcleo de Linux (consulte Sección 9.7.2,
    “Manipular archivos sin el montaje de discos”).

9.5.6. Comprobación de la integridad y creación del sistema de
archivos

    La orden mkfs(8) crea el sistema de archivos en el sistema Linux.
    La orden fsck(8) aporta la comprobación de integridad al sistema
    de archivos y la capacidad de reparación al sistema Linux.

    El Debian actual no ejecuta periódicamente fsck después de la
    creación del sistema de archivos.

    Atención
   
    Normalmente no es seguro ejecutar fsck en sistemas de archivos
    montados.

    Sugerencia

    Puede ejecutar la orden fsck(8) de forma segura en todos los
    sistemas de archivos incluido el sistema de archivos raíz en el
    arranque activando «enable_periodic_fsck» en «/etc/mke2fs.conf» y
    el contador de montajes máximo a 0 utilizando «tune2fs -c0 /dev/
    <nombre_de_la_partición>». Consulte mke2fs.conf(5) y tune2fs(8).

    Sugerencia
   
    Para comprobar la ejecución de la orden fsck(8) del archivo de
    órdenes del arranque compruebe los archivos en «/var/log/fsck/».

9.5.7. Optimización de los sistemas de archivos a través de las
opciones de montaje

    La configuración estática básica del sistema de archivos se
    realizan en «/etc/fstab». Por ejemplo,

    # <file system> <mount point>   <type>  <options>       <dump>  <pass>
    proc            /proc           proc    defaults        0       0
    UUID=709cbe4c-80c1-56db-8ab1-dbce3146d2f7 / ext4 noatime,errors=remount-ro 0 1
    UUID=817bae6b-45d2-5aca-4d2a-1267ab46ac23 none swap sw  0       0
    /dev/scd0       /media/cdrom0   udf,iso9660 user,noauto 0       0

    Sugerencia

    UUID (consulte Sección 9.5.3, “Acceso al particionado utilizando
    UUID”) puede utilizarse para identificar los dispositovos de
    bloque en lugar de los nombres de los dispositivos de bloque como
    «/dev/sda1», «/dev/sda2», …

    La personalización y la caracterización del sistema de archivos
    se puede optimizar a través de la utilización de las opciones de
    montaje (consulte fstab(5) y mount(8)). Los más relevantes son
    los siguientes.

      * La opción «defaults» conlleva las siguientes opciones:
        «rw,suid,dev,exec,auto,nouser,async». (Uso general)

      * La opción «noatime» o «relatime» es muy efectiva para mejorar
        los accesos de lectura. (Uso general)

      * La opción «user» permite un usuario normal el montaje de
        sistemas de archivos. Esta opción conlleva la combinación de
        opciones «noexec,nosuid,nodev» . (Utlizado generalmente en
        CDs o dispositivos de almacenamiento USB)

      * La combinación de opciones «noexec,nodev,nosuid» se utiliza
        para la mejora de la seguridad. ( Uso general)

      * La opción «noauto» solo permite el montaje de forma
        explícita. (Uso general)

      * La opción «data=journal» de ext3fs puede mejorar la
        integridad de la información ante caidas de fuerza y pierde
        algo de velocidad de escritura.

    Sugerencia

    Necesita aportar parámetros de arranque al núcleo (consulte
    Sección 3.1.2, “Fase 2: el cargador de arranque”),p. ej.
    «rootflags=data=journal» para desplegar el modo de registro de
    operaciones (journaling) no estándar para el sistema de archivos
    raíz. En lenny, el modo de registro de operaciones por defecto es
    «rootflags=data=ordered». Para squeeze es «rootflags=data=
    writeback».

%

9.5.8. Optimización del sistema de archivo a través del superbloque

    La caracterización del sistema de archivos puede ser optimizado a
    través de su superbloque utilizando la orden tune2fs(8).

      * La ejecución de «sudo tune2fs -l /dev/hda1» muestra el
        contenido del sistema de archivos del superbloque de «/dev/
        hda1».

      * La ejecución de «sudo tune2fs -c 50 /dev/hda1» cambia la
        frecuencia de comprobaciones del sistema de archivos (fsck
        durante el arranque) cada 50 arranques en «/dev/hda1».

      * La ejecución de «sudo tune2fs -j /dev/hda1» añade la
        capacidad del registro de operaciones al sistema archivos, a
        saber conversión del sistema de archivos de ext2 a ext3 en «/
        dev/hda1». (Para ello se necesita que el sistema de archivos
        este desmontado.)

      * La ejecución de «sudo tune2fs -O extents,uninit_bg,dir_index
        /dev/hda1 && fsck -pf /dev/hda1» lo convierte de ext3 a ext4
        en «/dev/hda1». (Realice esto con el sistema de archivos
        desmontado.)

    Sugerencia

    A pesar de su nombre, tune2fs(8) trabaja no solo con el sistema
    de archivos ext2 pero también con los sistemas de archivos ext3 y
    ext4.

%

9.5.9. Optimización del disco duro

    Aviso

    Por favor, compruebe su hardware y lea las páginas de manual de 
    hdparam(8) antes de probar las configuraciones del disco duro ya
    que puede ser peligroso para la integridad de los datos.

    Puede comprobar la velocidad de acceso al disco duro, p. ej. «/
    dev/hda» con «hdparm -tT /dev/hda». Algunos discos conectados
    mediante (E)IDE se puede mejorar su velocidad con «hdparm -q -c3
    -d1 -u1 -m16 /dev/hda» activando el «soporte I/O (E)IDE 32-bit«,
    activando la «bandera using_dma«, asignando la «bandera
    interrupt-unmask« y activando «multiple 16 sector I/O«
    (¡peligroso!).

    Puede comprobar la funcionalidad de la escritura de caché del
    disco duro , p. ej. «/dev/sda», con «hdparm -W /dev/sda». Para
    deshabilitar esta funcionalidad ejecute «hdparm -W 0 /dev/sda».

    Puede intentar leer CDROMs dañados en dispositivos de lectura de
    alta velocidad modernos haciendo que funcionen a menor velocidad
    con «setcd -x 2».

%

9.5.10. Optimización de un disco de estado sólido (SSD)

    El desempeño y el desgaste de un disco de estado sólido (SSD)
    puede optimizarse de la siguiente manera.

      * Utilice el núcleo de Linux más reciente. (>= 3.2)

      * Reduzca las escrituras al disco para accesos de lectura.

          + Asigne la opción «noatime» o «relatime» en el montaje de
            /etc/fstab.

      * Active la orden TRIM.

          + Asigne la opción de montaje «discard» en /etc/fstab para
            los sistemas de archivos ext4 , partición de intercambio,
            Btrfs, etc. Consulte fstab(5).

          + Asigne la opción «discard» en /etc/lvm/lvm.conf para LVM.
            Consulte lvm.conf(5).

          + Asigne la opción «discard» en /etc/crypttab para
            dm-crypt. Consulte crypttab(5).

      * Active el esquema de asignación de espacio de disco
        optimizado SSD,

          + Asigne la opción de montaje «ssd» en /etc/fstab para
            btrfs.

      * Haga que el sistema sincronice los datos cada 10 minutos al
        disco si utiliza un portátil.

          + Asigne la opcińo de montaje «commit=600» en /etc/fstab.
            Consulte fstab(5).

          + Active pm-utils a modo-portátil incluso si está conectado
            a la corriente. Consulte Debian BTS #659260.

    Aviso

    Cambiar la cadencia de la sincronización de datos del valor por
    defecto de 5 segundos a 10 miuntos hace que sus datos sean
    vulnerables a fallos de corriente.

%

9.5.11. Utilice SMART para predecir fallos en su disco duro

    Puede monitorear y registrar el cumplimiento de su disco duro con
    SMART con el demonio smartd(8).

     1. Active la funcionalidad SMART en la BIOS.

     2. Instale el paquete smartmontools.

     3. Identifique los dispositivos que son discos duros
        enumerándolos con df(1).

          + Asumamos que el dispositivo de disco duro a controlar es
            «/dev/hda».

     4. Compruebe la salida de «smartctl -a /dev/hda» para verificar
        que la funcionalidad SMART está activada realmente.

          + Si no es así, activelo con «smartctl -s on -a /dev/hda».

     5. Active el demonio smartd(8) ejecutando lo siguiente.

          + descomente «start_smartd=yes» en el archivo «/etc/default
            /smartmontools».

          + reinicie el demonio smartd(8) mediante «sudo /etc/init.d/
            smartmontools restart».

    Sugerencia

    El demonio smartd(8) daemon se puede personalizar mediante el
    archivo /etc/smartd.conf que incluye el modo de notificación de
    las alertas.

9.5.12. Determine el directorio de almacenamiento temporal por medio
de $TMPDIR

    Las aplicaciones habitualmente crean los archivos temporales en
    el directorio de almacenamiento temporal «/tmp». Si «/tmp» no
    proporciona suficiente espacio, puede especificar el directorio
    de almacenamiento temporal por medio de la variable $TMPDIR para
    obtener el comportamiento adecuado de las aplicaciones.

9.5.13. Expansión del espacio de almacenamiento utilizable mediante
LVM

    Las particiones creadas mediante el Gertor de Volumenes Lógicos
    (Logical Volume Manager, LVM) (funcionalidad de Linux) en el
    momento de la instalación, pueden ser redimensionadas de forma
    sencilla mediante la concatenación o la extensión de estas sobre
    varios dispositivos de almacenamiento sin necesitar otras
    reconfiguraciones del sistema.

9.5.14. Expansión del espacio de almacenamiento útil mendiante el
montaje de otra partición

    Si tiene una partición vacia (p. ej. «/dev/sdx»), puede darle
    formato con mkfs.ext4(1) y montarlo(8) en un directorio donde
    necesite más espacio. (Necesitará copiar el contenido de los
    datos originales.)

    $ sudo mv work-dir old-dir
    $ sudo mkfs.ext4 /dev/sdx
    $ sudo mount -t ext4 /dev/sdx work-dir
    $ sudo cp -a old-dir/* work-dir
    $ sudo rm -rf old-dir

    Sugerencia

    También puede montar un archivo de imagen de disco vacio
    (consulte Sección 9.6.5, “Haciendo un archivo de imagen de disco
    vacio”) como un dispositivo «loop« (consulte Sección 9.6.3,
    “Montaje del archivo de la imagen del disco”). La utilización de
    disco real crece con el almacenamiento de datos.

9.5.15. Expansión del espacio de almacenamient por el enlace mediante
el montaje en otro directorio

    Si tiene un directorio vacio (p. ej. «/path/to/emp-dir») en otra
    partición con espacio utilizable, puede montar(8)lo con la opción
    «--bind» a un directorio (p. ej., «work-dir») donde necesite más
    espacio.

    $ sudo mount --bind /ruta/al/directorio_de_trabajo_vacio

9.5.16. Expansion of usable storage space by overlay-mounting another
directory

    If you have usable space in another partition (e.g., "/path/to/
    empty" and "/path/to/work"), you can create a directory in it and
    stack that on to an old directory (e.g., "/path/to/old") where
    you need space using the OverlayFS for Linux kernel 3.18 or newer
    (Debian Stretch 9.0 or newer).

    $ sudo mount -t overlay overlay \
      -olowerdir=/ruta/al/directorio_antiguo,upperdir=/ruta/al/directorio_vacio,workdir=/ruta/al/directorio_de_trabajo

    Aquí, «/ruta/al/directorio_vacio» y «/ruta/al/
    directorio_de_trabajo» deben ser una partición con permisos de
    lectura y escritura para escribir en «/ruta/al/
    directorio_antiguo».

9.5.17. Expansión del espacio de almacenamiento útil utilizando un
enlace simbólico

    Atención

    This is a deprecated method. Some software may not function well
    with "symlink to a directory". Instead, use the "mounting"
    approaches described in the above.

    Si tiene un directorio vacio (p. ej., «/path/to/emp-dir») en otra
    partición con espacio utilzable, puede crear un enlace simbólico
    a el directorio con ln(8).

    $ sudo mv directoro_actual directorio_antiguo
    $ sudo mkdir -p /ruta/a/directorio_vacio
    $ sudo ln -sf /ruta/a/directorio_vacio directorio_actual
    $ sudo cp -a directorio_antiguo/* directorio_actual
    $ sudo rm -rf directorio_antiguo

    Aviso

    No utilice «enlaces simbólicos a directorios« que son gestionados
    por el sistema como «/opt». Como enlace simbólico puede ser
    sobreescrito cuando se actualice el sistema.

%

9.6. La imagen de disco

    Aquí hablaremos de la manipulación de imágenes de disco.

%

9.6.1. Creando un archivo de imagen de disco

    El archivo de imagen de disco «disk.img», de un dispositivo
    desmontado, p. ej. el segundo disco SCSI o serial ATA «/dev/sdb»,
    puede hacerse utilizando cp(1) o dd(1) como se muestra.

    # cp /dev/sdb disk.img
    # dd if=/dev/sdb of=disk.img

    La imagen de disco de un PC tradicional Registro de Arranque
    Maestro(MBR) (consulte Sección 9.5.2, “Configuración del
    particionado de disco”) el cual está en el primer sector del
    disco primario IDE puede hacerse mediante dd(1) lo siguiente.

    # dd if=/dev/hda of=mbr.img bs=512 count=1
    # dd if=/dev/hda of=mbr-nopart.img bs=446 count=1
    # dd if=/dev/hda of=mbr-part.img skip=446 bs=1 count=66

      * «mbr.img»: MBR con la tabla de particiones

      * «mbr-nopart.img»: MBR sin la tabla de particiones

      * «mbr-part.img»: Unicamente la tabla de particiones MBR

    Si su disco de arranque es SCSI o serial ATA, cambie «/dev/hda»
    por «/dev/sda».

    Si ha hecho una imagen del disco de la partición del disco
    original, cambie «/dev/hda» por «/dev/hda1» etc.

%

9.6.2. Escribiendo directamente en el disco

    El archivo de la imagen del disco «disk.img» puede ser escrito
    como un dispositivo sin montar, p. ej., el dispositivo SCSI
    secundario «/dev/sdb» con el tamaño adecuado como se muestra.

    # dd if=disk.img of=/dev/sdb

    De forma parecida, el archivo de la imagen de la partición del
    disco, «partition.img» puede ser escrito a una partición
    desmontada, p. ej., la primera partición del segundo dispositivo
    SCSI «/dev/sdb1» con el tamaño correcto, como se muestra.

    # dd if=partition.img of=/dev/sdb1

%

9.6.3. Montaje del archivo de la imagen del disco

    La imagen del disco «partition.img» que contiene la imagen de una
    única partición puede ser montada y desmontada utilizandolo como
    dispositivo «loop« como se muestra.

    # losetup -v -f partition.img
    Dispositivo «loop« es /dev/loop0
    # mkdir -p /mnt/loop0
    # mount -t auto /dev/loop0 /mnt/loop0
    ...hack...hack...hack
    # umount /dev/loop0
    # losetup -d /dev/loop0

    Este se puede simplificar como se muestra.

    # mkdir -p /mnt/loop0
    # mount -t auto -o loop partition.img /mnt/loop0
    ...hack...hack...hack
    # umount partition.img

    Cada partición de una imagen de disco «disk.img» que contiene
    varias particiones pueden ser montadas utilizando los
    dispositivos «loop«. Ya que el dispositivo «loop« no gestiona
    particiones por omisión, necesitamos iniciarlo como se muestra.

    # modinfo -p loop # comprueba la funcionalidad del núcleo
    max_part: número máximo de particiones por dispositivo «loop«
    max_loop: número máximo de dispositivos «loop«
    # losetup -a # comprueba que nadie utiliza el dispositivo «loop«
    # rmmod loop
    # modprobe loop max_part=16

    Ahora, el dispositivo «loop« puede gestionar hasta 16
    particiones.

    # losetup -v -f disk.img
    Dispositivo «loop« es /dev/loop0
    # fdisk -l /dev/loop0

    Disco /dev/loop0: 5368 MB, 5368709120 bytes
    255 cabezas, 63 sectores/pista, 652 cilindros
    Unidades = cilindros de 16065 * 512 = 8225280 bytes
    Identificador de disco: 0x452b6464

          Device Boot      Start         End      Blocks   Id  System
    /dev/loop0p1               1         600     4819468+  83  Linux
    /dev/loop0p2             601         652      417690   83  Linux
    # mkdir -p /mnt/loop0p1
    # mount -t ext4 /dev/loop0p1 /mnt/loop0p1
    # mkdir -p /mnt/loop0p2
    # mount -t ext4 /dev/loop0p2 /mnt/loop0p2
    ...hack...hack...hack
    # umount /dev/loop0p1
    # umount /dev/loop0p2
    # losetup -d /dev/loop0

    De forma, los mismos efectos pueden conseguirse utilizando el
    mapeo de dispositivos de los dispositivos creados por kpartx(8)
    del paquete kpartx como se muestra.

    # kpartx -a -v disk.img
    ...
    # mkdir -p /mnt/loop0p2
    # mount -t ext4 /dev/mapper/loop0p2 /mnt/loop0p2
    ...
    ...hack...hack...hack
    # umount /dev/mapper/loop0p2
    ...
    # kpartx -d /mnt/loop0

    Nota

    Puede montar una única partición como imagen del disco con
    dispositivos «loop« utilizando el desplazamiento para evitar el
    MBR etc., también. Pero es más propenso a errores.

%

9.6.4. Limpiando un archivo de imagen de disco

    Un archivo de imagen de disco, «disk.img» puede ser limpiado de
    archivos borrados en una imagen dispersa limpia «new.img» como se
    muestra.

    # mkdir old; mkdir new
    # mount -t auto -o loop disk.img old
    # dd bs=1 count=0 if=/dev/zero of=new.img seek=5G
    # mount -t auto -o loop new.img new
    # cd old
    # cp -a --sparse=always ./ ../new/
    # cd ..
    # umount new.img
    # umount disk.img

    Si «disk.img» es ext2, ext3 or ext4, también puede utilizar 
    zerofree(8) del paquete zerofree como se muestra.

    # losetup -f -v disk.img
    El dispositivo «loop« es /dev/loop3
    # zerofree /dev/loop3
    # cp --sparse=always disk.img new.img

%

9.6.5. Haciendo un archivo de imagen de disco vacio

    La imagen de disco vacio «disk.img» el cual puede crecer hasta
    5GiB, pude hacerse mediante dd(1) como se muestra.

    $ dd bs=1 count=0 if=/dev/zero of=disk.img seek=5G

    Puede crear un sistema de archivos ext4 en la imagen de disco
    «disk.img» utilizando el dispositivo «loop« como se muestra.

    # losetup -f -v disk.img
    El dispositivo «loop« es /dev/loop1
    # mkfs.ext4 /dev/loop1
    ...hack...hack...hack
    # losetup -d /dev/loop1
    $ du  --apparent-size -h disk.img
    5.0G  disk.img
    $ du -h disk.img
    83M disk.img

    Para «disk.img», su tamaño de archivo es 5.0 GiB y su utilización
    real de disco es de sólo 83MiB. Esta discrepancia es posible ya
    que ext4 se puede representar mediante un archivo disperso.

    Sugerencia
   
    La utilización real de discos que utiliza un archivo disperso
    crece con los datos que son escritos en el.

    Utilizando la misma operación en dispositivos creados por el
    dispositivo «loop« o el dispositivo mapeador de dispositivos como
    Sección 9.6.3, “Montaje del archivo de la imagen del disco”,
    puede particionar esta imagen de disco «disk.img» utilizando 
    parted(8) o fdisk(8) y puede crear el archivo de sistemas en el
    utilizando mkfs.ext4(8), mkswap(8), etc.

%

9.6.6. Haciendo un archivo de imagen ISO9660

    El archivo de imagen ISO9660, «cd.iso», utilizando como origen el
    árbol de directorios de «directorio_origen» se puede hacer
    utilizando genisoimage(1) aportado por cdrkit como se muestra.

    #  genisoimage -r -J -T -V volume_id -o cd.iso directorio_origen

    De igual manera, el archivo imagen ISO9660 arrancable,
    «cdboot.iso», se puede realizar desde el instalador debian como
    el árbol de directorios del «directorio_origen» como se muestra.

    #  genisoimage -r -o cdboot.iso -V volume_id \
       -b isolinux/isolinux.bin -c isolinux/boot.cat \
       -no-emul-boot -boot-load-size 4 -boot-info-table directorio_origen

    Aquí el cargador de arranque Isolinux (consulte Sección 3.1.2,
    “Fase 2: el cargador de arranque”) se utiliza para el arranque.

    Puede calcular el valor md5sum y hace la imagen ISO9660
    directamente desde el dispositivo CD-ROM como se muestra.

    $ isoinfo -d -i /dev/cdrom
    CD-ROM is in ISO 9660 format
    ...
    Logical block size is: 2048
    Volume size is: 23150592
    ...
    # dd if=/dev/cdrom bs=2048 count=23150592 conv=notrunc,noerror | md5sum
    # dd if=/dev/cdrom bs=2048 count=23150592 conv=notrunc,noerror > cd.iso

    Aviso

    Debe evitar cuidadosamente el sistema de archivos ISO9660 debido
    al problema de lectura adelantada de Linux para obtener el
    resultado correcto.

%

9.6.7. Escritura directa al CD/DVD-R/RW

    Sugerencia
   
    DVD es unicamente un CD de mayor tamaño que utiliza wodim(1) que
    es proporcionado por cdrkit.

    Puede encontrar un dispositivo utilizable como se muestra.

    # wodim --devices

    Entonces se inserta el CD-R vacio en el dispositivo CD,y el
    archivo de imagen ISO9660 , «cd.iso» se escribe en el
    dispositivo, p. ej. «/dev/hda», utilizando wodim(1) como se
    muestra.

    # wodim -v -eject dev=/dev/hda cd.iso

    Si se utiliza un CR-RW enlugar de un CD-R, hago lo siguiente en
    su lugar.

    # wodim -v -eject blank=fast dev=/dev/hda cd.iso

    Sugerencia

    Si su sistema de escritorio monta automaticamente los CD,
    desmontelo con «sudo umount /dev/hda» desde la consola antes de
    utilizar wodim(1).

%

9.6.8. Montando un archivo imagen ISO9660

    Si «cd.iso» contiene una imagen ISO9660, entonces lo siguiente
    sirve para montarlo de forma manual en «/cdrom».

    # mount -t iso9660 -o ro,loop cd.iso /cdrom

    Sugerencia

    Los sistemas de escritorio modernos pueden montar los medios
    extraibles como un CD con formato ISO9660 de forma automática
    (consulte Sección 10.1.7, “Dispositivos de almacenamiento
    extraibles”).

%

9.7. Datos binarios

    Aquí discutiremos la manipulación directa de datos binarios en
    medios de almacenamiento.

%

9.7.1. Viendo y editando datos binarios

    El método más básico de visualización de datos binarios es la
    orden «od -t x1».

    Tabla 9.20. Relación de paquetes para la visualización y edición
    de datos binarios

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|        descripción         |
    |---------------+-----------+------+----------------------------|
    |               |V:891,     |      |paquete básico que tiene od |
    |coreutils      |I:999      |17478 |(1) para volcar archivos    |
    |               |           |      |(HEX, ASCII, OCTAL, …)      |
    |---------------+-----------+------+----------------------------|
    |               |           |      |paquete de utilidades que   |
    |bsdmainutils   |V:60, I:996|26    |tiene hd(1) para volcar     |
    |               |           |      |archivos (HEX, ASCII, OCTAL,|
    |               |           |      |…)                          |
    |---------------+-----------+------+----------------------------|
    |hexedit        |V:1, I:12  |72    |visor y editor binario (HEX,|
    |               |           |      |ASCII)                      |
    |---------------+-----------+------+----------------------------|
    |               |           |      |editor hexadecimal con      |
    |bless          |V:0, I:4   |1028  |funcionalidad completa      |
    |               |           |      |(GNOME)                     |
    |---------------+-----------+------+----------------------------|
    |               |           |      |editor hexadecimal con      |
    |okteta         |V:1, I:15  |1508  |funcionalidad completa      |
    |               |           |      |(KDE4)                      |
    |---------------+-----------+------+----------------------------|
    |ncurses-hexedit|V:0, I:2   |132   |visor y editor binario (HEX,|
    |               |           |      |ASCII, EBCDIC)              |
    |---------------+-----------+------+----------------------------|
    |beav           |V:0, I:0   |133   |visor y editor binario (HEX,|
    |               |           |      |ASCII, EBCDIC, OCTAL, …)    |
    +---------------------------------------------------------------+


    Sugerencia

    HEX es un acrónimo del formato hexadecimal con radix 16. OCTAL se
    utiliza para formato octal con radix 8. ASCII se utiliza para
    Codificación Americana Estándar para el Intercambio de
    Información (American Standard Code for Information Interchange),
    a saber, codificación del inglés normal. EBCDIC es para Extended
    Binary Coded Decimal Interchange Code utilizado en sistemas
    operativos de IBM mainframe.

%

9.7.2. Manipular archivos sin el montaje de discos

    Existen herramientas para leer y escribir archivos sin montar el
    disco.

    Tabla 9.21. Relación de paquetes para manipular archivos sin
    montar el disco

    +---------------------------------------------------------------+
    |paquete |popularidad|tamaño|            descripción            |
    |--------+-----------+------+-----------------------------------|
    |mtools  |V:10, I:83 |389   |utilidades para archivos MSDOS sin |
    |        |           |      |montarlos                          |
    |--------+-----------+------+-----------------------------------|
    |hfsutils|V:0, I:7   |1884  |utilidades para archivos HFS y HFS+|
    |        |           |      |sin montarlos                      |
    +---------------------------------------------------------------+


%

9.7.3. Redundancia de datos

    Los sistemas de software RAID del núcleo Linux aportan
    redundancia en el nivel del sistema de archivos de datos del
    núcleo con la finalidad de alcanzar alta fiabilidad en el
    almacenamiento.

    Existen herramientas para añadir datos redundados a archivos al
    nivel de aplicación de programas para conseguir también alta
    fiabilidad en el almacenamiento.

    Tabla 9.22. Relación de herramientas para añadir redundancia de
    datos a los archivos

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|           descripción           |
    |----------+-----------+------+---------------------------------|
    |          |           |      |Paridad del conjunto de volúmenes|
    |par2      |V:4, I:15  |271   |de archivo, para comprobar y     |
    |          |           |      |reparar archivos                 |
    |----------+-----------+------+---------------------------------|
    |dvdisaster|V:0, I:2   |1741  |Protección contra pérdida/rotura/|
    |          |           |      |vejez de medios CD/DVD           |
    |----------+-----------+------+---------------------------------|
    |          |           |      |herramienta de copia de seguridad|
    |dvbackup  |V:0, I:0   |413   |para MiniDV (aportada por rsbep  |
    |          |           |      |(1))                             |
    |----------+-----------+------+---------------------------------|
    |          |           |      |recuperación de bloques perdidos |
    |vdmfec    |V:0, I:0   |97    |utilizando Corrección de Error   |
    |          |           |      |hacia Adelante                   |
    +---------------------------------------------------------------+


%

9.7.4. Recuperación de datos de archivos y análisis forense

    Existen herramientas para la recuperación de archivos y análisis
    forense.

    Tabla 9.23. Relación de paquetes para la recuperación de archivos
    y análisis forense

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|         descripción          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |utilidades para el escaneado  |
    |testdisk     |V:3, I:38  |1426  |de particiones y              |
    |             |           |      |recuperaciones de disco       |
    |-------------+-----------+------+------------------------------|
    |             |           |      |utilidades para la            |
    |magicrescue  |V:0, I:3   |259   |recuperación de archivos y    |
    |             |           |      |búsqueda de bytes mágicos     |
    |-------------+-----------+------+------------------------------|
    |scalpel      |V:0, I:4   |87    |Divisor de archivos ligero y  |
    |             |           |      |alto rendimiento              |
    |-------------+-----------+------+------------------------------|
    |myrescue     |V:0, I:3   |83    |recuperación de datos de      |
    |             |           |      |discos duros dañados          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |utilidad para recuperar       |
    |extundelete  |V:1, I:11  |148   |archivos borrados en sistemas |
    |             |           |      |de archivos ext3/4            |
    |-------------+-----------+------+------------------------------|
    |             |           |      |utilidad para recuperar       |
    |ext4magic    |V:0, I:4   |233   |archivos borrados en sistemas |
    |             |           |      |de archivos ext3/4            |
    |-------------+-----------+------+------------------------------|
    |             |           |      |herramienta de ayuda a la     |
    |ext3grep     |V:0, I:3   |281   |recuperación de archivos      |
    |             |           |      |borrados en sistemas de       |
    |             |           |      |archivos ext3                 |
    |-------------+-----------+------+------------------------------|
    |             |           |      |programa de recuperación de   |
    |scrounge-ntfs|V:0, I:3   |50    |datos en sistemas de archivos |
    |             |           |      |NTFS                          |
    |-------------+-----------+------+------------------------------|
    |gzrt         |V:0, I:0   |33    |conjunto de herramientas de   |
    |             |           |      |recuperación gzip             |
    |-------------+-----------+------+------------------------------|
    |sleuthkit    |V:2, I:24  |1511  |herramientas de análisis      |
    |             |           |      |forense (Sleuthkit)           |
    |-------------+-----------+------+------------------------------|
    |autopsy      |V:0, I:2   |1027  |interfaz gráfico para         |
    |             |           |      |SleuthKit                     |
    |-------------+-----------+------+------------------------------|
    |foremost     |V:0, I:7   |104   |aplicación forense para la    |
    |             |           |      |recuperación de datos         |
    |-------------+-----------+------+------------------------------|
    |             |           |      |herramienta para el análisis  |
    |guymager     |V:0, I:1   |1030  |forense de imágenes basado en |
    |             |           |      |Qt                            |
    |-------------+-----------+------+------------------------------|
    |dcfldd       |V:0, I:5   |106   |versión mejorada de dd para   |
    |             |           |      |análisis forense y seguridad  |
    +---------------------------------------------------------------+


    Sugerencia

    Puede recuperar archivos borrados en sistemas de archivos ext2
    utilizando la relación_de_inodos_borrados y la orden undel de 
    debugfs(8) en el paquete e2fsprogs.

%

9.7.5. División de un archivo grande en archivos de tamaño menor

    Cuando los datos son demasiado grandes para guardalos en un único
    archivo, puede obtener una copia de seguridad de su contenido
    dividiendolo en, p. ej. trozos de 2000MiB y juntarlos más tarde
    para obtener el archivo original.

    $ split -b 2000m archivo_grande
    $ cat x* >archivo_grande

    Atención
   
    Por favor, aseguresé que no tiene ningún archivo que comienza por
    «x» para evitar fallos de nombrado.

%

9.7.6. Limpieza del contenido de los archivos

    Para limpiar el contenido de los archivos como los archivos de
    registro, no utilice rm(1) para borrarlo y crear uno nuevo vacio,
    ya que puede intentar ser accedido entre ambas operaciones. La
    forma segura de limpiar el contenido de un archivo es la que se
    muestra.

    $ :>archivo_a_limpiar

%

9.7.7. Archivos «vacíos»

    Las órdenes siguientes crean archivos «vacíos».

    $ dd if=/dev/zero    of=5kb.file bs=1k count=5
    $ dd if=/dev/urandom of=7mb.file bs=1M count=7
    $ touch zero.file
    $ : > alwayszero.file

    Encontrará lo siguiente tras ejecutar lo anterior.

      * «5kb.file» que contiene 5KB de ceros.

      * «7mb.file» que contiene 7MB de datos aleatorios.

      * «zero.file» puede tener 0 bytes. Si existiera con
        anterioridad, su mtime es actualizado y su contenido y su
        longitud permanecen sin cambios.

      * «alwayszero.file» es siempre un archivo de 0 bytes. Si
        existía con anterioridad, su mtime es actualizado y su
        contenido borrado.

%

9.7.8. Borrando completo de un disco duro

    Existen diferentes modos de borrar completamente la información
    de un disco duro como dispositivo, p. ej. una memoria USB ubicada
    en «/dev/sda».

    Atención

    Antes de ejecutar las órdenes que le vamos a mostrar, compruebe
    la ubicación de su memoria USB por medio de mount(8). El
    dispositivo que indica «/dev/sda» puede ser un disco duro SCSI o
    serial-ATA que contiene su sistema.

    Borre todo el contenido del disco poiendo a 0 toda la información
    como se muestra.

    # dd if=/dev/zero of=/dev/sda

    Borrelo todo escribiendo datos aleatorios como sigue.

    # dd if=/dev/urandom of=/dev/sda

    Borrelo todo sobreescribiendolo con datos aleatorios de forma
    eficiente como se muestra.

    # shred -v -n 1 /dev/sda

    Ya que dd(1) esta disponible en el intérprete de órdenes de
    muchos CDs de Linux arrancables como el CD instalador de Debian,
    puede borrar el sistema instalado completamente ejecutando una de
    las órdenes anteriores desde dicho medio sobre el disco duro del
    sistema, p. ej.«/dev/hda», «/dev/sda», etc.

%

9.7.9. Borrar áreas de disco duro no utilizadas

    Las áreas en deshuso del disco duro (o de la memoria USB), p. ej.
    «/dev/sdb1» todavái pueden contener datos borrados ya que solo
    han sido desligados del sistema de archivos. Estos pueden ser
    limpiados sobreescribiendolos.

    # mount -t auto /dev/sdb1 /mnt/foo
    # cd /mnt/foo
    # dd if=/dev/zero of=junk
    dd: escribiendo en `junk': No hay espacio disponible en el dispositivo.
    # sync
    # umount /dev/sdb1

    Aviso

    Esto es generalmente suficiente para las memorias USB. Pero no es
    perfecto. La mayor parte de los nombres de archivo borrados y sus
    atributos pueden estar ocultos y permanecer en el sistema de
    archivos.

%

9.7.10. Recuperando archivos borrados pero todavía abiertos

    Incluso en el caso de que accidentalmente haya borrado un
    archivo, mientras que ese archivo sea utilizado por alguna
    aplicación (en modo lectura o escritura), es posible recuperar
    dicho archivo.

    Por ejemplo, intente lo siguiente

    $ echo foo > bar
    $ less bar
    $ ps aux | grep ' less[ ]'
    bozo    4775  0.0  0.0  92200   884 pts/8    S+   00:18   0:00 less bar
    $ rm bar
    $ ls -l /proc/4775/fd | grep bar
    lr-x------ 1 bozo bozo 64 2008-05-09 00:19 4 -> /home/bozo/bar (borrado)
    $ cat /proc/4775/fd/4 >bar
    $ ls -l
    -rw-r--r-- 1 bozo bozo 4 2008-05-09 00:25 bar
    $ cat bar
    foo

    Ejecute en otro terminal (cuando tenga el paquete lsof instalado)
    como se muestra.

    $ ls -li bar
    2228329 -rw-r--r-- 1 bozo bozo 4 2008-05-11 11:02 bar
    $ lsof |grep bar|grep less
    less 4775 bozo 4r REG 8,3 4 2228329 /home/bozo/bar
    $ rm bar
    $ lsof |grep bar|grep less
    less 4775 bozo 4r REG 8,3 4 2228329 /home/bozo/bar (borrado)
    $ cat /proc/4775/fd/4 >bar
    $ ls -li bar
    2228302 -rw-r--r-- 1 bozo bozo 4 2008-05-11 11:05 bar
    $ cat bar
    foo

%

9.7.11. Buscando todos los enlaces duros

    Los archivos con enlaces duros pueden identificarse mediante «ls
    -li».

    $ ls -li
    total 0
    2738405 -rw-r--r-- 1 root root 0 2008-09-15 20:21 bar
    2738404 -rw-r--r-- 2 root root 0 2008-09-15 20:21 baz
    2738404 -rw-r--r-- 2 root root 0 2008-09-15 20:21 foo

    Tanto «baz» y «foo» tiene una cuenta de «2« (>1) de forma que
    tiene enlaces duros. Sus números de inodos son comunes «2738404«.
    Esto significa que son el mismo archivo mediante un archivo duro.
    Si no quiere encontrar todos los enlaces duros mediante la
    suerte, puede buscarlos mediante el inodo, p. ej. «2738404« como
    se muestra.

    # find /ruta/al/punto/de/montaje -xdev -inum 2738404

%

9.7.12. Consumo invisible de espacio de disco

    Todos los archivos borrados pero abiertos consumen espacio de
    disco aunque no son visibles para el du(1) normal. Estos pueden
    ser enumerados junto con su tamaño como se muestra.

    # lsof -s -X / |grep deleted

%

9.8. Trucos para cifrar información

    Con acceso físico a su PC, cualquiera puede acceder como
    superusuario y acceder a todos los archivos en él (consulte
    Sección 4.7.4, “Asegurando la contraseña de root”). Esto
    significa que el sistema de acceso por contraseña puede no
    securizar sus datos delicados y privados contra posibles ladrones
    de su PC. Para hacerlo debe desplegar alguna tecnología de
    cifrado de información. Aunque GNU privacy guard (consulte
    Sección 10.3, “Infraestructura de seguridad de la información”)
    puede cifrar archivos , necesita de los esfuerzos del usuario.

    dm-crypt y eCryptfs ayudan al cifrado automático de la
    información de forma nativa por medio de módulos del núcleo Linux
    con el mínimo esfuezo por parte del usuario.

    Tabla 9.24. Relación de utilidades para el cifrado de información

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|         descripción         |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |utilidades para cifrar       |
    |cryptsetup    |V:29, I:78 |402   |dispositivos de bloque       |
    |              |           |      |(dm-crypt / LUKS)            |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |utilidades para cifrar       |
    |              |           |      |dispositivos de bloque       |
    |cryptmount    |V:4, I:5   |228   |(dm-crypt / LUKS) centrado en|
    |              |           |      |el montaje/desmontaje por    |
    |              |           |      |usuarios normales            |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |utilidades para cifrar       |
    |ecryptfs-utils|V:3, I:5   |460   |sistemas de archivos apilados|
    |              |           |      |(eCryptfs)                   |
    +---------------------------------------------------------------+


    Dm-crypt es un sistema de archivos criptográfico utilizando mapeo
    de dispositivos. El mapeo de dispositivos relaciona un
    dispositivo de bloques a otro.

    eCryptfs es otro sistema de archivos criptográfico que utiliza el
    sistema de archivos apilado. Los sistemas de archivos apilados se
    apilan a si mismos en lo alto de un directorio existente del
    sistema de archivos que esta montado.

    Atención
   
    El cifrado de información requiere tiempo de CPU etc. Por favor
    evalue costes y beneficios.

    Nota

    El sistema Debian entero puede instalarse en el disco cifrado por
    el instalador debian (lenny o más nuevo) utilizando dm-crypt/LUKS
    y initramfs.

    Sugerencia

    Consulte Sección 10.3, “Infraestructura de seguridad de la
    información” para la utilización del cifrado del espacio de
    usuario: GNU Privacy Guard.

%

9.8.1. Cifrado de discos externos con dm-crypt/LUKS

    Puede cifrar el contenido de los dispositivos masivos extraibles,
    p. ej. memoria USB en «/dev/sdx», utilizando dm-crypt/LUKS.
    Simplemente formateelo como se muestra.

    # badblocks -c 1024 -s -w -t random -v /dev/sdx
    # fdisk /dev/sdx
    ... «n« «p« «1« «return« «return« «w«
    # cryptsetup luksFormat /dev/sdx1
    ...
    # cryptsetup open --type luks /dev/sdx1 sdx1
    ...
    # ls -l /dev/mapper/
    total 0
    crw-rw---- 1 root root  10, 60 2008-10-04 18:44 control
    brw-rw---- 1 root disk 254,  0 2008-10-04 23:55 sdx1
    # mkfs.vfat /dev/mapper/sdx1
    ...
    # cryptsetup luksClose sdx1

    Entonces, se puede montar de forma habitual en «/media/
    <etiqueta_del_disco>», excepto por la pregunta de la contraseña
    (consulte Sección 10.1.7, “Dispositivos de almacenamiento
    extraibles”) en el entorno de escritorio moderno, como GNOME
    utilizando gnome-mount(1). La diferencia es que cada dato escrito
    en él está cifrado. Alternativamente puede formatear el medio en
    un sistema de archivo diferente, p. ej. ext4 con «mkfs.ext4 /dev/
    mapper/sdx1».

    Nota

    Si de verdad es un paranoico de la seguridad, puede necesitar
    sobreescribirlos varias veces (con la orden «badblocks» del
    ejemplo anterior). Esta operación necesita mucho tiempo.

%

9.8.2. Cifrado de la partición de intercambio con dm-crypt

    Asumamos que su «/etc/fstab» original contiene lo que se muestra.

    /dev/sda7 swap sw 0 0

    Puede activar el cifrado de la partición de intercambio
    utilizando dm-crypt según se muestra.

    # aptitude install cryptsetup
    # swapoff -a
    # echo «cswap /dev/sda7 /dev/urandom swap« >> /etc/crypttab
    # perl -i -p -e «s/\/dev\/sda7/\/dev\/mapper\/cswap/« /etc/fstab
    # /etc/init.d/cryptdisks restart
     ...
    # swapon -a

%

9.8.3. Montaje de disco cifrado con dm-crypt/LUCKS

    Una partición de disco cifrado creado con dm-crypt/LUKS en «/dev/
    sdc5» se puede montar en «/mnt» como se muestra:

    $ sudo cryptsetup open /dev/sdc5 ninja --type luks
    Enter passphrase for /dev/sdc5: ****
    $ sudo lvm
    lvm> lvscan
      inactive          '/dev/ninja-vg/root' [13.52 GiB] inherit
      inactive          '/dev/ninja-vg/swap_1' [640.00 MiB] inherit
      ACTIVE            '/dev/goofy/root' [180.00 GiB] inherit
      ACTIVE            '/dev/goofy/swap' [9.70 GiB] inherit
    lvm> lvchange -a y /dev/ninja-vg/root
    lvm> exit
      Exiting.
    $ sudo mount /dev/ninja-vg/root /mnt

%

9.8.4. Archivos cifrados automáticamente mediante eCryptfs

    Puede cifrar los archivos escritos en «~/Private/»
    automaticamente utilizando eCryptfs y el paquete ecryptfs-utils.

      * Ejecute ecryptfs-setup-private(1) y configure «~/Private/»
        siguiendo las instrucciones.

      * Active «~/Private/» ejecutando ecryptfs-mount-private(1).

      * Mueva los archivos con información sensible a «~/Private/» y
        cree los enlaces simbólicos que necesite.

          + Candidatos: «~/.fetchmailrc», «~/.ssh/identity», «~/.ssh/
            id_rsa», «~/.ssh/id_dsa» y otros archivos con permisos
            «go-rwx»

      * Mueva los directorios sensibles al subdirectorio en «~/
        Private/» y cree los enlaces simbólicos que necesite.

          + Candidatos: «~/.gnupg» y otros directorios con «go-rwx»

      * Para una operativa más fácil del escritorio cree el enlace
        simbólico desde «~/Desktop/Private/» a «~/Private/».

      * Deshabilite «~/Private/» ejecutando ecryptfs-umount-private
        (1).

      * Active«~/Private/» utilizando «ecryptfs-mount-private» cunado
        necesite los datos encriptados.

    Sugerencia

    Debido a que eCryptfs cifra unicamente los archivos sensibles, el
    coste para el sistema es mucho menor que utilizar dm-crypt sobre
    el dispositivo que contiene el árbol de directorios entero o «/
    home». No necesita un esfuerzo para la ubicación del
    almacenamiento en disco pero tampoco mantiene la confidencialidad
    de la metainformación de todo el sistema de archivos.

%

9.8.5. Montaje automático con eCryptfs

    Su utiliza una contraseña de paso para utilizar las claves de
    cifrado, puede automatizar el montaje de eCryptfs por medio de
    PAM (Pluggable Authentication Modules).

    Inserte la siguiente línea justo antes de «pam_permit.so» en «/
    etc/pam.d/common-auth».

    auth required pam_ecryptfs.so unwrap

    Inserte la siguiente línea en la última línea de «/etc/pam.d/
    common-session».

    session optional pam_ecryptfs.so unwrap

    Inserte la siguiente línea en la primera línea activa en «/etc/
    pam.d/common-password».

    password required pam_ecryptfs.so

    Lo cual es bastante conveniente.

    Aviso
   
    Los errores de configuración de PAM puede bloquear el acceso a su
    propio sistema. Consulte Capítulo 4, Acreditación.

    Atención

    Su utiliza su contraseña de acceso para acceder a las claves de
    cifrado, sus datos cifrados son tan seguras como su contraseña de
    acceso de usuario (consulte Sección 4.3, “Buenas contraseñas”).
    Al menos que sea cuidados al elegir una contraseña fuerte, sus
    datos estarán en riesgo cuando alguien ejecute algún software
    para reventar su contraseña trás robar su portátil (consulte
    Sección 4.7.4, “Asegurando la contraseña de root”).

%

9.9. El núcleo

    Debian distribuye el núcleo de Linux modularizado en paquetes
    para soportar las arquitecturas.

%

9.9.1. Núcleo Linux 2.6/3.x

    Existen unas cuantas funcionalidades importantes en los núcleos
    de Linux 2.6/3.x comparado con la versión 2.4.

      * Los dispostivos son creados por el sistema udev (see
        Sección 3.3, “El sistema udev”).

      * El acceso de lectura/escritura a los dispositivos CD/DVD IDE
        no utilizan el módulo ide-scsi.

      * Las funciones de flitrados de paquetes de red utilizan el
        módulo del núcleo iptables.

    El salto de versión entre Linux 2.6.39 a Linux 3.0 no es como
    consecuencia de cambios tecnológicos importantes sino por su 20
    aniversario.

%

9.9.2. Parametros del núcleo

    Muchas funcionalidades de Linux son configurables por medio de
    parámetros del núcleo como se muestra.

      * Los parámetros del núcleo son inicializados por el cargador
        de arranque (consulte Sección 3.1.2, “Fase 2: el cargador de
        arranque”)

      * Los parámetros del núcleo cambian mediante sysctl(8) en
        tiempo de ejecución por aquellos accesibles por medio de
        sysfs (consulte Sección 1.2.12, “procfs y sysfs”)

      * Los parámetros de modprobe(8) se asignan como parámetros del
        módulo cuando se activa el módulo (consulte Sección 9.6.3,
        “Montaje del archivo de la imagen del disco”)

    Consulte «kernel-parameters.txt(.gz)» y otros documentos
    relacionados en la documentación del núcleo de Linux («/usr/share
    /doc/linux-doc-3.*/Documentation/filesystems/*») que están en los
    paquetes linux-doc-3.*.

%

9.9.3. Cabeceras del núcleo

    La mayor parte de los programas normales no necesitan las
    cabeceras del núcleo y de hecho puede producir errores si se
    utiliza directamente para compilar. Estos deben ser compilados
    con las cabeceras en «/usr/include/linux» y «/usr/include/asm»
    que están en el paquete libc6-dev (creado por el paquete fuente
    glibc) en el sistema Debian.

    Nota

    Para compilar algunos programas especificos del núcleo como
    módulos del núcleo de origen externo y el demonio automonter
    (amd), debe incluir la ruta a las cabeceras del núcleo, p. ej.
    «-I/usr/src/linux-particular-version/include/», es su línea de
    órdenes. module-assistant(8) (en su forma corta m-a) ayuda a los
    usuarios a construir e instalar paquete(s) del módulo de forma
    sencilla para uno o más núcleos personalizados.

%

9.9.4. Compilar el núcleo y los módulos asociados

    Debian tiene su propio método para compilar el núcleo y los
    módulos asociados.

    Tabla 9.25. Relación de los paquetes fundamentales para la
    recompilación del núcleo en los sistemas Debian

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|        descripción         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |paquetes fundamentales para |
    |build-essential|I:499      |20    |la construcción de paquetes |
    |               |           |      |Debian: make, gcc, …        |
    |---------------+-----------+------+----------------------------|
    |bzip2          |V:157,     |122   |utilidades de compresión y  |
    |               |I:970      |      |decompresión de archivos bz2|
    |---------------+-----------+------+----------------------------|
    |libncurses5-dev|I:116      |6     |bibliotecas de desaroollo y |
    |               |           |      |documentación de ncurses    |
    |---------------+-----------+------+----------------------------|
    |               |           |      |git: sistema de control de  |
    |git            |V:305,     |35040 |versiones distribuido       |
    |               |I:478      |      |utilizado por el núcleo de  |
    |               |           |      |Linux                       |
    |---------------+-----------+------+----------------------------|
    |               |           |      |aporta el entorno fakeroot  |
    |fakeroot       |V:35, I:521|228   |para la construcción de     |
    |               |           |      |paquetes sin ser «root«     |
    |---------------+-----------+------+----------------------------|
    |initramfs-tools|V:371,     |112   |herramienta para contruir   |
    |               |I:989      |      |initramfs (propio de Debian)|
    |---------------+-----------+------+----------------------------|
    |               |           |      |soporte del núcleo para     |
    |dkms           |V:70, I:219|294   |módulos dinámico (DKMS,     |
    |               |           |      |dynamic kernel module       |
    |               |           |      |support) (genérico)         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |archivos de órdenes para el |
    |devscripts     |V:9, I:57  |2623  |mantenimiento de Paquetes   |
    |               |           |      |Debian (específico de       |
    |               |           |      |Debian)                     |
    +---------------------------------------------------------------+


    Si utiliza initrd in Sección 3.1.2, “Fase 2: el cargador de
    arranque”, asegurese de leer la documentación asociada en 
    initramfs-tools(8), update-initramfs(8), mkinitramfs(8) y 
    initramfs.conf(5).

    Aviso

    No cree enlaces simbólicos en el árbol de directorios del código
    fuente (p. ej. «/usr/src/linux*») de «/usr/include/linux» y «/usr
    /include/asm» cuando compile código fuente del núcleo de Linux.
    (Algunos documentos sin actualizar lo sugieren.)

    Nota

    Cuando compile el núcleo de Linux en el sistema Debian estable,
    la utilización las últimas herramientas retroportadas de Debian
    «inestable» pueden ser necesarias.

    Nota

    El soporte del núcelo a módulos dinámicos (dynamic kernel module
    support, DKMS) es un marco nuevo de distribución independiente
    diseñado para permitir la actualización de módulos sueltos sin
    cambiar el núcleo completo. Esto es utilizado para mantener
    módulos externos. Esto también facilita la reconstrucción de
    módulos cuando actualice su núcleo.

9.9.5. Compilando el código fuente del núcleo: recomendaciones del
Equipo Debian del Núcleo

    Para la construcción de paquetes binarios personalizados del
    núcleo desde el código fuente del núcleo, podría utilizar el
    objetivo «deb-pkg» que se proporciona para ello.

    $ sudo apt-get build-dep linux
    $ cd /usr/src
    $ wget http://www.kernel.org/pub/linux/kernel/v3.11/linux-<version>.tar.bz2
    $ tar -xjvf linux-<version>.tar.bz2
    $ cd linux-<version>
    $ cp /boot/config-<version> .config
    $ make menuconfig
     ...
    $ make deb-pkg

    Sugerencia

    El paquete linux-source-<version> package contiene el código
    fuente del núcleo de Linux con los parches de Debian como «/usr/
    src/linux-<version>.tar.bz2».

    Para la contrucción de paquetes binarios concretos desde el
    paquete de código fuente del núcleo de Debian, puede utilizar los
    objetivos «binary-arch_<architecture>_<featureset>_<flavour>» en
    «debian/rules.gen».

    $ sudo apt-get build-dep linux
    $ apt-get source linux
    $ cd linux-3.*
    $ fakeroot make -f debian/rules.gen binary-arch_i386_none_686

    Compruebe la información adicional:

      * Debian Wiki: KernelFAQ

      * Debian Wiki: DebianKernel

      * Debian Linux Kernel Handbook: https://
        kernel-handbook.debian.net

%

9.9.6. Controladores y firware del hardware

    El controlador de hardware es el código que se ejecuta en el
    sistema correspondiente. La mayor parte de los controladores de
    hardware están disponibles como software libre actualmente se
    incluyen en los paquetes normales del núcleo de Debian en el área
    main.

      * controlador de GPU

          + Controlador de Intel GPU (main)

          + Controladores AMD/ATI GPU (main)

          + Controlador NVIDIA GPU (main para el controlador nouveau
            y non-free para los controladores binarios aportador por
            el vendedor.)

      * Controlador Softmodem

          + paquetes martian-modem y sl-modem-dkms (non-free)

    El firmware es el código o datos ubicados en e propio dispositivo
    (p. ej. CPU microcode, código ejecutable para el «rendering« en
    GPU, o FPGA / datos CPLD , …). Algunso paquetes con firmware
    están disponibles como software libre pero no la mayoría ya que
    contienen información binaria sin su código fuente.

      * firmware-linux-free (main)

      * firmware-linux-nonfree (non-free)

      * firmware-linux-* (non-free)
   
      * *-firmware (non-free)

      * intel-microcode (non-free)

      * amd64-microcode (non-free)

    Tenga en cuenta que los paquetes de non-free y contrib no son
    parte del sistema Debian. El acceso a la configuración que
    permite la activación y desactivación de las áreas non-free y
    contrib está explicado en Sección 2.1.4, “Fundamentos del archivo
    de Debian”. Debería ser consciente de las consecuencias negativas
    que conlleva la utilización de paquetes de non-free y contrib
    según se explica en Sección 2.1.5, “Debian es 100% software
    libre”.

%

9.10. Sistemas virtualizados

    La utilización de sistemas virtualizados nos permite la ejecución
    de varias instancias del sistema a la vez sobre un único
    hardware.

    Sugerencia
   
    Cosulte https://wiki.debian.org/es/SystemVirtualization.

%

9.10.1. Herramientas de virtualización

    Existen varios sistemas de virtualización y de emulación con sus
    paquetes correspondientes en Debian más allá del sencillo chroot.
    Algunos paquetes además, le ayudarán a configurar estos sistemas.

    Tabla 9.26. Relación de herramientas de virtualización

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|        descripción         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas especializadas |
    |schroot        |V:7, I:10  |2708  |para la ejecución de        |
    |               |           |      |paquetes binarios en        |
    |               |           |      |«chroot«                    |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas para la        |
    |sbuild         |V:1, I:4   |286   |construcción de paquetes    |
    |               |           |      |binarios desde el código    |
    |               |           |      |fuente de Debian            |
    |---------------+-----------+------+----------------------------|
    |pbuilder       |V:2, I:16  |966   |contructor de paquetes      |
    |               |           |      |personales Debian           |
    |---------------+-----------+------+----------------------------|
    |               |           |      |sistema de arranque como    |
    |debootstrap    |V:6, I:63  |298   |sistema Debian mínimo       |
    |               |           |      |(escrito en sh)             |
    |---------------+-----------+------+----------------------------|
    |               |           |      |sistema de arranque de un   |
    |cdebootstrap   |V:0, I:3   |116   |sistema Debian (escrito en  |
    |               |           |      |C)                          |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Gestor de Máquinas          |
    |virt-manager   |V:10, I:42 |2298  |Virtuales: aplicación de    |
    |               |           |      |escritorio para la gestión  |
    |               |           |      |de máquinas virtuales       |
    |---------------+-----------+------+----------------------------|
    |libvirt-clients|V:43, I:62 |1167  |programas para la biblioteca|
    |               |           |      |libvirt                     |
    |---------------+-----------+------+----------------------------|
    |bochs          |V:0, I:1   |7194  |Bochs: emulador de PC IA-32 |
    |               |           |      |PC                          |
    |---------------+-----------+------+----------------------------|
    |qemu           |I:34       |94    |QEMU: emulador rápido de un |
    |               |           |      |procesador genérico         |
    |---------------+-----------+------+----------------------------|
    |               |           |      |QEMU: binarios para la      |
    |qemu-system    |I:21       |95    |emulación de un sistema     |
    |               |           |      |completo                    |
    |---------------+-----------+------+----------------------------|
    |qemu-user      |V:0, I:13  |89671 |QEMU: binarios para la      |
    |               |           |      |emulación en modo usuario   |
    |---------------+-----------+------+----------------------------|
    |qemu-utils     |V:11, I:107|6083  |QEMU: utilidades            |
    |---------------+-----------+------+----------------------------|
    |               |           |      |KVM: virtualización completa|
    |qemu-kvm       |V:10, I:61 |107   |de harsware x86 con la      |
    |               |           |      |virtualización asistida por |
    |               |           |      |hardware                    |
    |---------------+-----------+------+----------------------------|
    |               |           |      |VirtualBox: solución de     |
    |virtualbox     |V:12, I:16 |106495|virtualización x86 en i386 y|
    |               |           |      |amd64                       |
    |---------------+-----------+------+----------------------------|
    |               |           |      |herramientas para la gestión|
    |xen-tools      |V:0, I:4   |727   |de debian del servidor      |
    |               |           |      |virtual XEN                 |
    |---------------+-----------+------+----------------------------|
    |wine           |V:19, I:82 |192   |Wine: Implementación de la  |
    |               |           |      |API Windows (suite estándar)|
    |---------------+-----------+------+----------------------------|
    |               |           |      |DOSBox: emulador x86 con    |
    |dosbox         |V:2, I:18  |2742  |gráficos Tandy/Herc/CGA/EGA/|
    |               |           |      |VGA/SVGA , sonido y DOS     |
    |---------------+-----------+------+----------------------------|
    |dosemu         |V:0, I:2   |4891  |DOSEMU: el Emulador de Linux|
    |               |           |      |de DOS                      |
    |---------------+-----------+------+----------------------------|
    |               |           |      |OpenVZ solución de          |
    |vzctl          |V:0, I:1   |1112  |virtualización de servidor -|
    |               |           |      |herramientas de control     |
    |---------------+-----------+------+----------------------------|
    |               |           |      |OpenVZ Solución para la     |
    |vzquota        |V:0, I:1   |236   |virtualización de servidores|
    |               |           |      |- Herramientas de cuota     |
    |---------------+-----------+------+----------------------------|
    |               |           |      |Contenedores Linux          |
    |lxc            |V:10, I:15 |18761 |herramientas del espacio de |
    |               |           |      |usuario                     |
    +---------------------------------------------------------------+


    Consulte el artículo de Wikipedia Comparison of platform virtual
    machines para obtener detalles de la comparación entre diferentes
    plataformas y soluciones de virtualización.

%

9.10.2. Flujo de trabajo de la virtualización

    Nota
   
    Algunas funcionalidades que comentaremos aquí están únicamente
    disponibles en squeeze o en distribuciones posteriores.

    Nota
   
    El núcleo de Debian por defecto soporta KVM desde lenny.

    El flujo de trabajo de la virtualización conlleva varios pasos.

      * Crear un sistema de archivos vacio (un árbol de directorios o
        una imágen de disco).

          + El árbol de directorios puede ser creado mediante «mkdir
            -p /ruta/al/entorno//chroot».

          + El archivo de la imagen de disco en crudo puede ser
            creado con dd(1) (consulteSección 9.6.1, “Creando un
            archivo de imagen de disco” y Sección 9.6.5, “Haciendo un
            archivo de imagen de disco vacio”).

          + qemu-img(1) puede ser utilizado para crear y convertir
            archivos de imagen de disco utilizados por QEMU.

          + Los formatos de archivo crudos y VMDK se pueden utilizar
            como formato común entre diferentes herramientas de
            virtualización.

      * Monte la imágen de disco con mount(8) en el sistema de
        archivos (opcional).

          + Para el archivo de imágen de disco crudo, montelo como un
            dispositivo «loop« o mapeo de dispositivo (consulte
            Sección 9.6.3, “Montaje del archivo de la imagen del
            disco”).

          + Para el soporte de imágenes de disco por QEMU, montelos
            como dispositivo de bloque de red (consulte
            Sección 9.10.3, “Montando el archivo de imagen de disco
            virtual”).

      * Llene el sistema de archivos objetivo con la información del
        sistema.

          + La utilización de programas como debootstrap y
            cdebootstrap ayudan en este proceso (consulte
            Sección 9.10.4, “Sistemas chroot”).

          + Utilización de instaladores de los sistemas operativos en
            la emulación del sistema completo.

      * Ejecute un programa en un entorno virtualizado.

          + chroot ofrece un entorno de virtualización básico para
            compilar programas , ejecutar aplicaciones de consola y
            ejecutar demonios en él.

          + QEMU ofrece emulación de CPU independiente de la
            plataforma.

          + QEMU con KVM ofrece un sistema de emulación completo por
            medio de la virtualización asistida por hardware.

          + VirtualBox ofrece un sistema completo de emulación en
            i386 y amd64 con o sin la virtualización asistida por
            hardware.

%

9.10.3. Montando el archivo de imagen de disco virtual

    Para un archivo de imágen de disco crudo, consulte Sección 9.6,
    “La imagen de disco”.

    Para otros archivos de imágenes de disco virtuales, puede
    utilizar qemu-nbd(8) para exportarlos utilizando el protocolo de
    dispositivos de bloque de red y montarlos utilizando el módulo
    del núcleo nbd.

    qemu-nbd(8) soporta los formatos de disco soportados por QEMU:
    QEMU que soporta los siguientes formato de disco: crudo, qcow2,
    qcow, vmdk, vdi, bochs, cow (copia al escribir en modo usuario de
    Linux), parallels, dmg, cloop, vpc, vvfat (virtual VFAT) y
    «host_device«.

    Los dispositivos de bloque de red pueden soportar particiones de
    la misma manera que los dispositivos «loop« (consulte
    Sección 9.6.3, “Montaje del archivo de la imagen del disco”).
    Puede montar la primera partición de «disk.img» como se muestra.

    # modprobe nbd max_part=16
    # qemu-nbd -v -c /dev/nbd0 disk.img
    ...
    # mkdir /mnt/part1
    # mount /dev/nbd0p1 /mnt/part1

    Sugerencia
   
    Puede exportar únicamente la primera partición de «disk.img»
    utilizando la opción «-P 1» de qemu-nbd(8).

%

9.10.4. Sistemas chroot

    Chroot(8) ofrece la manera más básica de ejecutar diferentes
    instancias de un entorno GNU/Linux en un solo sistema de forma
    simultanea sin reiniciar.

    Atención
   
    En los ejemplos siguientes se asume que tanto el sistema padre
    como el sistema chroot comparten la misma arquitectura CPU.

    Puede aprender como crear , configurar y utilizar chroot(8)
    ejecutando el programa pbuilder(8) en script(1) como se muestra.

    $ sudo mkdir /sid-root
    $ sudo pbuilder --create --no-targz --debug --buildplace /sid-root

    Puede ver como debootstrap(8) o cdebootstrap(1) completa la
    información del sistema con un entorno sid en «/sid-root».

    Sugerencia

    Tanto debootstrap(8) como cdebootstrap(1) se utilizan para
    instalar Debian por parte del Instalador Debian. Estos también
    puede ser utilizado para instalar Debian en un sistema sin
    utilizar el disco de instalación de Debian en lugar de otra
    distribución GNU/Linux.

    $ sudo pbuilder --login --no-targz  --debug --buildplace /sid-root

    Puede ver como un intérprete de órdenes del sistema en entornos
    sid se crean como se muestra.

     1. Copia la configuración local («/etc/hosts», «/etc/hostname»,
        «/etc/resolv.conf»)

     2. Monte el sistema de archivos «/proc»

     3. Monte el sistema de archivox «/dev/pts»

     4. Cree «/usr/sbin/policy-rc.d» el cual siempre finaliza con 101

     5. Ejecute «chroot /sid-root bin/bash -c 'exec -a -bash bin/
        bash'»

    Nota

    Algunos programas para operar en entornos chroot oueden necesitar
    acceso a más ficheros del sistema huésped de los que ofrece
    pbuilder. Por ejemplo, «/sys», «/etc/passwd», «/etc/group», «/var
    /run/utmp», «/var/log/wtmp», etc. pueden requerir ser enlace de
    montaje o ser copiados.

    Nota

    El archivo «/usr/sbin/policy-rc.d» impide que los programas que
    son demonios comiencen de forma automática en el sistema Debian.
    Consulte «/usr/share/doc/sysv-rc/README.policy-rc.d.gz».

    Sugerencia

    El fin original del paquete de chroot especializado, pbuilder es
    la construcción de un sistema chroot y contruir paquetes dentro
    de chroot. Es un sistema ideal para comprobar que las
    dependencias de un paquete en contrucción son correctas y para
    asegurarse de que no existan dependencias inecesarias o
    incorrectas en el paquete que se está construyendo.

    Sugerencia
   
    El paquete similar schroot puede darle una idea de la ejecucuón
    de un sistema chroot i386 en un sistema huésped amd64.

%

9.10.5. Varios sistemas de escritorio

    Le recomiendo que utilice QEMU o VirtualBox en un sistema Debian
    estable para ejecutar varios sistemas de escritorio de forma
    segura por medio de la virtualización. Esto le permite ejecutar
    aplicaciones de escritorio de «inestable» y «en pruebas» sin los
    riesgos habituales asociados a ello.

    Ya que un QEMU puro es muy lento, se recomiendo acelerarlo
    mediante KVM cuando el sistema del equipo lo permita.

    La imágen de disco virtual «virtdisk.qcow2» que contiene una
    imágen del sistema Debian para QEMU se puede crear utilizando el
    instalador debian: en pequeños CDs como se muestra.

    $ wget http://cdimage.debian.org/debian-cd/5.0.3/amd64/iso-cd/debian-503-amd64-netinst.iso
    $ qemu-img create -f qcow2 virtdisk.qcow2 5G
    $ qemu -hda virtdisk.qcow2 -cdrom debian-503-amd64-netinst.iso -boot d -m 256
    ...

    Para más consejos consulte Debian wiki: QEMU.

    VirtualBox se proporciona con herramientas de interfaz gráfico de
    usuario Qt y es bastante intuitivo. Su GUI y herramietnas en
    línea de órdenes se explican en e Manual de Usuario de VirtualBox
    y el Manual de Usuario de VirtualBox (PDF).

    Sugerencia

    Ejecutar otra distribución GNU/Linux como Ubuntu y Fedora de
    forma virtualizada es un gran manera de aprender formas de
    configuración. También se pueden ejecutar correctamente SS.OO.
    propietarios virtualializado sobre GNU/Linux.

Capítulo 10. Gestión de información

    Se describen las herramientas y operaciones para la gestión de
    información en formato binarios y texto.

%

10.1. Compartición, copia y archivo

    Aviso

    El acceso de escritura sin coordinación a los dispositivos
    disponibles y a los archivos desde varios procesos no debe
    realizarse sin evitar la condición de carrera. Para evitarla se
    puede utilizar el mecanismo de bloqueo del archivo (file locking)
    flock(1).

    La seguridad de la información y el control de su compartición
    tiene varios aspectos.

      * La creación de un repositorio de información

      * El acceso al almacenamiento remoto

      * La duplicación

      * El seguimiento del histórico de modificaciones

      * Las facilidades de la compartición de la información

      * Evitar el acceso no autorizado a archivos

      * La detección de modificaciones no autorizadas de archivos

    Esto se puede llevar a cabo por la combinación de algunas
    herramientas.

      * Herramientas de repositorios y compresión

      * Herramientas de sincronización y copia

      * Sistemas de archivos en red

      * Medios de almacenamiento extraibles
   
      * El intérprete de órdenes seguro

      * El sistema de autenticación

      * Herramientas de sistemas de control de versiones

      * Herramientas de criptográficas de cifrado y resumen

%

10.1.1. Herramientas de repositorios y compresión

    Aquí esta un resumen de las herramientas de repositorio y
    compresión disponibles en un sistema Debian.

    Tabla 10.1. Relación de las herramientas de repositorios y
    compresión

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|extensión| orden |  comentario   |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |el archivador  |
    |tar       |V:905,     |3098  |.tar     |tar(1) |estándar       |
    |          |I:999      |      |         |       |(estándar de   |
    |          |           |      |         |       |facto)         |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |Archivador     |
    |          |V:412,     |      |         |       |estilo Unix    |
    |cpio      |I:998      |1136  |.cpio    |cpio(1)|System V,      |
    |          |           |      |         |       |utilizado con  |
    |          |           |      |         |       |find(1)        |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |archivador para|
    |binutils  |V:164,     |97    |.ar      |ar(1)  |la creación de |
    |          |I:678      |      |         |       |bibliotecas    |
    |          |           |      |         |       |estáticas      |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |fastjar|archivador para|
    |fastjar   |V:2, I:29  |183   |.jar     |(1)    |Java (similar a|
    |          |           |      |         |       |zip)           |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |nuevo          |
    |          |           |      |         |       |archivador     |
    |pax       |V:13, I:26 |170   |.pax     |pax(1) |estándar POSIX,|
    |          |           |      |         |       |comprometido   |
    |          |           |      |         |       |entre tar y    |
    |          |           |      |         |       |cpio           |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |gzip(1)|Utilidad de    |
    |gzip      |V:883,     |245   |.gz      |, zcat |compresión GNU |
    |          |I:999      |      |         |(1), … |LZ77 (estándar |
    |          |           |      |         |       |de facto)      |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |La utilidad de |
    |          |           |      |         |       |compresión por |
    |          |           |      |         |       |ordenamiento de|
    |          |           |      |         |       |bloques        |
    |          |           |      |         |bzip2  |Burrows-Wheeler|
    |bzip2     |V:157,     |122   |.bz2     |(1),   |tiene el índice|
    |          |I:970      |      |         |bzcat  |de compresión  |
    |          |           |      |         |(1), … |mayor que gzip |
    |          |           |      |         |       |(1) (más lento |
    |          |           |      |         |       |que gzip con   |
    |          |           |      |         |       |una sintáxis   |
    |          |           |      |         |       |similar)       |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |La utilidad de |
    |          |           |      |         |       |compresión LZMA|
    |          |           |      |         |       |tiene un índice|
    |lzma      |V:2, I:29  |149   |.lzma    |lzma(1)|de compresión  |
    |          |           |      |         |       |más alto que   |
    |          |           |      |         |       |gzip(1)        |
    |          |           |      |         |       |(obsoleto)     |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |La utilidad de |
    |          |           |      |         |       |compresión XZ  |
    |          |           |      |         |       |tiene un índice|
    |          |           |      |         |       |de compresión  |
    |          |           |      |         |       |mayor que bzip2|
    |          |V:454,     |      |         |xz(1), |(1) (más lento |
    |xz-utils  |I:977      |612   |.xz      |xzdec  |que gzip pero  |
    |          |           |      |         |(1), … |más rápdio que |
    |          |           |      |         |       |bzip2; es el   |
    |          |           |      |         |       |sustituyo del  |
    |          |           |      |         |       |la utilidad de |
    |          |           |      |         |       |compresión     |
    |          |           |      |         |       |LZMA)          |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |El archivador  |
    |          |           |      |         |       |de archivos    |
    |          |           |      |         |7zr(1),|7-Zip tiene el |
    |p7zip     |V:89, I:464|987   |.7z      |p7zip  |alto índice de |
    |          |           |      |         |(1)    |compresión     |
    |          |           |      |         |       |(compresión    |
    |          |           |      |         |       |LZMA)          |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |El archivador  |
    |          |           |      |         |       |de archivos    |
    |          |V:113,     |      |         |7z(1), |7-Zip tiene un |
    |p7zip-full|I:486      |4664  |.7z      |7za(1) |alto nivel de  |
    |          |           |      |         |       |compresión     |
    |          |           |      |         |       |(compresión    |
    |          |           |      |         |       |LZMA y otros)  |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |La utilidad de |
    |          |           |      |         |       |compresión LZO |
    |          |           |      |         |       |tiene una      |
    |          |           |      |         |       |velocidad de   |
    |          |           |      |         |       |compresión y   |
    |          |           |      |         |       |descompresión  |
    |lzop      |V:9, I:76  |164   |.lzo     |lzop(1)|más alta que   |
    |          |           |      |         |       |gzip(1) (menor |
    |          |           |      |         |       |índice de      |
    |          |           |      |         |       |compresión que |
    |          |           |      |         |       |gzip con una   |
    |          |           |      |         |       |sintáxis       |
    |          |           |      |         |       |parecida)      |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |InfoZIP:       |
    |zip       |V:51, I:432|608   |.zip     |zip(1) |herramienta de |
    |          |           |      |         |       |archivo y      |
    |          |           |      |         |       |compresión DOS |
    |----------+-----------+------+---------+-------+---------------|
    |          |           |      |         |       |InfoZIP:       |
    |          |V:154,     |      |         |unzip  |herramienta de |
    |unzip     |I:798      |566   |.zip     |(1)    |desarchivo y   |
    |          |           |      |         |       |descompresión  |
    |          |           |      |         |       |DOS            |
    +---------------------------------------------------------------+


    Aviso
   
    No asigne la variable «$TAPE» a menos que sepa sus consecuencias.
    Esta cambia el comportamiento tar(1).

    Nota
   
    Cuando se realiza una compresiñon gzip de un archivo tar(1) se
    utiliza la extensión de archivo «.tgz» o «.tar.gz».

    Nota
   
    La compresión xz de un archivo tar(1) utiliza la extensión de
    archivo «.txz» o «.tar.xz».

    Nota

    Los métodos de compresión más populares entre las herramientas
    FOSS como tar(1) ha evolucionado como se muestra: gzip → bzip2 →
    xz

    Nota
   
    cp(1), scp(1) y tar(1) puede tener alguna limitación con archivos
    especiales. Cpio(1) es más versátil.

    Nota

    cpio(1) esta diseñado para ser utilizado con find(1) y otras
    órdenes y archivos de órdenes para la creación de copias de
    respaldo ya que la parte de selección de archivo del archivo de
    órdenes puede ser probado de forma independiente.

    Nota

    La estructura interna de los archivos de información de
    Libreoffice son archivos «.jar» los cuales pueden incluso abrirse
    con unzip.

    Nota

    La herramienta de archivo multiplataforma de-facto es zip. Para
    conseguir la máxima compatibilidad utilicela mediante «zip -rX».
    Si el tamaño del fichero es importante añada también la opción
    «-s».

%

10.1.2. Herramientas de sincronización y copia

    Aquí hay un resumen de las herramientas de copia y respaldo
    disponibles en el sistema Debian.

    Tabla 10.2. Relación de las herramientas de copia y
    sincronización

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|herramienta|     función     |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |copia archivos y |
    |              |V:891,     |      |           |directorios      |
    |coreutils     |I:999      |17478 |GNU cp     |localmente («-a« |
    |              |           |      |           |para hacerlo     |
    |              |           |      |           |recursivo)       |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |copia archivos y |
    |              |           |      |           |directorios de   |
    |openssh-client|V:803,     |4298  |scp        |forma remota     |
    |              |I:996      |      |           |(cliente, -r»    |
    |              |           |      |           |para hacerlo     |
    |              |           |      |           |recursivo)       |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |copia archivos y |
    |openssh-server|V:690,     |1567  |sshd       |directorios de   |
    |              |I:834      |      |           |forma remota     |
    |              |           |      |           |(servidor remoto)|
    |--------------+-----------+------+-----------+-----------------|
    |              |V:281,     |      |           |sincronización y |
    |rsync         |I:560      |677   |-          |respaldo remoto  |
    |              |           |      |           |en un sentido    |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |sincronización y |
    |unison        |V:4, I:17  |14    |-          |respaldo remoto  |
    |              |           |      |           |en dos           |
    |              |           |      |           |direcciones      |
    +---------------------------------------------------------------+


    La copia de archivos con rsync(8) aporta muchas más
    funcionalidades que otros.

      * el algorimo de transferencia delta envia únicamente las
        diferencias entre los archivos de origen y los archivos que
        hay en el destino

      * el algoritmo de comprobación rápido (quick check algorithm)
        (por omisión) busca los archivos que han cambiado su tamaño o
        su fecha de última modificación

      * las opciones «--exclude» y «--exclude-from» son parecidas a
        las de tar(1)

      * la sintáxis de «una barra «/« en el directorio origen« evita
        la creación de un nivel de directorios adicional en el
        destino

    Sugerencia

    La ejecución del archivo de órdenes bkup que se menciona en
    Sección 10.2.3, “Un archivo de órdenes para copiar la información
    de backup” con la opción «-gl» en cron(8) aporta una
    funcionalidad parecida a la de dumpfs en Plan9 para el archivo de
    datos estáticos.

    Sugerencia

    Las herramientas de sistemas de control de versiones (VCS) en
    Tabla 10.11, “Relación de herramientas de sistemas de control de
    versiones” pueden operar como herramientas de sincronización y
    copia en múltiples sentidos.

%

10.1.3. Formas de archivado

    Aquí estan algunas manreas de archivar y desarchivar el contenido
    entero de un directorio «./origen» utilizando diferentes
    herramientas.

    GNU tar(1):

    $ tar -cvJf archive.tar.xz ./origen
    $ tar -xvJf archive.tar.xz

    Otra forma es como se muestra.

    $ find ./origen -xdev -print0 | tar -cvJf archive.tar.xz --null -F -

    cpio(1):

    $ find ./origen -xdev -print0 | cpio -ov --null > archive.cpio; xz archive.cpio
    $ zcat archive.cpio.xz | cpio -i

%

10.1.4. Formas de copia

    Aquí están diferentes maneras de copiar el contenido completo de
    un directotio «./origen» utilizando diferentes herramientas.

      * Copia local: directorio «./origen» → directorio «/destino»
   
      * Copia remota: directorio «./origen» en el equipo local →
        directorio «/destino» en el equipo «usuario@equipo.dom»

    rsync(8):

    # cd ./origen; rsync -aHAXSv . /destino
    # cd ./origen; rsync -aHAXSv . usuario@equipo.dom:/destino

    Puede utilizar la sintáxis de «barra «/« en el directorio
    origen«.

    # rsync -aHAXSv ./origen/ /destino
    # rsync -aHAXSv ./origen/ usuario@equipo.dom:/destino

    Otra forma es como se muestra.

    # cd ./origen; find . -print0 | rsync -aHAXSv0 --files-from=- . /destino
    # cd ./origen; find . -print0 | rsync -aHAXSv0 --files-from=- . usuario@equipo.dom:/destino

    GNU cp(1) y openSSH scp(1):

    # cd ./origen; cp -a . /destino
    # cd ./origen; scp -pr . usuario@equipo.dom:/destino

    GNU tar(1):

    # (cd ./origen && tar cf - . ) | (cd /destino && tar xvfp - )
    # (cd ./origen && tar cf - . ) | ssh usuario@equipo.dom '(cd /destino && tar xvfp - )'

    cpio(1):

    # cd ./origen; find . -print0 | cpio -pvdm --null --sparse /destino

    Puede sustituir «.» por «foo» para todos los ejemplos que
    contienen «.» para copiar archivos desde el directorio «./origen/
    foo» al directorio «/destino/foo».

    Puede sustituir «.» por la ruta absoluta «/ruta/al/origen/foo»
    para todos los ejemplos que contienen «.» para eliminar «cd ./
    source;». La copia de estos archivos a diferentes ubicaciones
    depende de las herramientas utilizadas como se muestra.

      * «/destino/foo»: rsync(8), GNU cp(1) y scp(1)
   
      * «/destino/ruta/al/origen/foo»: GNU tar(1) y cpio(1)

    Sugerencia
   
    Rsync(8) y GNU cp(1) tiene la opción «-u» para no tener en cuenta
    los archivos que son más nuevos que los recibidos.

%

10.1.5. Formas de selección de archivos

    La orden find(1) es utilizada para la selección de archivos en
    combinación con las órdenes de archivado y copia (consulte
    Sección 10.1.3, “Formas de archivado” and Sección 10.1.4, “Formas
    de copia”) o por xargs(1) (consulte Sección 9.3.9, “Repetición de
    una orden sobre archivos”). Esto se puede mejorar con la
    utilización de los parámetros de la orden.

    La sintáxis básica de find(1) se puede resumir en lo que se
    muestra.

      * los parámetros condicionales son evaluados de izquierda a
        derecha

      * Esta evaluación se para una vez que se ha determinado la
        salida.

      * El «O lógico« (que se escribe «-o» entre condiciones) tiene
        menor precedencia que el «Y lógico« (que se escribe «-a» o
        vacio entre condiciones).

      * El «NO lógico« (que se escribe «!» antes de la condición)
        tiene mayor precedencia que el «Y lógico«.

      * La expresión «-prune» devuelve siempre un VERDADERO lógico y,
        si es un directorio, la búsqueda del archivos es detenida al
        llegar a este punto.

      * La expresión «-name» encaja con los nombres de archivos con
        el mismo tipo de expresiones regulares que se usan en el
        intérprete de órdenes (glob) (consulte Sección 1.5.6,
        “Expansión de un patrón en el intérprete de órdenes”) pero
        también encaja su «.» inicial con metacaracteres como «*» y
        «?». (Nueva funcionalidad de POSIX)

      * La expresión «-regex» encaja con rutas absolutas al estilo de
        emacs BRE (consulte Sección 1.6.2, “Expresiones regulares”)
        por defecto.

      * La expresión «-size» encaja con los archivos en base a su
        tamaño (el valor precedido de «+» para mayor y precedido de
        «-» para menor)

      * La expresión «-newer» encaja con archivos más recientes que
        el que consta como parámetro.

      * La expresión «-print0» devuelve siempre un VERDADERO lógico e
        imprimet el nombre de archivo completo (finalizado con un
        null) por la salida estándar..

    La orden find(1) se utiliza frecuentemente con el estilo que se
    muestra a continuación.

    # find /ruta/a \
        -xdev -regextype posix-extended \
        -type f -regex «.*\.cpio|.*~« -prune -o \
        -type d -regex «.*/\.git« -prune -o \
        -type f -size +99M -prune -o \
        -type f -newer /path/to/timestamp -print0

    Lo que se traduce en las acciones siguientes.

     1. Busca todo los archivos que comienzan con «/ruta/a»

     2. Limita la búsqueda globalmente al comienzo de su sistema de
        archivos y en su lugar utiliza ERE (consulte Sección 1.6.2,
        “Expresiones regulares”)

     3. Excluye los archivos que encajan con las expresiones
        regulares «.*\.cpio» o «.*~» de la búsqueda sin procesarlos
   
     4. Excluye los directorios que encajan con la expresión regular
        de «.*/\.git» de la búsqueda sin procesarlas

     5. Excluye los archivos cuyo tamaño es mayor de 99 Megabytes (en
        bytes 1048576 ) de la búsqueda sin procesarla

     6. Impreme los nombres de los archivos que cumplen los criterios
        de búsqueda anterirores y son más nuevos que el «/ruta/al/
        sellodetiempo»

    Tenga el cuenta la forma en que se utiliza «-prune -o»para
    excluir los archvios en los ejemplos anteriores.

    Nota

    Para sistemas no Debian tipo Unix, algunas opciones de find(1)
    pueden no estar disponibles. En ese caso, por favor, considere
    ajustar los métodos de encaje y sustituya «-print0» con «-print».
    Puede que también necesite ajustar las órdenes parecidas.

%

10.1.6. Medios de archivo

    Cuando elija los medios de almacenamiento de información para el
    archivo de información importante, debe tener cuidado con sus
    limitaciones. Para el respaldo de pequeñas cantidades de
    información personal, yo utilizo CD-R y DVD-R de una compañia
    conocida y los almaceno en un lugar fresco, sin luz, seco y
    limpio. (El medio de archivo en cinta parece una opción común en
    entornos profesionales).

    Nota

    Un lugar resistente al fuegoA fire-resistant safe tiene sentido
    para documentos en papel. La mayor parte de los medios de
    almacenamiento de información tienen menor tolerancia a la
    temperatura que el papel. Yo normalmente mantengo almacenadas
    varias copias cifradas en diferentes ubicaciones seguras.

    Tiempo de vida optimista de los medios de archivo (la mayor parte
    proveniente de los proveedores del medio).

      * Más de 100 años: papel libre de ácido con tinta

      * 100 años : almacenamiento óptico (CD/DVD, CD/DVD-R)
   
      * 30 años: almacenamiento magnético (cinta, diquete)

      * 20 años: almacenamiento óptico con cambio de fase (CD-RW)

    Esto no tiene en cuenta los errores mecánicos debido al manejo
    etc.

    Ciclo de escritura de medios de archivos optimista visto en
    internet (proveniente de la información aportada por el
    vendedor).

      * Más de 250,000 ciclos : discos duros

      * Más de 10,000 ciclos : memoria flash
   
      * 1,000 ciclos : CD/DVD-RW

      * 1 ciclo : CD/DVD-R, papel

    Atención

    Los datos que vida de los medios de almacenamiento y de los
    ciclos de escritura que hemos comentado no deben ser tenidos en
    cuenta para la toma de decisiones sobre almacenamiento de datos
    críticos. Por favor, consulte la informaciń especifica del
    producto que proporciona el fabricante.

    Sugerencia

    Ya que los CD/DVD-R y el papel tienen únicamente un ciclo de
    escritura, impide de informa intrínseca la pérdida de datos por
    sobreescritura. ¡Esto es una ventaja!

    Sugerencia

    Si necesita copias de respaldo rápidas, frecuentes y de grandes
    cantidades de información, un disco duro en un equipo remoto
    sonre una conexión de red rápida, puede ser la única opción real.

%

10.1.7. Dispositivos de almacenamiento extraibles

    Un dispositivo de almacenamiento extraible puede pertenecer a uno
    de los siguientes tipos:

      * dispositivo USB flash

      * disco duro

      * disco óptico

      * Cámara digital

      * reproductor digital de música

    Pueden ser conectados mediante:

      * USB

      * IEEE 1394 / FireWire

      * PC Card

    Los entornos de escritorio modernos como GNOME y KDE pueden
    montar automaticamente estos dispositivos extraibles sin su
    entrada correspondiente en «/etc/fstab».

      * El paquete udisks aporta un demonio y las utilidades
        correspondientes para montar y desmontar estos dispositivos.

      * D-bus crea los eventos para iniciar automáticamente dicho
        proceso.

      * PolicyKit aporta los permisos necesarios.

    Sugerencia
   
    Los dispositivos que se montan de forma automática pueden tener
    la opción de montaje «uhelper=» que es utilizada por umount(8).

    Sugerencia

    En los entornos de escritorio modernos el automontaje ocurre
    unicamente cuando el dispositivo no posee una entrada en «/etc/
    fstab».

    En los entornos de escritorio modernos el punto de montaje es «/
    media/<etiqueta_del_disco>» que puede ser personalizado como se
    muestra.

      * mlabel(1) para el sistema de archivos FAT

      * genisoimage(1) con la opción «-V» para el sistema de archivos
        ISO9660

      * tune2fs(1) con la opción «-L» para los sistemas de archivos
        ext2/ext3/ext4

    Sugerencia

    Puede que necesite proporcionar el tipo de codificación como una
    opción a la hora del montaje (consulte Sección 8.4.6,
    “Códificación del nombre del archivo”).

    Sugerencia

    Si utiliza el menú del interfaz gráfico de usuario para desmontar
    un sistema de archivos puede eliminar su nodo de dispositivo
    generado dinámicamente como «/dev/sdc». Si quiere mantener el
    node del dispositivo, desmóntelo con la orden umount(8) desde el
    cursor del intérprete de órdenes.

%

10.1.8. Selección del sistema de archivos para compartir datos

    Cuando comparte información con otro sistema por medio de un
    dispositivo de almacenamiento extraible, podría formatearlo en un
    sistema de archivos que tenga soporte en ambos sistemas. Aquí
    esta una relación de posibles candidatos.

    Tabla 10.3. Relación de posibles sistemas de archivos para
    dispositivos de almacenamiento extrabiles con sus casos de uso
    normales

    +---------------------------------------------------------------+
    |sistema de|         descripción del caso de uso normal         |
    | archivos |                                                    |
    |----------+----------------------------------------------------|
    |FAT12     |compartición de información entre diferentes        |
    |          |platadormas mediante disquete (<32MiB)              |
    |----------+----------------------------------------------------|
    |          |compartición de información entre plataformas con el|
    |FAT16     |uso de dispositivos como pequeños discos duros      |
    |          |(<2GiB)                                             |
    |----------+----------------------------------------------------|
    |          |compartición de información entre plaformas mediante|
    |FAT32     |dispositivos como un gran disco duro (<8TiB,        |
    |          |soportados por MS Windows95 OSR2 y posteriores)     |
    |----------+----------------------------------------------------|
    |          |compartición de información entre platadormas       |
    |          |mediante un dispositivo como un gran disco duro     |
    |NTFS      |(soporte nativo en MS Windows NT y versiones        |
    |          |posteriores y soportdado porNTFS-3G por medio de    |
    |          |FUSE en Linux)                                      |
    |----------+----------------------------------------------------|
    |ISO9660   |compartición de información entre plataformas de    |
    |          |datos no volátiles en CD-R y DVD+/-R                |
    |----------+----------------------------------------------------|
    |UDF       |escritura incremental de información en CD-R y DVD+/|
    |          |+R (nuevo)                                          |
    |----------+----------------------------------------------------|
    |MINIX     |almacenamiento de información en archivos unix      |
    |filesystem|eficiente en disquete                               |
    |----------+----------------------------------------------------|
    |sistema de|almacenamiento de información en dispositivos como  |
    |archivos  |discos duro para sistemas Linux antiguos            |
    |ext2      |                                                    |
    |----------+----------------------------------------------------|
    |sistema de|almacenamiento de información en dispositivos como  |
    |archivo   |discos duro para sistemas Linux antiguos            |
    |ext3      |                                                    |
    |----------+----------------------------------------------------|
    |sistema de|compartición de datos en un dispositivo com oun     |
    |archivo   |disco duro para sistemas Linux actuales             |
    |ext4      |                                                    |
    +---------------------------------------------------------------+


    Sugerencia

    Consulte Sección 9.8.1, “Cifrado de discos externos con dm-crypt/
    LUKS” para la compartición de información entre plataformas
    utilizando cifrado a nivel de dispositivo.

    El sistema de archivos FAT esta soportado por casit todos los
    sistemas operativos modernos y es bastante útil para el
    intercambio de información por medio de un disco duro externo.

    Cuando se formatea un disco duro externo con el sistemas de
    archivos FAT para compartir información entre diferentes
    platadormas, lo siguiente podrían ser las opciones más seguras.

      * Particionemoslos con fdisk(8), cfdisk(8) or parted(8)
        (consulte Sección 9.5.2, “Configuración del particionado de
        disco”) en una única partición primaria y marquemosla como se
        muestra.

          + Tipo «6« para FAT15 para dispositivos menores de 2 GB.

          + Tipo «c« para FAT32 (LBA) para dispositivos grandes.
   
      * Formateemos la partición primaria con mkfs.vfat(8) como se
        muestra.

          + Si el nombre del dispositivo fuera, p. ej. «/dev/sda1»
            para FAT16

          + La opción explícita para FAT32 y su nombre de
            dispositivo, p.ej. «-F 32 /dev/sda1»

    Cuando se utilizan los sistemas de archivos FAT o ISO9660 para
    compartición de información tenga en cuenta las consideraciones
    siguientes:

      * El archivo de archivos se recomienda utilizar primero tar(1),
        o cpio(1) par mantener los nombres de archivos largos, los
        enlaces blandos, los permisos originales de Unix y la
        información del propietario.
   
      * Para protegerlo de las limitaciones de tamaño divida el
        archivo en trozos menores de 2GiB con la orden split(1).

      * Cifre el archivo para asegurar que no existirán accesos no
        autorizados.

    Nota

    En sistemas de archivos FAT debido a su diseño, el tamaño máximo
    de un archivo es (2^32 - 1) bytes = (4GiB - 1 byte). Para algunas
    aplicaciones antiguas en SSOO de 32 bits, el tamaño máximo de
    archivo es todavía menor (2^31 - 1) bytes = (2GiB - 1 byte).
    Debian no tiene este último problema.

    Nota

    La propia compañia Microsoft no recomienda el uso de FAT para
    dispostivos o particiones menores de 200 MB. Microsoft resalta en
    su «Visión de conjunto de los sistemas de archivos FAT, HPFS y
    NTFS« su uso ineficiente del espacio de disco. Sin duda en Linux
    habitualmente usaremos el sistema de archivos ext4.

    Sugerencia
   
    Para más información acerca de sistemas de archivos y su uso, por
    favor lea «Cómo Sistemas de Archivos«.

%

10.1.9. Compartición de información a través de la red

    Para compartir información con otros sistemas a través de
    internet, debería utilizar un servicio común. Aquí estan algunas
    pistas.

    Tabla 10.4. Relación de los servicios de red disponibles con el
    escenario típico de utilización

    +---------------------------------------------------------------+
    |  servicio de red  |    descripción del caso de uso normal     |
    |-------------------+-------------------------------------------|
    |SMB/CIFS sistema de|compartición de archivos por medio         |
    |archivos en red    |de«Microsoft Windows Network«, consulte    |
    |montado con Samba  |smb.conf(5) y Cómo Oficial y Guía de       |
    |                   |Referencia de 3.x.x o el paquete samba-doc |
    |-------------------+-------------------------------------------|
    |Sistema de archivos|compatición de archivos mediante una «Red  |
    |montado NFS con el |Unix/Linux«, consulte exports(5) y Linux   |
    |núcleo de Linux    |NFS-HOWTO                                  |
    |-------------------+-------------------------------------------|
    |servicio HTTP      |compartición de archivos entre cliente/    |
    |                   |servidor web                               |
    |-------------------+-------------------------------------------|
    |                   |compartición de archivos entre servidor web|
    |servicio HTTPS     |/cliente con cifrado con «Secure Sockets   |
    |                   |Layer« (SSL) o «Transport Layer Security«  |
    |                   |(TLS)                                      |
    |-------------------+-------------------------------------------|
    |servicio FTP       |compartición de archivos entre servidor FTP|
    |                   |/cliente                                   |
    +---------------------------------------------------------------+


    Aunque los sistemas de archivos montados a través de la red
    pueden ser útiles, estos pueden ser inseguros. Sus conexiones de
    red deben securizarse como se muestra.

      * Cifrado con SSL/TLS

      * Con túnel con SSH
   
      * Con túnel por medio de VPN

      * Limitando al área interna cubierto por un cortafuegos

    Consulte además Sección 6.10, “Servidores de aplicaciones en
    otras redes” y Sección 6.11, “Otros clientes de aplicaciones de
    red”.

%

10.2. Respaldo y recuperación

    Todos sabemos que los equipos fallan algunas veces o los errores
    humanos producen daños en el sistema o la información. Las
    operaciones de copia de seguridad y respaldo son una parte
    esencial de la administración de sistemas. Todos los errores
    posible ocurrirán alguna vez.

    Sugerencia

    Mantenga su sistema de respaldo simple y cree copias de seguridad
    con frecuencia. El hecho de tener copias de seguridad de la
    información es más importante que la forma en las que las
    realice.

    Existen tres factores que determinan la directriz de copia de
    seguridad y recuperación real.

     1. Saber lo qué hay que respaldar y recuperar.

          + Los archivos creados por usted: información en «~/»

          + Archivos de información creados por las aplicaciones que
            utiliza: la información en «/var/» (excepto «/var/cache/
            », «/var/run/» y «/var/tmp/»)

          + Archivos de configuración del sistema: información en «/
            etc/»

          + Software local: información en «/usr/local/» o «/opt/»

          + Información de la instalación del sistema: un resumen en
            texto plano de los pasos fundamentales (particionado,
            ...)

          + Probar el conjunto de datos: confirmarlo mediante la
            ejecución de operaciones de recuperación
   
     2. Saber como respaldar y recuperar datos.

          + Seguridad de la información almacenada: protegerlo de la
            sobreescritura y del fallo del sistema

          + Frecuencia de respaldo: planficación del respaldo

          + Redundancia de respaldo: copias de la información

          + Proceso a prueba de fallos: una única y sencilla orden
            para crear la copia de respaldo

     3. Evaluación de riesgos y costes implícitos.

          + Valor de los datos ante la pérdida

          + Uso de recursos para el respaldo: humanos, hardware,
            software, …

          + Modo de error en la recuperación y sus posibilidades

    Nota

    No respalde el contenido de los pseudo sistemas de archivos
    ubicados en /proc, /sys, /tmp y /run (consulte Sección 1.2.12,
    “procfs y sysfs” y Sección 1.2.13, “tmpfs”). A menos que sepa
    exactamente que está haciendo, estas ubicaciones contienen
    grandes cantidades de información poco relevantes.

    Para el almacenamiento seguro de información, la información debe
    al menos estar en parciones distintas de disco y preferentemente
    en discos diferentres y máquinas diferentes para resistir la
    corrupción del sistema de archivos. La información importante es
    mejor almacenarla en medios que solo permiten una grabación com
    CD/DVD-R para evitar sobreescribirla por accidente. (Consulte
    Sección 9.7, “Datos binarios” para saber como escribir en los
    medios de almacenamiento desde el intérpre de órdenes. El entorno
    GNOME a través del interfaz gráfico de usuario ofrece un acceso
    fácil desde el menú: «Ubicaciones→Crear CD/DVD«.)

    Nota

    Puee que quiera para algunos demonios como MTA (consulte
    Sección 6.3, “Agente de transporte de correo (Mail transport
    agent, MTA)”) mientras respalda su información.

    Nota

    Debe tener especial cuidado con el respaldo y restauración de los
    archivos de identificación como «/etc/ssh/ssh_host_dsa_key», «/
    etc/ssh/ssh_host_rsa_key», «~/.gnupg/*», «~/.ssh/*», «/etc/
    passwd», «/etc/shadow», «/etc/fetchmailrc»,
    «popularity-contest.conf», «/etc/ppp/pap-secrets» y «/etc/exim4/
    passwd.client». Algunos de estos elementos puede no ser
    regeneradod partiendo de la misma entrada del sistema.

    Nota

    Si una un trabajo cron como un proceso de usuario, debe restaurar
    los archivos en el directorio «/var/spool/cron/crontabs» y
    reinicie cron(8). Consulte Sección 9.3.14, “Planificación regular
    de tareas” para cron(8) y crontab(1).

%

10.2.1. Suites de utilidades de copias de seguridad

    Aquí estan una relación con las suites de copias de seguridad más
    importantes en un sistema Debian.

    Tabla 10.5. Relación de suites de utilidades de copias de
    respaldo

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|         descripción         |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |4.4 BSD dump(8) y restore(8) |
    |dump          |V:1, I:6   |352   |para sistemas de archivos    |
    |              |           |      |ext2/ext3/ext4               |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |dump y restore con xfsdump(8)|
    |xfsdump       |V:0, I:9   |854   |y xfsrestore(8) para XFS     |
    |              |           |      |sistemas de archivos en GNU/ |
    |              |           |      |Linux e IRIX                 |
    |--------------+-----------+------+-----------------------------|
    |backupninja   |V:4, I:5   |355   |sistema meta-backup          |
    |              |           |      |extensible y ligero          |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Bacula: copia de respaldo en |
    |bacula-common |V:10, I:15 |2158  |red, recuperación y          |
    |              |           |      |verificación - archivos de   |
    |              |           |      |apoyo comunes                |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Bacula: copia de seguridad en|
    |bacula-client |I:3        |183   |red, recuperación y          |
    |              |           |      |verificación - metapaquete   |
    |              |           |      |cliente                      |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Bacula: copia de seguridad en|
    |bacula-console|V:1, I:5   |107   |red, recuperación y          |
    |              |           |      |verificación - consola de    |
    |              |           |      |texto                        |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Bacula: copia de seguridad en|
    |bacula-server |I:1        |183   |red, recuperación y          |
    |              |           |      |verificación - metapaquete   |
    |              |           |      |del servidor                 |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Amanda: Archivador Automático|
    |amanda-common |V:0, I:2   |10031 |de Discos en Red Avanzado    |
    |              |           |      |Maryland (Bibliotecas)       |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Amanda: Archivador Automático|
    |amanda-client |V:0, I:2   |1089  |de Discos en Red Avanzado    |
    |              |           |      |Maryland (Cliente)           |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |Amanda: Archivador Automático|
    |amanda-server |V:0, I:0   |1076  |de Discos en Red Avanzado    |
    |              |           |      |Maryland (Servidor)          |
    |--------------+-----------+------+-----------------------------|
    |backup-manager|V:1, I:2   |572   |herramienta de copia de      |
    |              |           |      |seguridad en línea de órdenes|
    |--------------+-----------+------+-----------------------------|
    |              |           |      |herramienta para medios      |
    |              |           |      |externos para su copia/      |
    |backup2l      |V:0, I:1   |114   |restauración con bajo        |
    |              |           |      |mantenimiento (basado en     |
    |              |           |      |discos)                      |
    |--------------+-----------+------+-----------------------------|
    |              |           |      |BackupPC sistema de copia de |
    |backuppc      |V:3, I:3   |3182  |respadlo de PCs( basado en   |
    |              |           |      |disco) de alto rendimiento y |
    |              |           |      |ámbito empresarial           |
    |--------------+-----------+------+-----------------------------|
    |duplicity     |V:7, I:15  |1761  |respaldo incremental (remoto)|
    |--------------+-----------+------+-----------------------------|
    |flexbackup    |V:0, I:0   |243   |respaldo incremental (remoto)|
    |--------------+-----------+------+-----------------------------|
    |rdiff-backup  |V:7, I:15  |733   |respaldo incremental (remoto)|
    |--------------+-----------+------+-----------------------------|
    |restic        |V:1, I:3   |20595 |respaldo incremental (remoto)|
    |--------------+-----------+------+-----------------------------|
    |rsnapshot     |V:5, I:11  |462   |respaldo incremental (remoto)|
    |--------------+-----------+------+-----------------------------|
    |slbackup      |V:0, I:0   |151   |respaldo incremental (remoto)|
    +---------------------------------------------------------------+


    Las herramientas de copias de seguridad están especializadas en
    diferentes aspectos.

      * Mondo Rescue es un sistema de copias de seguridad centrado en
        realizar la restauración completa de un sistema rapidamente
        desde una copia en CD/DVD etc. sin seguir el proceso normal
        de instalación del sistema.

      * Las copias de seguridad normales de los datos de los usuarios
        pueden realizarse con un archivo de órdenes sencillo (
        Sección 10.2.2, “Un ejemplo del archivo de órdenes para el
        sistema de copias de seguridad”) y la ayuda de cron(8).

      * Bacula, Amanda, and BackupPC son suites de utilidades de
        copia de respaldo con funcionalidad completa centradas en la
        copias de seguridad regulars a través de la red.

    Las herramientas básicas detalladas en Sección 10.1.1,
    “Herramientas de repositorios y compresión” and Sección 10.1.2,
    “Herramientas de sincronización y copia” pueden ser utilizadas
    para permiteir la copias de seguridad del sistema por medio de
    archivos de órdenes personalizados. Estos archivos de órdenes
    pueden ser mejorados como se muestra.

      * El paquete restic permite las copias de seguridad
        incrementales (en remoto).

      * El paquete rdiff-backup permite las copias de seguridad
        incrementales (en remoto).

      * El paquete dump ayuda en el archivo y restauración
        incremental del sistema de archivos completo de forma
        incremental y eficiente.

    Sugerencia
   
    Consulte los archivos en «/usr/share/doc/dump/» y «Es dump de
    verdad en deshuso?« para aprender sobre el paquete dump.

10.2.2. Un ejemplo del archivo de órdenes para el sistema de copias
de seguridad

    Para un sistema personal de escritorio Debian ejecutando
    «inestable», solo necesito proteger mis datos críticos
    personales. Reinstalo el sistema una vez al año siempre. Así es
    que no encuentro una razón para tener copias de seguridad del
    sistema completo o instalar una herramienta de copias de
    seguridad con todas las funcionalidades.

    Utilizo un archivo de órdenes simple y lo grabo en un CD/DVD
    utilizando un interfaz gráfico de usuario. Aquí esta un ejemplo
    de un archivo de órdenes que realiza esta tarea.

    #!/bin/sh -e
    # Copyright (C) 2007-2008 Osamu Aoki <osamu@debian.org>, Public Domain
    BUUID=1000; USER=osamu # UID and name of a user who accesses backup files
    BUDIR=«/var/backups«
    XDIR0=«.+/Mail|.+/Desktop«
    XDIR1=«.+/\.thumbnails|.+/\.?Trash|.+/\.?[cC]ache|.+/\.gvfs|.+/sessions«
    XDIR2=«.+/CVS|.+/\.git|.+/\.svn|.+/Downloads|.+/Archive|.+/Checkout|.+/tmp«
    XSFX=«.+\.iso|.+\.tgz|.+\.tar\.gz|.+\.tar\.bz2|.+\.cpio|.+\.tmp|.+\.swp|.+~«
    SIZE=«+99M«
    DATE=$(date --utc +«%Y%m%d-%H%M«)
    [ -d «$BUDIR« ] || mkdir -p «BUDIR«
    umask 077
    dpkg --get-selections \* > /var/lib/dpkg/dpkg-selections.list
    debconf-get-selections > /var/cache/debconf/debconf-selections

    {
    find /etc /usr/local /opt /var/lib/dpkg/dpkg-selections.list \
         /var/cache/debconf/debconf-selections -xdev -print0
    find /home/$USER /root -xdev -regextype posix-extended \
      -type d -regex «$XDIR0|$XDIR1« -prune -o -type f -regex «$XSFX« -prune -o \
      -type f -size  «$SIZE« -prune -o -print0
    find /home/$USER/Mail/Inbox /home/$USER/Mail/Outbox -print0
    find /home/$USER/Desktop  -xdev -regextype posix-extended \
      -type d -regex «$XDIR2« -prune -o -type f -regex «$XSFX« -prune -o \
      -type f -size  «$SIZE« -prune -o -print0
    } | cpio -ov --null -O $BUDIR/BU$DATE.cpio
    chown $BUUID $BUDIR/BU$DATE.cpio
    touch $BUDIR/backup.stamp

    Esto pretende ser un ejemplo de archivo de órdenes ejecutado como
    superusuario.

    Espero que lo cambie y ejecute como se muestra.

      * Edite este archivo de órdenes para que tenga en cuenta todos
        sus datos importantes (consulte Sección 10.1.5, “Formas de
        selección de archivos” y Sección 10.2, “Respaldo y
        recuperación”).

      * Sustituya «find … -print0» por «find … -newer $BUDIR/
        backup.stamp -print0» para realizar copias de seguridad
        incrementales.

      * Copie los archivos de backup a un equipo remoto utilizando 
        scp(1) o rsync(1) o grabelos en CD/DVD para mayor seguridad.
        (Yo utilizo GNOME como interfaz gráfico de usuario de
        escritorio para grabar CD/DVD. Consulte para mayor
        redundancia Sección 12.1.8, “Ejemplo de archivo de órdenes
        con zenity”.)

    ¡Manténgalo simple!

    Sugerencia

    Puede recuperar la información de configuración de con
    «debconf-set-selections debconf-selections» y la selección de
    información de dpkg con «dpkg --set-selection
    <dpkg-selections.list».

%

10.2.3. Un archivo de órdenes para copiar la información de backup

    Para el conjunto de información qeu se encuentra en árbol del
    directorio, la copia con «cp -a» proporciona una copia de
    respaldo normal.

    Cuando se tiene gran cantidad de información estática que no se
    sobreescrite en un directorio como en el caso del directorio «/
    var/cache/apt/packages/», los enlaces duros con «cp -al» aporta
    una alternativa a la copia de respaldo normal consiguiendo un uso
    de espacio de disco eficiente.

    Aquí esta una copia del archivo de órdenes, el cual he llamado
    bkup para las copias de respaldo. Este archivo de órdenes copia
    todos los archivos (no-CVS) contenidos por el directorio actual
    al directorio antiguo en el directorio padre o en el equipo
    remoto.

    #!/bin/sh -e
    # Copyright (C) 2007-2008 Osamu Aoki <osamu@debian.org>, Public Domain
    fdot(){ find . -type d \( -iname «.?*« -o -iname «CVS« \) -prune -o -print0;}
    fall(){ find . -print0;}
    mkdircd(){ mkdir -p «$1«;chmod 700 «$1«;cd «$1«>/dev/null;}
    FIND=«fdot«;OPT=«-a«;MODE=«CPIOP«;HOST=«localhost«;EXTP=«$(hostname -f)«
    BKUP=«$(basename $(pwd)).bkup«;TIME=«$(date  +%Y%m%d-%H%M%S)«;BU=«$BKUP/$TIME«
    while getopts gcCsStrlLaAxe:h:T f; do case $f in
    g)  MODE=«GNUCP«;; # cp (GNU)
    c)  MODE=«CPIOP«;; # cpio -p
    C)  MODE=«CPIOI«;; # cpio -i
    s)  MODE=«CPIOSSH«;; # cpio/ssh
    t)  MODE=«TARSSH«;; # tar/ssh
    r)  MODE=«RSYNCSSH«;; # rsync/ssh
    l)  OPT=«-alv«;; # hardlink (GNU cp)
    L)  OPT=«-av«;;  # copy (GNU cp)
    a)  FIND=«fall«;; # find all
    A)  FIND=«fdot«;; # find non CVS/ .???/
    x)  set -x;; # trace
    e)  EXTP=«${OPTARG}«;; # hostname -f
    h)  HOST=«${OPTARG}«;; # user@remotehost.example.com
    T)  MODE=«TEST«;; # test find mode
    \?) echo «use -x for trace.«
    esac; done
    shift $(expr $OPTIND - 1)
    if [ $# -gt 0 ]; then
      for x in $@; do cp $OPT $x $x.$TIME; done
    elif [ $MODE = GNUCP ]; then
      mkdir -p «../$BU«;chmod 700 «../$BU«;cp $OPT . «../$BU/«
    elif [ $MODE = CPIOP ]; then
      mkdir -p «../$BU«;chmod 700 «../$BU«
      $FIND|cpio --null --sparse -pvd ../$BU
    elif [ $MODE = CPIOI ]; then
      $FIND|cpio -ov --null | ( mkdircd «../$BU«&&cpio -i )
    elif [ $MODE = CPIOSSH ]; then
      $FIND|cpio -ov --null|ssh -C $HOST «( mkdircd \«$EXTP/$BU\«&&cpio -i )«
    elif [ $MODE = TARSSH ]; then
      (tar cvf - . )|ssh -C $HOST «( mkdircd \«$EXTP/$BU\«&& tar xvfp - )«
    elif [ $MODE = RSYNCSSH ]; then
      rsync -aHAXSv ./ «${HOST}:${EXTP}-${BKUP}-${TIME}«
    else
      echo «Any other idea to backup?«
      $FIND |xargs -0 -n 1 echo
    fi

    Se trata de ejemplos de órdenes. Por favor lea el archivo de
    órdenes y modifiquelo usted mismo para adaptarlo a sus
    necesidades.

    Sugerencia

    Mantengo mi bkup en el directorio «/usr/local/bin/». Ejecuto la
    orden bkup sin ningún argumento cuando necesito una imagen
    temporal del directorio de trabajo.

    Sugerencia

    Para mantener un histórico de imágenes en un árbol de archivos o
    en un árbol de archivos de configuración, es fácil y eficiente en
    la utilización del espacio utilizar git(7) (see Sección 10.6.5,
    “Git para guardar el histórico de configuraciones”).

%

10.3. Infraestructura de seguridad de la información

    La infraestructura de seguridad de la información es una
    combinación de herramientas de cifrado de datos, herramientas de
    resúmenes de mensajes y herramientas de firma.

    Tabla 10.6. Relación de herramientas de infraestructura de
    seguridad de la información

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|  orden   |   descripción    |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |GNU Privacy Guard |
    |gnupg         |V:531,     |787   |gpg(1)    |- herramienta de  |
    |              |I:950      |      |          |firma y cifrado   |
    |              |           |      |          |OpenPGP           |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |GNU Privacy Guard |
    |gpgv          |V:880,     |859   |gpgv(1)   |- herramienta de  |
    |              |I:999      |      |          |verificación de   |
    |              |           |      |          |firma             |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |extracción        |
    |              |           |      |          |únicamente de la  |
    |              |           |      |paperkey  |información       |
    |paperkey      |V:1, I:13  |58    |(1)       |secreta sin       |
    |              |           |      |          |considerar las    |
    |              |           |      |          |claves secretas   |
    |              |           |      |          |OpenPGP           |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |utilities for     |
    |              |           |      |cryptsetup|dm-crypto soporte |
    |cryptsetup    |V:29, I:78 |402   |(8), …    |al cifrado de     |
    |              |           |      |          |dispositivo en    |
    |              |           |      |          |bloque para LUKS  |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |utilities for     |
    |ecryptfs-utils|V:3, I:5   |460   |ecryptfs  |ecryptfs cifrado  |
    |              |           |      |(7), …    |de sistema de     |
    |              |           |      |          |archivos apilados |
    |--------------+-----------+------+----------+------------------|
    |              |V:891,     |      |          |crea y comprueba  |
    |coreutils     |I:999      |17478 |md5sum(1) |el resúmen MD5 de |
    |              |           |      |          |un mensaje        |
    |--------------+-----------+------+----------+------------------|
    |              |V:891,     |      |          |crea y comprueba  |
    |coreutils     |I:999      |17478 |sha1sum(1)|el resumen SHA1 de|
    |              |           |      |          |un mensaje        |
    |--------------+-----------+------+----------+------------------|
    |              |           |      |          |crea el resumen de|
    |openssl       |V:794,     |1465  |openssl   |un mensaje con    |
    |              |I:993      |      |(1ssl)    |«openssl dgst»    |
    |              |           |      |          |(OpenSSL)         |
    +---------------------------------------------------------------+


    Consulte Sección 9.8, “Trucos para cifrar información” en
    dm-crypto y ecryptfs para la implementación de una
    infraestructura de cifrado de información automática por medio de
    los módulos del núcleo de Linux.

%

10.3.1. Gestión de claves con GnuPG

    Aquí están las órdenes GNU Privacy Guard para la gestión básica
    de claves.

    Tabla 10.7. Relación de las órdenes GNU Privacy Guard par la
    gestión de claves

    +---------------------------------------------------------------+
    |       orden        |               descripción                |
    |--------------------+------------------------------------------|
    |gpg --gen-key       |genera una nueva clave                    |
    |--------------------+------------------------------------------|
    |gpg --gen-revoke    |provoca la revocación de la clave para    |
    |mi_Id_de_usuario    |mi_ID_de_usuario                          |
    |--------------------+------------------------------------------|
    |gpg --edit-key      |edición interactiva de la clave, «help«   |
    |ID_de_usuario       |para obtener ayuda                        |
    |--------------------+------------------------------------------|
    |gpg -o archivo      |exporta todas las claves a un archivo     |
    |--export            |                                          |
    |--------------------+------------------------------------------|
    |gpg --import archivo|importa todas las claves desde un archivo |
    |--------------------+------------------------------------------|
    |gpg --send-keys     |envia la clave de un ID_de_usuario al     |
    |ID_usuario          |servidor de claves                        |
    |--------------------+------------------------------------------|
    |gpg --recv-keys     |recibe claves del usuario ID_de_usuario   |
    |ID_de_usuario       |desde el servidor de claves               |
    |--------------------+------------------------------------------|
    |gpg --list-keys     |relación de las claves de ID_de_usuario   |
    |ID_de_usuario       |                                          |
    |--------------------+------------------------------------------|
    |gpg --list-sigs     |relación de las firmas de ID_de_usuarios  |
    |ID_de_usuario       |                                          |
    |--------------------+------------------------------------------|
    |gpg --check-sigs    |comprueba la firma de ID_de_usuario       |
    |ID_de_usuario       |                                          |
    |--------------------+------------------------------------------|
    |gpg --fingerprint   |comprueba la huella del ID_de_usuario     |
    |ID_de_usuario       |                                          |
    |--------------------+------------------------------------------|
    |gpg --refresh-keys  |actualiza el círculo de claves local      |
    +---------------------------------------------------------------+


    Aquí esta el significado de un código seguro.

    Tabla 10.8. Relación del significado del código de confianza

    +---------------------------------------------------------------+
    |código|              descripción de la confianza               |
    |------+--------------------------------------------------------|
    |-     |sin asignación del dueño de la confianza /no calculado  |
    |      |todavía                                                 |
    |------+--------------------------------------------------------|
    |e     |cálculo de confianza fallido                            |
    |------+--------------------------------------------------------|
    |q     |falta de información suficiente para el cálculo         |
    |------+--------------------------------------------------------|
    |n     |no confie nunca en esta clave                           |
    |------+--------------------------------------------------------|
    |m     |confianza marginal                                      |
    |------+--------------------------------------------------------|
    |f     |confianza total                                         |
    |------+--------------------------------------------------------|
    |u     |confianza básica                                        |
    +---------------------------------------------------------------+


    Lo siguiente carga mi clave «1DD8D791» a un popular servidor de
    claves «hkp://keys.gnupg.net».

    $ gpg --keyserver hkp://keys.gnupg.net --send-keys 1DD8D791

    Un buen servidor de claves por defecto configurado en «~/.gnupg/
    gpg.conf» (o su ubicación antigua «~/.gnupg/options») contiene lo
    siguiente.

    keyserver hkp://keys.gnupg.net

    Lo siguiente obtiene las claves desconocidas del servidor de
    claves.

    $ gpg --list-sigs --with-colons | grep '^sig.*\[User ID not found\]' |\
      cut -d ':' -f 5| sort | uniq | xargs gpg --recv-keys

    Existió un error en el Servidor de Claves Públicas OpenPGP (pre
    versión 0.9.6) el cual corrompia las claves con más de dos
    subclaves. El nuevo paquete gnupg (>1.2.1-2) pueden gestionar
    estas subclaves corruptas. Consulte gpg(1) bajo la opción
    «--repair-pks-subkey-bug».

%

10.3.2. Usando GnuPG en archivos

    Aquí estan los ejemplos de utilización de las órdenes GNU Privacy
    Guard sobre archivos.

    Tabla 10.9. Relación de órdenes GNU Privacy Guard sobre archivos

    +---------------------------------------------------------------+
    |         orden         |              descripción              |
    |-----------------------+---------------------------------------|
    |gpg -a -s archivo      |archivo de firma en ASCII del          |
    |                       |archivo.asc blindado                   |
    |-----------------------+---------------------------------------|
    |gpg --armor --sign     |, ,                                    |
    |archivo                |                                       |
    |-----------------------+---------------------------------------|
    |gpg --clearsign archivo|mensaje sin firmar                     |
    |-----------------------+---------------------------------------|
    |gpg --clearsign archivo|envia un mensaje de correo sin firmar a|
    ||mail foo@example.org  |foo@example.org                        |
    |-----------------------+---------------------------------------|
    |gpg --clearsign        |                                       |
    |--not-dash-escaped     |parche sin firmar                      |
    |parche                 |                                       |
    |-----------------------+---------------------------------------|
    |gpg --verify archivo   |comprueba un archivo sin firmar        |
    |-----------------------+---------------------------------------|
    |gpg -o archivo.sig -b  |crea un firma objetivo                 |
    |archivo                |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o archivo.sig     |, ,                                    |
    |--detach-sig archivo   |                                       |
    |-----------------------+---------------------------------------|
    |gpg --verify           |comprueba el archivo con archivo.sig   |
    |archivo.sig archivo    |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o                 |intento de cifrado con clave pública   |
    |archivo_cifrado.gpg -r |para el nombre del archivo al arhivo   |
    |nombre -e archivo      |binario archivo_cifrado.gpg            |
    |-----------------------+---------------------------------------|
    |gpg -o                 |                                       |
    |archivo_cifrado.gpg    |, ,                                    |
    |--recipient nombre     |                                       |
    |--encrypt archivo      |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o                 |intento de cifrado con clave pública   |
    |archivo_cifrado.asc -a |para el nombre del archivo al archivo  |
    |-r name -e archivo     |blindado ASCII archivo_cifrado.asc     |
    |-----------------------+---------------------------------------|
    |gpg -o                 |cifrado simétrico de archivo a         |
    |archivo_cifrado.gpg -c |archivo_cifrado_gpg                    |
    |archivo                |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o                 |                                       |
    |archivo_cifrado.gpg    |, ,                                    |
    |--symmetric archivo    |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o                 |intento del cifrado simétrico para el  |
    |archivo_cifrado.asc -a |nombre desde el archivo fuente al      |
    |-c archivo             |archivo blindado en ASCII              |
    |                       |archivo_cifrado.asc                    |
    |-----------------------+---------------------------------------|
    |gpg -o archivo -d      |                                       |
    |archivo_cifrado.gpg -r |Descifrado                             |
    |name                   |                                       |
    |-----------------------+---------------------------------------|
    |gpg -o file --decrypt  |, ,                                    |
    |archivo_cifrado.gpg    |                                       |
    +---------------------------------------------------------------+


%

10.3.3. Uso de Mutt con GnuPG

    Añada lo siguiente a «~/.muttrc» para mantener el lento el inicio
    automático de GnuPG, mientras permite usarlo pulsado «S» del menú
    principal.

    macro index S «:toggle pgp_verify_sig\n«
    set pgp_verify_sig=no

%

10.3.4. Utilizando Vim con GnuPG

    La extensión de gnupg le permite ejecutar GnuPG de forma
    transparente para archivos con la extensión «.gpg», «.asc» y
    «.ppg».

    # aptitude install vim-scripts vim-addon-manager
    $ vim-addons install gnupg

%

10.3.5. El resumen MD5

    md5sum(1) proporciona la funcionalidad de hacer resumenes de un
    archivo utilizando el método descrito en rfc1321 y verificar cada
    archivo con él.

    $ md5sum foo bar >baz.md5
    $ cat baz.md5
    d3b07384d113edec49eaa6238ad5ff00  foo
    c157a79031e1c40f85931829bc5fc552  bar
    $ md5sum -c baz.md5
    foo: OK
    bar: OK

    Nota

    La computación de la suma MD5 es menos intensiva en CPU que la de
    firma criptográfica de GNU Privacy Guard (GnuPG). Normalmente,
    solo los archivos resumen de alto nivel están firmados
    criptologicamente para asegurar la integridad de la información.

%

10.4. Herramientas para mezclar código fuente

    Existen múltiples herramientas para el código fuente. Las
    siguientes órdenes llamaron mi atención.

    Tabla 10.10. Relación de las herramientas para mezclar código
    fuente

    +---------------------------------------------------------------+
    | paquete  |popularidad|tamaño|   orden   |     descripción     |
    |----------+-----------+------+-----------+---------------------|
    |diffutils |V:871,     |1598  |diff(1)    |compara archivos     |
    |          |I:991      |      |           |línea a línea        |
    |----------+-----------+------+-----------+---------------------|
    |          |V:871,     |      |           |compara y mezcla tres|
    |diffutils |I:991      |1598  |diff3(1)   |archivos línea a     |
    |          |           |      |           |línea                |
    |----------+-----------+------+-----------+---------------------|
    |          |V:106,     |      |           |compare dos archivos |
    |vim       |I:398      |3231  |vimdiff(1) |en vim uno contra    |
    |          |           |      |           |otro                 |
    |----------+-----------+------+-----------+---------------------|
    |patch     |V:99, I:725|248   |patch(1)   |aplica un archivo    |
    |          |           |      |           |diff al original     |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |gestiona un conjunto |
    |dpatch    |V:0, I:11  |191   |dpatch(1)  |de parches para      |
    |          |           |      |           |paquetes Debian      |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |produce un histográma|
    |diffstat  |V:16, I:154|73    |diffstat(1)|de los cambios de    |
    |          |           |      |           |diff                 |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |combinediff|crea un parche       |
    |patchutils|V:18, I:150|232   |(1)        |acumulativo con dos  |
    |          |           |      |           |parches incrementales|
    |----------+-----------+------+-----------+---------------------|
    |patchutils|V:18, I:150|232   |dehtmldiff |extrae un diff de un |
    |          |           |      |(1)        |página HTML          |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |filterdiff |extrae o excluye     |
    |patchutils|V:18, I:150|232   |(1)        |diffs de un archivo  |
    |          |           |      |           |diff                 |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |repara archivos diff |
    |patchutils|V:18, I:150|232   |fixcvsdiff |creados por CVS que  |
    |          |           |      |(1)        |son malinterpretados |
    |          |           |      |           |por patch(1)         |
    |----------+-----------+------+-----------+---------------------|
    |patchutils|V:18, I:150|232   |flipdiff(1)|intercambia el orden |
    |          |           |      |           |de dos parches       |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |muestra que archivos |
    |          |           |      |           |son modificados por  |
    |patchutils|V:18, I:150|232   |grepdiff(1)|un parche de acuerdo |
    |          |           |      |           |a una expresión      |
    |          |           |      |           |regular              |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |muestra las          |
    |patchutils|V:18, I:150|232   |interdiff  |diferencias entre dos|
    |          |           |      |(1)        |archivos diff        |
    |          |           |      |           |unificados           |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |muestra los archivos |
    |patchutils|V:18, I:150|232   |lsdiff(1)  |modificados por un   |
    |          |           |      |           |parche               |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |recalcula las cuentas|
    |patchutils|V:18, I:150|232   |recountdiff|y desplazamientos en |
    |          |           |      |(1)        |un contexto diff     |
    |          |           |      |           |unificado            |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |repara los           |
    |          |           |      |           |desplazamientos y    |
    |patchutils|V:18, I:150|232   |rediff(1)  |cuentas en un diff   |
    |          |           |      |           |editado de forma     |
    |          |           |      |           |manual               |
    |----------+-----------+------+-----------+---------------------|
    |patchutils|V:18, I:150|232   |splitdiff  |selecciona parches   |
    |          |           |      |(1)        |incrementales        |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |unwrapdiff |deshace los parches  |
    |patchutils|V:18, I:150|232   |(1)        |que han sido         |
    |          |           |      |           |mezclados            |
    |----------+-----------+------+-----------+---------------------|
    |wiggle    |V:0, I:0   |174   |wiggle(1)  |aplica parches       |
    |          |           |      |           |rechazados           |
    |----------+-----------+------+-----------+---------------------|
    |quilt     |V:3, I:33  |788   |quilt(1)   |gestiona un conjunto |
    |          |           |      |           |de parches           |
    |----------+-----------+------+-----------+---------------------|
    |meld      |V:14, I:39 |2972  |meld(1)    |compara y mezcla     |
    |          |           |      |           |archivos (GTK)       |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |muestra las          |
    |dirdiff   |V:0, I:2   |166   |dirdiff(1) |diferencias y mezcla |
    |          |           |      |           |los cambios entre    |
    |          |           |      |           |árboles de directorio|
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |compara dos archivos |
    |docdiff   |V:0, I:0   |555   |docdiff(1) |palabra a palabra /  |
    |          |           |      |           |carácter a carácter  |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |interactive full     |
    |imediff   |V:0, I:0   |157   |imediff(1) |screen 2/3-way merge |
    |          |           |      |           |tool                 |
    |----------+-----------+------+-----------+---------------------|
    |makepatch |V:0, I:0   |102   |makepatch  |genera archivos de   |
    |          |           |      |(1)        |parches extendidos   |
    |----------+-----------+------+-----------+---------------------|
    |makepatch |V:0, I:0   |102   |applypatch |aplica archivos de   |
    |          |           |      |(1)        |parches extendidos   |
    |----------+-----------+------+-----------+---------------------|
    |          |           |      |           |muestra las palabras |
    |wdiff     |V:9, I:72  |644   |wdiff(1)   |diferentes en dos    |
    |          |           |      |           |archivos de textos   |
    +---------------------------------------------------------------+


%

10.4.1. extrae las diferencias entre dos archivos fuente

    Los procedimientos siguientes extraen las diferencias entre dos
    archivos de código fuente y crea los archivos diff unificados
    «archivo.patch0» o «archivo.patch1» dependiendo de la ubicación
    del archivo.

    $ diff -u archivo.antiguo archivo.nuevo > archivo.patch0
    $ diff -u antiguo/archivo nuevo/archivo > archivo.patch1

%

10.4.2. Mezcla actualizaciones del archivos de código fuente

    Un archivo diff (también llamado un parche o un archivo de
    parche) se utiliza para enviar una actualización de un programa.
    Quien lo recibe aplica esta actualización a otro archivo como se
    muestra.

    $ patch -p0 archivo < archivo.patch0
    $ patch -p1 archivo < archivo.patch1

%

10.4.3. Actualizando por medio de la mezcla de la tres formas

    Si tiene tres versiones de un código fuente, puede realizar una
    mezcla de las tres de forma efectiva utilizandodiff3(1) como se
    muestra.

    $ diff3 -m archivo.mio archivo.antiguo archivo.tuyo > archivo

%

10.5. Sistemas de control de versiones

    Aquí está un resumen de los sistemas de control de versiones
    (CVS) en el sistema Debian.

    Nota
   
    Si no tiene experiencia con sistemas CVS, podría empezar a
    aprender Git, el cual es muy popular.

    Tabla 10.11. Relación de herramientas de sistemas de control de
    versiones

    +--------------------------------------------------------------------+
    | paquete  |popularidad|tamaño|herramienta|Tipo de CVS|  comentario  |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |copia de Unix |
    |cssc      |V:0, I:2   |2044  |CSSC       |local      |SCCS          |
    |          |           |      |           |           |(obsoleto)    |
    |----------+-----------+------+-----------+-----------+--------------|
    |rcs       |V:3, I:19  |562   |RCS        |local      |«Unix SCCS    |
    |          |           |      |           |           |bien hecho«   |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |estándar      |
    |cvs       |V:5, I:41  |4609  |CVS        |remoto     |anterior de   |
    |          |           |      |           |           |CVS remoto    |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |«CVS bien     |
    |          |           |      |           |           |hecho«, es    |
    |subversion|V:20, I:109|4858  |Subversion |remoto     |nuevo estándar|
    |          |           |      |           |           |de facto para |
    |          |           |      |           |           |CVS remoto    |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS           |
    |          |           |      |           |           |distribuido   |
    |          |           |      |           |           |rápido escrito|
    |git       |V:305,     |35040 |Git        |distribuido|en C          |
    |          |I:478      |      |           |           |(utilizado por|
    |          |           |      |           |           |el núcleo de  |
    |          |           |      |           |           |Linux entre   |
    |          |           |      |           |           |otros)        |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS distribudo|
    |          |           |      |           |           |escrito en    |
    |mercurial |V:8, I:48  |1053  |Mercurial  |distribuido|Python y una  |
    |          |           |      |           |           |pequeña parte |
    |          |           |      |           |           |en C          |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS           |
    |          |           |      |           |           |distribuido   |
    |          |           |      |           |           |influenciado  |
    |bzr       |V:2, I:16  |28    |Bazaar     |distribuido|por tla,      |
    |          |           |      |           |           |escrito en    |
    |          |           |      |           |           |Python        |
    |          |           |      |           |           |(utilizado por|
    |          |           |      |           |           |Ubuntu)       |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS           |
    |          |           |      |           |           |distribuido   |
    |darcs     |V:0, I:7   |23159 |Darcs      |distribuido|con notación  |
    |          |           |      |           |           |álgebraica    |
    |          |           |      |           |           |inteligente   |
    |          |           |      |           |           |(lento)       |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS           |
    |          |           |      |           |           |distribuido   |
    |tla       |V:0, I:2   |1011  |GNU arch   |distribuido|escrito       |
    |          |           |      |           |           |principalmente|
    |          |           |      |           |           |por Tom Lord  |
    |          |           |      |           |           |(histórico)   |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |CVS           |
    |monotone  |V:0, I:0   |5815  |Monotone   |distribuido|distribuido   |
    |          |           |      |           |           |escrito en C++|
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |Interfaz      |
    |          |           |      |           |           |gráfico de    |
    |          |           |      |           |           |usuario del   |
    |tkcvs     |V:0, I:1   |1498  |CVS, …     |remoto     |árbol del     |
    |          |           |      |           |           |repositorio de|
    |          |           |      |           |           |CVS (CVS,     |
    |          |           |      |           |           |Subversion,   |
    |          |           |      |           |           |RCS)          |
    |----------+-----------+------+-----------+-----------+--------------|
    |          |           |      |           |           |GUI del árbol |
    |gitk      |V:6, I:42  |1723  |Git        |distribuido|del           |
    |          |           |      |           |           |repositorio   |
    |          |           |      |           |           |CVS (Git)     |
    +--------------------------------------------------------------------+


    A CVS también se le denomina Sistema de Control de Revisiones
    (RCS) o Software de Gestión de la Configuración (SCM).

    Los sistemas CVS distribuidos como Git son las herramientas
    comunes hoy en dia. CVS y Subversión son todavía útiles en la
    gestión de ciertas actividades de código abierto.

    Debian provides free Git services via Debian Salsa service. Its
    documentation can be found at https://wiki.debian.org/Salsa .

    Atención
   
    Debian has closed its old alioth services and the old alioth
    service data are available at alioth-archive as tarballs.

    Existen unos pocos fundamentos para la creación de un archivo CVS
    compartido.

      * Utilice «umask 002» (consulte Sección 1.2.4, “Gestión de
        permisos para nuevos archivos: umask”)

      * Haga que todos los archivos del archivo CVS pertenezcan al
        grupo correspondiente
   
      * Active «asignar el ID de grupo« en todos directorios de los
        archivos CVS (según el esquema de creación de archivos BSD,
        consulte Sección 1.2.3, “Permisos del sistema de archivos”)

      * Haga que los usuarios compartan sus archivos perteneciendo al
        grupo correspondiente

%

10.5.1. Comparación de órdenes CVS

    Aquí se muestra una simplificación extrema de las órdenes propias
    de cada CVS para proporcionar una visión de conjunto. La
    secuencia de órdenes normal puede necesitar de opciones o
    parámetros.

    Tabla 10.12. Comparación de órdenes particulares de cada CVS

    +---------------------------------------------------------------+
    |     Git     | CVS  |Subversion|            función            |
    |-------------+------+----------+-------------------------------|
    |git init     |cvs   |svn create|crea un repositorio (local)    |
    |             |init  |          |                               |
    |-------------+------+----------+-------------------------------|
    |-            |cvs   |-         |acceso a un repositorio remoto |
    |             |login |          |                               |
    |-------------+------+----------+-------------------------------|
    |git clone    |cvs co|svn co    |comprueba el repositorio remoto|
    |             |      |          |como árbol de trabajo          |
    |-------------+------+----------+-------------------------------|
    |             |      |          |actualiza el árbol de trabajo  |
    |git pull     |cvs up|svn up    |mezclandolo con el repositorio |
    |             |      |          |remoto                         |
    |-------------+------+----------+-------------------------------|
    |git add .    |cvs   |svn add   |añade uno o más archivos al    |
    |             |add   |          |árbol de trabajo del CVS       |
    |-------------+------+----------+-------------------------------|
    |git rm       |cvs rm|svn rm    |borra uno o más archivos del   |
    |             |      |          |árbol de trabajo desde el CVS  |
    |-------------+------+----------+-------------------------------|
    |-            |cvs ci|svn ci    |compromete los cambios en el   |
    |             |      |          |repositorio remoto             |
    |-------------+------+----------+-------------------------------|
    |git commit -a|-     |-         |compromete los cambios en el   |
    |             |      |          |repositorio local              |
    |-------------+------+----------+-------------------------------|
    |git push     |-     |-         |actualiza el repositorio remoto|
    |             |      |          |con el repositorio local       |
    |-------------+------+----------+-------------------------------|
    |git status   |cvs   |svn status|muestra el estado del árbol de |
    |             |status|          |trabajo desde el CVS           |
    |-------------+------+----------+-------------------------------|
    |             |cvs   |          |diff                           |
    |git diff     |diff  |svn diff  |<repositorio_de_referencia>    |
    |             |      |          |<árbol_de_trabajo>             |
    |-------------+------+----------+-------------------------------|
    |git repack -a|-     |-         |reempaqueta el repositorio     |
    |-d; git prune|      |          |local en un único paquete      |
    |-------------+------+----------+-------------------------------|
    |gitk         |tkcvs |tkcvs     |interfaz gráfico para mostrar  |
    |             |      |          |el árbol de repositorios CVS   |
    +---------------------------------------------------------------+


    Atención

    LLamar una subórden git directamento como «git-xyz» desde la
    línea de órdenes ha sido declarado obsoleto desde principios de
    2006.

    Sugerencia

    Si existe un archivo ejecutable git-foo en la ruta determinada
    por $PATH, el escribir «git foo» sin guión en la línea de órdenes
    llama a git-foo. Esto es una funcionalidad de la orden git.

    Sugerencia

    Las herramientas GUI como tkcvs(1) y gitk(1) son realmente útiles
    en el seguimiento del histórico de archivos. El interfaz web que
    proporcionan muchos archivos públicos en sus repositorios son
    también muy útilies al permitir navegar por ellos.

    Sugerencia

    Git puede trabajar con diferentes repositorios como los de CVS y
    Subversión y proporciona un repositorio local para cambio locales
    por medio de los paquetes git-cvs y git-svn. Consulte Git para
    usuarios de CVS y Sección 10.6.4, “Git para repositorios
    Subversion”.

    Sugerencia
   
    En git existen órdenes que no poseen equivalente en CVS y
    Subversion como «fetch«, «rebase«, «cherry-pick«, …

%

10.6. Git

    Git puede realizan cualquier operación en el código fuente tanto
    el local como en remoto. Esto significa que puede guardar los
    cambios en el código fuente sin tener conexión de red al
    repositorio remoto.

%

10.6.1. Configuración del cliente Git

    Puede que quiera guardar parte de la configuración global en «~
    /.gitconfig» como su nombre y la dirección de correo electrónico
    que utiliza Git como se muestra.

    $ git config --global user.name «Nombre Apellido«
    $ git config --global user.email su_nombre@ejemplo.com

    Si esta acostumbrado a utilizar órdenes Subversion o CVS, puede
    que quiera crear algunos alias de orden como se muestra.

    $ git config --global alias.ci «commit -a«
    $ git config --global alias.co checkout

    Puede comprobar la configuración global como se muestra.

    $ git config --global --list

%

10.6.2. Algunas referencias sobre Git

    Consulte lo siguiente.

      * manpage: git(1) (/usr/share/doc/git-doc/git.html)

      * Manual de Usuario (/usr/share/doc/git-doc/user-manual.html)

      * Un tutorial de introducción a git (/usr/share/doc/git-doc/
        gittutorial.html)

      * Un tutorial inicial a git: parte dos (/usr/share/doc/git-doc/
        gittutorial-2.html)

      * «20 órdenes GIT para todos los días (/usr/share/doc/git-doc/
        everyday.html)

      * git para usuarios de CVS (/usr/share/doc/git-doc/
        gitcvs-migration.html)

          + Esto describe también como configurar un servidor como
            CVS y converitr los datos de CVS a Git.

      * Otros recursos git disponibles en Internet

          + Curso Intensivo Git - SVN

          + Git Mágico (/usr/share/doc/gitmagic/html/index.html)

    Las órdenes git-gui(1) y gitk(1) hacen que Git sea muy fácil de
    utilizar.

    Aviso

    No utilice etiquetas con caracteres blancos a pesar de que
    algunas herramientas permiten su utilización como gitk(1). Puede
    provocar errores en otras órdenes git.

%

10.6.3. Órdenes Git

    Incluso cuando el servidor es otro CVS, puede ser una buena idea
    utilizar git(1) para la operaciones locales ya que permite
    gestionar la copia local del árbol del código fuente sin una
    conexión de red al servidor. Aquí estan algunos paquetes y
    órdenes utilizados con git(1).

    Tabla 10.13. Relación de paquetes y órdenes relacionados con git

    +-----------------------------------------------------------------------+
    |    paquete     |popularidad|tamaño|       orden       |  descripción  |
    |----------------+-----------+------+-------------------+---------------|
    |git-doc         |I:15       |11762 |N/A                |documentación  |
    |                |           |      |                   |oficial de Git |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |«Git Mágico«,  |
    |gitmagic        |I:1        |721   |N/A                |una guía de Git|
    |                |           |      |                   |fácil de       |
    |                |           |      |                   |entender       |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |Git, el sistema|
    |                |           |      |                   |de control de  |
    |git             |V:305,     |35040 |git(7)             |versiones      |
    |                |I:478      |      |                   |rápido,        |
    |                |           |      |                   |escalable y    |
    |                |           |      |                   |distribuido    |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |Navegador de   |
    |gitk            |V:6, I:42  |1723  |gitk(1)            |repositorios   |
    |                |           |      |                   |Git GUI con    |
    |                |           |      |                   |históricos     |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |GUI para Git   |
    |git-gui         |V:2, I:24  |2317  |git-gui(1)         |(sin           |
    |                |           |      |                   |históricos)    |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |importar datos |
    |git-svn         |V:1, I:22  |1144  |git-svnimport(1)   |provenientes de|
    |                |           |      |                   |Subversion en  |
    |                |           |      |                   |Git            |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |proporciona    |
    |                |           |      |                   |operaciones    |
    |git-svn         |V:1, I:22  |1144  |git-svn(1)         |bidireccionales|
    |                |           |      |                   |entre          |
    |                |           |      |                   |Subversion y   |
    |                |           |      |                   |Git            |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |importa datos  |
    |git-cvs         |V:0, I:10  |1279  |git-cvsimport(1)   |provinientes de|
    |                |           |      |                   |CVS a Git      |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |exporta un     |
    |                |           |      |git-cvsexportcommit|compromiso     |
    |git-cvs         |V:0, I:10  |1279  |(1)                |desde Git a una|
    |                |           |      |                   |comprobación de|
    |                |           |      |                   |CVS            |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |emulador de un |
    |git-cvs         |V:0, I:10  |1279  |git-cvsserver(1)   |servidor CVS   |
    |                |           |      |                   |para Git       |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |Git envia un   |
    |git-email       |V:0, I:11  |966   |git-send-email(1)  |conjunto de    |
    |                |           |      |                   |parches como un|
    |                |           |      |                   |correo         |
    |----------------+-----------+------+-------------------+---------------|
    |stgit           |V:0, I:0   |603   |stg(1)             |quilt sobre git|
    |                |           |      |                   |(Python)       |
    |----------------+-----------+------+-------------------+---------------|
    |                |           |      |                   |automatiza la  |
    |git-buildpackage|V:2, I:12  |4193  |git-buildpackage(1)|creación de    |
    |                |           |      |                   |paquetes Debian|
    |                |           |      |                   |con Git        |
    |----------------+-----------+------+-------------------+---------------|
    |guilt           |V:0, I:0   |146   |guilt(7)           |quilt sobre git|
    |                |           |      |                   |(SH/AWK/SED/…) |
    +-----------------------------------------------------------------------+


    Sugerencia

    Con git(1), puedes trabajar en una rama local con varios
    compromisos del código (commits) y utilizar algo similar a «git
    rebase -i master» para reorganizar más tarde el histórico de
    cambios. Esto permite un histórico de cambios limpio. Consulte 
    git-rebase(1) y git-cherry-pick(1).

    Sugerencia

    Cuando quiera bolver a un directorio de trabajo limpio sin perder
    el estado actual del directorio de trabajo, puede utilizar «git
    stash». Consulte git-stash(1).

%

10.6.4. Git para repositorios Subversion

    Puedes comprobar un repositorio Subversion en «svn+ssh://
    svn.example.org/project/module/trunk» a un repositorio local Git
    en «./dest» y comprometer los cambios de vuelta al repositorio
    Subversion p. ej.:

    $ git svn clone -s -rHEAD svn+ssh://svn.example.org/project dest
    $ cd dest
    ... hacer los cambios
    $ git commit -a
    ... sigua cambiando localmente con git
    $ git svn dcommit

    Sugerencia
   
    La utilización de «-rHEAD» activa el evitar clonar el histórico
    del contenido entero del repositorio de Subversion.

%

10.6.5. Git para guardar el histórico de configuraciones

    Puede guardar manualmente la cronología de histórico de
    configuraciones utilizando las herramientas Git. Aquí esta un
    ejemplo simple para guardad el contenido de «/etc/apt/» de una
    forma práctica.

    $ cd /etc/apt/
    $ sudo git init
    $ sudo chmod 700 .git
    $ sudo git add .
    $ sudo git commit -a

    Comprometes la configuración con la descripción.

    Hacer modificaciones a los archivos de configuración.

    $ cd /etc/apt/
    $ sudo git commit -a

    Compromete la configuración con la descripción y continua con su
    vida.

    $ cd /etc/apt/
    $ sudo gitk --all

    Usted tiene el histórico completo de la configuración con usted.

    Nota

    sudo(8) es necesario para trabajar con todos los permisos de
    archivo de los datos de configuración. Para los datos de
    configuración del usuario, puede evitar la utilización sudo.

    Nota
   
    Se necesita la orden «chmod 700 .git» en el ejemplo anterior para
    proteger los datos del archivo de lecturas no autorizadas.

    Sugerencia

    Para un despliege completo del guardado del histórico de la
    configuración, por favor compruebe el paquete etckeeper:
    Sección 9.2.10, “Guardando cambios en los archivos de
    configuración”.

%

10.7. CVS

    CVS is an older version control system before Subversion and Git.

    Atención
   
    Many URLs found in the below examples for CVS don't exist any
    more.

    Consulte lo siguiente.

      * cvs(1)

      * «/usr/share/doc/cvs/html-cvsclient»

      * «/usr/share/doc/cvs/html-info»

      * «/usr/share/doc/cvsbook»

      * «info cvs»

%

10.7.1. Configuración de un repositorio CVS

    La siguiente configuración permite comprometer a un repositorio
    CVS solo por un miembro del grupo «src» y la administración del
    CVS unicamente por un miembro del grupo «staff», que reduce la
    probabilidad de errores.

    # cd /var/lib; umask 002; mkdir cvs
    # export CVSROOT=/srv/cvs/project
    # cd $CVSROOT
    # chown root:src .
    # chmod 2775 .
    # cvs -d $CVSROOT init
    # cd CVSROOT
    # chown -R root:staff .
    # chmod 2775 .
    # touch val-tags
    # chmod 664 history val-tags
    # chown root:src history val-tags

    Sugerencia

    Puede restringuir la creación de un nuevo proyecto cambiando el
    dueño del directorio «$CVSROOT» «root:staff» y su permisos a
    «3775».

%

10.7.2. Acceso local a CVS

    El repositorio por defecto de CVS esta referenciado por
    «$CVSROOT». Lo siguiente configura «$CVSROOT» para acceso local.

    $ export CVSROOT=/srv/cvs/project

%

10.7.3. Acceso remoto a CVS con pserver

    Many public CVS servers provide read-only remote access to them
    with account name "anonymous" via pserver service. For example,
    Debian web site contents were maintained by webwml project via
    CVS at Debian alioth service. The following was used to set up
    "$CVSROOT" for the remote access to this old CVS repository.

    $ export CVSROOT=:pserver:anonymous@anonscm.debian.org:/cvs/webwml
    $ cvs login

    Nota

    Ya que pserver es propenso a ataques de escucha e inseguro, el
    acceso de escritura normalmente esta deshabilitado por los
    administradores del servidor.

%

10.7.4. Acceso remoto a CVS con ssh

    The following was used to set up "$CVS_RSH" and "$CVSROOT" for
    the remote access to the old CVS repository by webwml project
    with SSH.

    $ export CVS_RSH=ssh
    $ export CVSROOT=:ext:account@cvs.alioth.debian.org:/cvs/webwml

    Puede utilizar tambien una clave pública para acreditarse por SSH
    el cual elimina el acceso remoto con contraseña.

%

10.7.5. Importando un nuevo recurso a CVS

    Cree una nueva ubicación de un árbol local en «~/path/to/module1»
    como se muestra.

    $ mkdir -p ~/path/to/module1; cd ~/path/to/module1

    Rellene un nuevo árbol local en «~/path/to/module1» con archivos.

    Impórtelo a CVS con los siguientes parámetros.

      * Nombre del módulo: «module1»

      * Etiqueta del proveedor (Vendor tag): «Rama-principal»
        (etiqueta para toda la rama)

      * Etiqueta de la publicación: «release-initial» (etiqueta para
        una publicación concreta)

    $ cd ~/path/to/module1
    $ cvs import -m «Start module1« module1 Rama-principal Release-initial
    $ rm -Rf . # opcional

%

10.7.6. Permisos de archivo en un repositorio CVS

    CVS no sobreescribe el archivo del repositorio actual si no que
    lo cambia por otro. Así, los permisos de escritura del directorio
    del repositorio son críticos. Para cada nuevo módulo de «module1»
    en el repositorio en «/srv/cvs/project», si es necesario, ejecute
    lo siguiente para asegurar que se cumple esto.

    # cd /srv/cvs/project
    # chown -R root:src module1
    # chmod -R ug+rwX   module1
    # chmod    2775     module1

%

10.7.7. Flujo de trabajo de CVS

    Aquí esta un ejemplo paradigmático de flujo de trabajo con CVS.

    Compruebe que todos los módulos disponibles del proyecto en el
    CVS son referenciados por «$CVSROOT» como se muestra.

    $ cvs rls
    CVSROOT
    module1
    module2
    ...

    Compruebe «module1» en su directorio por defecto «./module1» como
    se muestra.

    $ cd ~/path/to
    $ cvs co module1
    $ cd module1

    Haga los cambios que se necesiten en el contenido.

    Compruebe los cambios haciendo el equivalente a «diff -u
    [repositorio] [local]» como se muestra.

    $ cvs diff -u

    Encontrará que ha comedito errores en algunos archivos
    «archivo_a_deshacer» y que otros archivos son correctos.

    Sobreescrita el archivo «archivo_a_deshacer» con una copia la
    copia en buen estado del repositorios CVS como se muestra.

    $ cvs up -C archivo_a_deshacer

    Guarde el árbol local actualizado en CVS como se muestra.

    $ cvs ci -m «Descripción del cambio«

    Cree y añada el archivo «archivo_para_añadir» al CVS como se
    muestra.

    $ vi archivo_a_añadir
    $ cvs add archivo_a_añadir
    $ cvs ci -m «Añadido archivo_a_añadir«

    Mezcle la última versión del CVS como se muestra.

    $ cvs up -d

    Vigile las líneas que empiezan por «C filename» ya que indican
    cambios conflictivos.

    Mire el código que no se ha modificado en «.#
    nombre_del_archivo.version».

    Los cambios conflictivos en los archivos los puede encontrar
    buscando por la cadena «<<<<<<<» y «>>>>>>>».

    Modifique los archivos para resolver los conflictos según
    necesite.

    Añada una etiqueta de distribución «Liberación-1» como se
    muestra.

    $ cvs ci -m «último compromiso de la Liberación-1«
    $ cvs tag Liberación-1

    Editelo para continuar.

    Borre la etiqueta de publicación «Liberación-1» como se muestra.

    $ cvs tag -d Liberación-1

    Compruebe los cambios del CVS como se muestra.

    $ cvs ci -m «Últimos cambios comprometidos para la Liberación-1«

    Vuelva a añadir al etiqueta de la publicación «Liberación-1» para
    actualizalar la cabecera CVS (CVS HEAD) del raíz como se muestra.

    $ cvs tag Liberación-1

    Crea una rama poniendo una marca persistente ('sticky') de rama
    «Correción-Liberación-inicial» a partir de la versión original
    apuntada por la etiqueta «Liberación-inicial» haga una
    comprobación de ella en el antiguo directorio «~/camino/al/
    antiguo» de la siguiente manera.

    $ cvs rtag -b -r Liberación-inicial Correción-Liberación-inicial module1
    $ cd ~/ruta/a
    $ cvs co -r Correción-Liberación-inicial -d antiguo module1
    $ cd antiguo

    Sugerencia

    Utilice «-D 2005-12-20» (formato de fecha ISO 8601) para
    especificar una fecha particular como un hito en la rama en lugar
    de «-r Lineración-inicial».

    Trabaje en esta parte del árbol local con la etiqueta
    «Corrección-Liberación-inicial» que está basada en la versión
    original.

    Trabaje en esta rama ... hasta que alguien más se una a la rama
    «CorrecciónLiberación-inicial».

    Sincronize los archivos modificados con otros en el rama y cree
    los archivos que necesite como se muestra.

    $ cvs up -d

    Modifique los archivos para resolver los conflictos según
    necesite.

    Compruebe los cambios del CVS como se muestra.

    $ cvs ci -m «comprobado en esta rama«

    Actualice el árbol local con el HEAD del principal mientras borra
    la etiqueta por defecto («-A») y sin la expansion del teclado
    («-kk») como se muestra.

    $ cvs up -d -kk -A

    Actualice el árbol local (contenido = raíz del principal) por la
    mezcla de la rama «Corrección-Liberación-inicial» y sin la
    expansión de teclado como se muestra.

    $ cvs up -d -kk -j Corrección-Liberación-inicial

    Corrija los conflictos con el editor.

    Compruebe los cambios del CVS como se muestra.

    $ cvs ci -m «Corrección-Liberación-inicial mezclada«

    Realice el archivado como se muestra.

    $ cd ..
    $ mv antiguo corrección-antiguo-module1
    $ tar -cvzf corrección-antiguo-module1.tar.gz corrección-antiguo-module1
    $ rm -rf corrección-antiguo-module1

    Sugerencia

    La orden «cvs up» puede tener la opción «-d» para crear nuevos
    directorios y la opción «-P» para eliminar los directorios
    vacíos.

    Sugerencia
   
    Puede comprobar únicamente el subdirectorio «module1» dando su
    nombre como «cvs co module1/subdirectorio».

    Tabla 10.14. Opciones importantes de la orden CVS (utilizado como
    primer parámetro en cvs(1))

    +---------------------------------------------------------------+
    |opción|                      significado                       |
    |------+--------------------------------------------------------|
    |-n    |ejecución en seco, sin efecto                           |
    |------+--------------------------------------------------------|
    |-t    |muestra los mensajes de los pasos de la actividad de cvs|
    +---------------------------------------------------------------+


%

10.7.8. Últimos archivos CVS

    Para obtener los últimos archivos del CVS, utilice «tomorrow»
    como se muestra.

    $ cvs ex -D tomorrow nombre_del_módulo

%

10.7.9. Administración del servicio CVS

    Añadir un alias «mx» a un módulo de un proyecto CVS (servidor
    local) como se muestra.

    $ export CVSROOT=/srv/cvs/proyecto
    $ cvs co CVSROOT/módulos
    $ cd CVSROOT
    $ echo «mx -a module1« >>módulos
    $ cvs ci -m «Ahora mx es un alias para module1«
    $ cvs release -d .

    Ahora ya puede comprobar «module1» (alias: «mx») del CVS al
    directorio «nuevo» como se muestra.

    $ cvs co -d nuevo mx
    $ cd nuevo

    Nota
   
    Con el fin de llevar a cabo el procedimiento anterior, usted debe
    tener los permisos necesarios.

%

10.7.10. Bit de ejecución para la comprobación del CVS

    Cuendo compruebe los archivos del CVS su bit de ejecución será
    mantenido.

    Si encuentra problemas de permisos de ejecución al comprobar un
    archivo, p. ej. «archivo», para arreglarlo cambie su permiso en
    el repositorio CVS correspondiente como se muestra.

    # chmod ugo-x archivo

%

10.8. Subversion

    Subversion is an older version control system before Git but
    after CVS. It lacks tagging and branching features found in CVS
    and Git.

    You need to install subversion, libapache2-mod-svn and
    subversion-tools packages to set up a Subversion server.

%

10.8.1. Configuración de un repositorio con Subversion

    Actualmente el paquete subversion no crea ningún repositorio, así
    es que debe ser creado de forma manual. Una posible localización
    del repositorio es en /srv/svn/proyecto».

    Cree un directorio como se muestra.

    # mkdir -p        /srv/svn/proyecto

    Cree la base de datos del repositorio como se muestra.

    # svnadmin create /srv/svn/proyecto

%

10.8.2. Acceso a Subversion a través del servidor Apache2

    Si solo accede al repositorio de Subversion a través del servidor
    Apache2, solo necesita hacer que el repositorio sea modificable
    solo por el servidor WWW como se muestra.

    # chown -R www-data:www-data /srv/svn/proyecto

    Añada (o descomente) lo siguiente en «/etc/apache2/mods-available
    /dav_svn.conf» para permitir el acesso al repositorio por medio
    de la autenticación de usuario.

    <Location /project>
      DAV svn
      SVNPath /srv/svn/proyecto
      AuthType Basic
      AuthName «Subversion repository«
      AuthUserFile /etc/subversion/passwd
    <LimitExcept GET PROPFIND OPTIONS REPORT>
        Require valid-user
    </LimitExcept>
    </Location>

    Cree un archivo de autenticación de usuarios con la orden que se
    muestra.

    # htpasswd2 -c /etc/subversion/passwd algún_nombre_de_usuario

    Reinicie de Apache2.

    Se puede acceder a su nuevo repositorio de Subversion en la URL
    «http://localhost/proyecto» y «http://example.com/proyecto» desde
    svn(1) (asumiendo que la URL de su servidor web es «http://
    example.com/»).

%

10.8.3. Acceso local a Subversion basada en el grupo

    Lo siguiente configura el acceso local a un repositorio
    Subversion en función del grupo, p. ej. projecto.

    # chmod  2775     /srv/svn/proyecto
    # chown -R root:src /srv/svn/proyecto
    # chmod -R ug+rwX   /srv/svn/proyecto

    Su nuevo repositorio Subversion es accesible para los miembros
    del grupo local project a través de la URL «file:///localhost/srv
    /svn/proyecto» o «file:///srv/svn/proyecto» desde svn(1). Para
    asegurar el acceso del grupo debe ejecutar las órdenes svn,
    svnserve, svnlook y svnadmin con la máscara «umask 002».

%

10.8.4. Acceso remoto a Subversion con SSH

    El acceso remoto SSH a un repositorio Subversion basado en grupos
    se realiza mediante la URL «example.com:/srv/svn/proyecto»,
    también puede acceder con svn(1) mediante la URL «svn+ssh://
    example.com:/srv/svn/proyecto».

%

10.8.5. Estructura de directorios de Subversion

    Muchos proyectos utilizan un árbol de directorios similar para
    compensar la falta de ramas y etiquetas de Subversion.

      ----- module1
        |   |-- branches
        |   |-- tags
        |   |   |-- release-1.0
        |   |   `-- release-2.0
        |   |
        |   `-- trunk
        |       |-- file1
        |       |-- file2
        |       `-- file3
        |
        `-- module2

    Sugerencia

    Debe utilizar la orden «svn copy ...» para marcar ramas y
    etiquetas. Esto asegura que Subversion registra el histórico de
    modificaciones de archivos de forma adecuada y ahorra espacio de
    almacenamiento.

%

10.8.6. Importando una nueva fuente a Subversion

    Cree una nueva ubicación de un árbol local en «~/path/to/module1»
    como se muestra.

    $ mkdir -p ~/path/to/module1; cd ~/path/to/module1

    Rellene un nuevo árbol local en «~/path/to/module1» con archivos.

    Impórtela a Subversion con los parámetros siguientes.

      * Nombre del módulo: «module1»

      * URL del sitio de Subversion: «file:///srv/svn/proyecto»
   
      * Directorio de Subversion: «module1/trunk»

      * Etiqueta de Subversion: «module1/tags/Liberación-incial»

    $ cd ~/ruta/al/module1
    $ svn import file:///srv/svn/proyecto/module1/trunk -m «Inicio del module1«
    $ svn cp file:///srv/svn/proyecto/module1/trunk file:///srv/svn/proyecto/module1/tags/Liberación-inicial

    Otra forma es como se muestra.

    $ svn import ~/ruta/al/module1 file:///srv/svn/proyecto/module1/trunk -m «Inicio del module1«
    $ svn cp file:///srv/svn/proyecto/module1/trunk file:///srv/svn/proyecto/module1/tags/Liberación-inicial

    Sugerencia
   
    Puede sustituir las URLs del tipo «file:///…» por otros formatos
    de URLs como «http://…» y «svn+ssh://…».

%

10.8.7. Flujo de trabajo en Subversion

    Aquí esta un ejemplo de flujo de trabajo estándar utilizando
    Subversion con su cliente nativo.

    Sugerencia

    La orden cliente que aporta el paquete git-svn puede ofrecer un
    flujo de trabajo alternativo de Subversion utilizando la orden
    git. Consulte Sección 10.6.4, “Git para repositorios Subversion”.

    Enumere todos los módulos disponibles del proyecto Subversión que
    se referencias por la URL «file:///srv/svn/proyecto» como se
    muestra.

    $ svn list file:///srv/svn/proyecto
    module1
    module2
    ...

    Compruebe «module1/trunk» al directorio «module1» como se
    muestra.

    $ cd ~/ruta/al
    $ svn co file:///srv/svn/proyecto/module1/trunk module1
    $ cd module1

    Haga los cambios que se necesiten en el contenido.

    Compruebe los cambios haciendo el equivalente a «diff -u
    [repositorio] [local]» como se muestra.

    $ svn diff

    Encontrará que ha comedito errores en algunos archivos
    «archivo_a_deshacer» y que otros archivos son correctos.

    Sobreescriba «archivo_a_deshacer» con una copia limpia de
    Subversion como se muestra.

    $ svn revert archivo_a_deshacer

    Guarde un árbol local actualizado en Subversión como se muestra.

    $ svn ci -m «Descripción del cambio«

    Cree y añada un archivo «archivo_a_añadir» como se muestra.

    $ vi archivo_a_añadir
    $ svn add archivo_a_añadir
    $ svn ci -m «Añadido archivo archivo_a_añadir«

    Mezcle la última versión de Subversion como se muestra.

    $ svn up

    Vigile las líneas que empiezan por «C filename» ya que indican
    cambios conflictivos.

    MIre el código no modificado en p. ej. «nombre_de_archivo.r6»,
    «nombre_de_archivo.r9» y «nombre_de_archivo.mio».

    Los cambios conflictivos en los archivos los puede encontrar
    buscando por la cadena «<<<<<<<» y «>>>>>>>».

    Modifique los archivos para resolver los conflictos según
    necesite.

    Añada una etiqueta de distribución «Liberación-1» como se
    muestra.

    $ svn ci -m «Última entrega para la Liberación-1«
    $ svn cp file:///srv/svn/proyecto/module1/trunk file:///srv/svn/proyecto/module1/tags/Liberación-1

    Editelo para continuar.

    Borre la etiqueta de publicación «Liberación-1» como se muestra.

    $ svn rm file:///srv/svn/proyecto/module1/tags/Liberación-1

    Comprometa los cambios en Subversion como se muestra.

    $ svn ci -m «Realmente la última entrega para la Liberación-1«

    Vuelva a añadir al etiqueta de liberación «Liberación-1» de la
    cabeza de «trunk« de la versión actualizada de Subversion como se
    muestra.

    $ svn cp file:///srv/svn/proyecto/module1/trunk file:///srv/svn/proyecto/module1/tags/Liberación-1

    Creee una rama con la ruta «module1/ramas/
    Corrección-Liberación-inicial» de la versión original
    referenciada por la ruta «module1/etiquetas/Liberación-inicial» y
    compruebela en el directorio «~/ruta/al/antiguo» como se muestra.

    $ svn cp file:///srv/svn/proyecto/module1/etiquetas/LIberación-inicial file:///srv/svn/proyecto/module1/ramas/Corrección-Liberación-inicial
    $ cd ~/ruta/a
    $ svn co file:///srv/svn/proyecto/module1/ramas/corrección-Liberación-inicial antiguo
    $ cd antiguo

    Sugerencia

    Utilice «module1/trunk@{2005-12-20}» (formato de fecha ISO 8601)
    en vez de «module1/tags/Liberación-inicial» para especificar una
    fecha determinada como punto de bifurcación.

    Trabaje en este árbol local que refencia a la rama
    «Corrección-Liberación-inicial» la cual esta basada en la versión
    original.

    Trabaje en esta rama ... hasta que alguien más se una a la rama
    «CorrecciónLiberación-inicial».

    Sincronice los archivos modificados por tercereos en esta rama
    como se muestra.

    $ svn up

    Modifique los archivos para resolver los conflictos según
    necesite.

    Comprometa los cambios en Subversion como se muestra.

    $ svn ci -m «Comprobando esta rama«

    Actualice el árbol local con el comienzo de trunk como se
    muestra.

    $ svn switch file:///srv/svn/proyecto/module1/trunk

    Actualice el árbol local (contenido = raíz de «trunk«)
    mezclandolo con la rama «Corrección-Liberación-inicial» como se
    muestra.

    $ svn merge file:///srv/svn/proyecto/module1/ramas/Corrección-Liberación-inicial

    Corrija los conflictos con el editor.

    Comprometa los cambios en Subversion como se muestra.

    $ svn ci -m «Corrección-Liberación-inicial mezclada«

    Realice el archivado como se muestra.

    $ cd ..
    $ mv antiguo corrección-antiguo-module1
    $ tar -cvzf corrección-antiguo-module1.tar.gz corrección-antiguo-module1
    $ rm -rf corrección-antiguo-module1

    Sugerencia
   
    Puede sustituir las URLs del tipo «file:///…» por otros formatos
    de URLs como «http://…» y «svn+ssh://…».

    Sugerencia

    Puede comprobar unicamente un subdirectorio de «module1»
    proporcionando su nombre como en «svn co file:///srv/svn/proyecto
    /module1/trunk/subdir module1/subdir», etc.

    Tabla 10.15. Opciones importantes de las órdenes de Subversion
    (utilizadas como primer parámetro en svn(1))

    +---------------------------------------------------------------+
    | opción  |                     significado                     |
    |---------+-----------------------------------------------------|
    |--dry-run|ejecución en seco, sin efecto                        |
    |---------+-----------------------------------------------------|
    |-v       |muestra los detalles de los mensajes de la actividad |
    |         |de svn                                               |
    +---------------------------------------------------------------+


Capítulo 11. Conversión de datos

    Se describen herramientas y métodos para convertir formatos de
    datos en el sistema Debian.

    Las herramientas para formatos estándar son muy buenas pero para
    formatos propietarios son limitadas.

%

11.1. Herramientas para la conversión de información en formato texto

    Los siguientes paquetes para la conversión de información en
    formato texto llamaron mi atención.

    Tabla 11.1. Relación de herramientas de conversión de información
    en formato texto

    +---------------------------------------------------------------+
    |paquete |popularidad|tamaño|palabra clave |    descripción     |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |conversor de la     |
    |        |           |      |              |codificación de     |
    |        |V:935,     |      |conjunto de   |texto entre         |
    |libc6   |I:999      |12771 |caracteres    |configuraciones     |
    |        |           |      |              |locales mediante    |
    |        |           |      |              |iconv(1)            |
    |        |           |      |              |(fundamental)       |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |conversor de        |
    |        |           |      |              |codificaciones de   |
    |        |           |      |              |texto entre         |
    |recode  |V:3, I:25  |603   |conjunto de   |configuraciones     |
    |        |           |      |caracteres+eol|locales (versátil,  |
    |        |           |      |              |con más             |
    |        |           |      |              |funcionalidades y   |
    |        |           |      |              |alias)              |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |conversor de        |
    |        |           |      |              |codificaciones de   |
    |konwert |V:1, I:54  |134   |conjunto de   |texto entre         |
    |        |           |      |caracteres    |configuraciones     |
    |        |           |      |              |locales             |
    |        |           |      |              |(sofisticado)       |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |traductor del       |
    |nkf     |V:0, I:11  |358   |conjunto de   |conjunto de         |
    |        |           |      |caracteres    |caracteres para el  |
    |        |           |      |              |japonés             |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |conjunto de   |traductor de        |
    |tcs     |V:0, I:0   |518   |caracteres    |conjunto de         |
    |        |           |      |              |caracteres          |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |cambia las letras   |
    |unaccent|V:0, I:0   |29    |conjunto de   |acentuadas por su   |
    |        |           |      |caracteres    |equivalente sin     |
    |        |           |      |              |acentuar            |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |conversor entre     |
    |        |           |      |              |formatos de texto   |
    |tofrodos|V:1, I:25  |55    |eol           |entre DOS y Unix:   |
    |        |           |      |              |fromdos(1) y todos  |
    |        |           |      |              |(1)                 |
    |--------+-----------+------+--------------+--------------------|
    |        |           |      |              |conversor de        |
    |        |           |      |              |formatos de texto   |
    |macutils|V:0, I:1   |298   |eol           |entre Macintosh y   |
    |        |           |      |              |Unix: frommac(1) y  |
    |        |           |      |              |tomac(1)            |
    +---------------------------------------------------------------+


%

11.1.1. Convirtiendo un archivo de texto con iconv

    Sugerencia

    iconv(1) es parte del paquete libc6 y esta siempre disponible en
    practicamente el cualquier sistema tipo Unix para la conversión
    de codificaciones de caracteres.

    Puede converitr las codificaciones de los archivos de texto con 
    iconv(1)como es muestra.

    $ iconv -f codificación1 -t codificación2 entrada.txt >salida.txt

    Los valores de codificaciones para el encaje distinguen entre
    mayúsculas y minúsculas y pasan por alto «-» y «_». Puede obtener
    una relación de las codificaciones reconocidas mediante la orden
    «iconv -l».

    Tabla 11.2. Relación de valores de codificación y su uso

    +---------------------------------------------------------------+
    |valor de la |                       uso                        |
    |codificación|                                                  |
    |------------+--------------------------------------------------|
    |            |Código Estándar Americano para el Intercambio de  |
    |ASCII       |Información, código de 7 bits sin caracteres      |
    |            |acentuados                                        |
    |------------+--------------------------------------------------|
    |UTF-8       |estándar multilenguaje actual en los sistemas     |
    |            |operativos modernos                               |
    |------------+--------------------------------------------------|
    |ISO-8859-1  |estándar antiguo de las lenguas occidentales,     |
    |            |ASCII+ caracteres acentuados                      |
    |------------+--------------------------------------------------|
    |ISO-8859-2  |antiguo estándar de las lenguas occidentales,     |
    |            |ASCII + caracteres acentuados                     |
    |------------+--------------------------------------------------|
    |ISO-8859-15 |antiguo estándar de las lenguas occidentales,     |
    |            |ISO-8859-1 con el símbolo del euro                |
    |------------+--------------------------------------------------|
    |            |página de códigos 850, caracteres de Microsoft DOS|
    |CP850       |con gráficos para los lenguajes de la Europa      |
    |            |occidental, variante de ISO-8859-1                |
    |------------+--------------------------------------------------|
    |CP932       |página de código 932, variante del japonés de     |
    |            |Shift-JIS al estilo Microsoft Windows             |
    |------------+--------------------------------------------------|
    |            |página de códigos 936,GB2312, GBK o GB18030       |
    |CP936       |variante para chino simplificado al estilo        |
    |            |Microsoft Windows                                 |
    |------------+--------------------------------------------------|
    |CP949       |página de código 949, EUC-KR o Código Unificado   |
    |            |Hangul par coreano al estilo Microsoft Windows    |
    |------------+--------------------------------------------------|
    |CP950       |código de página 950, Big5 variante par chino     |
    |            |tradicional al estilo Microsoft Windows           |
    |------------+--------------------------------------------------|
    |CP1251      |código de página 1251, codificación del alfabeto  |
    |            |cirílico al estilo Microsoft Windows              |
    |------------+--------------------------------------------------|
    |            |código de página 1252, ISO-8859-15 para las       |
    |CP1252      |lenguas de Europa occidental al estilo Microsoft  |
    |            |Windows                                           |
    |------------+--------------------------------------------------|
    |KOI8-R      |antiguo estándar ruso UNIX para el alfabeto       |
    |            |cirílico                                          |
    |------------+--------------------------------------------------|
    |ISO-2022-JP |estándar de codificación japones para el correo   |
    |            |electrónico que solo utiliza códigos de 7 bit     |
    |------------+--------------------------------------------------|
    |eucJP       |código de 8 bit del antiguo estándar japonés de   |
    |            |UNIX, completamente diferente de Shift-JIS        |
    |------------+--------------------------------------------------|
    |Shift-JIS   |Apéndice 1 para el japonés JIS X 0208 (consulte   |
    |            |CP932)                                            |
    +---------------------------------------------------------------+


    Nota

    Algunas codificaciones son únicamente usadas para la conversión
    de información y no son usables como valores de la configuración
    local (Sección 8.4.1, “Fundamentos de codificación”).

    Para los conjuntos de caracteres que caben en un único byte como
    ASCII y ISO-8859, la códificación de caracteres es casi lo mismo
    que el conjunto de caracteres.

    Para los conjuntos de caracteres con muchos elementos como JIS X
    0213 en el japonés o Conjunto de Caracteres Universal (UCS,
    Unicode, ISO-10646-1) en prácticamente cualquier lenguaje,
    existen muchos esquemas de codificación y encajan como secuencias
    de bytes de datos.

      * EUC e ISO/IEC 2022 (también conocido como JIS X 0202) para el
        japonés

      * UTF-8, UTF-16/UCS-2 y UTF-32/UCS-4 para Unicode

    En este caso existe un diferenciación clara entre el conjunto de
    caracteres y la códificación de caracteres

    Algunos proveedores en algunos casos utilizan la página de
    códigos como sinónimo de la tabla de codificación de caracteres.

    Nota

    Tenga en cuenta que la mayor parte de los sistemas de
    codificación comparten los mismos códigos con ASCII de 7 bits.
    Pero existen algunas excepciones. Si esta convirtiendo programas
    antiguos japoneses en C y datos URL de la codificación conocida
    como formato shift-JIS a formato UTF-8, utilice «CP932» como
    nombre de la codificación en lugar de «shift-JIS» para obtener
    los resultados correctos: 0x5C → «\» y 0x7E → «~». De otro modo
    serán convertidos a los caracteres incorrectos.

    Sugerencia

    recode(1) también puede ser usado y aporta mayor funcionalidad
    que la combinación de iconv(1), fromdos(1), todos(1), frommac(1)
    y tomac(1). Para más información, consulte «info recode».

%

11.1.2. Comprobando que un archivo es UTF-8 con iconv

    Puede comprobar si un archivo de texto está codificado en UTF-8
    con iconv(1) como se muestra.

    $ iconv -f utf8 -t utf8 entrada.txt >/dev/null || echo «non-UTF-8 found«

    Sugerencia
   
    Utilice la opción «--verbose» en el ejemplo anterior para
    determinar el primer caracter que no pertenece a UTF-8.

%

11.1.3. Convirtiendo los nombres de archivos con iconv

    Aquí esta un archivo de órdenes de ejemplo de conversión de los
    nombres de archivos creados en un sistema operativo antiguo a
    otro moderno UTF-8 en un único directorio.

    #!/bin/sh
    ENCDN=iso-8859-1
    for x in *;
     do
     mv «$x« «$(echo «$x« | iconv -f $ENCDN -t utf-8)«
    done

    La variable «$ENCDN» contiene la codificación original utilizada
    por el nombre de archivo en el sistema operativo antiguo como en
    Tabla 11.2, “Relación de valores de codificación y su uso”.

    Para escenarios más complicados, por favor, monte el sistema de
    archivos (p. ej. la partición del disco) que contiene los nombres
    de archivos con la codificación adecuada mediante la opción
    correspondiente de mount(8) (consulte Sección 8.4.6,
    “Códificación del nombre del archivo”) y copie el contenido
    completo a otro sistema de archivos montado como UTF-8 con la
    orden «cp -a».

%

11.1.4. Conversión EOL

    El formato de archivo de texto, concretamente el código de final
    de línea (EOL) depende de la plataforma.

    Tabla 11.3. Relación de estilos EOL para las diferentes
    plataformas

    +---------------------------------------------------------------+
    |  plataforma   |codificación de EOL|control|decimal|hexadecimal|
    |---------------+-------------------+-------+-------+-----------|
    |Debian (unix)  |LF                 |^J     |10     |0A         |
    |---------------+-------------------+-------+-------+-----------|
    |MSDOS y Windows|CR-LF              |^M^J   |13 10  |0D 0A      |
    |---------------+-------------------+-------+-------+-----------|
    |Macintosh      |CR                 |^M     |13     |0D         |
    +---------------------------------------------------------------+


    ,Los porgramas de conversion del formato EOL fromdos(1), todos(1)
    , frommac(1) y tomac(1), son muy útiles. Recode(1) también es muy
    útil.

    Nota

    Algunos datos del sistema Debian, como las páginas wiki del
    paquete python-moinmoin utilizan el estilo de MSDOS usando como
    EOL la combinación CR-LF. Así es que lo anterior es solo una
    regla general.

    Nota
   
    La mayor parte de los editores (p ej.vim, emacs, gedit, …)
    gestionan de forma transparente el estilo EOL de MSDOS.

    Sugerencia

    La utilización de «sed -e '/\r$/!s/$/\r/'» en lugar de todos(1)
    es mejor si quiere unificar el uso de EOL de los estilos MSDOS y
    Unix. (p. ej. tras mezclar dos archivos MSDOS con diff3(1).) Esto
    es debido a que todos añade CR a todas las líneas.

%

11.1.5. Conversión de tabuladores

    Existen unow pocos programas especializados en convertir los
    códigos de tabulación.

    Tabla 11.4. Relación de las órdenes de conversión de tabuladores
    de los paquetes bsdmainutils y coreutils

    +-------------------------------------------------------------+
    |               función                |bsdmainutils|coreutils|
    |--------------------------------------+------------+---------|
    |cambia los tabuladores a espacios     |«col -x»    |expand   |
    |--------------------------------------+------------+---------|
    |no cambia los tabuladores por espacios|«col -h»    |unexpand |
    +-------------------------------------------------------------+


    indent(1) perteneciente al paquete indent reformatea
    completamente a un programa en C..

    Los programas de edición como vim y emacs pueden también utilizar
    la conversión de tabuladores. Por ejemplo con vim, puede expandir
    los tabuladores con la secuencia de órdenes «:set expandtab» y
    «:%retab». Puede deshacer estos cambios con la secuencia de
    órdenes «:set noexpandtab» y «:%retab!».

%

11.1.6. Editores con conversión automática

    Los editores modernos inteligentes como el programa vim son lo
    bastante inteligentes y trabajan bien con cualquier sistema de
    codificación y formato de archivo. Para mejorar la compatibilidad
    debería usar la configuración local UTF-8 en una consola con esta
    posibilidad.

    Un archivo de texto Unix «u-file.txt» almacenado en la antiguo
    europeo occidental con la codificación latin1 (iso-8859-1) puede
    ser editado con vim como se muestra.

    $ vim u-file.txt

    Esto es debido al mecanismode autodetección de la codificación
    del archivo en vim que asume por defecto UTF-8 y si falla asume
    que será latin1.

    Un antiguo archivo de text polaco en Unix, «pu-file.txt»,
    almacenado en la codificación latin2 (iso-8859-2) puede ser
    editado con vim como se muestra.

    $ vim '+e ++enc=latin2 pu-file.txt'

    Un antiguo fichero de texto Unix en japonés, «ju-file.txt»,
    almacenado con la codificación eucJP puede ser editado por vim
    como se muestra.

    $ vim '+e ++enc=eucJP ju-file.txt'

    Un archivo de texto MS-Windows antiguo en japonés, «jw-file.txt»,
    almacenado con la codificación shift-JIS (concretamente: CP932)
    puede ser editado con vim como se muestra.

    $ vim '+e ++enc=CP932 ++ff=dos jw-file.txt'

    Cuando se abre un archivo con las opciones «++enc» y «++ff» , la
    orden de Vim «:w» lo almacena en su formato original
    sobreescribiendo el archivo original. También puede guardarlo con
    un formato y nombre de archivo específico con la orden de Vim
    correspondiente, p. ej. , «:w ++enc=utf8 new.txt».

    Por favor para más información sobre el «soporte de texto
    multibyte« consulte mbyte.txt en la ayuda de vim y Tabla 11.2,
    “Relación de valores de codificación y su uso” para los valores
    de configuraciones de la ubicación utilizados por «++enc».

    En los programas de la familia de emacs existen funcionalidades
    equivalentes a las anteriormente descritas.

%

11.1.7. Extracción de texto plano

    Los siguiente lee un página web y la convierte en un archivo de
    texto. Es muy útil copiando configuraciones de la Web o para
    aplicarle las herramientas de texto de Unix a la página web como 
    grep(1).

    $ w3m -dump http://www.sitio-remoto.com/pagina-web.html > archivo_de_texto

    De igual forma, puede extraer información en texto plano desde
    otros formatos como se muestra.

    Tabla 11.5. Relación de las herramientas para extraer información
    en texto plano

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño| palabra clave |     función      |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de HTML |
    |w3m      |V:31, I:284|2289  |html→text      |a texto con la    |
    |         |           |      |               |orden «w3m -dump» |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor avanzado|
    |html2text|V:3, I:33  |274   |html→text      |de HTML a texto   |
    |         |           |      |               |(ISO 8859-1)      |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de HTML |
    |lynx     |V:13, I:98 |1948  |html→text      |a texto con la    |
    |         |           |      |               |orden «lynx -dump»|
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de HTML |
    |elinks   |V:6, I:28  |1767  |html→text      |a texto con la    |
    |         |           |      |               |orden «elinks     |
    |         |           |      |               |-dump»            |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |Conversor de HTML |
    |links    |V:6, I:39  |2249  |html→text      |a texto con la    |
    |         |           |      |               |orden «links      |
    |         |           |      |               |-dump»            |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de HTML |
    |links2   |V:1, I:15  |5417  |html→text      |a texto con la    |
    |         |           |      |               |orden «links2     |
    |         |           |      |               |-dump»            |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |convierte archivos|
    |antiword |V:2, I:10  |589   |MSWord→text,ps |MSWord a texto    |
    |         |           |      |               |plano o ps        |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |convierte archivos|
    |catdoc   |V:27, I:127|675   |MSWord→text,TeX|MSWord a texto    |
    |         |           |      |               |plano o TeX       |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |extrae texto de   |
    |pstotext |V:1, I:3   |126   |ps/pdf→text    |PostScript y de   |
    |         |           |      |               |archivos PDF      |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |borra lass        |
    |unhtml   |V:0, I:0   |43    |html→text      |etiquetas de      |
    |         |           |      |               |marcado de un     |
    |         |           |      |               |archivo HTML      |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de Texto|
    |odt2txt  |V:1, I:7   |60    |odt→texto      |OpenDocument a    |
    |         |           |      |               |texto             |
    +---------------------------------------------------------------+


%

11.1.8. Resaltando y dándole formato a información en texto plano

    Puede resaltar y dar formato a información en texto plano como se
    muestra.

    Tabla 11.6. Relación de herramientas para resaltar información en
    texto plano

    +------------------------------------------------------------------+
    |    paquete     |popularidad|tamaño| palabra clave | descripción  |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |Vim MACRO para|
    |                |           |      |               |convertir     |
    |                |           |      |               |código fuente |
    |vim-runtime     |V:19, I:435|31723 |highlight      |a HTML con    |
    |                |           |      |               |«:source      |
    |                |           |      |               |$VIMRUNTIME/  |
    |                |           |      |               |syntax/       |
    |                |           |      |               |html.vim»     |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |convierte un  |
    |cxref           |V:0, I:0   |1193  |c→html         |programa en   |
    |                |           |      |               |lenguaje C a  |
    |                |           |      |               |latext y HTML |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |convierte     |
    |src2tex         |V:0, I:0   |622   |highlight      |varios códigos|
    |                |           |      |               |fuentes a TeX |
    |                |           |      |               |(lenguaje C)  |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |convierte     |
    |                |           |      |               |varias códigos|
    |                |           |      |               |fuente a HTML,|
    |                |           |      |               |XHTML, LaTeX, |
    |                |           |      |               |Texinfo,      |
    |source-highlight|V:0, I:7   |1992  |highlight      |secuencias de |
    |                |           |      |               |escape de     |
    |                |           |      |               |color ANSI y  |
    |                |           |      |               |archivos      |
    |                |           |      |               |DocBook con   |
    |                |           |      |               |resaltado     |
    |                |           |      |               |(C++)         |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |convierte     |
    |                |           |      |               |varios códigos|
    |                |           |      |               |fuente a      |
    |                |           |      |               |archivos HTML,|
    |highlight       |V:1, I:12  |1083  |highlight      |XHTML, RTF,   |
    |                |           |      |               |LaTeX, TeX o  |
    |                |           |      |               |XSL-FO con    |
    |                |           |      |               |resaltado     |
    |                |           |      |               |(C++)         |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |coloreado     |
    |grc             |V:0, I:3   |190   |texto→color    |genérico para |
    |                |           |      |               |todo (Python) |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |conversor de  |
    |txt2html        |V:0, I:3   |259   |texto→html     |texto a HTML  |
    |                |           |      |               |(Perl)        |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |formateador de|
    |                |           |      |               |documentos de |
    |markdown        |V:0, I:8   |57    |texto→html     |texto         |
    |                |           |      |               |«markdown« a  |
    |                |           |      |               |(X)HTML (Perl)|
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |formateador de|
    |                |           |      |texto→cualquier|documentos de |
    |asciidoc        |I:13       |81    |cosa           |texto AsciiDoc|
    |                |           |      |               |a XML/HTML    |
    |                |           |      |               |(Python)      |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |conversor     |
    |pandoc          |V:8, I:47  |151714|texto→cualquier|general       |
    |                |           |      |cosa           |«markup«      |
    |                |           |      |               |(Haskell)     |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |formateador de|
    |                |           |      |texto→cualquier|documentos de |
    |python-docutils |V:12, I:133|1771  |cosa           |Texto         |
    |                |           |      |               |ReStructurado |
    |                |           |      |               |a XML (Python)|
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |conversión de |
    |                |           |      |               |documentos de |
    |                |           |      |               |texto a HTML, |
    |                |           |      |               |SGML, LaTeX,  |
    |txt2tags        |V:0, I:1   |342   |texto→cualquier|páginas de    |
    |                |           |      |cosa           |manual,       |
    |                |           |      |               |MoinMoin,     |
    |                |           |      |               |Magic Point y |
    |                |           |      |               |PageMaker     |
    |                |           |      |               |(Python)      |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |documento     |
    |                |           |      |               |universal -   |
    |udo             |V:0, I:0   |583   |texto→cualquier|utilidad de   |
    |                |           |      |cosa           |procesamiento |
    |                |           |      |               |de texto      |
    |                |           |      |               |(lenguaje C)  |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |conversor de  |
    |                |           |      |               |documentos    |
    |                |           |      |texto→cualquier|desde texto   |
    |stx2any         |V:0, I:0   |264   |cosa           |plano         |
    |                |           |      |               |estructurado a|
    |                |           |      |               |otros formatos|
    |                |           |      |               |(m4)          |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |conversor de  |
    |                |           |      |               |documentos de |
    |rest2web        |V:0, I:0   |527   |texto→html     |Texto         |
    |                |           |      |               |ReStructurado |
    |                |           |      |               |a html        |
    |                |           |      |               |(Python)      |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |sistema de    |
    |                |           |      |texto→cualquier|preparación de|
    |aft             |V:0, I:0   |235   |cosa           |documento en  |
    |                |           |      |               |«formato      |
    |                |           |      |               |libre« (Perl) |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |herramientas y|
    |                |           |      |texto→cualquier|lenguajes para|
    |yodl            |V:0, I:0   |610   |cosa           |procesar      |
    |                |           |      |               |predocumentos |
    |                |           |      |               |(lenguaje C)  |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |análisis de   |
    |sdf             |V:0, I:0   |1445  |texto→cualquier|documentos    |
    |                |           |      |cosa           |sencillos     |
    |                |           |      |               |(Perl)        |
    |----------------+-----------+------+---------------+--------------|
    |                |           |      |               |marco para la |
    |                |           |      |               |búsqueda,     |
    |sisu            |V:0, I:0   |5344  |texto→cualquier|publicación y |
    |                |           |      |cosa           |estructuración|
    |                |           |      |               |de documentos |
    |                |           |      |               |(Ruby)        |
    +------------------------------------------------------------------+


%

11.2. datos XML

    El Lenguaje de Marcado Extensible (XML) es un lenguaje de marcado
    para documentos que tengan la información estructurada.

    Consulte la información introductoria en XML.COM.

      * «¿Qué es XML?«

      * «¿Qué es XSLT?«
   
      * «¿Qué es XSL-FO?«

      * «¿Qué es XLink?«

%

11.2.1. Conceptos básicos de XML

    El código XML tiene la apariencia de HTML. Nos permite obtener
    diferentes formatos de un documento. Un sistema sencillo de XML
    es el paquete docbook-xsl, que utilizamos aquí.

    Todo archivo XML comienza con una declaración estándar XML como
    se muestra.

    <?xml version=«1.0« encoding=«UTF-8«?>

    La sintaxis fundamental de un elemento XML se marca como se
    muestra.

    <nombre atributo=«valor«>contenido</nombre>

    Un elemento XML sin contenido se marca de forma resumida como se
    muestra.

    <nombre atributo=«valor«/>

    El «atributo=«valor«» de los ejemplos anteriores son opcionales.

    Un comentario en XML se marca como se muestra.

    <!-- comentario -->

    Mientras que otros añaden marcas, XML necesita cambios menores al
    utilizar entidades predefinidas para los siguientes caracteres.

    Tabla 11.7. Relación de entidades predefinidas para XML

    +---------------------------------------------+
    |entidad predefinida|carácter a ser convertido|
    |-------------------+-------------------------|
    |&quot;             |« : comillas             |
    |-------------------+-------------------------|
    |&apos;             |' : apóstrofe            |
    |-------------------+-------------------------|
    |&lt;               |< : menor que            |
    |-------------------+-------------------------|
    |&gt;               |> : mayor que            |
    |-------------------+-------------------------|
    |&amp;              |& : signo &              |
    +---------------------------------------------+


    Atención
   
    «<» y «&» no se pueden utilizar en los atributos y elementos.

    Nota

    Cuando se utilizan entidades definidas por el usuario, p. ej. «&
    alguna_etiqueta:», la primera definición prevalece sobre las
    demás. La definición de la entidad se realiza como «<!ENTITY
    alguna-etiqueta «valor de la entidad«>».

    Nota

    Ya que las marcas XML se realizan de forma coherente con un
    cierto conjunto de etiquetas (y alguna información en su
    contenido y atributos), la conversión a otro XML es un
    procedimiento trivial utilizando Transformaciones del Lenguaje de
    Estilo Extensibles (XSLT, Extensible Stylesheet Language
    Transformations).

%

11.2.2. Procesamiento XML

    Existen muchas herramientas para procesar archivos XML como el
    Lenguaje de Estilos Extensible (XSL, the Extensible Stylesheet
    Language).

    Principalmente, una vez que tenga un archivo XML bien formado,
    puede convertirlo en cualquier otro formato utilizando el
    Lenguaje de Transformación de Estilos Extensible (XSLT,
    Extensible Stylesheet Language Transformations .

    El Lenguaje de Estilo Extensible para dar Formato a Objetos
    (XSL-FO, Extensible Stylesheet Language for Formatting Objects)
    se supone que es la solución en lo referente a dar formato. El
    paquete fop es nuevo en el archivo main de Debian debido a su
    dependencia del lenguaje de programación Java. Así que el código
    LaTeX se genera normalmente partiendo de XML y utilizando XSLT y
    el sistema LaTeX se utiliza para crear los formatos de archivo
    imprimibles como DVI, PostScript y PDF.

    Tabla 11.8. Relación de herramientas XML

    +---------------------------------------------------------------+
    |  paquete  |popularidad|tamaño|palabra|      descripción       |
    |           |           |      | clave |                        |
    |-----------+-----------+------+-------+------------------------|
    |           |           |      |       |Documento de definición |
    |docbook-xml|V:15, I:280|2133  |xml    |de XML (DTD) para       |
    |           |           |      |       |DocBook                 |
    |-----------+-----------+------+-------+------------------------|
    |           |           |      |       |procesador de línea de  |
    |xsltproc   |V:15, I:104|160   |xslt   |órdenes XSLT (XML → XML,|
    |           |           |      |       |HTML, texto plano, etc.)|
    |-----------+-----------+------+-------+------------------------|
    |           |           |      |       |Hojas de estilos XSL    |
    |           |           |      |xml/   |para procesar documetnos|
    |docbook-xsl|V:13, I:165|14870 |xslt   |XML DocBook a diferentes|
    |           |           |      |       |formatos de salida con  |
    |           |           |      |       |XSLT                    |
    |-----------+-----------+------+-------+------------------------|
    |xmlto      |V:1, I:23  |130   |xml/   |conversor de XML a      |
    |           |           |      |xslt   |cualquier cosa con XSLT |
    |-----------+-----------+------+-------+------------------------|
    |dbtoepub   |V:0, I:0   |37    |xml/   |conversor DocBook XML a |
    |           |           |      |xslt   |.epub                   |
    |-----------+-----------+------+-------+------------------------|
    |           |           |      |xml/   |convierte archivos      |
    |dblatex    |V:3, I:16  |4643  |xslt   |Docbook adocumentos DVI,|
    |           |           |      |       |PostScript, PDF con XSLT|
    |-----------+-----------+------+-------+------------------------|
    |fop        |V:1, I:24  |291   |xml/   |convierte archivos XML  |
    |           |           |      |xsl-fo |Docbook a PDF           |
    +---------------------------------------------------------------+


    Ya que XML es un subconjunto del Lenguaje Estándar de Marcas
    Generalizado (SGML), puede ser procesado por cualquier
    herramienta para SGML, como Lenguaje de Especificación y
    Semantica de Documentos de Estilo (DSSSL, Document Style
    Semantics and Specification Language).

    Tabla 11.9. Relación de herramientas DSSSL

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|palabra|     descripción      |
    |             |           |      | clave |                      |
    |-------------+-----------+------+-------+----------------------|
    |             |           |      |       |ISO/IEC 10179:1996    |
    |openjade     |V:2, I:38  |1019  |dsssl  |procesador de estándar|
    |             |           |      |       |DSSSL (más            |
    |             |           |      |       |actualizado)          |
    |-------------+-----------+------+-------+----------------------|
    |             |           |      |       |Hojas de estilo DSSSL |
    |             |           |      |       |para el procesamiento |
    |docbook-dsssl|V:1, I:23  |2604  |xml/   |de documentos XML     |
    |             |           |      |dsssl  |DocBook a diferentes  |
    |             |           |      |       |formatos de salida con|
    |             |           |      |       |DSSSL                 |
    |-------------+-----------+------+-------+----------------------|
    |             |           |      |       |utilidades para       |
    |             |           |      |       |archivos DocBook      |
    |             |           |      |       |incluyendo la         |
    |docbook-utils|V:0, I:16  |281   |xml/   |conversión a otros    |
    |             |           |      |dsssl  |formatos (HTML, RTF,  |
    |             |           |      |       |PS, man, PDF) con las |
    |             |           |      |       |órdenes docbook2* con |
    |             |           |      |       |DSSSL                 |
    |-------------+-----------+------+-------+----------------------|
    |             |           |      |SGML/  |conversor de SGML y   |
    |sgml2x       |V:0, I:0   |90    |dsssl  |XML usando hojas de   |
    |             |           |      |       |estilos de DSSSL      |
    +---------------------------------------------------------------+


    Sugerencia

    Algunas veces es práctico leer directamente archivos XML DocBook
    con yelp de GNOME ya que tiene una representación de imágenes en
    X decente.

%

11.2.3. La extracción de información XML

    Puede extraer información HTML o XML de otros formatos utilizado
    lo que sigue:

    Tabla 11.10. Relación de herramientas de extracción de información
    XML

    +------------------------------------------------------------------+
    | paquete |popularidad|tamaño|    palabra clave     | descripción  |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |         |           |      |                      |documentos de |
    |wv       |V:0, I:7   |717   |MSWord→cualquiera     |Microsoft Word|
    |         |           |      |                      |a HTML, LaTeX,|
    |         |           |      |                      |etc.          |
    |---------+-----------+------+----------------------+--------------|
    |texi2html|V:0, I:8   |1833  |texi→html             |conversor de  |
    |         |           |      |                      |Texinfo a HTML|
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |man2html |V:0, I:2   |138   |páginas man→html      |páginas man a |
    |         |           |      |                      |HTML (soporte |
    |         |           |      |                      |CGI)          |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |unrtf    |V:0, I:4   |148   |rtf→html              |documentos de |
    |         |           |      |                      |RTF a HTML,   |
    |         |           |      |                      |etc           |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |info2www |V:1, I:3   |76    |info→html             |GNU info a    |
    |         |           |      |                      |HTML (soporte |
    |         |           |      |                      |CGI)          |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |         |           |      |                      |documentos SXW|
    |ooo2dbk  |V:0, I:0   |217   |sxw→xml               |de            |
    |         |           |      |                      |OpenOffice.org|
    |         |           |      |                      |a DocBook XML |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |archivos      |
    |         |           |      |                      |WordPerfect   |
    |wp2x     |V:0, I:0   |202   |WordPerfect→cualquiera|5.0 y 5.1 a   |
    |         |           |      |                      |TeX, LaTeX,   |
    |         |           |      |                      |troff, GML y  |
    |         |           |      |                      |HTML          |
    |---------+-----------+------+----------------------+--------------|
    |         |           |      |                      |conversor de  |
    |doclifter|V:0, I:0   |451   |troff→xml             |troff a       |
    |         |           |      |                      |DocBook XML   |
    +------------------------------------------------------------------+


    Para archivos HTML que no son XML, puede convertirlos a XHTML el
    cual es una ocurrencia de XML bien formado. XHTML puede ser
    procesado por las herramientas XML.

    Tabla 11.11. Relación de las herramientas de impresión de calidad
    de XML

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|palabra clave |  descripción  |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |herramienta XML|
    |             |           |      |              |en línea de    |
    |             |           |      |              |órdenes xmllint|
    |libxml2-utils|V:22, I:246|182   |xml↔html↔xhtml|(1)            |
    |             |           |      |              |(comprobación  |
    |             |           |      |              |de sintáxi,    |
    |             |           |      |              |reformateo,    |
    |             |           |      |              |filtrado, …)   |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |comprobador de |
    |tidy         |V:2, I:14  |84    |xml↔html↔xhtml|la sintáxis    |
    |             |           |      |              |HTML y         |
    |             |           |      |              |reformateador  |
    +---------------------------------------------------------------+


    Una vez que se genera el apropiado XML, puede utilizar la
    tecnología XSLT para extraer información basandose el contexo de
    marcas, etc.

%

11.3. Configuración tipográfica

    El programa Unix troff, creado por AT&T puede utilizarse para la
    composición tipográfica simple. Las páginas de man son
    generalmente creadas con él.

    TeX fue creado por Donald Knuth y es una herramienta de
    composición tipográfica muy poderoso y el estándar de facto LaTeX
    fue creado por Leslie Lamport y permite un acceso a nivel alto a
    todas la potencia de TeX.

    Tabla 11.12. Relación de las herramientas de composición
    tipográfica

    +---------------------------------------------------------------+
    |paquete|popularidad|tamaño|palabra|        descripción         |
    |       |           |      | clave |                            |
    |-------+-----------+------+-------+----------------------------|
    |       |           |      |       |El sistema de composición   |
    |texlive|V:3, I:50  |71    |(La)TeX|tipográfica TeX, para       |
    |       |           |      |       |previsualización e impresión|
    |-------+-----------+------+-------+----------------------------|
    |groff  |V:3, I:64  |11838 |troff  |sistema para dar formato al |
    |       |           |      |       |texto GNU troff             |
    +---------------------------------------------------------------+


%

11.3.1. composición tipográfica roff

    Tradicionalmente, roff es el sistema principal de Unix para la
    composición tipográfica. Consulte roff(7), groff(7), groff(1), 
    grotty(1), troff(1), groff_mdoc(7), groff_man(7), groff_ms(7), 
    groff_me(7), groff_mm(7) y «info groff».

    Puede leer o imprimir un buen tutorial y texto de referencia en
    la macro «-me» instalando el paquete groff en el archivo «/usr/
    share/doc/groff/».

    Sugerencia

    Con «groff -Tascii -me -» se obtiene una salida en texto plano
    con códigos de escape ANSI. Si lo que quiere son páginas man con
    muchos «^H« y «_«, utilice en su lugar«GROFF_NO_SGR=1 groff
    -Tascii -me -».

    Sugerencia
   
    Para eliminar los «^H« y «_« del archivo de texto que groff ha
    generado, fíltrelo con «col -b -x».

%

11.3.2. TeX/LaTeX

    El software TeX Live contiene un sistema completo del sistema
    TeX. El metapaquete texlive aporta un selección apropiada de
    paquetes TeX Live que cumplirá decentemente la mayor parte de las
    tareas.

    Hay disponibles numerosas referencias a TeX y LaTeX.

      * Cómo teTeX: La Guía Local de Linux-teTeX

      * tex(1)

      * latex(1)

      * texdoc(1)

      * texdoctk(1)

      * «El libro de TeX«, de Donald E. Knuth, (Addison-Wesley)

      * «LaTeX - Un Sistema para Preparar un Documento«, de Leslie
        Lamport, (Addison-Wesley)

      * «El Compendio de LaTeX«, de Goossens, Mittelbach, Samarin,
        (Addison-Wesley)

    Este es el entorno de composición tipográfica más potente. Muchos
    procesadores de SGML lo utilizan como motor para el procesamiento
    de texto. Lyx que está en el paquete lyx y GNU TeXmacs que se
    encuentra en el paquete texmacs ofrecen un entorno de edición
    LaTeX agradable WYSIWYG mientras que muchos utilizan Emacs y Vim
    como su preferencia como editor.

    Existen multitud de recursos disponibles en la red.

      * La Guía de TEX Live - TEX Live 2007 («/usr/share/doc/
        texlive-doc-base/english/texlive-en/live.html») (del paquete
        texlive-doc-base)

      * Una Guía Sencilla de Latex/Lyx

      * Procesando Texto con LaTeX

      * Guía del Usuario Local de teTeX/LaTeX

    Cuando los documentos se vuelven grandes, algunas veces TeX puede
    fallar. Debe incrementar el tamaño de los recursos compartidos en
    «/etc/texmf/texmf.cnf» (o más concretamente editar «/etc/texmf/
    texmf.d/95NonPath» y ejecutar update-texmf(8)) con el fin de
    solucionarlo.

    Nota

    La código fuente TeX de «El Libro de TeX« esta disponible en
    http://tug.ctan.org/tex-archive/systems/knuth/dist/tex/
    texbook.tex. Este archivo contiene la mayor parte de las macros
    que se necesitan. Me consta que puede procesar dicho documento
    con tex(1) comentando las líneas de la 7 a la 10 y añadiendo «\
    input manmac \proofmodefalse». Le recomiendo ferviertemente
    comprar dicho libro (y todos los del autor Donald E. Knuth) en
    vez de utilizar la versión en línea aunque ¡el código fuente es
    un gran ejemplo de entrada de TeX!.

%

11.3.3. Impresión de una página de manual

    Puede imprimir una página manual en PostScript con una de las
    órdenes que se muestran.

    $ man -Tps alguna_página_de_manual | lpr

%

11.3.4. Crear una página de man

    Aunque es posible escribir una página de man en formato troff
    plano, existen algunos paquetes que ayudan a crearla.

    Tabla 11.13. Relación de paquetes que ayudan a crear páginas man

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|  palabra  |   descripción   |
    |              |           |      |   clave   |                 |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |SGML→página|conversor de SGML|
    |docbook-to-man|V:0, I:13  |191   |man        |DocBook en macros|
    |              |           |      |           |man roff         |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |generador de     |
    |help2man      |V:0, I:10  |498   |text→página|página man       |
    |              |           |      |man        |automático con   |
    |              |           |      |           |--help           |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |info→página|conversor de GNU |
    |info2man      |V:0, I:0   |134   |man        |info a POD o     |
    |              |           |      |           |páginas man      |
    |--------------+-----------+------+-----------+-----------------|
    |              |           |      |           |conversor de     |
    |txt2man       |V:0, I:1   |114   |text→página|texto ASCII plano|
    |              |           |      |man        |a formato de     |
    |              |           |      |           |página man       |
    +---------------------------------------------------------------+


%

11.4. Información imprimible

    En el sistema Debian la información imprimible se realizan en
    formato PostScript. El Sistema de Impresión Común de Unix (CUPS)
    utiliza Ghostscript como motor de representación para impresoras
    que no reconocen PostScript.

%

11.4.1. Ghostscript

    El núcleo de la manipulación es el intérprete de Ghostscript
    PostScript (PS) el cual genera imágenes de representación.

    La última versión de Ghostscript de Artifex fue relicenciado con
    GPL en vez de AFPL y mezcla las últimas cambios de la versión ESP
    como los de la versión 8.60 de CUPS en la distribución como
    distribución unificada.

    Tabla 11.14. Relación de intérpretes Ghostscript de PostScript

    +---------------------------------------------------------------+
    |    paquete     |popularidad|tamaño|        descripción        |
    |----------------+-----------+------+---------------------------|
    |                |V:252,     |      |El intérprete GPL          |
    |ghostscript     |I:598      |231   |Ghostscript de PostScript/ |
    |                |           |      |PDF                        |
    |----------------+-----------+------+---------------------------|
    |                |           |      |Intérprete Ghostscript de  |
    |ghostscript-x   |V:15, I:65 |223   |PostScript/PDF GPL -       |
    |                |           |      |soporte para entornos X    |
    |----------------+-----------+------+---------------------------|
    |                |           |      |biblioteca de              |
    |libpoppler95    |I:3        |4172  |representación de PDF      |
    |                |           |      |bifurcado del visor PDF    |
    |                |           |      |xpdf                       |
    |----------------+-----------+------+---------------------------|
    |                |           |      |biblioteca de              |
    |libpoppler-glib8|V:217,     |449   |representación PDF         |
    |                |I:481      |      |(biblioteca compartida     |
    |                |           |      |basada en Glib)            |
    |----------------+-----------+------+---------------------------|
    |                |           |      |biblioteca de              |
    |poppler-data    |V:111,     |13090 |representación CMaps para  |
    |                |I:637      |      |PDF (con soporte CJK:      |
    |                |           |      |Adobe-*)                   |
    +---------------------------------------------------------------+


    Sugerencia
   
    «gs -h» puede mostrar la configuración de Ghostscript.

%

11.4.2. Mezcla de dos archivos PS o PDF

    Puede mezclar dos archivos PostScript (PS) o Formato de
    Documentos Portable (PDF, Portable Document Format ) utilizando
    la orden gs(1) de Ghostscript.

    $ gs -q -dNOPAUSE -dBATCH -sDEVICE=pswrite -sOutputFile=bla.ps -f foo1.ps foo2.ps
    $ gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sOutputFile=bla.pdf -f foo1.pdf foo2.pdf

    Nota

    El formato PDF, el cual se usa de forma habitual como un formato
    de impresión multiplatafoma, es en su esencia un formato PS
    comprimido con algunas funcionalidades y extensiones adicionales.

    Sugerencia

    Para la manipulación de documentos PostScript desde la línea de
    órdenes existen órdenes como psmerge(1) y otras que pertenecen al
    paquete psutils package. pdftk(1) del paquete pdftk se utiliza
    para la manipulación de documentos PDF.

%

11.4.3. Utilidades de impresión

    Los siguienetes paquetes contienen utilidades para la impresión
    que considero importantes.

    Tabla 11.15. Relación de utilidades para la impresión

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|palabra clave |  descripción  |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |Utilidades PDF |
    |             |           |      |              |: pdftops,     |
    |poppler-utils|V:241,     |689   |pdf→ps,texto,…|pdfinfo,       |
    |             |I:434      |      |              |pdfimages,     |
    |             |           |      |              |pdftotext,     |
    |             |           |      |              |pdffonts       |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |herramientas de|
    |psutils      |V:6, I:105 |219   |ps→ps         |conversión de  |
    |             |           |      |              |documentos     |
    |             |           |      |              |PostScript     |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |crea póster    |
    |poster       |V:0, I:5   |58    |ps→ps         |grandes de     |
    |             |           |      |              |páginas        |
    |             |           |      |              |PostScript     |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |convierte texto|
    |             |           |      |              |ASCII a        |
    |enscript     |V:1, I:20  |2132  |texto→ps,     |PostScript,    |
    |             |           |      |html, rtf     |HTML, RTF o una|
    |             |           |      |              |impresión      |
    |             |           |      |              |bonita         |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |             |           |      |              |«cualquier     |
    |a2ps         |V:1, I:15  |3651  |texto→ps      |formato a      |
    |             |           |      |              |PostScript« e  |
    |             |           |      |              |impresión      |
    |             |           |      |              |bonita         |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |herramienta de |
    |pdftk        |I:51       |28    |pdf→pdf       |conversión de  |
    |             |           |      |              |documentos PDF:|
    |             |           |      |              |pdftk          |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |html2ps      |V:0, I:3   |249   |html→ps       |HTML a         |
    |             |           |      |              |PostScript     |
    |-------------+-----------+------+--------------+---------------|
    |gnuhtml2latex|V:0, I:1   |27    |html→latex    |conversor de   |
    |             |           |      |              |html a latex   |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |             |           |      |              |documentos     |
    |latex2rtf    |V:0, I:6   |480   |latex→rtf     |LaTeX a RTF la |
    |             |           |      |              |cual puede ser |
    |             |           |      |              |leído por MS   |
    |             |           |      |              |Word           |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |ps2eps       |V:3, I:68  |98    |ps→eps        |PostScript a   |
    |             |           |      |              |EPS (PostScript|
    |             |           |      |              |encapsulado)   |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |             |           |      |              |texto a        |
    |e2ps         |V:0, I:0   |109   |texto→ps      |PostScript con |
    |             |           |      |              |soporte a la   |
    |             |           |      |              |codificación   |
    |             |           |      |              |japonés        |
    |-------------+-----------+------+--------------+---------------|
    |impose+      |V:0, I:0   |119   |ps→ps         |utilidades     |
    |             |           |      |              |PostScript     |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |imprime bien   |
    |             |           |      |              |muchos códigos |
    |             |           |      |              |fuente (C, C++,|
    |trueprint    |V:0, I:0   |146   |texto→ps      |Java, Pascal,  |
    |             |           |      |              |Perl, Pike, Sh |
    |             |           |      |              |y Verilog) a   |
    |             |           |      |              |PostScript     |
    |             |           |      |              |(lenguaje C).  |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |             |           |      |              |PDF al formato |
    |             |           |      |              |gráficos de    |
    |pdf2svg      |V:0, I:4   |30    |ps→svg        |vector         |
    |             |           |      |              |escalable      |
    |             |           |      |              |(Scalable      |
    |             |           |      |              |vector         |
    |             |           |      |              |graphics)      |
    |-------------+-----------+------+--------------+---------------|
    |             |           |      |              |conversor de   |
    |pdftoipe     |V:0, I:0   |71    |ps→ipe        |PDF a formato  |
    |             |           |      |              |XML IPE        |
    +---------------------------------------------------------------+


%

11.4.4. Imprimiendo con CUPS

    Tanto las órdenes de lp(1) y lpr(1) existen en Sistema de
    Impresión Común de Unix (CUPS) que proporciona opciones
    personalizadas para la impresión.

    Puede imprimir tres copias del archivo correspondiente utilizando
    las siguientes órdenes.

    $ lp -n 3 -o Collate=True nombre_de_archivo

    $ lpr -#3 -o Collate=True nombre_de_archivo

    Puede personalizar las impresiones mediante opciones como «-o
    number-up=2», «-o page-set=even», «-o page-set=odd», «-o scaling=
    200», «-o natural-scaling=200», etc., según consta en Impresión
    con línea de órdenes y sus opciones.

%

11.5. La conversión de los datos de correo

    Considero importantes los siguientes paquetes de conversión de
    datos de correo.

    Tabla 11.16. Relación de paquetes que ayudan a la conversión de
    datos de correo

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño|palabra|       descripción        |
    |         |           |      | clave |                          |
    |---------+-----------+------+-------+--------------------------|
    |sharutils|V:4, I:55  |1421  |mail   |shar(1), unshar(1),       |
    |         |           |      |       |uuencode(1), uudecode(1)  |
    |---------+-----------+------+-------+--------------------------|
    |         |           |      |       |codifica y decodifica los |
    |mpack    |V:1, I:18  |106   |MIME   |mensajes MIME: mpack(1) y |
    |         |           |      |       |munpack(1)                |
    |---------+-----------+------+-------+--------------------------|
    |         |           |      |       |desempaca los archivos    |
    |         |           |      |       |adjuntos MIME del tipo    |
    |tnef     |V:1, I:10  |110   |ms-tnef|«application/ms-tnef« que |
    |         |           |      |       |es un formato propio de   |
    |         |           |      |       |Microsoft                 |
    |---------+-----------+------+-------+--------------------------|
    |         |           |      |       |codifica y decodifica los |
    |         |           |      |       |siguientes formatos:      |
    |uudeview |V:0, I:5   |109   |mail   |uuencode, xxencode,       |
    |         |           |      |       |BASE64, quoted printable y|
    |         |           |      |       |BinHex                    |
    +---------------------------------------------------------------+


    Sugerencia

    Se puede utilizar un servidor del Protocolo de Acceso a Mensajes
    de Internet versión 4 (IMAP4) (consulte Sección 6.7, “Servidor
    POP3/IMAP4”) para obtener los correos de un sistema de correo
    propietario siempre que el cliente permita configurar el servidor
    de correo IMAP4.

%

11.5.1. Fundamentos de información de correo

    La información de correo (SMTP) deben utilizar 7 bits.
    Seleccionando el juego de caracteres (consulte Sección 8.4.1,
    “Fundamentos de codificación”) y las Extensiones de Correo de
    Internet Multipropósito (MIME) los datos binarios y la
    información en formato texto de 7 bits son codificados en formato
    de 7 bits.

    El formato de almacenamiento estándar de correo es mbox según
    RFC2822 (actualizado por el RFC822). Consulte mbox(5) (es
    proporcionado por el paquete mutt).

    En las lenguas europeas normalmente se utiliza en el correo la
    «Codificación-para-Tranferir-Contenido:quoted-printable» con el
    juego de caracteres ISO-8859-1 ya que no existen muchos de los
    caracteres de 8 bits. SI el texto europeo esta codificado en
    UTF-8, «Codificación-para-Transferir-Contenido: quoted-printable»
    es usado como la mayor parte de la información en 7 bits.

    En japonés el tradicional «Content-Type: text/plain; charset=
    ISO-2022-JP» es normalmente utilizado en el correo ya que
    mantiene el texto en 7 bits. Pero los antiguos sistemas Microsoft
    puede enviar información en Shift-JIS sin la declaración
    correspondiente. Si el texto japonés esta codificado en UTF-8
    Base64 es como utilizar información de 8 bits. Lo que ocurre en
    otros lenguajes asiáticos es parecido.

    Nota

    Si su información de correo no Unix se accede desde un cliente
    que no es de Debian, con soporte de IMAP4, puede moverlo
    desplegando su propio servidor IMAP4 (consulte Sección 6.7,
    “Servidor POP3/IMAP4”).

    Nota

    Si utiliza otros formatos de almacenamiento de correo, moverlos
    al formato mbox es un buen comienzo. Un cliente versátil como 
    mutt(1) puede ser útil para ello.

    Puede partir el contenido del buzón de correo en mensajes
    utilizando procmail(1) y formail(1).

    Cada mensaje de correo se puede desempaquetar utilizando munpack
    (1) del paquete mpack (u otra herramienta especiaizada) para
    obtener el contenido codificado con MIME.

%

11.6. Herramientas para información gráfica

    Los siguientes paquetes para la conversión, edición y
    organización de información gráfica llamaron mi atención.

    Tabla 11.17. Relación de herramientas de información gráfica

    +-------------------------------------------------------------------------+
    |        paquete         |popularidad|tamaño|palabra clave|  descripción  |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |GNU GIMP       |
    |gimp                    |V:68, I:341|22313 |imagen       |Programa de    |
    |                        |           |      |(bitmap)     |Manipulación de|
    |                        |           |      |             |Imágenes       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |imagen       |programa de    |
    |imagemagick             |I:400      |218   |(bitmap)     |manipulación de|
    |                        |           |      |             |imágenes       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |programas de   |
    |                        |           |      |imagen       |manipulación de|
    |graphicsmagick          |V:3, I:17  |5224  |(bitmap)     |imágenes       |
    |                        |           |      |             |(bifurcaciones |
    |                        |           |      |             |de imagemagick)|
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |Interfaz       |
    |                        |           |      |             |GTK+basado en  |
    |                        |           |      |imagen       |X11 para SANE  |
    |xsane                   |V:17, I:173|2346  |(bitmap)     |(Acceso        |
    |                        |           |      |             |inmediato y    |
    |                        |           |      |             |fácil a        |
    |                        |           |      |             |escáner)       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |imagen       |herramienta de |
    |netpbm                  |V:32, I:409|4302  |(bitmap)     |conversión de  |
    |                        |           |      |             |gráficos       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |convierte      |
    |                        |           |      |             |iconos y       |
    |                        |           |      |png↔ico      |cursores MS    |
    |icoutils                |V:21, I:127|221   |(bitmap)     |Windows a y    |
    |                        |           |      |             |desde formatos |
    |                        |           |      |             |PNG            |
    |                        |           |      |             |(favicon.ico)  |
    |------------------------+-----------+------+-------------+---------------|
    |scribus                 |V:2, I:23  |30375 |ps/pdf/SVG/… |Scribus editor |
    |                        |           |      |             |de documentos  |
    |------------------------+-----------+------+-------------+---------------|
    |                        |V:177,     |      |imágen       |LibreOffice    |
    |libreoffice-draw        |I:434      |14600 |(vector)     |office suite - |
    |                        |           |      |             |dibujo         |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |editor SVG     |
    |inkscape                |V:55, I:209|84823 |imágen       |(Scalable      |
    |                        |           |      |(vector)     |Vector         |
    |                        |           |      |             |Graphics)      |
    |------------------------+-----------+------+-------------+---------------|
    |dia                     |V:5, I:31  |3727  |imágen       |editor de      |
    |                        |           |      |(vector)     |diagramas (Gtk)|
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |facilidad para |
    |xfig                    |V:2, I:15  |1793  |imágen       |la creación    |
    |                        |           |      |(vector)     |interactiva de |
    |                        |           |      |             |figuras en X11 |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |conversor de   |
    |pstoedit                |V:4, I:98  |988   |ps/pdf→image |archivos       |
    |                        |           |      |(vector)     |PostScript y   |
    |                        |           |      |             |PDF a SVG      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |herramientas de|
    |                        |           |      |             |conversión de  |
    |                        |           |      |             |archivos con   |
    |                        |           |      |Windows/     |formato        |
    |libwmf-bin              |V:10, I:211|113   |imágen       |metafile de    |
    |                        |           |      |(vector)     |Windows        |
    |                        |           |      |             |(formato de    |
    |                        |           |      |             |gráficos       |
    |                        |           |      |             |vectoriales)   |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |convierte      |
    |fig2sxd                 |V:0, I:0   |149   |fig→sxd      |archivos XFig a|
    |                        |           |      |(vector)     |formato Draw de|
    |                        |           |      |             |OpenOffice.org |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |herramienta    |
    |                        |           |      |             |para el        |
    |                        |           |      |             |procesado      |
    |unpaper                 |V:2, I:19  |460   |imágen→imágen|posteriro de   |
    |                        |           |      |             |páginas        |
    |                        |           |      |             |escaneadas para|
    |                        |           |      |             |OCR            |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |software libre |
    |tesseract-ocr           |V:8, I:37  |1500  |imágen→texto |OCR basado en  |
    |                        |           |      |             |el motor OCR   |
    |                        |           |      |             |comercial de HP|
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |motor de       |
    |                        |           |      |             |información    |
    |                        |           |      |             |OCR: archivo en|
    |tesseract-ocr-eng       |V:7, I:37  |4032  |imágen→texto |inglés         |
    |                        |           |      |             |tesseact-ocr   |
    |                        |           |      |             |para textos    |
    |                        |           |      |             |ingleses       |
    |------------------------+-----------+------+-------------+---------------|
    |gocr                    |V:1, I:13  |531   |imágen→texto |software libre |
    |                        |           |      |             |OCR            |
    |------------------------+-----------+------+-------------+---------------|
    |ocrad                   |V:0, I:5   |303   |imágen→texto |software libre |
    |                        |           |      |             |OCR            |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |programa visor |
    |eog                     |V:71, I:264|10189 |imágen(Exif) |de gráficos    |
    |                        |           |      |             |«Eye of GNOME« |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |visor y        |
    |gthumb                  |V:5, I:22  |5475  |imágen(Exif) |navegador de   |
    |                        |           |      |             |imágenes       |
    |                        |           |      |             |(GNOME)        |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |visor de       |
    |geeqie                  |V:6, I:21  |14643 |imágen(Exif) |imágenes       |
    |                        |           |      |             |utilizando GTK+|
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |organizador de |
    |shotwell                |V:19, I:223|6451  |imágen(Exif) |fotos digital  |
    |                        |           |      |             |(GNOME)        |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |aplicación para|
    |                        |           |      |             |acceder a      |
    |gtkam                   |V:0, I:6   |1154  |imágen(Exif) |material de    |
    |                        |           |      |             |cámaras        |
    |                        |           |      |             |digitales      |
    |                        |           |      |             |(GTK+)         |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |El cliente de  |
    |                        |           |      |             |línea de       |
    |gphoto2                 |V:1, I:12  |955   |imágen(Exif) |órdenes de     |
    |                        |           |      |             |cámara digital |
    |                        |           |      |             |gphoto2        |
    |------------------------+-----------+------+-------------+---------------|
    |gwenview                |V:28, I:97 |10570 |imágen(Exif) |visor de       |
    |                        |           |      |             |imágenes (KDE) |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |aplicaciones   |
    |                        |           |      |             |KDE para       |
    |kamera                  |I:97       |798   |imágen(Exif) |soporte de     |
    |                        |           |      |             |cámaras        |
    |                        |           |      |             |digitales      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |aplicación para|
    |digikam                 |V:2, I:13  |2646  |imágen(Exif) |la gestión de  |
    |                        |           |      |             |fotos digitales|
    |                        |           |      |             |para KDE       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |herramienta de |
    |exiv2                   |V:3, I:44  |321   |imágen(Exif) |manipulación de|
    |                        |           |      |             |metainformación|
    |                        |           |      |             |EXIF/IPTC      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |transforma     |
    |exiftran                |V:1, I:21  |70    |imágen(Exif) |imágenes de    |
    |                        |           |      |             |cámaras        |
    |                        |           |      |             |digitales jpeg |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |manipula la    |
    |                        |           |      |             |parte que no   |
    |                        |           |      |             |son imágenes de|
    |                        |           |      |             |los archivos   |
    |jhead                   |V:1, I:11  |109   |imágen(Exif) |jpeg de acuerod|
    |                        |           |      |             |a Exif         |
    |                        |           |      |             |(imágenes de   |
    |                        |           |      |             |cámaras        |
    |                        |           |      |             |digitales)     |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |utilidad de    |
    |                        |           |      |             |línea de       |
    |                        |           |      |             |órdenes para   |
    |exif                    |V:1, I:12  |339   |imágen(Exif) |mostrar        |
    |                        |           |      |             |información    |
    |                        |           |      |             |EXIF de        |
    |                        |           |      |             |archivos JPEG  |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |utilidad para  |
    |                        |           |      |             |leer etiquetas |
    |exiftags                |V:0, I:5   |292   |imágen(Exif) |Exif de        |
    |                        |           |      |             |archivos JPEG  |
    |                        |           |      |             |de cámaras     |
    |                        |           |      |             |digitales      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |lee            |
    |exifprobe               |V:0, I:4   |499   |imágen(Exif) |metainformación|
    |                        |           |      |             |de imágenes    |
    |                        |           |      |             |digitales      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |decodifica     |
    |                        |           |      |imágen       |imágenes en    |
    |dcraw                   |V:2, I:19  |535   |(crudo)→ppm  |crudo de       |
    |                        |           |      |             |cámaras        |
    |                        |           |      |             |digitales      |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |busca imágenes |
    |findimagedupes          |V:0, I:1   |79    |imagen→huella|duplicadas o   |
    |                        |           |      |             |parecidas      |
    |                        |           |      |             |visualmente    |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |fusiona        |
    |                        |           |      |             |imágenes para  |
    |ale                     |V:0, I:0   |839   |imágen→imágen|aumentar su    |
    |                        |           |      |             |integridad o   |
    |                        |           |      |             |crea mosaicos  |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |genera galerias|
    |                        |           |      |imagen(Exif) |HTML estáticos |
    |imageindex              |V:0, I:2   |145   |→html        |partiendo un   |
    |                        |           |      |             |grupo de       |
    |                        |           |      |             |imágenes       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |herramienta    |
    |outguess                |V:0, I:2   |261   |jpeg,png     |universal      |
    |                        |           |      |             |esteanográfica |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |editor de      |
    |librecad                |V:4, I:18  |8205  |DXF          |información CAD|
    |                        |           |      |             |(KDE)          |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |blend, TIFF, |editor de      |
    |blender                 |V:4, I:38  |79166 |VRML, …      |animaciones 3D |
    |                        |           |      |             |etc            |
    |------------------------+-----------+------+-------------+---------------|
    |mm3d                    |V:0, I:0   |3778  |ms3d, obj,   |editor OpenGL  |
    |                        |           |      |dxf, …       |de modelado 3D |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |metapaquete    |
    |open-font-design-toolkit|I:0        |10    |ttf, ps, …   |para el diseño |
    |                        |           |      |             |de tipos de    |
    |                        |           |      |             |letra abiertos |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |editor de tipos|
    |fontforge               |V:0, I:8   |4191  |ttf, ps, …   |de letra PS,   |
    |                        |           |      |             |TrueType y     |
    |                        |           |      |             |OpenType       |
    |------------------------+-----------+------+-------------+---------------|
    |                        |           |      |             |programas para |
    |                        |           |      |             |la ajuste e    |
    |                        |           |      |             |interpolación  |
    |xgridfit                |V:0, I:0   |806   |ttf          |(gridfitting y |
    |                        |           |      |             |hinting) de    |
    |                        |           |      |             |tipos de letra |
    |                        |           |      |             |TrueType       |
    +-------------------------------------------------------------------------+


    Sugerencia

    Busque más herramientras de imágenes utilizando aptitude(8) con
    la expresión regular «~Gworks-with::image» (consulte
    Sección 2.2.6, “Opciones del método de búsqueda con aptitude”).

    Aunque existen programas GUI muy potentes como gimp(1), las
    herramientas en línea de órdenes como imagemagick(1) son muy
    útiles para automatizar la manipulación de imágenes por medio de
    archivos de órdenes.

    El formato de facto de los archivos de imágenes en cámaras
    digitales es Formato de Archivo de Imagen Intercambiable (EXIF,
    Exchangeable Image File Format) que se corresponde con el formato
    de archivo de imágenes JPEGcon etiquetas de metainformación
    adicionales. Puede contener información como la fecha, la hora y
    la configuración de la cámara.

    La patente de compresión de datos sin pérdida Lempel-Ziv-Welch
    (LZW) ha expirado. Las utilidades del Formato de Intercambio de
    Gráficos (GIF, Graphics Interchange Format), que utiliza el
    método de compresión LZW, están ahora disponibles libremente en
    el sistema Debian.

    Sugerencia

    Cualquier cámara digital o escáner con un medio de grabación
    extraible interactua con Linux a través de lectores de
    almacenamiento USB ya que cumple con el las reglas del Sistema de
    archivos para Cámaras y utiliza el sistema de archivos FAT.
    Consulte Sección 10.1.7, “Dispositivos de almacenamiento
    extraibles”.

%

11.7. Conversiones de información variadas

    Existen otros programas para la conversión entre datos. Los
    siguientes paquetes llamaron mi atención al usar aptitude(8) con
    la expresión regular «~Guse::converting» (consulte Sección 2.2.6,
    “Opciones del método de búsqueda con aptitude”).

    Tabla 11.18. Relación de herramientas varias para la conversión
    de información

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño| palabra clave |   descripción    |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor entre   |
    |alien    |V:2, I:34  |161   |rpm/tgz→deb    |paquetes externos |
    |         |           |      |               |en paquetes Debian|
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |conversor de      |
    |         |           |      |               |«Libro            |
    |         |           |      |               |Electrónico«      |
    |freepwing|V:0, I:0   |421   |EB→EPWING      |(común en Japón) a|
    |         |           |      |               |uno único con     |
    |         |           |      |               |formato JIS X 4081|
    |         |           |      |               |(un subconjunto de|
    |         |           |      |               |EPWING V1)        |
    |---------+-----------+------+---------------+------------------|
    |         |           |      |               |gestión de        |
    |         |           |      |               |bibliotecas y     |
    |calibre  |V:9, I:36  |54876 |cualquiera→EPUB|conversor de      |
    |         |           |      |               |libros            |
    |         |           |      |               |electrónicos      |
    +---------------------------------------------------------------+


    Puede extraer la información de formato RPM como se muestra.

    $ rpm2cpio file.src.rpm | cpio --extract

Capítulo 12. Programación

    Algunos consejos para quién quiera aprender a programar en el
    sistema Debian para trazar el código fuente. Aquí están los
    paquetes más importantes y los paquetes de documentación más
    importantes para la programación.

    Tabla 12.1. Relación de paquetes que ayudan a la programación

    +---------------------------------------------------------------+
    |    paquete    |popularidad|tamaño|       documentación        |
    |---------------+-----------+------+----------------------------|
    |               |           |      |«info autoconf»             |
    |autoconf       |V:41, I:282|1846  |proporcionado con           |
    |               |           |      |autoconf-doc                |
    |---------------+-----------+------+----------------------------|
    |               |           |      |«info automake»             |
    |automake       |V:42, I:279|1830  |proporcionado con           |
    |               |           |      |automake1.10-doc            |
    |---------------+-----------+------+----------------------------|
    |bash           |V:791,     |6469  |«info bash» proporcionado   |
    |               |I:999      |      |con bash-doc                |
    |---------------+-----------+------+----------------------------|
    |bison          |V:9, I:103 |2815  |«info bison» proporcionado  |
    |               |           |      |con bison-doc               |
    |---------------+-----------+------+----------------------------|
    |cpp            |V:319,     |42    |«info cpp» proporcionado con|
    |               |I:770      |      |cpp-doc                     |
    |---------------+-----------+------+----------------------------|
    |ddd            |V:0, I:10  |4184  |«info ddd» proporcionado por|
    |               |           |      |ddd-doc                     |
    |---------------+-----------+------+----------------------------|
    |exuberant-ctags|V:5, I:37  |341   |exuberant-ctags(1)          |
    |---------------+-----------+------+----------------------------|
    |flex           |V:9, I:93  |1279  |«info flex» proporcionado   |
    |               |           |      |por flex-doc                |
    |---------------+-----------+------+----------------------------|
    |gawk           |V:368,     |2558  |«info gawk» proporcionado   |
    |               |I:454      |      |por gawk-doc                |
    |---------------+-----------+------+----------------------------|
    |gcc            |V:165,     |45    |«info gcc» proporcionado por|
    |               |I:604      |      |gcc-doc                     |
    |---------------+-----------+------+----------------------------|
    |gdb            |V:13, I:114|9789  |«info gdb» proporcionado por|
    |               |           |      |gdb-doc                     |
    |---------------+-----------+------+----------------------------|
    |gettext        |V:48, I:312|5843  |«info gettext» proporcionado|
    |               |           |      |por gettext-doc             |
    |---------------+-----------+------+----------------------------|
    |               |           |      |«info gfortran»             |
    |gfortran       |V:11, I:98 |16    |proporcionado por           |
    |               |           |      |gfortran-doc (Fortran 95)   |
    |---------------+-----------+------+----------------------------|
    |fpc            |I:3        |121   |fpc(1) y html por fp-docs   |
    |               |           |      |(Pascal)                    |
    |---------------+-----------+------+----------------------------|
    |glade          |V:0, I:8   |1730  |proporciona ayuda por medio |
    |               |           |      |del menú (Constructor UI)   |
    |---------------+-----------+------+----------------------------|
    |               |V:935,     |      |«info libc» proporcionado   |
    |libc6          |I:999      |12771 |por glibc-doc y             |
    |               |           |      |glibc-doc-reference         |
    |---------------+-----------+------+----------------------------|
    |make           |V:157,     |1592  |«info make» proporcionado   |
    |               |I:609      |      |por make-doc                |
    |---------------+-----------+------+----------------------------|
    |xutils-dev     |V:1, I:12  |1466  |imake(1), xmkmf(1), etc.    |
    |---------------+-----------+------+----------------------------|
    |mawk           |V:372,     |242   |mawk(1)                     |
    |               |I:997      |      |                            |
    |---------------+-----------+------+----------------------------|
    |               |V:610,     |      |perl(1) y páginas html      |
    |perl           |I:992      |705   |proporcionadas por perl-doc |
    |               |           |      |y perl-doc-html             |
    |---------------+-----------+------+----------------------------|
    |python         |V:293,     |68    |python(1) y páginas html    |
    |               |I:923      |      |proporcionado por python-doc|
    |---------------+-----------+------+----------------------------|
    |               |           |      |tcl(3) y páginas de manual  |
    |tcl            |V:31, I:414|22    |detalladas proporcionadas   |
    |               |           |      |por tcl-doc                 |
    |---------------+-----------+------+----------------------------|
    |               |           |      |tk(3) y páginas de manual   |
    |tk             |V:30, I:406|22    |detalladas proporcionados   |
    |               |           |      |por tk-doc                  |
    |---------------+-----------+------+----------------------------|
    |               |V:137,     |      |ruby(1) y la referencia     |
    |ruby           |I:318      |35    |interactiva proporcionada   |
    |               |           |      |por ri                      |
    |---------------+-----------+------+----------------------------|
    |vim            |V:106,     |3231  |ayuda(F1) del menú          |
    |               |I:398      |      |proporacionado por vim-doc  |
    |---------------+-----------+------+----------------------------|
    |susv2          |I:0        |16    |cumple «La Especificación   |
    |               |           |      |Única de UNIX v2«           |
    |---------------+-----------+------+----------------------------|
    |susv3          |I:0        |16    |cumple «La Especificación   |
    |               |           |      |Única de UNIX v3«           |
    +---------------------------------------------------------------+


    Las referencia en línea está disponible escribiendo by typing
    «man nombre» tras instalar los paquetes manpages y manpages-dev.
    La referencia en línea para las herramientas GNU están
    disponibles escribiendo «info nombre_de_programa» después de
    instalar los paquetes correspondientes de documentación. Pude
    necesitar incluir los repositorios contrib y non-free además del
    repositorio main ya que una parte de la documentación GFDL no se
    cosidera que cumple con DFSG.

    Aviso
   
    No use«test» como nombre de un archivo ejecutable. «test» es una
    orden interna del intérprete de órdenes.

    Atención

    Usted puede instalar programas de software directametne compilado
    de la fuente en «/usr/local» o «/opt» para evitar la colisión con
    los programas del sistema.

    Sugerencia

    Los ejemplos de código para crear «La canción de 99 botellas de
    Cerveza« le aportará buenas ideas para pácticamente cualquier
    lenguaje de programación.

%

12.1. Los archivos de órdenes

    Un archivo de órdenes es un archivo de texto co el bit de
    ejecución activado y contiene órdenes con el formato siguiente.

    #!/bin/sh
     ... líneas de órdenes

    La primera línea determina cuál es el intérprete de órdenes que
    se encarga de leer y ejecutar el contenido del archivo.

    La lectura de archivos de órdenes es la mejor manera de entender
    como funciona un sistema tipo Unix. Aquí, doy algunos apuntes
    para la programación de archivos de órdenes. Consulte «Errores
    con el intérprete de órdenes« (http://www.greenend.org.uk/rjk/
    2001/04/shell.html) para aprender los errores más comunes.

    A diferencia del uso interactivo del intérprete de órdenes
    (consulte Sección 1.5, “Órdenes simples para el intérprete de
    órdenes” y Sección 1.6, “Operaciones de texto al estilo de Unix”)
    en los archivos de órdenes se usan generalmente parámetros,
    condiciones y bucles.

%

12.1.1. Compatibilidad del intérprete de órdenes POSIX

    Muchos de los archivos de órdenes pueden ser interpretados por un
    intérprete de órdenes POSIX (consulte Tabla 1.13, “Relación de
    intérpretes de órdenes”). El intérprete de órdenes del sistema
    por defecto es «/bin/sh» el cual es un enlace simbólico que
    referencia al programa real.

      * bash(1) para lenny o más antiguo
   
      * dash(1) para squeeze o más nuevo

    Evite escribir archivos de órdenes con particularidades de bash o
    zs para hacerlo portable entre intérpretes de órdenes POSIX.
    Puede comprobaro utilizando checkbashisms(1).

    Tabla 12.2. Relación de particularidades de bash

    +---------------------------------------------------------------+
    |          Bien: POSIX          |         Mal: bashism          |
    |-------------------------------+-------------------------------|
    |if [ «$foo« = «$bar« ] ; then …|if [ «$foo« == «$bar« ] ; then |
    |                               |…                              |
    |-------------------------------+-------------------------------|
    |diff -u archivo.c.orig         |diff -u archivo.c{.orig,}      |
    |archivo.c                      |                               |
    |-------------------------------+-------------------------------|
    |mkdir /foobar /foobaz          |mkdir /foo{bar,baz}            |
    |-------------------------------+-------------------------------|
    |funcname() { … }               |function funcname() { … }      |
    |-------------------------------+-------------------------------|
    |octal format: «\377»           |formato hexadecimal: «\xff»    |
    +---------------------------------------------------------------+


    La orden «echo» debe utilizarse con cuidado ya que su
    implementación cambia entre la orden interna y la externa.

      * Evite utilizar cualquier opción excepto -n».
   
      * Evite utilizar secuencias de escape en una cadena ya que su
        tratamiento varia.

    Nota
   
    Ya que la opción «-n» no pertenece realmente a la sintáxis POSIX
    es aceptada normalmente.

    Sugerencia

    Utilice la orden «printf» en vez de la orden «echo» si necesita
    incluir secuencias de caracteres en las cadenas de caracteres de
    salida.

%

12.1.2. Parámetros del intérprete de órdenes

    Frecuentemente son utilizados por el intérprete de órdenes
    parámetros especiales

    Tabla 12.3. Relación de los parámetros de intérprete de órdenes

    +---------------------------------------------------------------+
    |    parámetro del    |                  valor                  |
    |intérprete de órdenes|                                         |
    |---------------------+-----------------------------------------|
    |$0                   |nombre del archivo de órdenes            |
    |---------------------+-----------------------------------------|
    |$1                   |primer parámetro del archivo de órdenes  |
    |---------------------+-----------------------------------------|
    |$9                   |noveno parámetro del archivo de órdenes  |
    |---------------------+-----------------------------------------|
    |$#                   |parámetro posicionado en el número       |
    |---------------------+-----------------------------------------|
    |«$*«                 |«$1 $2 $3 $4 … «                         |
    |---------------------+-----------------------------------------|
    |«$@«                 |«$1« «$2« «$3« «$4« …                    |
    |---------------------+-----------------------------------------|
    |$?                   |estado de finalización de la orden más   |
    |                     |reciente                                 |
    |---------------------+-----------------------------------------|
    |$$                   |PID de este archivo de órdenes           |
    |---------------------+-----------------------------------------|
    |$!                   |PID del trabajo en segundo plano que se  |
    |                     |ha iniciado más recientemente            |
    +---------------------------------------------------------------+


    Lasexpansiones de parámetros fundamentales que debe recordar son
    las que se muestran.

    Tabla 12.4. Relación de expansiones de parámetros del intérprete
    de órdenes

    +---------------------------------------------------------------+
    |forma de expresión | valor si var  |   valor si var no está    |
    |   del parámetro   | esta activado |         asignado          |
    |-------------------+---------------+---------------------------|
    |${var:-string}     |«$var»         |«string»                   |
    |-------------------+---------------+---------------------------|
    |${var:+string}     |«string»       |«null»                     |
    |-------------------+---------------+---------------------------|
    |${var:=string}     |«$var»         |«string» (y ejecuta «var=  |
    |                   |               |string»)                   |
    |-------------------+---------------+---------------------------|
    |${var:?string}     |«$var»         |echo «string» a stderr (y  |
    |                   |               |finalizar con error)       |
    +---------------------------------------------------------------+


    Aquí, el símbolo «:» en todos estos operadores es realmente
    opcional.

      * con «:» el operador = comprueba que existe y no es null
   
      * sin «:» el operador = comprueba unicamente si existe

    Tabla 12.5. Relación de las sustituciones clave de parámetros del
    intérprete de órdenes

    +---------------------------------------------------------------+
    |formulario de sustitución del |           resultado            |
    |          parámetro           |                                |
    |------------------------------+--------------------------------|
    |${var%suffix}                 |elimina patrón del sufijo más   |
    |                              |pequeño                         |
    |------------------------------+--------------------------------|
    |${var%%suffix}                |elimina el patrón del sufijo más|
    |                              |largo                           |
    |------------------------------+--------------------------------|
    |${var#prefix}                 |elimina el patrón del prefijo   |
    |                              |más pequeño                     |
    |------------------------------+--------------------------------|
    |${var##prefix}                |elimina el patrón del prefijo   |
    |                              |más largo                       |
    +---------------------------------------------------------------+


%

12.1.3. Condiciones del intérprete de órdenes

    Cada comando devuelve un estado de salida que puede usarse para
    expresioneos condicionales.

      * Éxito: 0 («Verdadero«)
   
      * Error: no 0 («Falso«)

    Nota

    En el contexto del intérprete de órdenes «0« es equivalente a
    «verdadero«, mientras que en contexto de una condición en C «0«
    significa «falso«.

    Nota
   
    «[» es el equivalente a la orden test, la cual detemina la
    expresión condicional de sus parámetros hasta«]».

    Algunas expresiones condicionales que es importate recordar son
    las que se muestran.

      * «<orden> && <si_éxito_ejecuta_esta_orden_además> || true»

      * «<orden> || <si_no_tiene_éxito_ejecuta_esta_orden_además> ||
        true»

      * Un pequeño archivo de órdenes de varias líneas como se
        muestra

    if [ <expresión_condicional> ]; then
     <si_éxito_ejecuta_esta_órden>
    else
     <si_no_éxito_ejecuta_esta_órden>
    fi

    Aquí se añade «|| true» para asegurarnos de que el archivo de
    órdenes no finaliza en esta línea si el intérprete de órdenes se
    llama con la bandera «-e».

    Tabla 12.6. Relación de operadores para comparar archivos en la
    expresión condicional

    +---------------------------------------------------------------+
    |   ecuación   |   condición que devuelve un verdadero lógico   |
    |--------------+------------------------------------------------|
    |-e <archivo>  |<archivo> existe                                |
    |--------------+------------------------------------------------|
    |-d <archivo>  |<archivo> existe y es un directorio             |
    |--------------+------------------------------------------------|
    |-f <archivo>  |<archivo> existe y es un archivo normal         |
    |--------------+------------------------------------------------|
    |-w <archivo>  |<archivo> existe y se puede modificar           |
    |--------------+------------------------------------------------|
    |-x <archivo>  |<archivo> existe y es ejecutable                |
    |--------------+------------------------------------------------|
    |<archivo1> -nt|<archivo> es más nuevo que<archivo2> (respecto  |
    |<archivo2>    |de la modificación)                             |
    |--------------+------------------------------------------------|
    |<archivo1> -ot|<archivo1> es más viejo que <archivo2> (respecto|
    |<archivo2>    |de al modificación)                             |
    |--------------+------------------------------------------------|
    |<archivo1> -ef|<archivo1> y <archivo2> están en el mismo       |
    |<archivo2>    |dispositivo y tienen el mismo número de inodo   |
    +---------------------------------------------------------------+


    Tabla 12.7. Relación de operadores de comparación de cadenas en
    expresiones condicionales

    +---------------------------------------------------------------+
    |        ecuación         | condición que devuelve un verdadero |
    |                         |               lógico                |
    |-------------------------+-------------------------------------|
    |-z <cadena_de_caracteres>|la longitud de <str> es cero         |
    |-------------------------+-------------------------------------|
    |-n <cadena_de_caracteres>|la longitud de <str> no es cero      |
    |-------------------------+-------------------------------------|
    |<cadena_de_caracteres1> =|<cadena1> y <cadena2> son iguales    |
    |<cadena_de_caracteres2>  |                                     |
    |-------------------------+-------------------------------------|
    |<cadena_de_caracteres1> !|<str1> y <str2> no son iguales       |
    |= <cadena_de_caracteres2>|                                     |
    |-------------------------+-------------------------------------|
    |<cadena_de_caracteres1> <|<cadena1> está antes que <cadena2>   |
    |<cadena_de_caracteres2>  |(depende de la configuración         |
    |                         |regional)                            |
    |-------------------------+-------------------------------------|
    |<cadena_de_caracteres1> >|<cadena1> está después de la         |
    |<cadena_de_caracteres2>  |<cadena2> (depende de la             |
    |                         |configuración local)                 |
    +---------------------------------------------------------------+


    Los operadores aritméticos de comparación de enteros en la
    expresión original son «-eq», «-ne», «-lt», «-le», «-gt» y «-ge».

%

12.1.4. Bucles del intérprete de órdenes

    Existen diferentes bucles en el intérprete de órdenes POSIX.

      * «for x in foo1 foo2 … ; do comand0 ; done» asigna
        secuencialmente elementos de la relación «foo1 foo2 …» a la
        variable «x» y ejecuta «comando».

      * «while condición ; do comando ; done» repite «comando»
        mientras «condición» sea verdadero.
   
      * «until condición ; do comando ; done» repite «comando»
        mientras «condición» no sea verdadero.

      * «break» permite salir del bucle.

      * «continue» permite continuar con la próxima iteración del
        bucle.

    Sugerencia

    La iteración sobre números como la del lenguaje C puede
    realizarse con la utilización de seq(1) como un generador de
    «foo1 foo2 …».

    Sugerencia
   
    Consulta Sección 9.3.9, “Repetición de una orden sobre archivos”.

%

12.1.5. La secuencia de procesamiento de la línea de órdenes

    El intérprete de órdenes ejecuta un archivo de órdenes siguiendo
    la secuencia que se muestra:

      * el intérprete de órdenes lee la línea

      * El intérprete de órdenes agrupa como un único elemento la
        parte de la línea incluida entre «…« o '…'.

      * el intérprete de órdenes divide el resto de la línea en 
        elementos como se muestra.

          + Espacios en blanco: <espacio> <tabulador> <nueva línea>

          + Metacaracteres: < > | ; & ( )

      * El intérprete de órdenes comprueba si cada elemento es una 
        palabra reservada para adaptar su comportamiento si no esta
        incluida entre «…« o '…'.

          + palabras reservadas: if then elif else fi for in while
            unless do done case esac

      * el intérprete de órdenes expande los alias si no están
        incluidos entre «…« o '…'

      * El intérprete de órdenes expande las tilde si no están
        incluidas entre «…« o '…'.

          + «~» → el directorio home del usuario actual

          + «~<usuario>» → el directorio home de <usuario>

      * el intérprete de órdenes expande los parámetros a sus valores
        si no están incluidos entre '…'

          + parámetro: «$PARAMETER» o «${PARAMETER}»

      * el intérprete de órdenes expande la sustitución de órdenes si
        no está incluida entre '…'

          + «$( comando )» → la salida de «comando»

          + «` comando `» → la salida de «comando»

      * el intérprete de órdenes expande las rutas de nombres que
        encajan con nombres de archivos si no están incluidas entre
        «…« o '…'

          + * → cualesquier caracteres

          + ? → un caracter

          + […] → cualquiera de los caracteres en «…»

      * el intérprete de órdenes busca las órdenes como se muestra y
        los ejecuta

          + definición de lafunción

          + orden interna

          + archivo ejecutable en «$PATH»

      * el intérprete de órdenes va a la siguiente línea y repite
        este proceso de nuevo desde el inicio de la secuencia

    Las comillas simples no tienen efecto dentro de comillas dobles.

    Si ejecuta «set -x» en el intérprete de órdenes o lo llama con la
    opción «-x» hace que se impriman todas las órdenes ejecutadas.
    Esto puede ser muy útil para la depuración.

%

12.1.6. Programas útiles para los archivos de órdenes

    Para hacer los archivos de órdenes tan portables como sea posible
    entre sistemas Debian, es una buena idea limitar las utilidades a
    aquellos que son proporcionados por los paquetes esenciales.

      * «aptitude search ~E» relación paquetes esenciales.
   
      * «dpkg -L <paquete> | grep '/man/man.*/'» relación páginas de
        manual de las órdenes del paquete <paquete>.

    Tabla 12.8. Relación de paquetes que contienen pequeñas
    utilidades para los archivos de órdenes

    +---------------------------------------------------------------+
    |  paquete   |popularidad|tamaño|          descripción          |
    |------------+-----------+------+-------------------------------|
    |coreutils   |V:891,     |17478 |Utilidades fundamentales GNU   |
    |            |I:999      |      |                               |
    |------------+-----------+------+-------------------------------|
    |debianutils |V:925,     |230   |utilidades varias específicas  |
    |            |I:999      |      |de Debian                      |
    |------------+-----------+------+-------------------------------|
    |bsdmainutils|V:60, I:996|26    |colección de más utilidades de |
    |            |           |      |FreeBSD                        |
    |------------+-----------+------+-------------------------------|
    |bsdutils    |V:673,     |393   |utilidades básicas de BSD-Lite |
    |            |I:999      |      |4.4                            |
    |------------+-----------+------+-------------------------------|
    |moreutils   |V:11, I:35 |237   |utilidades adicionales de Unix |
    +---------------------------------------------------------------+


    Sugerencia

    A pesar de que moreutils puede encontrarlo únicamente en Debian,
    ofrece pequeños programas interesantes. El más interesante es 
    sponge(8) que es bastantes útil cuando quiere sobreescribir un
    archivo original.

%

12.1.7. Archivo de órdenes dialog

    El interfaz de usuario de un programa de archivo de órdenes
    simple puede mejorarse mediante una interacción sosa de las
    órdenes echo y read. Si desea más interacción puede utilizar los
    llamados programas de diálogos etc.

    Tabla 12.9. LIsta de programas de interfaz de usuario

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño|           descripción            |
    |---------+-----------+------+----------------------------------|
    |         |V:180,     |      |xmessage(1): muestra un mensaje o |
    |x11-utils|I:599      |712   |realiza un pregunta en una ventana|
    |         |           |      |(X)                               |
    |---------+-----------+------+----------------------------------|
    |         |           |      |muestra cuadros de diálogo de     |
    |whiptail |V:87, I:995|71    |fácil uso para los archivos de    |
    |         |           |      |órdenes (newt)                    |
    |---------+-----------+------+----------------------------------|
    |         |           |      |muestra cuadros de diálogo de     |
    |dialog   |V:15, I:123|1222  |fácil uso para los archivos de    |
    |         |           |      |órdenes (ncurses)                 |
    |---------+-----------+------+----------------------------------|
    |         |           |      |muestra cuadros de diálogo        |
    |zenity   |V:87, I:409|384   |gráficos del archivo de órdenes   |
    |         |           |      |(gtk2.0)                          |
    |---------+-----------+------+----------------------------------|
    |         |           |      |Herramienta de interfaz de archivo|
    |ssft     |V:0, I:0   |75    |de órdenes (cubierto con zenity,  |
    |         |           |      |kdialog y dialog con gettext)     |
    |---------+-----------+------+----------------------------------|
    |gettext  |V:48, I:312|5843  |«/usr/bin/gettext.sh»: traduce un |
    |         |           |      |mensajes                          |
    +---------------------------------------------------------------+


%

12.1.8. Ejemplo de archivo de órdenes con zenity

    Aquí esta un archivo de órdenes simple que crea una imágen ISO
    con datos redundantes RS02 mediante dvdisaster(1).

    #!/bin/sh -e
    # gmkrs02 : Copyright (C) 2007 Osamu Aoki <osamu@debian.org>, Public Domain
    #set -x
    error_exit()
    {
      echo "$1" >&2
      exit 1
    }
    # Initialize variables
    DATA_ISO="$HOME/Desktop/iso-$$.img"
    LABEL=$(date +%Y%m%d-%H%M%S-%Z)
    if [ $# != 0 ] && [ -d "$1" ]; then
      DATA_SRC="$1"
    else
      # Select directory for creating ISO image from folder on desktop
      DATA_SRC=$(zenity --file-selection --directory  \
        --title="Select the directory tree root to create ISO image") \
        || error_exit "Exit on directory selection"
    fi
    # Check size of archive
    xterm -T "Check size $DATA_SRC" -e du -s $DATA_SRC/*
    SIZE=$(($(du -s $DATA_SRC | awk '{print $1}')/1024))
    if [ $SIZE -le 520 ] ; then
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="The data size is good for CD backup:\\n $SIZE MB"
    elif [ $SIZE -le 3500 ]; then
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="The data size is good for DVD backup :\\n $SIZE MB"
    else
      zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
        --text="The data size is too big to backup : $SIZE MB"
      error_exit "The data size is too big to backup :\\n $SIZE MB"
    fi
    # only xterm is sure to have working -e option
    # Create raw ISO image
    rm -f "$DATA_ISO" || true
    xterm -T "genisoimage $DATA_ISO" \
      -e genisoimage -r -J -V "$LABEL" -o "$DATA_ISO" "$DATA_SRC"
    # Create RS02 supplemental redundancy
    xterm -T "dvdisaster $DATA_ISO" -e  dvdisaster -i "$DATA_ISO" -mRS02 -c
    zenity --info --title="Dvdisaster RS02" --width 640  --height 400 \
      --text="ISO/RS02 data ($SIZE MB) \\n created at: $DATA_ISO"
    # EOF

    Puede que quiera crear un lanzador en el escritorio con una orden
    parecida a «/usr/local/bin/gmkrs02 %d».

%

12.2. Make

    Make es una utilidad para mantener grupos de programas. is a
    utility to maintain groups of programs. La ejecución de make(1)
    consiste en, la lectura del archivo de reglas «Makefile» por
    parte de make y la actualización de un objetivo si los archivos
    que son necesarios han sido modificados desde la última vez o si
    el objetivo no existe. La ejecución de estas actualizaciones
    pueden suceder de concurrentemente.

    La sintáxis del archivo de reglas es la que se muestra.

    objetivo: [ prerequisitos ... ]
     [TAB]  orden1
     [TAB]  -orden2 # ignora los errores
     [TAB]  @orden3 # no imprime la salida

    Aquí «[TAB]» es un código TAB. Cada línea es interpretada por el
    intérprete de órdenes después de la sustitución de las variables.
    Utilice «\» al final de la líena para continuar el archivo de
    órdenes. Utilice «$$» para incluir «$» par los valores del
    entorno para el archivo de órdenes.

    Las reglas implícitas y los prerequisitos para un objetivos
    pueden ser escrito, por ejemplo, como se muestra.

    %.o: %.c header.h

    Aquí, el objetivo contiene el carácter «%» (únicamente un
    carácter). El carácter %» encaja con cualquier cadena no vacía
    que corresponda a los nombres de archivo del objetivo real. Así
    mismo el prerrequisito utiliza «%» para mostrar como se
    relaciones sus nombres con los nombres del objetivo real.

    Tabla 12.10. Relación de variables automáticas de make

    +---------------------------------------------------------------+
    |variable automática|                   valor                   |
    |-------------------+-------------------------------------------|
    |$@                 |objetivo                                   |
    |-------------------+-------------------------------------------|
    |$<                 |primer prerrequisitos                      |
    |-------------------+-------------------------------------------|
    |$?                 |todos los prerrequisitos nuevos            |
    |-------------------+-------------------------------------------|
    |$^                 |todos los prerequisitos                    |
    |-------------------+-------------------------------------------|
    |$*                 |«%» encaja la raíz en el patrón del        |
    |                   |objetivo                                   |
    +---------------------------------------------------------------+


    Tabla 12.11. Relación de expansiones de variables de make

    +------------------------------------------+
    |expansión variable|      descripción      |
    |------------------+-----------------------|
    |foo1 := bar       |expansión por única vez|
    |------------------+-----------------------|
    |foo2 = bar        |expansión recursiva    |
    |------------------+-----------------------|
    |foo3 += bar       |anexar                 |
    +------------------------------------------+


    Ejecute «make -p -f/dev/null»para ver las reglas internas
    automática.

%

12.3. C

    Puede configurar su entorno para la compilación de programas
    escritos en el lenguaje de programación C como se muestra.

    # apt-get install glibc-doc manpages-dev libc6-dev gcc build-essential

    El paquete libc6-dev, a saber, la biblioteca GNU C, aporta la
    biblioteca estándar de C que es un conujnto de archivos de
    cabecera y rutinas de biblioteca utilizadas por el lenguaje de
    programación C.

    Consulte las referencias siguientes sobre C.

      * «info libc» (referencia de las funciones de la biblioteca de
        C)

      * gcc(1) y «info gcc»
   
      * nombre_de_cada_función_de_la_biblioteca_de_C(3)

      * Kernighan & Ritchie, «The C Programming Language«, 2nd
        edición (Prentice Hall)

%

12.3.1. Programa sencillo en C (gcc)

    Se puede crear un ejecutable «ejecutable_de_ejemplo» utilizando
    la biblioteca «libm» mediante este sencillo ejemplo.

    $ cat > ejemplo.c << EOF
    #include <stdio.h>
    #include <math.h>
    #include <string.h>

    int main(int argc, char **argv, char **envp){
            double x;
            char y[11];
            x=sqrt(argc+7.5);
            strncpy(y, argv[0], 10); /* impide el desbordamiento */
            y[10] = '\0'; /* asegura que la cadena finaliza con '\0' */
            printf(«%5i, %5.3f, %10s, %10s\n«, argc, x, y, argv[1]);
            return 0;
    }
    EOF
    $ gcc -Wall -g -o ejecutable_de_ejemplo ejemplo..c -lm
    $ ./ejecutable_de_ejemplo
            1, 2.915, ./run_exam,     (null)
    $ ./run_example 1234567890qwerty
            2, 3.082, ./run_exam, 1234567890qwerty

    Aquí, se necesita «-lm» para enlazar la biblioteca «/usr/lib/
    libm.so» del paquete libc6 para utilizar la función sqrt(3). La
    biblioteca real está ubicada en «/lib/» con el nombre de archivo
    «libm.so.6», el cual es un enlace simbólico a «libm-2.7.so».

    Mire el último elemento de la salida. Tiene incluso más de 10
    caracteres a pesar de tener «%10s».

    La utilización de operaciones de punteros sin comprobar los
    límites, como ocurre con sprintf(3) y strcpy(3), no se utilizan
    para evitar el desbordamiento del buffer que puede provocar
    problemas desconocidos. En su lugar se utilizan snprintf(3) y 
    strncpy(3).

%

12.4. Depuración

    La depuración es una de las actividades más importantes de la
    programación. Conocer como depurar un programa le convierte en un
    usuario de Debian mejor que puede aportar informes de error
    relevantes.

%

12.4.1. Fundamentos de gdb

    El principal depurador en Debian es gdb(1) el cual permite
    inspeccionar un programa mientras se ejecuta.

    Instalemo gdb y otros programas relevantes com se muestra.

    # apt-get install gdb gdb-doc build-essential devscripts

    Puede encontrar un buen tutorial de gdb en «info gdb» y mucha más
    información a través de Internet. Aquí hay un ejemplo sencillo de
    la utilización de gdb(1) en un «programa» que ha sido compilado
    para producir información de depuración con la opción «-g».

    $ gdb programa
    (gdb) b 1                # pone un punto de ruptura en la línea 1
    (gdb) run args           # ejecuta el programa con args
    (gdb) next               # siguiente línea
    ...
    (gdb) step               # paso hacia adelante
    ...
    (gdb) p parm             # imprime el valor de parm
    ...
    (gdb) p parm=12          # le asigna el valor de 12
    ...
    (gdb) quit

    Sugerencia

    Existen abreviaturas para la mayor parte de las órdenes de gdb(1)
    . La expansión del tabulador funciona de la misma manera que en
    el intérprete de órdenes.

%

12.4.2. Depurando un paquete Debian

    Por omisión, en un paquete normal, los binarios del sistema
    Debian deben estar limpios por lo que la mayor parte de los
    símbolos del sistema son eliminados. Para depurar un paquete
    Debian con gdb(1), se necesita la instalación de su paquete
    correspondiente *-dbg o *-dbgsym (p. ej. libc6-dbg en el caso de
    la libc6 o coreutils-dbgsym en el caso de coreutils).

    Los paquetes más antiguos tienen su paquete *-dbg
    correspondiente. Este se encuentra en el área principal del
    archivo Debian junto con el propio paquete. Los paquetes más
    nuevos pueden generar de forma automática cuando se construyen
    paquetes *-dbgsym y estos están separados en el archivo
    debian-debug. Para más información al respecto consulte los
    artículos de la Wiki de Debian.

    Si el paquete que se quiere depurar no ofrece ni su versión *-dbg
    ni su versión *-dbgsym, necesita instalarlo después de
    construirlo como se muestra.

    $ mkdir /path/new ; cd /path/new
    $ sudo apt-get update
    $ sudo apt-get dist-upgrade
    $ sudo apt-get install fakeroot devscripts build-essential
    $ apt-get source package_name
    $ cd package_name*
    $ sudo apt-get build-dep ./

    Si lo necesita corrija los errores.

    Cuando recompile la publicación de un paquete ya existente elija
    una que no exista en Debian, p. ej. añadiendole «+debug1» o
    añadiendole «~pre1» como se muestra.

    $ dch -i

    Para compilar e instalar paquetes con la depuración de símbolos
    activada realice las siguientes operaciones:

    $ export DEB_BUILD_OPTIONS="nostrip noopt"
    $ debuild
    $ cd ..
    $ sudo debi package_name*.changes

    Necesita comprobar que los archivos de órdenes del paquete y
    utlizar «CFLAGS=-g -Wall» para la compilación de binarios.

%

12.4.3. Obteniendo trazas

    Cuando encuentre un programas que no funciona, es una buena idea
    al informar del error añadir información sobre las trazas de su
    ejecución.

    Las trazas se generan siguiendo los siguientes pasos.

      * Ejecute el programa con gdb(1).

      * Reproduzca el mal funcionamiento del programa.
   
          + Al reproducirlo volverá al cursor de gdb.

      * Escriba «bt» en el cursor de gdb.

    Si el programa deja de responder, puede salir de su ejecución
    pulsando Ctrl-C en el terminal que ejecuta gdb para volver al
    cursor de gdb.

    Sugerencia

    Frecuentemente encontrará en primeras líneas «malloc()» o
    «g_malloc()». Cuando esto ocurre disminuyen las posibilidades de
    que las trazas sean útiles. La forma más fácil de encontrar
    alguna información útil es asignado a la variable de entorno
    «$MALLOC_CHECK_» el valor de 2 (malloc(3)). Puede hacer esto a la
    vez que se ejecuta gdb como se muestra.

     $ MALLOC_CHECK_=2 gdb hello

%

12.4.4. Órdenes avanzadas de gdb

    Tabla 12.12. Relación de órdenes avanzadas gdb

    +---------------------------------------------------------------+
    |     orden      | descripción de la funcionalidad de la orden  |
    |----------------+----------------------------------------------|
    |(gdb) hilo      |recogen trazas de todos los hilos para        |
    |aplica a todos  |programas multihilo                           |
    |bt              |                                              |
    |----------------+----------------------------------------------|
    |(gdb) bt full   |recoge los parámetros de la pila de las       |
    |                |llamadas de función                           |
    |----------------+----------------------------------------------|
    |(gdb) thread    |recoge trazas y parámetros como una           |
    |apply all bt    |combinación de las opciones anteriores        |
    |full            |                                              |
    |----------------+----------------------------------------------|
    |(gdb) thread    |recoge trazas y parámetros de las 10 llamadas |
    |apply all bt    |más recientes para eliminar información no    |
    |full 10         |relevante                                     |
    |----------------+----------------------------------------------|
    |(gdb) set       |escribe la salida del registro de gdb a un    |
    |logging on      |archivo (por defecto «gdb.txt»)               |
    +---------------------------------------------------------------+


%

12.4.5. Errores de depuración X

    Si el programa GNOME preview1 ha recibido un error de las X se
    puede ver el mensaje como se muestra.

    El programa 'preview1' ha recibido un error del Sistema de Ventanas X.

    En este caso, puede intentar ejecutar el programa con «--sync», y
    poner un punto de ruptura en la función «gdk_x_error» con el fin
    de obtener trazas.

%

12.4.6. Comprobar las dependencias de las bibliotecas

    Utilice como se muestra ldd(1) para determinar las bibliotecas de
    las que depende un programa.

    $ ldd /bin/ls
            librt.so.1 => /lib/librt.so.1 (0x4001e000)
            libc.so.6 => /lib/libc.so.6 (0x40030000)
            libpthread.so.0 => /lib/libpthread.so.0 (0x40153000)
            /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)

    Para que ls(1) funcione en un entorno `chroot` las bibliotecas
    siguientes deben estar disponibles en dicho entorno.

    Consulte Sección 9.3.6, “Trazando la actividad de un programa”.

%

12.4.7. Herramientas de detección de fugas de memoria

    Existen varias herramientas de detección de fugas de memoria en
    Debian.

    Tabla 12.13. Relación de herramientas de detección de fugas de
    memoria

    +---------------------------------------------------------------+
    |   paquete    |popularidad|tamaño|         descripción         |
    |--------------+-----------+------+-----------------------------|
    |libc6-dev     |V:249,     |14357 |mtrace(1): funcionalidad de  |
    |              |I:620      |      |depuración de malloc en glibc|
    |--------------+-----------+------+-----------------------------|
    |valgrind      |V:6, I:46  |80378 |depurador y analizador de    |
    |              |           |      |memoria                      |
    |--------------+-----------+------+-----------------------------|
    |electric-fence|V:0, I:5   |70    |depurador malloc(3)          |
    |--------------+-----------+------+-----------------------------|
    |leaktracer    |V:0, I:3   |57    |programas C++ para trazar    |
    |              |           |      |fugas de memoria             |
    |--------------+-----------+------+-----------------------------|
    |libdmalloc5   |V:0, I:3   |393   |biblioteca de depuración de  |
    |              |           |      |la asignación de memoria     |
    +---------------------------------------------------------------+


%

12.4.8. Herramientas de análisis estático de memoria

    Existen herramientas para el análisis estádito de código como
    lint.

    Tabla 12.14. Relación de las herramientras para el análisis de
    código estático

    +---------------------------------------------------------------+
    |   paquete   |popularidad|tamaño|         descripción          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |herramienta para la           |
    |splint       |V:0, I:4   |2315  |comprobación estática de      |
    |             |           |      |errores de programación en C  |
    |-------------+-----------+------+------------------------------|
    |             |           |      |herramienta que examina código|
    |flawfinder   |V:0, I:0   |181   |fuente en C/C++ para encontrar|
    |             |           |      |debilidades de seguridad      |
    |-------------+-----------+------+------------------------------|
    |             |V:610,     |      |intérprete con comprobador de |
    |perl         |I:992      |705   |código estático interno:      |
    |             |           |      |B::Lint(3perl)                |
    |-------------+-----------+------+------------------------------|
    |pylint       |V:2, I:13  |1371  |comprobador de código estático|
    |             |           |      |Python                        |
    |-------------+-----------+------+------------------------------|
    |weblint-perl |V:0, I:1   |32    |comprobador de estilo mínimo y|
    |             |           |      |sintáctico para HTML          |
    |-------------+-----------+------+------------------------------|
    |             |           |      |herramientas de mantenimiento |
    |linklint     |V:0, I:0   |344   |de sitios web y comprobador de|
    |             |           |      |enlaces rápido                |
    |-------------+-----------+------+------------------------------|
    |libxml2-utils|V:22, I:246|182   |utilidades para la validación |
    |             |           |      |de archivos XML xmllint(1)    |
    +---------------------------------------------------------------+


%

12.4.9. Desemsamblado de binarios

    Usted puede desemsamblar código binario con objdump(1) como se
    muestra.

    $  objdump -m i386 -b binary -D /usr/lib/grub/x86_64-pc/stage1

    Nota
   
    gdb(1) puede ser utilizado para desemsamblar el código de forma
    interactiva.

%

12.5. Flex — una mejora de Lex

    Flex es un generador rápido de analizadores léxicos compatible
    con Lex.

    Puede encontrar un tutuorial de flex(1) en «info flex».

    Necesita que proporcione su propio «main()» y «yywrap()». De otra
    manera su programa flex se parecerá a este al compilarlo sin la
    biblioteca. Esto es debido a que «yywrap» es una macro y «%option
    main» se combierte implicitamente en «%option noyywrap».

    %option main
    %%
    .|\n    ECHO ;
    %%

    También puede compilar con la opción de enlazado «-lfl» al final
    de su línea de órdenes cc(1) (como AT&T-Lex con «-ll»). En ese
    caso no es necesaria la opción «%option».

%

12.6. Bison — una mejora de Yacc

    Los paquetes que proporcionan un mejor y compatible Yacc son el
    analizador sintáctico LR o el analizador sintáctico LALR de
    Debian.

    Tabla 12.15. Relación de analizadores sintácticos LALR
    compatibles con Yacc

    +---------------------------------------------------------------+
    |paquete|popularidad|tamaño|            descripción             |
    |-------+-----------+------+------------------------------------|
    |bison  |V:9, I:103 |2815  |Analizador sintáctico GNU LALR      |
    |-------+-----------+------+------------------------------------|
    |byacc  |V:0, I:6   |160   |Analizador sintáctico LALR Berkeley |
    |-------+-----------+------+------------------------------------|
    |btyacc |V:0, I:0   |243   |analizador sintáctico hacia atrás   |
    |       |           |      |basado en byacc                     |
    +---------------------------------------------------------------+


    Puede encontrar un tutorial de bison(1) en «info bison».

    Puede que sea necesario que proporcione su propio «main()» y
    «yyerror()». El método «main()» invoca «yyparse()» el cual invoca
    «yylex()», que normalmente se crea con Flex.

%

12.7. Autoconf

    Autoconf es una herramienta para la producción de automática de
    archivos de órdenes que configura de forma automática los
    paquetes de código fuente y los adapat a diferentes sistemas tipo
    Unix utilizando el sistema de construcción GNU completo.

    Autoconf(1) crea el archivo de órdenes de configuración
    «configure». «Configure» crea de forma automática un archivo
    «Makefile» personalizado utilizando la plantilla «Makefile.in».

%

12.7.1. Compilando e instalando un programa

    Aviso
   
    Cuando compile programas y los instale no sobreescriba los
    archivos del sistema.

    Debian no modifica los archivos en «/usr/local/» o «/opt». Así
    que si compila un programa desde el código fuente, instaleló en «
    /usr/local/» para que no interfiera con Debian.

    $ cd src
    $ ./configure --prefix=/usr/local
    $ make
    $ make install # pone los archivos en el sistema

%

12.7.2. Desistalando programas

    Si se tiene el código original, se utiliza autoconf(1)/automake
    (1) y se recuerda como se configuró, ejecute lo siguiente para
    realizar la desistalación del programa.

    $ ./configure «todas_las_opciones_que_le_dió«
    # make uninstall

    Otra manera, si está totalmente seguro de que la instalación solo
    únicamente archivos en «/usr/local/» y no hay nada importante
    allí, puede borrar todo su contenido como se muestra.

    # find /usr/local -type f -print0 | xargs -0 rm -f

    Si no está seguro de donde se instalaron los archivos, debe
    sopesar utilizar checkinstall(8) del paquete checkinstall, que
    proporciona una ruta limpia para la desistalación. Ahora soporta
    la creación de paquetes Debian con la opción «-D».

%

12.8. Locura de pequeños archivos de órdenes en Perl

    A pesar de que cualquier archivo de órdenes AWK puede ser
    reeescrito de forma automática en Perl utilizando a2p(1), los
    archivos de órdenes de una línea AWK se convierten mejor a
    archivos de órdenes de una sola línea en Perl de forma manual.

    Pensemos en el siguiente fragmento de archivo de órdenes de AWK.

    awk '($2==«1957«) { print $3 }' |

    Esto es equivalente a cualquiera de las siguientes líneas.

    perl -ne '@f=split; if ($f[1] eq «1957«) { print «$f[2]\n«}' |

    perl -ne 'if ((@f=split)[1] eq «1957«) { print «$f[2]\n«}' |

    perl -ne '@f=split; print $f[2] if ( $f[1]==1957 )' |

    perl -lane 'print $F[2] if $F[1] eq «1957«' |

    perl -lane 'print$F[2]if$F[1]eq+1957' |

    El último es retorcido. Utiliza algunas de las funcionalidades
    avanzadas de Perl.

      * El espacio en blanco es opcional.
   
      * La conversión entre números y cadenas se realiza de forma
        automática.

    Consulte perlrun(1) sobre las opciones de la línea de órdenes.
    Puede encotrar más archivos de órdenes en Perl retorcidos en Perl
    Golf y pueden ser muy interesantes.

%

12.9. Web

    Se pueden crear páginas web dinámicas básicas como se muestra.

      * Las consultas se presentan al navegador del usuario
        utilizando formularios HTML.

      * Rellenando y pulsado sobre las entradas del formulario se
        envia la cadena URL con los parámetros codificados desde el
        navegador al servidor web.

          + «http://www.foo.dom/cgi-bin/program.pl?VAR1=VAL1&VAR2=
            VAL2&VAR3=VAL3»

          + «http://www.foo.dom/cgi-bin/program.py?VAR1=VAL1&VAR2=
            VAL2&VAR3=VAL3»

          + «http://www.foo.dom/program.php?VAR1=VAL1&VAR2=VAL2&VAR3=
            VAL3»

      * «%nn» en la URL se sustituye por el carácter hexadecimal que
        tiene el valor nn.

      * Las variables de entorno se asignan como: «QUERY_STRING=«VAR1
        =VAL1 VAR2=VAL2 VAR3=VAL3«».

      * Un programa CGI (independientemente de su extensión
        «programa.*») en un servidor web se ejecuta a si mimo con la
        variable de entorno «$QUERY_STRING».

      * La salida de un programa CGI se envía al servidor web y se
        representa como una página web dinámica.

    Por seguridad es mejor no realizar de forma manual o de otras
    formas la gestión de análisis de los parámetros CGI. Existen
    módulos para ello en Perl y Python. PHP tiene dicha
    funcionalidad. Cuando se necesita almacenar información del
    usuario, se utilizan las cookies HTTP cookies. Cuando se necesita
    procesar información en el lado del cliente, normalmente se
    utiliza Javascript.

    Para mayor información, consulteInterfaz de Pasarela Común
    (Common Gateway Interface), La Fundación de Software Apache (The
    Apache Software Foundation) y JavaScript.

    Buscar «CGI tutorial« en Google, escribiendo la URL codificada
    http://www.google.com/search?hl=en&ie=UTF-8&q=CGI+tutorial
    directamente en la barra de direcciones del navegador, es una
    buena manera de ver en acción un archivo de órdenes en el
    servidor G¡de Google.

%

12.10. La traducción de código fuente

    Existen aplicaciones para convertir código fuente de un lenguaje
    a otro.

    Tabla 12.16. Relación de herramientas de traducción de código
    fuente

    +---------------------------------------------------------------+
    | paquete |popularidad|tamaño| palabra |      descripción       |
    |         |           |      |  clave  |                        |
    |---------+-----------+------+---------+------------------------|
    |perl     |V:610,     |705   |AWK→PERL |converit código fuente  |
    |         |I:992      |      |         |de AWK a PERL: a2p(1)   |
    |---------+-----------+------+---------+------------------------|
    |         |           |      |         |convierte código fuente |
    |f2c      |V:0, I:6   |442   |FORTRAN→C|de FORTRAN 77 a C/C++:  |
    |         |           |      |         |f2c(1)                  |
    |---------+-----------+------+---------+------------------------|
    |         |           |      |         |convierte de NASM       |
    |intel2gas|V:0, I:0   |178   |intel→gas|(formato Intel) a GAS   |
    |         |           |      |         |(Ensamblador GNU)       |
    +---------------------------------------------------------------+


%

12.11. Haciendo un paquete Debian

    Si quiere hacer un paquete Debian, lea lo siguiente.

      * Capítulo 2, Gestión de paquetes Debian para comprender los
        fundamentos del sistema de paquetes

      * Sección 2.7.13, “Portar un paquete a un sistema estable” para
        comprender lo fundamental del proceso de portabilidad

      * Sección 9.10.4, “Sistemas chroot” para comprender los
        fundamentos de la técnica de chroot

      * debuild(1), pbuilder(1) y pdebuild(1)

      * Sección 12.4.2, “Depurando un paquete Debian” para la
        recompilación con la finalidad de la depuración

      * Nueva Guía del Mantenedor de Debian (Debian New Maintainers'
        Guide) como tutorial (en el paquete maint-guide)

      * Referencia de Desarrolladores de Debian (Debian Developer's
        Reference) (en el paquete developers-reference)

      * Manual Directrices de Debian (en el paquete debian-policy)

      * Guía de Mantenedores Debian (Guide for Debian Maintainers)
        (el paquete debmake-doc)

    Existen paquetes que ayudan al empaquetado como debmake, dh-make,
    dh-make-perl, etc.

Apéndice A. Apéndice

    Aquí estan las referencias de este documento.

A.1. La mazmorra de Debian

    El sistema Debian es una platadorma de computación compleja para
    un equipo en red. Sin embargo, aprender a utilizar todas sus
    capacidades no es sencillo. Configurar una cola de impresora LPR
    con una impresora que no soporta PostScript es un buen ejemplo de
    ello. (No existen ahora problemas con ello desde que se utiliza
    el sistema CUPS).

    Es un completo y detallado mapa llamado el «CÓDIGO FUENTE«. Es
    muy preciso pero difícil de entender. Existen también referencias
    a Cómos o MiniCómos. Son más fáciles de comprender pero tienden a
    dar demasiados detalles y pierden la visión global. Algunas veces
    tengo problemas para encontrar la sección correcta en los Cómos
    largo cuando solo necesito saber como se ejecutan.

    I hope this "Debian Reference (version 2.77)" (2021-01-10
    06:32:51 UTC) provides a good starting direction for people in
    the Debian maze.

A.2. Histórico de copyright

    La Referencia de Debian fue iniciada por mi, Osamu Aoki <osamu at
    debian punto org>, como un sistema personal de administración de
    notas. Mucho contenido proviene del conocimiento que he adquirido
    de la lista de correo de usuarios de debian y otros recursos
    Debian.

    La Referencia de Debian (versión 1, 2001-2007) fue creado como
    una sugerencia de Josip Rodin, que es muy activo en el Proyecto
    de Documentación Debian (DDP) como parte de los documentos DDP.

    Después de 6 años, me di cuenta de que la versión original de la
    «Referencia de Debian« estaba desactualizada y comencé a
    reescribir parte de su contenido. La nueva «Referencia de Debian
    (versión 2)» se publicó en 2008.

    El contenido del tutorial puede ser seguido desde su original y
    su inspiración como se muestra.

      * «Guía Linux de Usuario (Linux User's Guide)« de Larry
        Greenfield (Diciembre 1996)

          + obsoleto por el «Tutorial de Debian«

      * «Tutorial de Debian« de Havoc Pennington. (11 Diciembre,
        1998)

          + parcialmente escrito por Oliver Elphick, Ole Tetlie,
            James Treacy, Craig Sawyer e Ivan E. Moore II

          + obsoleto por la «GNU/Linux Debian: guía de instalación y
            uso«

      * «GNU/Linux Debian: guía de instalación y uso« de John Goerzen
        y Ossama Othman (1999)

          + obsoleto por la «Referencia de Debian (versión 1)«

    El paquete y la descripción del archivo puede seguir algo sobre
    sus origenes y su inspiración en lo siguiente.

      * «FAQ Debian FAQ« (versión de March 2002, que era mantenida
        por Josip Rodin)

    Otro contenido puede seguir a sus originales y su inspiración de
    lo siguiente.

      * «Referencia de Debian (version 1)« de Osamu Aoki (2001–2007)
   
          + obsoleted by the newer "Debian Reference (version 2)" in
            2008.

    La versión anterior «Referencia Debian (versión 1)« fue creada
    por varios autores.

      * la mayor parte del contenido de la configuración de red fue
        escrito por Thomas Hood

      * una parte significativa del contenido de X y CSV fue escrita
        por Brian Nelson

      * la ayuda en los archivos de órdenes de contrucciń y la mayor
        parte de las correcciones fueron aportadas por Jens Seidel

      * gran parte de las correcciones fueron aportadas por David
        Sewell

      * múltiples contribuciones de los traductores, colaboradores y
        personas que descubrieron errores

    Muchas páginas de manual y páginas info del sistema Debian han
    sido usadas como referencia principal para escribir este
    documento. Many manual pages and info pages on the Debian system
    were used as the primary references to write this document. En
    cuanto que Osamu Aoki consideró un uso justo, muchas partes de
    ellos, especialmente la definición de órdenes, fueron usadas como
    parte de otras frases, con un uso cuidadoso para ajustarla al
    estilo y objetivo de este documento.

    La descripción de depurardor gdb se amplió utilizando el
    contenido de la Wiki de Debian sobre la depuración con el
    consentimiento de Ari Pollak, Loïc Minier y Dafydd Harries.

    Contents of the current "Debian Reference (version 2.77)"
    (2021-01-10 06:32:51 UTC) are mostly my own work except as
    mentioned above. These has been updated by the contributors too.

    El autor, Osamu Aoki, agradece a todos ellos su ayuda para hacer
    posible este documento.

A.3. Formato del documento

    La fuente del documento original en inglés está escrito en
    archivos de texto en formato AsciiDoc. AsciiDoc se usa solo por
    conveniencia puesto que requiere escribir menos que XML puro y
    permite insertar tablas de forma muy intuitiva. Debería
    considerar los ficheros XML y PO como los archivos fuentes
    reales. Mediante archivos de órdenes para su construcción, se
    convierte a formato DocBook XML y los datos generados
    automáticamente se insertan para componer la fuente DocBook XML
    final. La fuente DocBook XML final se puede convertir en HTML,
    epub, texto plano, PostScript y PDF. (Algunos formatos pueden
    omiten cuando se distribuye.)

